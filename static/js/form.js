seajs.use("form/tplutil");

define("form/componentmodel", function(n, y, u) {
    n = Backbone.Model.extend({
        initialize: function(m) {
            null != m && (this.formId = m.reportId)
        },
        getFormSelectFields: function(m) {
            $.ajax({
                type: TEAMS.ajaxMethod,
                contentType: "application/json",
                url: "/formfieldstat/findFormStatFields.json",
                dataType: "json",
                data: JSON.stringify({
                    formId: this.formId
                }),
                success: function(h) {
                    m && m(h)
                }
            })
        },
        findFormAllFields: function(m) {
            $.ajax({
                type: TEAMS.ajaxMethod,
                contentType: "application/json",
                url: "/formfieldstat/findFormAllFields.json",
                dataType: "json",
                data: JSON.stringify({
                    formId: this.formId
                }),
                success: function(h) {
                    m && m(h)
                }
            })
        },
        getFormTableSelectFields: function(m) {
            $.ajax({
                type: TEAMS.ajaxMethod,
                contentType: "application/json",
                url: "/formfieldstat/findFormTableStatFields.json",
                dataType: "json",
                data: JSON.stringify({
                    formId: this.formId
                }),
                success: function(h) {
                    m && m(h)
                }
            })
        },
        getFormNumberSelectFields: function(m) {
            $.ajax({
                type: TEAMS.ajaxMethod,
                contentType: "application/json",
                url: "/formfieldstat/findFormNumberStatFields.json",
                dataType: "json",
                data: JSON.stringify({
                    formId: this.formId
                }),
                success: function(h) {
                    m && m(h)
                }
            })
        },
        getNumberFieldStatData: function(m, h) {
            $.ajax({
                type: TEAMS.ajaxMethod,
                contentType: "application/json",
                url: "/formfieldstat/countNumberStatData.json",
                dataType: "json",
                data: JSON.stringify({
                    fieldId: m.componentSetup.dataSetId,
                    statType: m.componentSetup.stattype,
                    formId: this.formId,
                    reportId: this.reportId,
                    param: m.viewcon.closest(".form-view_js").data("param")
                }),
                success: function(g) {
                    h && h(g)
                }
            })
        },
        getFieldStat: function(m, h) {
            $.ajax({
                type: TEAMS.ajaxMethod,
                contentType: "application/json",
                url: "/formfieldstat/findFieldStat.json",
                dataType: "json",
                data: JSON.stringify({
                    fieldId: m,
                    formId: this.formId
                }),
                success: function(g) {
                    h && h(g)
                }
            })
        },
        getFieldChartStat: function(m, h) {
            m = {
                chartParam: m.chartParam,
                param: m.param,
                formId: this.formId,
                reportId: this.reportId
            };
            $.ajax({
                type: TEAMS.ajaxMethod,
                contentType: "application/json",
                url: "/formfieldstat/findFieldChartData.json",
                dataType: "json",
                data: JSON.stringify(m),
                success: function(g) {
                    h && h(g)
                }
            })
        },
        getTablePageData: function(m, h) {
            var g = "/formdatastat/findRowListByFieldIds.json";
            "workflow" == m.module && (g = TEAMS.service.flow + "/flowdatastat/findRowListByFieldIds.json");
            $.ajax({
                type: TEAMS.ajaxMethod,
                contentType: "application/json",
                url: g,
                dataType: "json",
                data: JSON.stringify({
                    formId: this.formId,
                    reportId: this.reportId,
                    fieldIds: m.fieldIds,
                    pageNo: m.pageNo,
                    pageSize: m.pageSize,
                    param: m.param
                }),
                success: function(f) {
                    h && h(f)
                }
            })
        },
        generatorId: function(m) {

            var g = {},
                l = parseInt(m.size) || 1,
                gIds = [],
                gid= parseInt(1000*Math.random())*(new Date()).valueOf();
               
            g = {
              generatorId: gid,
              size:1
            }
            m && m(g)
            // $.ajax({
            //     type: TEAMS.ajaxMethod,
            //     url: TEAMS.api.generatorId,
            //     dataType: "json",
            //     async: !1,
            //     success: function(h) {
            //         m && m(h)
            //     }
            // })
        },
        generatorIds: function(m, h) {
              var g = {},
                  l = parseInt(m.size) || 1,
                gIds = [],
                gid= parseInt(1000*Math.random())*(new Date()).valueOf();
                for(var i=0;i<l;i++) {
                    gIds.push(gid+i)
                }
            g = {
              generatorIds: gIds,
              size:m.size 
            }
            h && h(g)
            // $.ajax({
            //     type: TEAMS.ajaxMethod,
            //     url: TEAMS.api.generatorIds,
            //     dataType: "json",
            //     async: !1,
            //     data: m,
            //     success: function(g) {
            //         h && h(g)
            //     }
            // })
        },
        findFieldLayoutDetail: function(m, h) {
            $.ajax({
                type: TEAMS.ajaxMethod,
                url: "freeform/findFieldLayoutDetail.json",
                dataType: "json",
                async: !1,
                data: m,
                success: function(g) {
                    h && h(g)
                }
            })
        },
        findRowListStatForReport: function(m, h) {
            m.pageSize = 10;
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                url: "/formdatastat/findRowListStatForReport.json",
                dataType: "json",
                data: JSON.stringify(m),
                success: function(g) {
                    h && h(g)
                }
            })
        },
        queryList: function(m, h) {
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                url: "/folders/queryList.json",
                dataType: "json",
                data: JSON.stringify(m),
                success: function(g) {
                    h && h(g)
                }
            })
        },
        queryFolder: function(m, h) {
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                url: "/folders/queryFolder.json",
                dataType: "json",
                data: JSON.stringify(m),
                success: function(g) {
                    h && h(g)
                }
            })
        },
        search: function(m, h) {
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                url: TEAMS.service.docUrl + "/documents/pcSearch.json",
                dataType: "json",
                data: m,
                success: function(g) {
                    h && h(g)
                }
            })
        },
        checkUnique: function(m, h) {
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                url: TEAMS.api.checkUnique,
                dataType: "json",
                async: !1,
                data: JSON.stringify(m),
                success: function(g) {
                    h && h(g)
                }
            })
        },
        queryWorkingTime: function(m, h) {
            $.ajax({
                type: TEAMS.ajaxMethod,
                url: "/attend/queryWorkingTime.json",
                dataType: "json",
                async: !1,
                data: m,
                success: function(g) {
                    h && h(g)
                }
            })
        },
        saveSignImage: function(m, h) {
            $.ajax({
                type: TEAMS.ajaxMethod,
                url: "/base/upload/saveBase64Image.json?optType\x3dsignature\x26module\x3dformdatareport",
                dataType: "json",
                data: m,
                success: function(g) {
                    h && h(g)
                }
            })
        },
        findAdvSearchField: function(m, h) {
            $.ajax({
                type: TEAMS.ajaxMethod,
                url: "/formdatastat/findAdvSearchField.json",
                dataType: "json",
                async: !1,
                data: m,
                success: function(g) {
                    h && h(g)
                }
            })
        }
    });
    u.exports = n
});

define("form/formpreview", ["form/form-plugin"], function(m, y, w) {
    var k = m("form/form-plugin")
      , e = {
        laodForm: function() {
            window.isPreview = !0;
            var d = $("#formId").val()
              , a = $("#formLayoutId").val()
              , b = $("#dataId").val()
              , c = $("#reportId").val()
              , f = $("#module").val()
              , l = $("#collectStatus").val()
              , g = $("#filterName").val()
              , h = $("#filterDescription").val()
              , n = $("#isExtDist").val();
            if ("true" == n || 1 == n)
                window.isEDist = !0;
            c && 0 < c.length && $("#widget-control").data("reportId", c);
            g = k.sensitiveWords(g);
            h = k.sensitiveWords(h);
            $(".form-name").text(g).attr("title", g);
            $(".form-description").text(h).attr("title", h);
            $("#widget-control").html("");
            null == TEAMS.currentUser && ($(".btn-login").removeClass("hide"),
            needCopy = !1);
            c = $("#distributeId").val();
            g = $("#loginMobile").val();
            h = $("#loginEmail").val();
            if (0 < window.location.href.indexOf("/formfills/") || 0 < window.location.href.indexOf("/fill/")) {
                var m = ""
                  , v = ""
                  , q = "";
                if (c) {
                    var r = {};
                    r.distributeId = c;
                    $.ajax({
                        type: "post",
                        async: !1,
                        url: TEAMS.service.baseUrl + "/datasources/queryDistributeById.json",
                        dataType: "json",
                        data: r,
                        success: function(a) {
                            m = a.distribute;
                            v = a.distributeCount;
                            q = a.ipString;
                            $("#netip").attr("href", q)
                        }
                    });
                    if (!m) {
                        $(".j_form_preview").addClass("hide");
                        $(".j_form_disabled").removeClass("hide");
                        return
                    }
                    var s = m.showMobile
                      , l = m.needPwd
                      , u = m.password
                      , w = m.webpicUrl
                      , y = m.showWebpic
                      , r = m.showSource;
                    -1 < window.location.pathname.indexOf("/biaoge") && (1 != r && "true" != r || $(".j_go-home").removeClass("hide"));
                    var r = m.collectStatus
                      , z = m.dueDate
                      , C = m.collectCount;
                    if (C && v && Number(v) >= Number(C)) {
                        $(".j_form_preview").addClass("hide");
                        $(".j_form_disabled").removeClass("hide");
                        return
                    }
                    if (z && (z = Date.create(z).format("{yyyy}-{MM}-{dd} {HH}:{mm}"),
                    (new Date).format("{yyyy}-{MM}-{dd} {HH}:{mm}") > z)) {
                        $(".j_form_preview").addClass("hide");
                        $(".j_form_disabled").removeClass("hide");
                        return
                    }
                    if ("close" == r) {
                        $(".j_form_preview").addClass("hide");
                        $(".j_form_disabled").removeClass("hide");
                        return
                    }
                    r = m.everyOnce;
                    if (1 == r || "true" == r) {
                        var B = "";
                        if (null != TEAMS.currentUser) {
                            if (z = TEAMS.currentUser.id,
                            r = {},
                            r.userId = z,
                            r.distributeId = c,
                            $.ajax({
                                contentType: "application/json",
                                type: "post",
                                async: !1,
                                url: TEAMS.service.baseUrl + "/datasources/queryReportByUserAndDisId.json",
                                dataType: "json",
                                data: JSON.stringify(r),
                                success: function(a) {
                                    B = a.distributeCount
                                }
                            }),
                            B && 0 < Number(B)) {
                                $(".j_form_preview").addClass("hide");
                                $(".j_form_disabled").removeClass("hide");
                                return
                            }
                        } else if (z = $("#localip").attr("href"),
                        q && z) {
                            if (C = {},
                            r = {},
                            C.distributeId = c,
                            C.netIp = q,
                            C.localIp = z,
                            r.dataReport = C,
                            $.ajax({
                                contentType: "application/json",
                                type: "post",
                                async: !1,
                                url: TEAMS.service.baseUrl + "/datasources/queryReportByNet.json",
                                dataType: "json",
                                data: JSON.stringify(r),
                                success: function(a) {
                                    B = a.everyCount
                                }
                            }),
                            B && 0 < Number(B)) {
                                $(".j_form_preview").addClass("hide");
                                $(".j_form_disabled").removeClass("hide");
                                return
                            }
                        } else if (localStorage.getItem(c + "_distribute")) {
                            $(".j_form_preview").addClass("hide");
                            $(".j_form_disabled").removeClass("hide");
                            return
                        }
                    }
                    if ((1 == l || "true" == l) && u && "" != u) {
                        $(".j_form_preview").addClass("hide");
                        $(".j_form_inputPwd").removeClass("hide");
                        return
                    }
                } else if ("disable" == l) {
                    $(".j_form_preview").addClass("hide");
                    $(".j_form_disabled").removeClass("hide");
                    return
                }
            }
            0 <= window.location.href.indexOf("/submitResult/") ? (localStorage.removeItem(d + "_datacollect"),
            d = $("#trackReport").val(),
            "mobile" != window.systemInfo_form ? (null != d && "" != d ? $(".form-preview-wrapper").find("#report_track input").val(d).attr("readonly", !0) : $(".form-preview-wrapper").find("#report_track input").focus(),
            $("#form-preview").addClass("hide"),
            $("#report_track").removeClass("hide"),
            $(".form-comment-wrapper").removeClass("hide"),
            r = {},
            r.pageNo = e.comment.pageNo,
            e.loadComment(r),
            d = $(".j_catalog-list").height(),
            $(".j_catalog-item").css("height", d)) : ($("#form-preview").addClass("hide"),
            $("#report_track").find(".j_trackBtn").attr("trackReport", d),
            $("#report_track").removeClass("hide"))) : (e.renderFormDetail(b, f, d, a, c, n, w, y),
            e.renderMobileOrEmail(s, g, h),
            0 != window.location.pathname.indexOf("/biaoge/preview/") ? $(".form-preview-wrapper .j_cloneForm").remove() : null != TEAMS.currentUser && $(".form-preview-wrapper .j_cloneForm").removeClass("hide"),
            -1 == window.location.pathname.indexOf("/previewFill") && $(".form-preview-wrapper .j_comment-content").removeClass("hide"),
            0 <= window.location.pathname.indexOf("/biaoge/previewFill/") && ("mobile" != window.systemInfo_form && 0 > window.location.pathname.indexOf("/scanReport") ? ($(".form-comment-wrapper").removeClass("hide"),
            r = {},
            r.pageNo = e.comment.pageNo,
            e.loadComment(r)) : ($("#form-preview").find("#comment-view").removeClass("hide"),
            r = {},
            r.pageNo = e.comment.pageNo,
            e.loadComment_m(r))))
        }

    };
    $(document).on("click", ".j_view_type", function() {
        if (!$(this).hasClass("active")) {
            $(this).addClass("active").siblings("a").removeClass("active");
            var d = $(this).attr("data-value")
              , a = $(this).parents(".form-preview-content");
            "pc" == d ? (a.find(".j_form-viewport-mobile").hide().css({
                right: "0px",
                opacity: "0"
            }),
            $("#form-preview-mobile").fadeOut(200, function() {
                $("#form-preview").fadeIn(100, function() {
                    $("#form-preview").removeClass("hide")
                });
                $(window).resize();
                setTimeout(function() {
                    a.find(".j_form-viewport-pc").show().animate({
                        right: -41,
                        opacity: 1
                    })
                }, 100);
                a.find('.j_form-viewport-pc a[data-value\x3d"pc"]').addClass("active").siblings().removeClass("active");
                d = "mobile";
                a.css({
                    "padding-top": "40px",
                    width: "1000px"
                })
            })) : (a.find(".j_form-viewport-pc").hide().css({
                right: "0px",
                opacity: "0"
            }),
            $("#form-preview").fadeOut(200, function() {
                $("#form-preview-mobile").fadeIn(100, function() {
                    $("#form-preview-mobile").removeClass("hide")
                });
                setTimeout(function() {
                    a.find(".j_form-viewport-mobile").show().animate({
                        right: -41,
                        opacity: 1
                    })
                }, 100);
                a.find('.j_form-viewport-mobile a[data-value\x3d"mobile"]').addClass("active").siblings().removeClass("active");
                d = "pc";
                a.css({
                    "padding-top": "40px",
                    width: "375px"
                })
            }))
        }
    });

    e.renderFormDetail = function(d, a, b, c, f, l, g, h) {
        var n = $("#scanReport").val()
          , m = !1;
        n && (m = !0);
        n ? $("#submit").parent().remove() : $("#submit").parent().removeClass("hide")
        null != d && "" != d ? k.renderFormData({
            parentEl: $("#widget-control"),
            dataId: d,
            module: a,
            notDefault: !0,
            readOnly: m,
            callback: function(a) {
         //       "submit" == a.formData.dataStatus || n ? $("#submit").parent().remove() : ($("#submit").removeClass("hide"),
        //        $("#temporary").show())
            }
        }) : ("mobile" == window.systemInfo_form ? !h || 1 != h && "true" != h || ($(".j_formbanner").empty().append('\x3cimg src\x3d"/static/img/mobile/form/banner/' + _.random(1, 10) + '.png"/\x3e'),
        g && -1 < g.indexOf("download") && (d = g.substring(g.indexOf("download")),
        d = d.substring(d.indexOf("/") + 1),
        d = TEAMS.api.downImgUrl+"/" + d,
        $(".j_formbanner").empty().append('\x3cimg src\x3d"' + d + '"/\x3e'))) : $(".j_formbanner").empty(),      
        // k.renderForm({
        //     parentEl: $("#widget-control"),
        //     formId: b,
        //     layoutId: c,
        //     distributeId: f,
        //     module: a,
        //     isExtDist: l,
        //     formData: e.getFormDataLocalStorage(b, l),
        //     callback: function(a) {
        //  //       0 < window.location.href.indexOf("/formfills/") || 0 < window.location.href.indexOf("/fill/") ? ($("#submit").removeClass("hide"),
        //   //      $("#temporary").show()) : $("#submit").parent().remove()
        //     }
        // })

        k.renderFormData({
            parentEl: $("#widget-control"),
            formId: b,
            layoutId: c,
            distributeId: f,
            module: a,
            isExtDist: l,
            readOnly: m,
            formData: e.getFormDataLocalStorage(b, l),
            callback: function(a) {
              //  $("#temporary").show()

              // if($("#printDatas").length)
              //   $("#printDatas").val(JSON.stringify(a))
            }
         })

        );


        1 == window.isEDist || "true" == window.isEDist || 0 <= window.location.pathname.indexOf("/form/reportPreview/") || 0 <= window.location.pathname.indexOf("/freeform/reportPreview/") ? $(".j_form-viewport-opt").remove() : ($(".j_form-viewport-opt").removeClass("hide"),
        c = $("#mobileIframe"),
        b = $("#formId").val(),
        window.m_formpreview = "m_formpreview",
        $(this).attr("is_frist") || ("workflow" == a ? c.attr("src", "/mobile/ebgforms/workflow/" + b) : c.attr("src", TEAMS.mobileformview)),
        $(".j_form-viewport-mobile").hide().css({
            right: "0px",
            opacity: "0"
        }))
    }
    ;
    e.renderMobileOrEmail = function(d, a, b) {
        if (0 <= window.location.pathname.indexOf("/biaoge/formfills/") || 0 <= window.location.pathname.indexOf("/biaoge/fill/"))
            if (1 == d || "true" == d)
                "mobile" != window.systemInfo_form ? (d = '\x3cdiv class\x3d"j_track field-hoz field-contact"\x3e\x3clabel class\x3d"widget-title w-120"\x3e\x3cspan class\x3d"widget-title_js"\x3e\u8bf7\u586b\u5199\u624b\u673a\u6216\u90ae\u7bb1\x3c/span\x3e\x3c/label\x3e\x3cdiv class\x3d"widget-content ml-130"\x3e\x3cinput type\x3d"text" class\x3d"form-control w-400 j_mobileOrEmail" placeholder\x3d"\u8f93\u5165\u5373\u53ef\u7ed1\u5b9a\u672c\u6761\u6570\u636e\uff0c\u65b9\u4fbf\u60a8\u4e4b\u540e\u67e5\u770b\u6216\u4e0e\u6570\u636e\u6536\u96c6\u8005\u4e92\u52a8\u54e6"\x3e\x3c/div\x3e\x3c/div\x3e',
                $(".form-preview-wrapper .j_form_foot").before(d),
                null != a && "" != a ? $(".form-preview-wrapper .j_track .j_mobileOrEmail").val(a).attr("readonly", !0) : null != b && "" != b && $(".form-preview-wrapper .j_track .j_mobileOrEmail").val(b).attr("readonly", !0)) : (d = '\x3cdiv class\x3d"j_track form-track-box"\x3e\x3cdiv class\x3d"track-title"\x3e\x3cspan class\x3d"widget-title_js"\x3e\u8bf7\u586b\u5199\u624b\u673a\u6216\u90ae\u7bb1\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"track-input"\x3e\x3cinput type\x3d"text" class\x3d"j_mobileOrEmail" placeholder\x3d"\u8f93\u5165\u53ef\u7ed1\u5b9a\u672c\u6761\u6570\u636e\uff0c\u65b9\u4fbf\u4e4b\u540e\u67e5\u770b\u6216\u4e0e\u6570\u636e\u6536\u96c6\u8005\u4e92\u52a8"\x3e\x3c/div\x3e\x3c/div\x3e',
                $("#form-preview .j_submit_btn").before(d),
                null != a && "" != a ? $("#form-preview .j_track .j_mobileOrEmail").val(a).attr("readonly", !0) : null != b && "" != b && $("#form-preview .j_track .j_mobileOrEmail").val(b).attr("readonly", !0))
    }
    ;
    e.loadComment_m = function(d) {
        var a = $("#dataReportId").val()
          , b = $("#ownership").val()
          , c = TEAMS.service.baseUrl + "/datasources/queryComment.json";
        if (b && "cloud" == b)
            a = $("#formId").val(),
            d.formId = a,
            d.pageSize = e.comment.pageSize,
            c = TEAMS.service.baseUrl + "/datasources/searchFormcomment.json";
        else {
            if ("" == a || null == a) {
                $("#form-preview .j_comment_enter").attr("disabled", "disabled");
                return
            }
            d.targetId = a;
            d.entityType = "formdatareport";
            d.formId = $("#formId").val();
            d.pageSize = e.comment.pageSize
        }
        e.comment.queryComment(b, c, d, function(a) {
            var c = a.commentPage;
            b && "cloud" == b && (c = a.pageFormComment);
            $.each(c.result, function() {
                e.renderComment_m(this, "append")
            });
            c.hasNext ? ($("#form-preview .j_more").removeClass("hide"),
            $("#form-preview .j_more").attr("pageNo", c.pageNo)) : $("#form-preview .j_more").addClass("hide");
            a = $("#scanReport").val();
            c = $("#comment-list .j_comt-item").length;
            a && (0 == c ? $("#comment-view").remove() : $("#form-preview").find(".j_comt-replay").remove())
        })
    }
    ;
    e.loadComment = function(d) {
        $(".form-comment-wrapper .j_comment-input .j_content").autosize();
        var a = $("#ownership").val()
          , b = $("#dataReportId").val()
          , c = TEAMS.service.baseUrl + "/datasources/queryComment.json";
        if (a && "cloud" == a)
            b = $("#formId").val(),
            d.formId = b,
            d.pageSize = e.comment.pageSize,
            c = TEAMS.service.baseUrl + "/datasources/searchFormcomment.json";
        else {
            if ("" == b || null == b) {
                $(".form-comment-wrapper").removeClass("hide");
                $(".form-comment-wrapper").find(".j_module-container").empty().html('\x3cbr\x3e\x3cp style\x3d"text-align:center;"\x3e\u8be5\u6761\u6570\u636e\u5df2\u5220\u9664\uff0c\u6682\u4e0d\u80fd\u8bc4\u8bba\uff01\x3c/p\x3e');
                return
            }
            d.targetId = b;
            d.formId = $("#formId").val();
            d.entityType = "formdatareport";
            d.pageSize = e.comment.pageSize
        }
        e.comment.queryComment(a, c, d, function(b) {
            var c = b.commentPage;
            a && "cloud" == a && (c = b.pageFormComment);
            $.each(c.result, function() {
                e.renderComment(this, "append")
            });
            c.hasNext ? ($(".j_module-container .j_morecontent").removeClass("hide"),
            $(".j_module-container .j_morecontent").attr("pageNo", c.pageNo)) : $(".j_module-container .j_morecontent").addClass("hide")
        })
    }
    ;
    e.calculateHeight = function() {
        var d = $(window).height();
        $("#form-preview").attr("style", "min-height:" + (d - 30) + "px;")
    }
    ;
    e.calculateMobileHeight = function() {}
    ;
    e.comment = {
        pageNo: 1,
        pageSize: 10,
        queryComment: function(d, a, b, c) {
            $.ajax({
                contentType: "application/json",
                type: "post",
                url: a,
                dataType: "json",
                data: JSON.stringify(b),
                success: function(a) {
                    a = k.sensitiveWords(a, "json");
                    c && c(a)
                }
            })
        },
        createComment: function(d, a, b) {
            $.ajax({
                contentType: "application/json",
                type: "post",
                url: d,
                dataType: "json",
                data: JSON.stringify(a),
                success: function(a) {
                    a = k.sensitiveWords(a, "json");
                    b && b(a)
                }
            })
        }
    };
    e.initMessage = function(d) {
        d = d.replace(/</g, "\x26lt").replace(/>/g, "\x26gt").replace(/\r\n|\n/g, " \x3cbr/\x3e").replace(/ /g, "  ");
        d.match(RegExp("(((ht|f)tp(s?))://)?(www.|([a-zA-Z]+[.]{1}))[a-zA-Z0-9-.]*(com|edu|gov|mil|net|org|biz|info|name|museum|us|ca|uk|cn)(/($|[a-zA-Z0-9:.;?'\\+\x26amp;%$#\x3d~_-])+)*", "g"));
        return d
    }
    ;
    e.initUrl = function(d, a) {
        if (!d)
            return a;
        for (var b = "", c = 0; c < d.length; c++) {
            var f = $.trim(d[c]);
            if (!(0 <= b.indexOf(f))) {
                if (0 == f.indexOf("http") || 0 == f.indexOf("https") || 0 == f.indexOf("ftp"))
                    for (var e = a.split(f), g = "", h = 0; h < e.length - 1; h++)
                        g += e[h] + '\x3ca target\x3d"_blank" href\x3d"' + f + '"\x3e' + f + "\x3c/a\x3e";
                else
                    for (e = a.split(f),
                    g = "",
                    h = 0; h < e.length - 1; h++)
                        g += e[h] + '\x3ca target\x3d"_blank" href\x3d"http://' + f + '"\x3e' + f + "\x3c/a\x3e";
                a = g + e[e.length - 1];
                b += d[c] + "  "
            }
        }
        return a
    }
    ;
    e.renderComment = function(d, a) {
        d.operator && (d.commentor = d.operator,
        d.addTime = d.createTime,
        d.parent && d.parent.operator && (d.parent.commentor = d.parent.operator));
        var b = $(".form-comment-wrapper #comment-clone #comment-item").clone();
        $("#loginMobile").val();
        $("#loginEmail").val();
        b.attr("id", d.id);
        if (d.commentor) {
            d.commentor.username && b.find(".comment-user").text(d.commentor.username).attr("userId", d.commentor.id);
            var c = {};
            c.userId = d.commentor.id;
            $.ajax({
                type: "post",
                url: TEAMS.service.baseUrl + "/datasources/queryByUserId.json",
                dataType: "json",
                data: c,
                success: function(a) {
                    a = a.tkey;
                    d.commentor.avatar && d.commentor.avatar.p3 && TEAMS.currentTenant && a.toUpperCase() == TEAMS.currentTenant.tenantKey.toUpperCase() && b.find(".j_comment_clone_avatar img").attr("src", "/base/download/" + d.commentor.avatar.p3)
                }
            })
        } else
            b.find(".comment-user").text("\u6e38\u5ba2");
        c = e.initMessage(d.content);
        if (d.commentCount)
            b.find("#show_at_comment .j_comment-count").text("(" + d.commentCount + ")");
        else if (d.parent && d.parent.id) {
            var f = $(".form-comment-wrapper .j_module-container .j_comment_list").find("#" + d.parent.id).find(".j_comment-count").text();
            f ? (f = f.substring(1, f.lastIndexOf(")")),
            f = parseInt(f) + 1,
            $(".form-comment-wrapper .j_module-container .j_comment_list").find("#" + d.parent.id).find(".j_comment-count").text("(" + f + ")")) : $(".form-comment-wrapper .j_module-container .j_comment_list").find("#" + d.parent.id).find(".j_comment-count").text("(1)")
        }
        if (d.parent) {
            var k = d.parent.content;
            d.parent && d.parent.commentor ? b.find(".j_parent_comment .j_p_username").text("\u56de\u590d@" + d.parent.commentor.username).attr("userId", d.parent.commentor.id) : b.find(".j_parent_comment .j_p_username").text("\u56de\u590d@\u6e38\u5ba2");
            if (d.parent.userData) {
                var g = [];
                if (g = eval(d.parent.userData))
                    for (f = 0; f < g.length; f++)
                        if (g[f])
                            if (g[f].userIdIndex && 0 != g[f].userIdIndex)
                                var h = e.getAtUserClass(g[f].atType)
                                  , k = k.substring(0, g[f].userIdIndex - 1) + "@" + g[f].userName + k.substring(g[f].userIdIndex - 1);
                            else
                                "null" != g[f].userId && clone.find("#show_at_comment").prepend("\x3ca class\x3d'" + h + "' userId\x3d'" + g[f].userId + "'\x3e@" + g[f].userName + " \x3c/a\x3e")
            }
            k = e.initMessage(k);
            b.find(".j_parent_comment .j_parent_content").html(k);
            b.find(".j_parent_comment").removeClass("hide")
        }
        if (d.userData && (k = [],
        k = eval(d.userData)))
            for (f = 0; f < k.length; f++)
                k[f] && (k[f].userIdIndex && 0 != k[f].userIdIndex ? (h = e.getAtUserClass(k[f].atType),
                c = c.substring(0, k[f].userIdIndex - 1) + "@" + k[f].userName + c.substring(k[f].userIdIndex - 1)) : "null" != k[f].userId && clone.find("#show_at_comment").prepend("\x3ca class\x3d'" + h + "' userId\x3d'" + k[f].userId + "'\x3e@" + k[f].userName + " \x3c/a\x3e"));
        b.find("#show_at_comment .j_content").html(c);
        b.find("#show_at_comment .j_time").text((new Date(d.addTime)).format("{yyyy}-{MM}-{dd} {HH}:{mm}"));
        "append" == a ? $(".form-comment-wrapper .j_module-container .j_comment_list").append(b) : $(".form-comment-wrapper .j_module-container .j_comment_list").prepend(b)
    }
    ;
    e.getAtUserClass = function(d) {
        return void 0 == d || "user" == d ? "at-user usercard-toggle" : "department" == d ? "at-user departmentcard-toggle" : "group" == d ? "at-user channelcard-toggle" : "at-user"
    }
    ;
    e.mobileCheck = function(d) {
        var a = !1;
        /^13\d{9}$/.test(d) && (a = !0);
        /^14\d{9}$/.test(d) && (a = !0);
        /^15\d{9}$/.test(d) && (a = !0);
        /^18\d{9}$/.test(d) && (a = !0);
        /^17\d{9}$/.test(d) && (a = !0);
        /^((\+)?86)?1(3|4|5|7|8)\d{9}$/.test(d) && (a = !0);
        /^19\d{9}$/.test(d) && (a = !0);
        /^16\d{9}$/.test(d) && (a = !0);
        return a ? !0 : !1
    }
    ;
    e.emailCheck = function(d) {
        return /^([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/.test(d)
    }
    ;
    e.checkVal = function(d) {
        return null == d || "" == d || e.mobileCheck(d) || e.emailCheck(d) ? !0 : !1
    }
    ;
    e.renderComment_m = function(d, a) {
        d.operator && (d.commentor = d.operator,
        d.addTime = d.createTime);
        var b = $("#form-preview #comment-clone .j_comt-item").clone();
        $("#loginMobile").val();
        $("#loginEmail").val();
        b.attr("id", d.id);
        b.find(".j_comt-replay").attr("p_id", d.id);
        if (d.commentor) {
            d.commentor.username && b.find(".j_comt-user").text(d.commentor.username).attr("userId", d.commentor.id);
            var c = {};
            c.userId = d.commentor.id;
            $.ajax({
                type: "post",
                url: TEAMS.service.baseUrl + "/datasources/queryByUserId.json",
                dataType: "json",
                data: c,
                success: function(a) {
                    a = a.tkey;
                    d.commentor.avatar && d.commentor.avatar.p3 && TEAMS.currentTenant && a.toUpperCase() == TEAMS.currentTenant.tenantKey.toUpperCase() && b.find(".j_comment_clone_avatar img").attr("src", "/base/download/" + d.commentor.avatar.p3)
                }
            })
        } else
            b.find(".j_comt-user").text("\u6e38\u5ba2");
        c = e.initMessage(d.content);
        if (d.parent) {
            var f = d.parent.content;
            d.parent && d.parent.commentor ? b.find(".j_parent-content-body .j_parent-username").text("\u56de\u590d" + d.parent.commentor.username + "\uff1a").attr("userId", d.parent.commentor.id) : b.find(".j_parent-content-body .j_parent-username").text("\u56de\u590d\u6e38\u5ba2\uff1a");
            if (d.parent.userData) {
                var k = [];
                if (k = eval(d.parent.userData))
                    for (var g = 0; g < k.length; g++)
                        if (k[g])
                            if (k[g].userIdIndex && 0 != k[g].userIdIndex)
                                var h = e.getAtUserClass(k[g].atType)
                                  , f = f.substring(0, k[g].userIdIndex - 1) + "@" + k[g].userName + f.substring(k[g].userIdIndex - 1);
                            else
                                "null" != k[g].userId && clone.find(".j_com-content-body").prepend("\x3ca class\x3d'" + h + "' userId\x3d'" + k[g].userId + "'\x3e@" + k[g].userName + " \x3c/a\x3e")
            }
            f = e.initMessage(f);
            b.find(".j_parent-content-body .j_parent-content").html(f)
        }
        if (d.userData && (f = [],
        f = eval(d.userData)))
            for (g = 0; g < f.length; g++)
                f[g] && (f[g].userIdIndex && 0 != f[g].userIdIndex ? (h = e.getAtUserClass(f[g].atType),
                c = c.substring(0, f[g].userIdIndex - 1) + "@" + f[g].userName + c.substring(f[g].userIdIndex - 1)) : "null" != f[g].userId && clone.find(".j_com-content-body").prepend("\x3ca class\x3d'" + h + "' userId\x3d'" + f[g].userId + "'\x3e@" + f[g].userName + " \x3c/a\x3e"));
        b.find(".j_com-content-body").html(c);
        b.find(".j_comt-date").text((new Date(d.addTime)).format("{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}"));
        "append" == a ? $("#form-preview #comment-list").append(b) : $("#form-preview #comment-list").prepend(b)
    }
    ;
    e.setFormDataLocalStorage = function(d) {
        var a = k.submitAssembleForm({
            parentEl: $("#widget-control")
        })
          , b = [];
        $("#widget-control").find(".subform_js").each(function() {
            var a = $(this);
            b.push({
                maxIndex: a.find(".subtable_js tbody tr").length - 1,
                subFormId: a.attr("id")
            })
        });
        a && a.formData && a.formData.dataDetails && 0 < a.formData.dataDetails.length && (a.formData.maxSubFormIndexs = b,
        localStorage.setItem(d + "_datacollect", JSON.stringify(a.formData)))
    }
    ;
    e.getFormDataLocalStorage = function(d, a) {
        return "true" == a || 1 == a ? JSON.parse(localStorage.getItem(d + "_datacollect")) || null : null
    }
    ;
    e.beforeunload = function() {
        window.onunload = function() {
            e.setFormDataLocalStorage($("#formId").val());
            return !1
        }
    }
    ;    
    $(function() {
        e.beforeunload();

        "mobile" == window.systemInfo_form && ($("#form-preview").off("tap.formpreview", ".j_comment_enter").on("tap.formpreview", ".j_comment_enter", function() {
            $(this);
            $(".j_page-view").addClass("hide");
            $("#edit_comment").removeClass("hide");
            $("#edit_comment").find(".j_comment-create").attr("type", "create")
        }),
        $("#edit_comment").off("tap.formpreview", ".j_comment-create").on("tap.formpreview", ".j_comment-create", function() {
            var a = $(this)
              , b = a.attr("type")
              , c = $("#edit_comment #comment-content").val()
              , d = a.attr("p_comment_id")
              , l = $("#dataReportId").val()
              , g = $("#filterName").text()
              , h = $("#ownership").val()
              , n = TEAMS.service.baseUrl + "/datasources/createComment.json"
              , m = {};
            b && "create" == b ? h && "cloud" == h ? (l = {},
            l.formID = $("#formId").val(),
            l.content = c,
            n = TEAMS.service.baseUrl + "/datasources/createFormcomment.json",
            m.formComment = l) : (b = {},
            b.targetId = l,
            b.module = "formdatareport",
            b.targetName = g,
            b.content = c,
            m.comment = b,
            m.formId = $("#formId").val()) : b && "replay" == b && (h && "cloud" == h ? (l = {},
            l.formID = $("#formId").val(),
            l.content = c,
            n = {},
            n.id = d,
            l.parent = n,
            n = TEAMS.service.baseUrl + "/datasources/createFormcomment.json",
            m.formComment = l) : (b = {},
            b.targetId = l,
            b.module = "formdatareport",
            b.targetName = g,
            b.content = c,
            m.parentId = d,
            m.comment = b,
            m.formId = $("#formId").val()));
            0 == c.length ? k.notify("\u8bc4\u8bba\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a") : 200 < c.length ? k.notify("\u8bc4\u8bba\u5185\u5bb9\u4e0d\u80fd\u8d85\u8fc7200\u4e2a\u5b57\u7b26") : (a.attr("disabled", "disabled"),
            e.comment.createComment(n, m, function(b) {
                if (b && b.message && 0 != b.message.code)
                    k.notify(b.message),
                    a.removeAttr("disabled");
                else {
                    var c = b.comment;
                    h && "cloud" == h && (c = b.formComment);
                    b && c && (e.renderComment_m(c, "prepend"),
                    $(".j_page-view").removeClass("hide"),
                    $("#edit_comment").addClass("hide"),
                    $("#edit_comment #comment-content").val(""),
                    a.removeAttr("disabled"),
                    k.notify("\u8bc4\u8bba\u6210\u529f"))
                }
            }))
        }),
        $("#edit_comment").off("tap.formpreview", "#j_a-back").on("tap.formpreview", "#j_a-back", function() {
            $(".j_page-view").removeClass("hide");
            $("#edit_comment").addClass("hide")
        }),
        $("#form-preview").off("tap.formpreview", ".j_comt-replay").on("tap.formpreview", ".j_comt-replay", function() {
            var a = $(this);
            setTimeout(function() {
                $(".j_page-view").addClass("hide");
                $("#edit_comment").removeClass("hide")
            }, 100);
            a = a.attr("p_id");
            $("#edit_comment").find(".j_comment-create").attr("type", "replay").attr("p_comment_id", a)
        }),
        $("#form-preview").off("tap.formpreview", ".j_more").on("tap.formpreview", ".j_more", function() {
            var a = $(this).attr("pageNo");
            $(this).addClass("hide");
            var b = {};
            b.pageNo = parseInt(a) + 1;
            e.loadComment_m(b)
        }),
        $("#report_track").off("tap.formpreview", ".j_signup_btn").on("tap.formpreview", ".j_signup_btn", function() {
            var a = $("#dataId").val()
              , b = "";
            0 <= window.location.href.indexOf("localhost:9080") ? b = "https://passport.teems.cn/login?service\x3dhttp://localhost:9080/biaoge/previewFill/" + a : 0 <= window.location.href.indexOf("teems.cn") ? b = "https://passport.teems.cn/login?service\x3dhttps://www.teems.cn/biaoge/previewFill/" + a : 0 <= window.location.href.indexOf("mulinquan.com") ? b = "https://passport.mulinquan.com/login?service\x3dhttps://www.mulinquan.com/biaoge/previewFill/" + a : 0 <= window.location.href.indexOf("xiezuoqu.cn") ? b = "https://passport.xiezuoqu.cn/login?service\x3dhttps://www.xiezuoqu.cn/biaoge/previewFill/" + a : 0 <= window.location.href.indexOf("smartheer.cn") && (b = "https://passport.smartheer.cn/login?service\x3dhttps://www.smartheer.cn/biaoge/previewFill/" + a);
            window.location.href = b
        }),
        $("#preview_m").width($(window).width()),
        window.self != window.top && ($("#preview_m").width($(window).width()),
        $("#preview_m").css({
            overflow: "auto",
            "-webkit-overflow-scrolling": "touch",
            width: "100%",
            height: "100%"
            // width: realClientSize.width + "px",
            // height: realClientSize.height + "px"
        }),
        $(window).off("orientationchange.formpreview resize.formpreview").on("orientationchange.formpreview resize.formpreview", function(a) {
            $("#preview_m").width("100%");
            $("#preview_m").height("100%")
            // $("#preview_m").width(realClientSize.width);
            // $("#preview_m").height(realClientSize.height)
        })));

        if ("mobile" != window.systemInfo_form) {
            $("body").off("resizeSroll").on("resizeSroll", "div.scroll-wrapper", function(a) {
                a = $(this);
                if (a.attr("horizontal")) {
                    var b = $(window).width()
                      , c = a.offset().left;
                    a.css("width", b - c)
                } else {
                    var b = $(window).height()
                      , c = a.attr("marginbottom") || 0
                      , d = a.offset().top;
                    a.css("height", b - d - c)
                }
                a.mCustomScrollbar("update")
            });
            (function(a) {
                if(!a.length) return;
                var b = a.attr("marginbottom") || 0
                  , c = a.offset().top || 0
                  , d = $(window).height();
                a.height(d - c - b);
                b = a.attr("theme") ? a.attr("theme") : "darkblue";
                a.hasClass("mCustomScrollbar") || a.mCustomScrollbar({
                    theme: b
                })
            }
            )($(".j_module-container"));
            e.calculateHeight();
            $(window, window.parent).off("resize.formpreview").on("resize.formpreview", function(a) {
                $(".j_view_type[data_value\x3d'pc']").hasClass("active") && (e.calculateHeight(),
                setTimeout(function() {
                    $("body div.scroll-wrapper").each(function(a) {
                        $(this).trigger("resizeSroll", a)
                    })
                }, 100))
            });
            $(".preview_btn").click(function(a) {
                $(".j_comment-content").hasClass("in") ? ($(".j_comment-content").removeClass("in"),
                $(this).addClass("preview_btn_off").attr("title", "\u663e\u793a\u8bc4\u8bba")) : ($(".j_comment-content").addClass("in"),
                $(this).removeClass("preview_btn_off").attr("title", "\u9690\u85cf\u8bc4\u8bba"),
                $(".form-comment-wrapper").find(".j_comment_list #replay").addClass("hide"),
                a.stopPropagation())
            });
            $("body").off("click").on("click", function(a) {
                a = $(a.target);
                !a.hasClass("j_comment-content") && null == a.parents(".j_comment-content").get(0) && $(".j_comment-content").hasClass("in") && ($(".j_comment-content").removeClass("in"),
                $(".preview_btn").addClass("preview_btn_off").attr("title", "\u663e\u793a\u8bc4\u8bba"))
            });
            $(".j_module-container").off("click.formpreview", ".j_replay").on("click.formpreview", ".j_replay", function() {
                var a = $(this);
                a.parents(".j_comment-item").find("#replay-content").autosize();
                a.parents(".j_comment-item").find(".commentreplay-emoji").css("margin-left", "0px");
                a.parents(".j_comment-item").find("#replay").hasClass("hide") ? a.parents(".j_comment-item").find("#replay").removeClass("hide") : a.parents(".j_comment-item").find("#replay").addClass("hide");
                a.parents(".j_comment-item").find("#replay .j_btn_replay").attr("parentId", a.parents(".j_comment-item").attr("id"))
            });
            $(".j_module-container").off("click.formpreview", ".j_btn_replay").on("click.formpreview", ".j_btn_replay", function() {
                var a = $(this)
                  , b = a.attr("parentId")
                  , c = $("#dataReportId").val()
                  , d = $("#filterName").text()
                  , l = a.parents(".j_comment-item").find("#replay #replay-content").val()
                  , g = $("#ownership").val()
                  , h = TEAMS.service.baseUrl + "/datasources/createComment.json"
                  , n = {};
                if (g && "cloud" == g)
                    c = {},
                    c.formID = $("#formId").val(),
                    c.content = l,
                    h = TEAMS.service.baseUrl + "/datasources/createFormcomment.json",
                    d = {},
                    d.id = b,
                    c.parent = d,
                    n.formComment = c;
                else {
                    var m = {};
                    m.targetId = c;
                    m.module = "formdatareport";
                    m.targetName = d;
                    m.content = l;
                    n.parentId = b;
                    n.comment = m;
                    n.formId = $("#formId").val()
                }
                0 == l.length ? k.notify("\u56de\u590d\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a") : 200 < l.length ? k.notify("\u56de\u590d\u5185\u5bb9\u4e0d\u80fd\u8d85\u8fc7200\u4e2a\u5b57\u7b26") : e.comment.createComment(h, n, function(b) {
                    if (b && b.message && 0 != b.message.code)
                        k.notify(b.message);
                    else {
                        var c = b.comment;
                        g && "cloud" == g && (c = b.formComment);
                        b && c && (c.content = l,
                        e.renderComment(c, "prepend"),
                        a.parents(".j_comment-item").find("#replay #replay-content").val(""),
                        a.parents(".j_comment-item").find("#replay").addClass("hide"),
                        k.notify("\u56de\u590d\u6210\u529f"))
                    }
                })
            });
            $(".j_module-container").off("keyup.formpreview", "#replay-content").on("keyup.formpreview", "#replay-content", function(a) {
                a.ctrlKey && 13 == a.keyCode && $(this).parents("#replay").find(".j_btn_replay").click()
            });
            $(".j_module-container").off("click.formpreview", ".j_btn_cancel").on("click.formpreview", ".j_btn_cancel", function() {
                $(this).parents(".j_comment-item").find("#replay").addClass("hide")
            });
            $(".j_module-container").off("click.formpreview", ".j_addcomment").on("click.formpreview", ".j_addcomment", function() {
                var a = {}
                  , b = $.trim($(".j_module-container .j_content").val())
                  , c = $("#ownership").val();
                if (0 == b.length)
                    k.notify("\u8bc4\u8bba\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a");
                else if (200 < b.length)
                    k.notify("\u8bc4\u8bba\u5185\u5bb9\u4e0d\u80fd\u8d85\u8fc7200\u4e2a\u5b57\u7b26");
                else {
                    var d = TEAMS.service.baseUrl + "/datasources/createComment.json";
                    if (c && "cloud" == c) {
                        var l = {};
                        l.formID = $("#formId").val();
                        l.content = b;
                        d = TEAMS.service.baseUrl + "/datasources/createFormcomment.json";
                        a.formComment = l
                    } else {
                        var l = $("#dataReportId").val()
                          , g = $("#filterName").text()
                          , h = {};
                        h.targetId = l;
                        h.module = "formdatareport";
                        h.targetName = g;
                        h.content = b;
                        a.comment = h;
                        a.formId = $("#formId").val()
                    }
                    var n = $(this);
                    n.attr("disabled", "disabled");
                    e.comment.createComment(d, a, function(a) {
                        if (a && a.message && 0 != a.message.code)
                            k.notify(a.message),
                            n.removeAttr("disabled");
                        else {
                            var b = a.comment;
                            c && "cloud" == c && (b = a.formComment);
                            a && b && (e.renderComment(b, "prepend"),
                            $(".j_module-container").find(".j_comment-input .j_content").val(""),
                            n.removeAttr("disabled"),
                            k.notify("\u8bc4\u8bba\u6210\u529f"))
                        }
                    })
                }
            });
            $(".j_module-container .j_content").on("keyup.formpreview", function(a) {
                a.ctrlKey && 13 == a.keyCode && $(".j_module-container .j_addcomment").trigger("click.formpreview")
            });
            $(".j_module-container .j_morecontent").click(function() {
                var a = $(this).attr("pageNo");
                $(this).addClass("hide");
                var b = {};
                b.pageNo = parseInt(a) + 1;
                e.loadComment(b)
            });
            $(".form-preview-wrapper .j_cloneForm").on("click.formpreview", function() {
                TEAMS.currentUser ? copyForm(TEAMS.currentUser.userId) : $("#login-dialog").modal("show");
                return !1
            });
            $(".btn-login").on("click.formpreview", function() {
                $("#login-dialog").modal("show")
            });
            var d = $("#ownership").val();
            d && "cloud" == d && ($(".form-comment-wrapper").removeClass("hide"),
            d = {},
            d.pageNo = e.comment.pageNo,
            e.loadComment(d))
        }
        e.laodForm();
        d = "click";
        "mobile" == window.systemInfo_form && (d = "click");
        "en-us" == (navigator.language || navigator.browserLanguage).toLowerCase() ? $(".j_go-home").text("From smartheer.cn") : "zh-cn" == (navigator.language || navigator.browserLanguage).toLowerCase() && $(".j_go-home").text("\u6765\u6e90\u4e8e smartheer.cn");
        "mobile" == window.systemInfo_form && ($("#comment-view #comment-input .j_comment_enter").show(),
        $("#scanReport").val() && $("#comment-view #comment-input .j_comment_enter").hide());
        $(document).on(d, "#report_track .j_signupBtn", function(a) {
            $("#login-dialog").modal("show");
            $("#login-dialog").find(".tab-header li").removeClass("active");
            $("#login-dialog").find(".tab-header .j_signup").addClass("active");
            a = $("#login-dialog").find(".tab-header .j_signup").find("a").attr("href");
            $("#login-dialog .tab-pane").removeClass("active");
            $("#login-dialog").find(a).addClass("active")
        });
        $(document).on(d, "#report_track .j_trackBtn", function(a) {
            var b = $(this);
            a = $("#dataReportId").val();
            var c = ""
              , d = b.attr("biaoge");
            if ("mobile" != window.systemInfo_form) {
                c = $.trim(b.parents("#report_track").find(".j_mobileOrEmail").val());
                b = b.parents("#report_track").find(".j_mobileOrEmail").attr("placeholder");
                c == b && (c = "");
                if (null == c || "" == c)
                    return k.notify("\u8bf7\u8f93\u5165\u8ddf\u8e2a\u67e5\u8be2\u7684\u624b\u673a\u53f7\u6216\u90ae\u7bb1!"),
                    !1;
                if (!e.checkVal(c))
                    return k.notify("\u624b\u673a\u53f7\u6216\u90ae\u7bb1\u683c\u5f0f\u4e0d\u5bf9\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165!"),
                    !1;
                window.open(d + "/reporttrack.jsp?reportId\x3d" + a + "\x26trackId\x3d" + c)
            } else
                (c = $("#report_track").find(".j_trackBtn").attr("trackReport")) ? window.open(d + "/reporttrack.jsp?reportId\x3d" + a + "\x26trackId\x3d" + c) : (a = $("#dataId").val(),
                window.location.href = "/biaoge/previewFill/" + a)
        });
        $(document).on(d, "#confirm-pwd", function(a) {
            $(this);
            var b = $("#distributeId").val()
              , c = $.trim($(".j_password").val());
            a = {};
            a.distributeId = b;
            $.ajax({
                contentType: "application/json",
                type: "post",
                url: TEAMS.service.baseUrl + "/datasources/queryDistributeById.json",
                dataType: "json",
                data: JSON.stringify(a),
                success: function(a) {
                    var d = a.distribute
                      , g = d.password;
                    a = d.showMobile;
                    var h = d.webpicUrl
                      , d = d.showWebpic;
                    if (c && g && "" != g && c == g) {
                        var g = $("#dataId").val()
                          , n = $("#module").val()
                          , m = $("#formId").val()
                          , v = $("#formLayoutId").val()
                          , q = $("#isExtDist").val();
                        e.renderFormDetail(g, n, m, v, b, q, h, d);
                        h = $("#loginMobile").val();
                        d = $("#loginEmail").val();
                        e.renderMobileOrEmail(a, h, d);
                        $(".j_form_preview").removeClass("hide");
                        $(".j_form_inputPwd").addClass("hide")
                    } else
                        k.notify("\u586b\u5199\u5bc6\u7801\u8f93\u5165\u9519\u8bef!")
                }
            })
        });
        $(document).on(d, "#submit,#save_btn", function(a) {
            var b = $(this)
              , c = $.trim(b.parents(".j_form_preview").find(".j_track .j_mobileOrEmail").val());
            a = b.parents(".j_form_preview").find(".j_track .j_mobileOrEmail").attr("placeholder");
            c == a && (c = "");
            var dataType = b.attr('dataType');
            if (!e.checkVal(c))
                return k.notify("\u624b\u673a\u53f7\u6216\u90ae\u7bb1\u683c\u5f0f\u4e0d\u5bf9\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165!"),
                !1;
            b.parents(".j_form_preview").find(".form-name").text();
      //      0 != b.data("isSubmit") && (b.data("isSubmit", !1),
            b.parents(".j_form_preview").find(".j_loading").removeClass("hide"),
            b.addClass('disabled'),
            setTimeout(function(){b.removeClass('disabled')},3000),
            k.saveFormData({
                parentEl: $("#widget-control"),
                dataStatus: 1,
                isExternal: !0,
                submittype: dataType,
                callback: function(a) {
         //           b.data("isSubmit", !0);
                    if (a)
                        if (a && a.message)
                            k.notify(a.message);
                        else if (a.formData) {
                            k.notify('操作成功');
                            var d = $("#distributeId").val()
                              , e = $("#netip").attr("href")
                              , h = $("#localip").attr("href")
                              , n = {}
                              , m = {};
                            n.status = "finshed";
                            n.formData = a.formData.id;
                            n.name = a.formData.name;
                            n.formId = a.formData.form.id;
                            n.formLayout = a.formData.formLayout.id;
                            n.trackReport = c;
                            n.distributeId = d;
                            n.netIp = e;
                            n.localIp = h;
                            m.dataReport = n;
                            // $.ajax({
                            //     contentType: "application/json",
                            //     type: "post",
                            //     url: TEAMS.service.baseUrl + "/datasources/createReport.json",
                            //     dataType: "json",
                            //     data: JSON.stringify(m),
                            //     success: function(c) {
                            //         b.parents(".j_form_preview").find(".j_loading").addClass("hide");
                            //         c.message ? k.notify(c.message) : (localStorage.setItem(d + "_distribute", d),
                            //         window.location.href = "/biaoge/submitResult/" + a.formData.id)
                            //     }
                            // })
                        } else 
                            k.notify('操作失败 ');
                    else 
                        k.notify('操作失败 ');
                    b.parents(".j_form_preview").find(".j_loading").addClass("hide");

                }
            })
        });
        $(document).on("click", "#temporary", function(a) {
            k.saveFormData({
                parentEl: $("#widget-control"),
                dataStatus: 0,
                isExternal: !0,
                callback: function(a) {
                    a.formData && (window.location.href = "/biaoge/previewFill/" + a.formData.id)
                }
            })
        });
        $(document).on("click", "#readOnly", function(a) {
            k.setFormReadOnly({
                parentEl: $("#widget-control"),
                readOnly: !0
            })
        });
        $(document).on("click", "#notReadOnly", function(a) {
            k.setFormReadOnly({
                parentEl: $("#widget-control"),
                readOnly: !1
            })
        });
        $("#login-dialog .tab-list").on("click", "li", function() {
            $(this).siblings().removeClass("active");
            $(this).addClass("active");
            var a = $(this).find("a").attr("href");
            $("#login-dialog .tab-pane").removeClass("active");
            $("#login-dialog").find(a).addClass("active")
        })

        // 打印 评审日志 
         var b = $(document)
        b.off("click", ".js_printcomment").on("click", ".js_printcomment", function(a) {
           
            if($(this).is(":checked")) 
                $(document).find(".extend-panel").show();
            else 
               $(document).find(".extend-panel").hide(); 
        //    b.find(".j_extend").show(),
        //    "flow" == c.pageKey && b.find(".js_printdirection").parent().show()) : (b.find(".extend-panel").hide(),
        //    b.find(".j_extend").hide();
       //     "flow" == c.pageKey && b.find(".js_printdirection").parent().hide());
      //      window.localStorage && localStorage.setItem(c.pageKey + "Printcomment_" + c.userId, $(this).is(":checked"))
        });

        b.off("click", ".js_maxPrint").on("click", ".js_maxPrint", function(a) {
            a = $(this).prop("checked");
          //  window.localStorage && localStorage.setItem(c.pageKey + "MaxPrint_" + c.userId, a);
            b.find("#print").css({
                width: a ? "100%" : "",
                "padding-left": a ? "30px" : "",
                "padding-right": a ? "30px" : ""
            });
            var f = b.find("#print").css("width");
              f = parseInt(f.substring(0, f.indexOf("px")));
            b.find("#formName").css("max-width", a ? 2 * f : f / 2);
        });

        b.off("click", ".js_device_NeedlePrinter").on("click", ".js_device_NeedlePrinter", function(a) {
            $(this).is(":checked") ? $("body").addClass("device-needle-printer") : $("body").removeClass("device-needle-printer")
        });


        b.off("click", ".js_print").on("click", ".js_print", function(a) {
            var t = $(this).parents('#print-toolbar');
            t.hide();
            t.siblings('#print').css('padding-top', '0');
            if (-1 != document.title.indexOf("\u5ba1\u6279\u6253\u5370") || -1 != document.title.indexOf("\u8868\u5355\u6253\u5370")) {
                var f;
                a = {};
                var b = [];
                -1 != document.title.indexOf("\u5ba1\u6279\u6253\u5370") ? (a.module = "workflow",
                f = $("#info-div").attr("reportid")) : -1 != document.title.indexOf("\u8868\u5355\u6253\u5370") ? (a.module = "formdatareport",
                f = $("#reportContent").attr("reportid")) : a.module = "";
                // b.push(f);
                // a.ids = b;
                // $.ajax({
                //     contentType: "application/json;charset\x3dUTF-8",
                //     type: "post",
                //     url: "/stream/savePrintLog.json",
                //     dataType: "json",
                //     data: JSON.stringify(a),
                //     success: function(a) {}
                // })
            }
            

 


            window.print()

            setTimeout(function(){
                t.show();
                t.siblings('#print').css('padding-top', '60px');
            },200)
        });
        

        /*导出 pdf*/
        b.off("click", ".js_pdf").on("click", ".js_pdf", function(a) {
            var targetDom = $("#print");
            //把需要导出的pdf内容clone一份，这样对它进行转换、微调等操作时才不会影响原来界面
            var copyDom = targetDom.clone();
            //新的div宽高跟原来一样，高度设置成自适应，这样才能完整显示节点中的所有内容（比如说表格滚动条中的内容）
            copyDom.width(targetDom.width() + "px");
            copyDom.height(targetDom.height()+50 + "px");
            $('body').append(copyDom);//ps:这里一定要先把copyDom append到body下，然后再进行后续的glyphicons2canvas处理，不然会导致图标为空

            svg2canvas(copyDom);
            html2canvas(copyDom, {
                onrendered: function (canvas) {

                    var context = canvas.getContext('2d');        
                    // 【重要】关闭抗锯齿        
                    context.mozImageSmoothingEnabled = false;       
                     context.webkitImageSmoothingEnabled = false;     
                        context.msImageSmoothingEnabled = false;      
                          context.imageSmoothingEnabled = false;


                    var imgData = canvas.toDataURL('image/jpeg');
                    var img = new Image();
                    img.src = imgData;
                    //根据图片的尺寸设置pdf的规格，要在图片加载成功时执行，之所以要*0.225是因为比例问题
                    img.onload = function () {

                        var contentWidth = canvas.width;
                        var contentHeight = canvas.height-40;
    
                        //一页pdf显示html页面生成的canvas高度;
                        var pageHeight = contentWidth / 595.28 * 841.89+50;
                        //未生成pdf的html页面高度
                        var leftHeight = contentHeight;

                        //pdf页面偏移
                        var position = 20;
                        //a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高
                        var imgWidth = 555.28;
                        var imgHeight = 555.28/contentWidth * contentHeight-50;
    
    
                        var pageData = canvas.toDataURL('image/jpeg', 1.0);
    
                        var pdf = new jsPDF('', 'pt', 'a4');
                        //有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)
                        //当内容未超过pdf一页显示的范围，无需分页
                        if (leftHeight < pageHeight) {
                            pdf.addImage(pageData, 'JPEG', 20, position, imgWidth, imgHeight );
                        } else {
                            while(leftHeight > 0) {
                                pdf.addImage(pageData, 'JPEG', 20, position, imgWidth, imgHeight)
                                leftHeight -= pageHeight;
                                position -= 841.89;
                                //避免添加空白页
                                if(leftHeight > 0) {
                                    pdf.addPage();
                                }
                            }
                        }
                        
                        pdf.save('我的表单_'+$('#filterName').val() + '.pdf');
                    };
                    //删除复制出来的div
                    copyDom.remove();
                },
                background: "#fff",
                scale:2,
                logging:false,
                //这里给生成的图片默认背景，不然的话，如果你的html根节点没设置背景的话，会用黑色填充。
                allowTaint: true //避免一些不识别的图片干扰，默认为false，遇到不识别的图片干扰则会停止处理html2canvas
            });


            function svg2canvas(targetElem) {
                var svgElem = targetElem.find('svg');
                svgElem.each(function (index, node) {
                    var parentNode = node.parentNode;
                    //由于现在的IE不支持直接对svg标签node取内容，所以需要在当前标签外面套一层div，通过外层div的innerHTML属性来获取
                    var tempNode = document.createElement('div');
                    tempNode.appendChild(node);
                    var svg = tempNode.innerHTML;
                    var canvas = document.createElement('canvas');
                    //转换
                    canvg(canvas, svg);
                    parentNode.appendChild(canvas);
                });
            }

        })

        
        /*导出 word*/
        b.off("click", ".js_word").on("click", ".js_word", function(a) {

            var table = $( '<table  width="800" cellspacing="0" style="margin:0 auto;" class="tablecon">' ),
                arr = [];
            $( '#widget-control').children('.field ').each( function(i) {
                var tr = $( '<tr>' );

               
                if($(this).hasClass('field_js')){
                    var table44 = $('<table class="tablesub"><tr class="trbd"></tr></table>');
                    var _html_title =  $(this).children('.widget-title').html() || $(this).children('.alert').html();
                    var _html_content =  $(this).children('.widget-content').html()
                    var _bgcolor = '#fff';
                    tr.append(table44); 
                    if($(this).children('.alert'))  _bgcolor = $(this).children('.alert').css('background-color');
                    var td_t22 = $( '<td class="td_tit" height="32"  width="100" style="background:'+_bgcolor+'">' ).html(_html_title );
                    if(_html_title)
                        tr.find('.tablesub tbody tr').append( td_t22 );

                    if(_html_content)
                       var td_c22 = $( '<td  class="td_con" height="32">' ).html(_html_content );
                        tr.find('.tablesub tbody tr').append( td_c22 );

                }
                if($(this).attr('componentkey')=='ColumnPanel') {
                     var table2 = $('<td><table class="tablesub"><tr class="trbd"></tr></table></td>');
                    var isBoder = $(this).hasClass('noborder');
                    if(isBoder) tr.addClass('noborder');
                    $(this).find('.cell_js').each( function() {
                        var _i = $(this).index();
                        var _t = $(this).children('.field_js');
                        var _html_title =  _t.children('.widget-title').html()
                        var _html_content =  _t.children('.widget-content').html()


                       var td_t = $( '<td  class="td_tit" height="32" width="100">' ).html(_html_title );

                        if(_html_title)
                            table2.find('.tablesub tbody tr').append( td_t );

                       var td_c = $( '<td  class="td_con" height="32">' ).html(_html_content );
                        if(_html_content)
                            table2.find('.tablesub tbody tr').append( td_c );
                        tr.addClass('subtrPanel').append(table2); 


                    });

                }
                
                if($(this).attr('componentkey')=='DataTable' || $(this).attr('componentkey')=="TableLayout"  || $(this).attr('componentkey')=="TabControl") {
                    var td = $( '<td width="200" height="32" border="1">' ).html( $( this ).html() );
                    tr.append(td)
                }  

                if($(this).attr('componentkey')=='DataTable') {
                    tr.addClass('trdatatable')
                }

                if($(this).attr('componentkey')=='Paragraph') {
                    tr.find('td.td_tit').addClass('parag')
                }
                table.append( tr );
            });
            if($('.form-view').length<=1) {

                var c = $('.preview-box').clone();
                var d = c.find('.form-view');
             //   $('.j_form_preview').append(c);
                $('.form-preview').append(c);
                table.replaceAll(c.find('#widget-control')); // 替换原来的 ul
                c.addClass(' clone_r')
                if($('.extend-panel').css('display')=='none') {
                    $('.clone_r').find('#datareport-info').remove();
                }


                d.find('.hide').each(function(index, el) {
                    $(this).remove();
                });

                d.find('input,select,textarea').each(function(index, el) {

                   if($(this).attr('type')=='hidden') {
                      $(this).remove();
                   } 
                });

                
                c.find('.form-head').html("<h1 style='text-align:center;'>"+c.find('.form-name').text()+"</h1>");
                
                d.find('.widget-title').each(function(index, el) {
                   if($(this).css('display')=='none') {
                      $(this).remove();
                   } 
                });
                
                d.find('.document-preview-btn').remove();
                c.find('td').css({
                    "height":"40px"
                }).find('.widget-title').css({
                    'font-size': '14px'
                });
                c.find('table,table>tbody>tr>td').css({
                    "border": "1px solid #4c4c4c"
                });
                
                c.find('tr,.detail-block').find('table th').css({
                    "background-color": "#dff0d8",
                    "font-weight": "bold",
                    "height":"40px"
                });

                c.find('.trbd td').css({
                    'padding':'8px'
                });



                d.find('.field_js').each(function(){
                        var table2 = $('<table class="tablesub"><tr></tr></table>');
                        var _html_title =  $(this).children('.widget-title').html() || $(this).children('.alert').html();
                        var _html_content =  $(this).children('.widget-content').html()

                       $(this).html('').append(table2); 

                       var td_t = $( '<td  class="td_tit" height="32" width="100">' ).html(_html_title );
                       if(_html_title)
                            $(this).find('.tablesub tbody tr').append( td_t );

                       var td_c = $( '<td class="td_con" height="32">' ).html(_html_content );
                       if(_html_content)
                            $(this).find('.tablesub tbody tr').append( td_c );


                        $(this).find('.table,td').css({
                            'border': '1px sold #4c4c4c',
                            'padding':'0 5px',
                            'height':'auto'
                        });
                        


                    });

                c.find('.table,.tablesub').css({
                    'border': '0'
                });

                c.find('table').css({
                    'width': '100%',
                    "border-collapse":"collapse",
                    "margin":'0 auto',
                    "font-size":'14px'
                }).attr('cellspacing', '0');
                
                c.find('.tablecon,.tablecon>tbody>tr>td').css({
                     'border': '0'
                });
                

                var _letable = $('.tablecon>tbody>tr').length-1;
                c.find('.tablecon>tbody>tr').each(function(index, el) {
                    if(_letable>1) {
                        if($(this).index()==0) {
                            $(this).find('.table>tbody>tr>td').css({
                                'border-bottom': '0'
                            });

                            $(this).find('.tablesub>tbody>tr>td').css({
                                'border-bottom': '0'
                            });
                          
                        }

                        if($(this).index()==_letable) {
                            $(this).find('.table>tbody>tr>td').css({
                                'border-top': '0'
                            });

                            $(this).find('.tablesub>tbody>tr>td').css({
                                'border-top': '0'
                            });

                            $(this).find('.trdatatable>td').css({
                                'border-top': '0'
                            });
                        }
                    }
                });
               c.find('.trdatatable>td').css({
                     'border': '1px solid #4c4c4c',
                     'border-bottom': '0'
                });

                c.find('.noborder').find('table td').css({
                    'border': '0'
                });

                c.find('td.td_con').css({
                    'padding-left':'20px'
                })

                c.find('td.td_tit').css({
                    'padding-right':'10px',
                    'text-align':'right'
                }).each(function(index, el) {
                   if($(this).children('span').html()=='') {
                        $(this).remove();
                   }
                });

                c.find('td.parag').css({
                    'padding':'12px',
                    'text-align':'left'
                })


                c.find('.table>tbody>tr>td:nth-child(1)').css({
                    'min-width': '100px'
                });
                
                c.find('tr,td').each(function(index, el) {
                    if($(this).css('display')=='none') 
                        $(this).remove();
                });

                if(c.find('img')) {
                    var _w = c.find('img').width();
                    var _h = c.find('img').height();
                    c.find('img').attr('width', _w);
                    c.find('img').attr('height', _h);
                    c.find('img').parent().css('padding', '10px');
                }


             c.wordExport('我的表单_'+$('#filterName').val());
             c.remove();
            }
            
        })

        var kk ;    
        $(document).find("#lineslider").slider({
                range: "min",
                value: 0,
                min: 1,
                max: 10,
                disabled: !1,
                slide: function(a, f) {
                    for (var b = $("#print").attr("class").split(" "), c = 0; c < b.length; c++)
                        -1 != b[c].indexOf("slider-linecolor-") && $("#print").removeClass(b[c]);
                    $("#print").addClass("slider-linecolor-" + f.value)
                },
                create: function(a, b) {
                    $(document).find("#lineslider .ui-slider-handle").addClass("cs-g");
                    $("#print").addClass("slider-linecolor-" + d)
                },
                start: function(a, b) {
                    kk = b.value;
                    $(document).find("#lineslider .ui-slider-handle").removeClass("cs-g").addClass("cs-ging");
                },
                stop: function(b, d) {
                    $(document).find("#lineslider .ui-slider-handle").removeClass("cs-ging").addClass("cs-g");
                }
        })


        $(document).find("#flowslider").slider({
                range: "min",
                value: 0,
                min: 8,
                max: 15,
                disabled: !1,
                slide: function(a, f) {
                    for (var b = $("#print").attr("class").split(" "), c = 0; c < b.length; c++)
                        -1 != b[c].indexOf("slider-fontsize-") && $("#print").removeClass(b[c]);
                    $("#print").addClass("print-sliderfont slider-fontsize-" + f.value)
                },
                create: function(a, b) {
                    $("#flowslider .ui-slider-handle").addClass("cs-g");
                    $("#print").addClass("slider-fontsize-" + m)
                },
                start: function(a, b) {
                    kk = b.value;
                    $("#flowslider .ui-slider-handle").removeClass("cs-g").addClass("cs-ging")
                },
                stop: function(b, d) {
                    $("#flowslider .ui-slider-handle").removeClass("cs-ging").addClass("cs-g");
                    kk != d.value && ($(".js_printdirection").is(":checked") && ($(".comment-container").masonry("destroy"),
                    $(".comment-container").imagesLoaded(function() {
                        $(".comment-container").masonry({
                            itemSelector: ".comment-box",
                            gutter: 0,
                            isAnimated: !0
                        })
                    })),
                    window.localStorage && localStorage.setItem("PrintFont_", '12'))
                }
        })

    });
    w.exports = e
});
var needCopy = !0;
function loginCallback(n) {
    $("#login-dialog").modal("hide");
    n = n.uid;
    needCopy ? copyForm(n) : ($(".btn-login").addClass("hide"),
    window.location.reload())
}
function copyForm(n) {
    n = $("#formId").val();
    var y = $("#module").val();
    "workflow" == y ? $.ajax({
        type: TEAMS.ajaxMethod,
        url: "/form/copy.json",
        dataType: "json",
        async: !1,
        data: {
            formId: n,
            module: y
        },
        success: function(n) {
            n.message && n.message ? formPlugin.notify(n.message) : n && n.form ? (TEAMS.currentUser || window.location.reload(),
            window.open("/workflows/" + TEAMS.currentUser.id + "/personal")) : formPlugin.notify("\u670d\u52a1\u5668\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7cfb\u7edf\u7ba1\u7406\u5458!")
        }
    }) : ($.ajax({
        type: TEAMS.ajaxMethod,
        url: TEAMS.service.baseUrl + "/datasources/copy.json",
        dataType: "json",
        async: !1,
        data: {
            formId: n
        },
        success: function(n) {
            n.message && n.message ? formPlugin.notify(n.message) : n && n.form ? TEAMS.currentUser || window.location.reload() : formPlugin.notify("\u670d\u52a1\u5668\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7cfb\u7edf\u7ba1\u7406\u5458!")
        }
    }),
    window.open("/forms"))
}
define("form/form-plugin", "form/component/text form/component/textarea form/component/columnpanel form/component/datatable form/component/dividingline form/component/datecomponent form/component/dateinterval form/component/option form/component/radiobox form/component/checkbox form/component/select form/component/comboselect form/component/paragraph form/component/numbercomponent form/component/money form/component/department form/component/employee form/component/email form/component/phone form/component/mobile form/component/filecomponent form/component/imagecomponent form/component/barcomponent form/component/piecomponent form/component/chartcomponent form/component/tablestatcomponent form/component/numberstatcomponent form/component/tablecomponent form/component/monitor form/component/mainline form/component/tablelayout form/component/raty form/component/task form/component/document form/component/workflow form/component/formcomponent form/component/customercomponent form/component/contactcomponent form/component/datasource form/component/imageradiobox form/component/imagecheckbox form/component/comboselect form/component/form-select form/component/table form/component/tabcontrol form/component/chancecomponent form/component/productioncomponent form/component/contractcomponent form/component/serialnumber form/component/positioncomponent form/component/positionselecter form/component/einvoicecomponent form/component/signaturecomponent form/component/agendacomponent form/componentmodel".split(" "), function(n, y, u) {
    n("form/component/text");
    n("form/component/textarea");
    n("form/component/columnpanel");
    n("form/component/datatable");
    n("form/component/dividingline");
    n("form/component/datecomponent");
    n("form/component/dateinterval");
    n("form/component/option");
    n("form/component/radiobox");
    n("form/component/checkbox");
    n("form/component/select");
    n("form/component/comboselect");
    n("form/component/paragraph");
    n("form/component/numbercomponent");
    n("form/component/money");
    n("form/component/department");
    n("form/component/employee");
    n("form/component/email");
    n("form/component/phone");
    n("form/component/mobile");
    n("form/component/filecomponent");
    n("form/component/imagecomponent");
    n("form/component/barcomponent");
    n("form/component/piecomponent");
    n("form/component/chartcomponent");
    n("form/component/tablestatcomponent");
    n("form/component/numberstatcomponent");
    n("form/component/tablecomponent");
    n("form/component/monitor");
    n("form/component/mainline");
    n("form/component/tablelayout");
    n("form/component/raty");
    n("form/component/task");
    n("form/component/document");
    n("form/component/workflow");
    n("form/component/formcomponent");
    n("form/component/customercomponent");
    n("form/component/contactcomponent");
    n("form/component/datasource");
    n("form/component/imageradiobox");
    n("form/component/imagecheckbox");
    n("form/component/comboselect");
    n("form/component/form-select");
    n("form/component/table");
    n("form/component/tabcontrol");
    n("form/component/chancecomponent");
    n("form/component/productioncomponent");
    n("form/component/contractcomponent");
    n("form/component/serialnumber");
    n("form/component/positioncomponent");
    n("form/component/positionselecter");
    n("form/component/einvoicecomponent");
    n("form/component/signaturecomponent");
    n("form/component/agendacomponent");
    var m = n("form/componentmodel");
    window.valMap = {};
    window.formPlugin = {};
    formPlugin.loadingImgEl = '\x3cdiv class\x3d"loading_small form-loading"\x3e\x3cspan\x3e\u52a0\u8f7d\u4e2d...\x3c/span\x3e\x3c/div\x3e';
    formPlugin.nullDataEl = '\x3cdiv class\x3d"alert alert-block fade in"\x3e\x3ch4 class\x3d"alert-heading"\x3e\u5bf9\u4e0d\u8d77! \u4f60\u8bbf\u95ee\u7684\u8868\u5355\u4e0d\u5b58\u5728\x3c/h4\x3e\x3cp\x3e\u60a8\u8bbf\u95ee\u7684\u8868\u5355\u53ef\u80fd\u5df2\u7ecf\u88ab\u5176\u4ed6\u7528\u6237\u5220\u9664\u4e86\u3002\x3c/p\x3e\x3c/div\x3e';
    $(function() {
        $(document).off("currentTime").on("currentTime", function(h, g) {
            g(TEAMS.nowTime)
        });
        $(document).off("currentDepartment").on("currentDepartment", function(h, g) {
            TEAMS.currentUser && g(TEAMS.currentUser.department)
        });
        $(document).off("currentUser").on("currentUser", function(h, g) {
            g(TEAMS.currentUser)
        });
        $(document).click(function() {
            window.abposview && window.abposview.remove()
        })
    });
    formPlugin.renderForm = function(h) {
        (function(g) {
            var f = g.parentEl, _data_layoutDetail = {};
            f.addClass("form-view_js").html(formPlugin.loadingImgEl);
            var d = g.formId
              , b = g.layoutId
              , c = g.readOnly
              , l = g.notDefault
              , e = g.layoutDetail
              , a = g.formData
              , k = g.callback
              , z = g.module
              , h = g.isExtDist
              , q = g.distributeId
              , p = formPlugin.initAutoSave(g.autoSave, z);
            if (null != e)
                b = {},
                b.layoutDetail = e,
                formPlugin.analyseLayout(b, f, l, c, p),
                a ? formPlugin.analyseData(a, f, c) : (f.find(".check_js:not(.subtd_js .check_js)").each(function() {
                    var a = $(this).data("componentData")
                      , e = a.el.closest(".form-view_js");
                    a && a.componentSetup.relateField && a.fillRelateValue(a.componentSetup.relateField.fieldId, e)
                }),
                f.find("input[componentkey\x3d'Monitor']").each(function() {
                    var a = $(this)
                      , e = $(this).data("componentData");
                    0 == a.val().length && (e.getMonitorValue(),
                    e.getValue($(this)))
                })),
                formPlugin.afterRenderForm(f),
                k && k();
            else {
                e = {};
                e.formId = d;
                e.layoutId = b;
                e.module = z;
                if (1 == h || "true" == h)
                    e.isExtDist = !0,
                    q && (e.distributeId = q);
                "app" == z && (e.appId = f.closest(".form-view_js").attr("appid"),
                e.appId || (e.appId = $("#appId").val()));
                $.ajax({
                    type: TEAMS.ajaxMethod,
                    data: e,
                    dataType: "json",
                    url: TEAMS.api.findPreviewFrom,
                    success: function(e) {
                        f.html("");

                        // if(!window.parent.m_layoutDetail && window.localStorage) {
                        //     _data_layoutDetail = window.localStorage.getItem('m_layoutDetail');
                        //     e.formLayout.layoutDetail = String(_data_layoutDetail)
                        // }
                        if (null == e.formLayout)
                            f.parents(".form-view_js").html(formPlugin.nullDataEl);
                        else {
                            var b = f.data("form");
                            null == b ? b = {
                                formId: d,
                                layoutId: e.formLayout.id,
                                readOnly: c,
                                module: z,
                                formFields: e.formFields
                            } : (b.formId = d,
                            b.layoutId = e.formLayout.id,
                            b.readOnly = c,
                            b.module = z,
                            b.formFields = e.formFields,
                            b.dataId = null);
                            f.data("form", b);
                            f.data("startTime", (new Date).getTime());
                            a && (l = !0);
                            b = (new Date).getTime();
                            formPlugin.analyseLayout(e.formLayout, f, l, c, p);
                            console.log("\u6e32\u67d3\u8868\u5355\u6240\u82b1\u65f6\u95f4\uff1a" + ((new Date).getTime() - b));
                            a ? formPlugin.analyseData(a, f, c) : (f.find(".check_js:not(.subtd_js .check_js)").each(function() {
                                var a = $(this).data("componentData")
                                  , e = a.el.closest(".subtr_js")
                                  , e = 1 == e.length ? e : a.el.closest(".form-view_js");
                                a && a.componentSetup.relateField && a.fillRelateValue(a.componentSetup.relateField.fieldId, e, null, !1)
                            }),
                            f.find("input[componentkey\x3d'Monitor']").each(function() {
                                var a = $(this)
                                  , e = $(this).data("componentData");
                                0 == a.val().length && (e.getMonitorValue(),
                                e.getValue($(this)))
                            }));
                            formPlugin.afterRenderForm(f)
                        }
                        k(e)
                    },
                    error: function() {}
                })
            }
        }
        )(h)
    }
    ;
    formPlugin.afterRenderForm = function(h) {
        h.find(".field_js[componentkey\x3d'ComboSelect']:not(.subtd_js\x3e.field_js)").find("select:last").trigger("change", {
            isCheck: !1
        });
        h.find(".field_js[componentkey\x3d'Select']:not(.subtd_js\x3e.field_js)").find("select").trigger("change", {
            isCheck: !1
        });
        h.find(".field_js[componentkey\x3d'CheckBox']:not(.subtd_js\x3e.field_js),.field_js[componentkey\x3d'RadioBox']:not(.subtd_js\x3e.field_js)").find("input:first").trigger("change", {
            isCheck: !1
        });
        h.find(".field_js[componentkey\x3d'DataSource']:not(.subtd_js\x3e.field_js)").trigger("datacheck", {
            isCheck: !1
        })
    }
    ;
    formPlugin.renderFormDataByLayoutId = function(h) {
        var g = h.callback
          , f = h.parentEl;
        h.callback = function(d) {
            var b = f.data("form");
            b && delete b.dataId;
            g && g(d)
        }
        ;
        formPlugin.renderFormData(h)
    }
    ;
    formPlugin.initAutoSave = function(h, g) {
        if (null != h && 0 != h) {
            var f = {
                beforeDataDetailSave: function(d) {},
                validate: function(d) {
                    return !0
                },
                afterformDataCreate: function(d) {
                    return !0
                },
                afterDataDetailSave: function(d) {},
                module: g
            };
            $.extend(f, h);
            return f
        }
        return null
    }
    ;
    formPlugin.analyseComponentReadOnly = function(h, g, f) {
        var d = h.componentKey
          , b = (new window[d](h)).renderPreview(g, !0, !0, !1, f);
        if ("ColumnPanel" == d && null != h.layoutDetail)
            for (d = 0; d < h.layoutDetail.length; d++) {
                var c = h.layoutDetail[d];
                if (c) {
                    var l = ""
                      , l = 1 == h.size ? g : $(b[d]);
                    formPlugin.analyseComponentReadOnly(c, l, f)
                }
            }
    }
    ;
    formPlugin.renderFormDatas = function(h) {
        var g = h.parentEls
          , f = h.callback
          , d = h.module;
        h = h.formId;
        var b = [];
        g.each(function() {
            var c = $(this);
            c.html(formPlugin.loadingImgEl);
            (c = c.attr("formDataId")) && b.push(c)
        });
        0 == b.length ? (g.html(""),
        f()) : $.ajax({
            type: TEAMS.ajaxMethod,
            contentType: "application/json",
            url: TEAMS.api.findFormDatas,
            dataType: "json",
            data: JSON.stringify({
                formDataIds: b,
                formId: h,
                module: d
            }),
            success: function(c) {
                var b = c.formDatas
                  , e = c.formLayout;
                if (b && e && e.layoutDetail) {
                    var a = $("\x3cdiv class\x3d'form-view form-view_js'\x3e\x3c/div\x3e");
                    formPlugin.analyseComponentReadOnly(JSON.parse(e.layoutDetail), a, d);
                    g.each(function() {
                        for (var e = $(this), c = a.clone(!0), d = e.attr("formDataId"), f = null, g = 0; g < b.length; g++)
                            if (b[g].id == d) {
                                f = b.splice(g, 1)[0];
                                break
                            }
                        f && (formPlugin.analyseData(f, c, !0),
                        e.html(c).show())
                    })
                } else
                    g.html("");
                "function" == typeof f && f(c)
            }
        })
    }
    ;
    formPlugin.renderFormData = function(h) {
        (function(g) {
            var f = g.parentEl;
            f.addClass("form-view_js").html(formPlugin.loadingImgEl);
            var d = g.dataId
              , b = g.readOnly
              , c = g.notDefault
              , l = g.layoutId
              , e = g.callback
              , a = g.module
              , k = g.newLayout
              , z = formPlugin.initAutoSave(g.autoSave, a);
            g = {};
            g.dataId = $('#dataId').val();
            g.layoutId = l;
            g.formId = $('#formId').val();
            g.module = a;
            g.newLayout = k;
            "app" == a && (g.appId = f.closest(".form-view_js").attr("appid"));

            $.ajax({
                type: TEAMS.ajaxMethod,
                data: g,
                dataType: "json",
                url: TEAMS.api.findFormData,
                success: function(d) {
                    f.html("");
                    if (null == d.formLayout)
                        f.parents(".form-view_js").html(formPlugin.nullDataEl);
                    else {
                        null == b && (b = "submit" == d.formData.dataStatus ? !0 : !1);
                        if (null == c || "" == c)
                            c = !0;
                        var k = f.data("form");
                        null == k ? k = {
                            formId: d.formData.form.id,
                            layoutId: d.formLayout.id,
                            dataId: d.formData.id,
                            readOnly: b,
                            module: a,
                            formFields: d.formFields
                        } : (k.formId = d.formData.form.id,
                        k.layoutId = d.formLayout.id,
                        k.dataId = d.formData.id,
                        k.readOnly = b,
                        k.formFields = d.formFields,
                        k.module = a);
                        f.data("form", k);
                        f.data("startTime", (new Date).getTime());
                        k = (new Date).getTime();
                        formPlugin.analyseLayout(d.formLayout, f, c, b, z);
                        formPlugin.cacheSubFormData(d.formData, f, b);
                        formPlugin.analyseData(d.formData, f, b);
                        formPlugin.afterRenderForm(f);
                        f.find(".subform_js").each(function() {
                            var a = $(this)
                              , e = a.find("table.subtable_js").data("componentData");
                            1 != e.isReadOnly && "true" != e.isReadOnly || setTimeout(function() {
                                e.frozenColumn(a)
                            }, 300)
                        })
                    }
                    e(d)
                },
                error: function() {}
            })
        }
        )(h)
    }
    ;
    formPlugin.cacheSubFormData = function(h, g, f) {
        if (!f) {
            h = h.dataDetails;
            f = {};
            if (null != h && 0 < h.length)
                for (var d = 0; d < h.length; d++) {
                    var b = h[d];
                    b.subForm && b.subForm.id && b.formField && (f[b.formField.id + b.dataIndex] = b)
                }
            g.data("subFormdata", f)
        }
    }
    ;
    formPlugin.analyseData = function(h, g, f) {
        h && (h.dataDetails = formPlugin.sensitiveWords(h.dataDetails, "json"),
        formPlugin.subFormFillRows(formPlugin.analyseMaxSubFormIndexs(h), g),
        formPlugin.fillFieldContent(h.dataDetails, g),
        "mobile" == window.systemInfo_form && (formPlugin.mobileShowSubForm(h, g),
        f && g.addClass("form-noedit")),
        formPlugin.removeEmptyRow(g))
    }
    ;
    formPlugin.removeEmptyRow = function(h) {
        h.find(".subtable_js").each(function() {
            var g = $(this).find(".subtr_js");
            if (1 < g.length)
                for (var f = g.length - 1; 0 < f; f--) {
                    var d = $(g[f])
                      , b = !0;
                    d.find(".field_js .check_js").each(function() {
                        var c = $(this).data("componentData");
                        c && null != c.getValue($(this)) && (b = !1)
                    });
                    if (b)
                        d.remove();
                    else
                        break
                }
        })
    }
    ;
    formPlugin.analyseMaxSubFormIndexs = function(h) {
        h = h.dataDetails;        
        var g = [];
        if (null != h && 0 < h.length)
            for (var f = 0; f < h.length; f++) {
                var d = h[f];
                if (d.subForm && d.subForm.id) {
                    var b = formPlugin.checkSubform(g, d.subForm.id);
                    b ? b.maxIndex < d.dataIndex && (b.maxIndex = d.dataIndex) : g.push({
                        subFormId: d.subForm.id,
                        maxIndex: d.dataIndex
                    })
                }
            }
        return g
    }
    ;
    formPlugin.checkSubform = function(h, g) {
        if (null != h && 0 < h.length)
            for (var f = 0; f < h.length; f++) {
                var d = h[f];
                if (d.subFormId == g)
                    return d
            }
        return null
    }
    ;
    formPlugin.saveFormData = function(h) {
        var g = h.parentEl
          , f = h.callback
          , d = h.isExternal
          , b = h.submittype;
        if (null != g.get(0)) {
            var c = g.data("form");
            if (null != c)
                if (c.readOnly)
                    f && f({
                        type: "readOnly"
                    });
                else {
                    var l = !0;
                    if (null == b || null != b && 0 > b.indexOf("-save"))
                        l = formPlugin.submitCheck(g, f);
                    if (l) {
                        var e = formPlugin.submitAssembleForm(h);
                        "mobile" != window.systemInfo_form && 0 < g.parents("#flowContent").length && (e.formData.updateTimeStamp = g.parents("#flowContent").data("updateTimeStamp"));
                        "mobile" == window.systemInfo_form && 0 < g.parents("#flow-info").length && (e.formData.updateTimeStamp = g.parents("#flow-info").data("updateTimeStamp"));
                        $.ajax({
                            contentType: "application/json",
                            type: TEAMS.ajaxMethod,
                            dataType: "json",
                            url: TEAMS.api.saveData,
                            data: JSON.stringify(e),
                            complete: function (XMLHttpRequest,status) {
                                if(status=='timeout') {
                                    formPlugin.notify('网络超时','请重新操作');
                                }
                            },
                            success: function(a) {
                                a.formData && !a.message && (c.dataId = a.formData.id,
                                "mobile" != window.systemInfo_form && 0 < g.parents("#flowContent").length && (e.formData.updateTime = g.parents("#flowContent").data("updateTimeStamp", a.formData.updateTimeStamp)),
                                "mobile" == window.systemInfo_form && 0 < g.parents("#flow-info").length && (e.formData.updateTime = g.parents("#flow-info").data("updateTimeStamp", a.formData.updateTimeStamp)));
                                f(a)
                                $('#dataId').val(a.dataId);
                                if(a.message) {
                                    formPlugin.notify(a.message)
                                }
                                setTimeout(function(){
                                   // $('body').load($('#form-preview'));
                                  _loadHref();
                                },3000)
                            },

                            error: function() {
                                formPlugin.notify('操作失败')
                            }
                        })
                    }
                }
        }
    }
    ;
    formPlugin.filterBlankLines = function() {
        $("table.subtable_js").each(function() {
            $(this).find(".subtr_js").not(":eq(0)").each(function() {
                var h = !0;
                $(this).find(".field_js .check_js").each(function() {
                    null != $(this).data("componentData").getValue($(this)) && (h = !1)
                });
                h && $(this).remove()
            })
        })
    }
    ;
    formPlugin.isContainContent = function(h) {
        return 0 < h.children().length && (h = formPlugin.submitAssembleForm({
            parentEl: h
        })) && "[]" != JSON.stringify(h.formData.dataDetails) ? !0 : !1
    }
    ;
    formPlugin.submitCheck = function(h, g) {
        var f = !0;
        h.find(".field_js").not(".fieldReadOnly, .hide").find(".check_js").each(function(d) {
            if (0 < $(this).closest(".form-condition-hide").length)
                return !0;
            d = $(this).data("componentData");
            if (!d || 1 != d.componentSetup.isReadOnly && "true" != d.componentSetup.isReadOnly)
                if (d.submitCheck($(this), function(b) {
                    formPlugin.checkPrompt(b) || (g && g(b),
                    f = !1)
                }),
                !f && "mobile" == window.systemInfo_form)
                    return !1
        });
        f || "mobile" == window.systemInfo_form || formPlugin.notify("\u8868\u5355\u5185\u5bb9\u586b\u5199\u6709\u8bef\uff01");
        1 == f && h.find(".subform_js").each(function() {
            var d = $(this);
            if (d.hasClass("form-condition-hide") || d.hasClass("hide"))
                return !0;
            var d = d.find(".subtable_js")
              , b = d.data("componentData");
            if (!b || !b.componentSetup.required || "false" == b.componentSetup.required || !b.isEditRow(b.componentSetup.layoutDetail))
                return !0;
            if (0 < d.find(".required_js").length && 1 == d.find("tr").length)
                return formPlugin.notify("\u8bf7\u586b\u5199\u660e\u7ec6\u8868\u5fc5\u586b\u9879\uff01"),
                g && g({
                    message: "\u8bf7\u586b\u5199\u660e\u7ec6\u8868\u5fc5\u586b\u9879\uff01"
                }),
                f = !1;
            if (b.componentSetup.requiredRows > d.find("tbody tr").length - 1)
                return formPlugin.notify("\u8bf7\u81f3\u5c11\u586b\u5199 " + b.componentSetup.requiredRows + " \u884c\u660e\u7ec6\u8868\u6570\u636e\uff01"),
                g && g({
                    message: "\u8bf7\u81f3\u5c11\u586b\u5199  " + b.componentSetup.requiredRows + " \u884c\u660e\u7ec6\u8868\u6570\u636e\uff01"
                }),
                f = !1
        });
        return f
    }
    ;
    formPlugin.printVerticaltable = function(h) {
        var g = h.find(".subtr_js:gt(0)")
          , f = $("\x3cdiv class\x3d'js_vertical_table'\x3e\x3c/div\x3e");
        g.each(function() {
            $this = $(this);
            $this.find("td").each(function() {
                f.append($(this).html())
            })
        });
        f.find(".widget-title_js").parent().show();
        h.append(f.show())
    }
    ;
    formPlugin.submitAssembleForm = function(h, g) {
        var f = h.parentEl
          , d = 1 == h.dataStatus ? "submit" : "temporary";
        if (null != f.get(0)) {
            var b = f.data("form");
            null == b && (b = f.parents(".form-view_js").data("form"));
            if (null != b) {
                var c = $('#formId').val() || ''
                  , l = $('#dataId').val() || ''
                  , b = $('#layoutId').val() || ''
                  , t = $('#taskId').val() || '';
                null != l && null == h.dataStatus && (d = null);
                var e = 0
                  , a = f.data("startTime");
                a && (e = ((new Date).getTime() - a) / 1E3,
                e = parseInt(e, 10),
                e = 0 < e ? e : 0);
                d = {
                    formId: c,
                    layoutId: b,
                    dataId: l,
                    taskId: t,
                    formData: {
                        spentTime: e,
                        dataStatus: d
                    },
                    isDel: h.isDel,
                    module: h.module,
                    sessionType:h.submittype,
                    clientSource: "pc"
                };
                "mobile" == window.systemInfo_form && (d.clientSource = "mobile");
                c = formPlugin.assembleFormFieldData(f, g);
                f = formPlugin.assembleSubFormData(f);
                d.formData.dataDetails = c;
                d.formData.subFormLogs = f;
                return d
            }
        }
    }
    ;
    formPlugin.assembleFormFieldData = function(h, g) {
        var f = []
          , d = 0
          , b = h.find(".field_js .check_js");
        null == b.get(0) && (b = h.find(".check_js"));
        b.each(function(c) {
            c = $(this).data("componentData");
            var b = c.getValue($(this), g)
              , e = $(this).parents(".subtable_js")
              , a = ""
              , k = "";
            null != e.get(0) && (c = e.data("componentData"),
            a = c.componentSetup.subFormId,
            k = $(this).parents(".subtr_js").index());
            if(!a) a =  c.cid;

            if ("[object Object]" == Object.prototype.toString.apply(b)) {
                null != e.get(0) && (b.subForm = {
                    id: a
                },
                b.dataIndex = k),
                f[d] = b,
                d++;

                }
            else if ("[object Array]" == Object.prototype.toString.apply(b))
                for (c = 0; c < b.length; c++)
                    null != e.get(0) && (b[c].subForm = {
                        id: a
                    },
                    b[c].dataIndex = k),
                    f[d] = b[c],
                    d++
        });
        return f
    }
    ;
    formPlugin.assembleSubFormData = function(h) {
        var g = []
          , f = h.find(".subtable_js");
        null == f.get(0) && (f = h.parents(".form-view_js").find(".subtable_js"));
        f.each(function(d) {
            var b = $(this).data("componentData").getValue($(this));
            g[d] = b
        });
        return g
    }
    ;
    formPlugin.subFormFillRows = function(h, g) {
        if (null != h && 0 != h.length)
            for (var f = 0; f < h.length; f++) {
                var d = h[f]
                  , b = d.maxIndex
                  , c = g.find("#" + d.subFormId).find("table.subtable_js")
                  , d = c.data("componentData");
                if (null != d)
                    for (formPlugin.destroyEvents(c),
                    c.find("tr.subtr_js").not(":eq(0)").remove(),
                    c = 0; c < b; c++)
                        d.addRow(!0, null, g)
            }
    }
    ;
    formPlugin.fillFieldContent = function(h, g) {
        if (null != h && 0 < h.length)
            for (var f = 0; f < h.length; f++) {
                var d = h[f];
                if (null != d.formField) {
                    var b = d.formField.id
                      , c = null;
                    null != d.subForm ? (c = d.dataIndex,
                    c = g.find("#" + d.subForm.id).find(".subtr_js").eq(c).find("#field_" + b)) : c = g.find("#field_" + b);
                    0 != c.length && (b = c.find(".check_js"),
                    null == b.get(0) && (b = c.parents(".check_js")),
                    0 != b.length && b.data("componentData").setValue(c, d))
                    if(d.isDataSource) b.attr('disabled', 'disabled');
                }
            }
        null != g.find(".subform_js").get(0) && this.renderTotal(g.find(".subform_js"))
    }
    ;
    formPlugin.renderTotal = function(h) {
        var g = this;
        h.find(".subtable_js tfoot span").each(function(f) {
            f = $(this).attr("name");
            var d = h.find('.subtable_js input[name\x3d"' + f + '"]');
            if (0 == d.length)
                return !1;
            var b = new String(formPlugin.calculateTotal(d))
              , d = d.eq(0).data("componentData");
            "Money" == h.find('span[name\x3d"' + f + '"]').attr("type") && "\u4eba\u6c11\u5e01" == h.find('span[name\x3d"' + f + '"]').attr("tp") && (b = g.formatMoney(b, 0 < b.indexOf(".") ? b.length - (b.indexOf(".") + 1) : -1) + " " + ("" == g.numberToChinese(b) ? g.numberToChinese(b) : "(" + g.numberToChinese(b) + ")"));
            "NumberComponent" == h.find('span[name\x3d"' + f + '"]').attr("type") && ("mobile" == window.systemInfo_form || "number" != d.componentSetup.numberType || 1 != d.componentSetup.isCapital && "true" != d.componentSetup.isCapital || (b = b + " " + ("" == g.numberToChinese(b) ? g.numberToChinese(b) : "(" + g.numberToChinese(b) + ")")));
            "Monitor" == h.find('span[name\x3d"' + f + '"]').attr("type") && "mobile" != window.systemInfo_form && "number" == d.componentSetup.monitorType && (1 == d.componentSetup.isCapital || "true" == d.componentSetup.isCapital) && 0 < b.length && (b = b + " " + ("" == g.numberToChinese(b) ? g.numberToChinese(b) : "(" + g.numberToChinese(b) + ")"));
            h.find('span[name\x3d"' + f + '"]').html(b)
        })
    }
    ;
    formPlugin.numberToChinese = function(h) {
        var g = parseFloat(h)
          , f = parseFloat("10000000000000000");
        if (g >= f)
            return "\u8d85\u51fa\u6700\u5927\u5904\u7406\u6570\u5b57";
        g = "";
        0 == h.indexOf("-") && (g += "\u8d1f",
        h = h.substring(1));
        strUnit = "\u4edf\u4f70\u62fe\u4e07\u4edf\u4f70\u62fe\u4ebf\u4edf\u4f70\u62fe\u4e07\u4edf\u4f70\u62fe\u5143\u89d2\u5206";
        h += "00";
        f = h.indexOf(".");
        0 <= f && (h = h.substring(0, f) + h.substr(f + 1, 2));
        strUnit = strUnit.substr(strUnit.length - h.length);
        for (f = 0; f < h.length; f++)
            g += "\u96f6\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c\u7396".substr(h.substr(f, 1), 1) + strUnit.substr(f, 1);
        return g.replace(/\u96f6\u5206$/, "").replace(/\u96f6\u89d2\u96f6\u5206$/, "").replace(/\u96f6[\u4edf\u4f70\u62fe]/g, "\u96f6").replace(/\u96f6{2,}/g, "\u96f6").replace(/\u96f6([\u4ebf|\u4e07])/g, "$1").replace(/\u96f6+\u5143/, "\u5143").replace(/\u4ebf\u96f6{0,3}\u4e07/, "\u4ebf").replace(/^\u5143/, "\u96f6\u5143").replace(/\u96f6\u89d2$/, "").replace(/\u96f6\u5143$/, "")
    }
    ;
    formPlugin.calculateTotal = function(h) {
        var g = this
          , f = 0;
        h.each(function(d) {
            d = parseFloat($(this).val().replace(/[^\d.-]/g, ""));
            if (!d || "" == d || isNaN(d))
                return !0;
            f = g.accAdd(f, d)
        });
        return f
    }
    ;
    formPlugin.accAdd = function(h, g) {
        var f, d;
        try {
            f = h.toString().split(".")[1].length
        } catch (b) {
            f = 0
        }
        try {
            d = g.toString().split(".")[1].length
        } catch (c) {
            d = 0
        }
        f = Math.pow(10, Math.max(f, d));
        return Math.round(h * f + g * f) / f
    }
    ;
    formPlugin.checkPrompt = function(h) {
        var g = h.element;
        h = h.message;
        var f = !0;
        null != h && "" != h ? (g.parents(".field_js").find(".form-error").text(h),
        "mobile" == window.systemInfo_form ? formPlugin.notify(h) : g.parents(".field_js").find(".form-error").show(),
        f = !1) : (g.parents(".field_js").find(".form-error").text(""),
        g.parents(".field_js").find(".form-error").hide());
        return f
    }
    ;
    formPlugin.analyseLayout = function(h, g, f, d, b) {
        g.html("").hide();
        if (h && h.layoutDetail) {
            var c = JSON.parse(h.layoutDetail);
            formPlugin.analyseComponent(c, g, f, d, h, b)
        }
        formPlugin.renderMonitorTitle(g);
        formPlugin.sensitiveWordsPage(g);
        g.show()
    }
    ;
    formPlugin.renderMonitorTitle = function(h) {
        var g = $(h).find(".field_js[componentkey\x3d'Monitor']");
        g && 0 < g.length && $.each(g, function() {
            $(this).find(".check_js").data("componentData").setMonitorTitle(h, $(this))
        })
    }
    ;
    formPlugin.addComponentModel = function(h, g) {
        var f = g.data("reportId") || g.parents(".form-view_js").data("reportId")
          , d = g.closest(".form-view_js").data("form")
          , d = d ? d.formId : null;
        null == f || h.componentmodel && h.componentmodel.formId || (cmpmodel = new m({
            reportId: f
        }),
        cmpmodel.reportId = d,
        h.setComponentModel(cmpmodel))
    }
    ;
    formPlugin.analyseComponent = function(h, g, f, d, b, c) {
        var l = h.componentKey;
        if ("DateInterval" == l || "TableLayout" == l || "DataTable" == l || "ComboSelect" == l || "TabControl" == l)
            h.fieldWrites = b.fieldWrites,
            h.fieldReads = b.fieldReads;
        var e = new window[l](h);
        this.addComponentModel(e, g);
        var a = d;
        if (!d && h.fieldId && b.fieldWrites) {
            var k = b.fieldWrites[h.fieldId];
            "undefined" == typeof k || k || (a = !0)
        }
        var k = ""
          , k = g.data("form")
          , z = "";
        k && ((z = k.module) || (z = "form"));
        k = "PositionComponent" == l ? e.renderPreview(g, f, a, b, z) : e.renderPreview(g, f, a, c, z);
        h.fieldId && b.fieldReads && (z = b.fieldReads[h.fieldId],
        "undefined" == typeof z || z || g.children().last().addClass("hide"));
        a && g.children().last().addClass("fieldReadOnly");
        e.checkEvents(function(a) {
            formPlugin.checkPrompt(a)
        }, c);
        e.conditionEvent(g, c);
        c && !d && e.autoSaveEvents(c);
        if ("ColumnPanel" == l && null != h.layoutDetail)
            for (l = 0; l < h.layoutDetail.length; l++)
                if (e = h.layoutDetail[l])
                    a = "",
                    a = 1 == h.size ? g : $(k[l]),
                    formPlugin.analyseComponent(e, a, f, d, b, c),
                    e = a.parents("[componentkey\x3d'ColumnPanel']"),
                    0 != e.find(".field_js").size() && 0 == e.find(".field_js").not(".hide").size() ? e.hide() : e.show()
    }
    ;
    formPlugin.setFormReadOnly = function(h) {
        var g = h.parentEl
          , f = h.readOnly;
        null != g && null != f && (g.find(".field_js .check_js").each(function(d) {
            $(this).data("componentData").readOnly(g, f)
        }),
        g.find(".subform_js").each(function(d) {
            $(this).find(".subtable_js").data("componentData").readOnly(g, f)
        }))
    }
    ;
    formPlugin.setEmpty = function(h) {
        null != h && h.find(".field_js .check_js").each(function(g) {
            $(this).data("componentData").empty($(this).parents(".field_js "))
        })
    }
    ;
    formPlugin.mobileShowSubForm = function(h, g) {
        var f = h.dataDetails
          , d = h.form.id;
        g.find(".widget-content").siblings(".j_subField").remove();
        if (null != f && 0 < f.length)
            for (var b = 0; b < f.length; b++) {
                var c = f[b]
                  , l = c.formField.id
                  , e = null;
                if (null != c.subForm) {
                    g.find("#" + c.subForm.id + " .widget-content").addClass("hide");
                    var a = c.dataIndex
                      , e = g.find("#" + c.subForm.id).find(".subtr_js").eq(a).find("#field_" + l);
                    if(a>0) g.find("#" + c.subForm.id).find(".subtr_js").eq(0).hide();  
                    
                    g.find("#" + c.subForm.id + " .subtable_js .subtr_js").not(":eq(0)").each(function(a) {
                        $(this).attr("index", a + 1)
                    });
                    var a = c.content
                      , k = c.dataText
                      , z = c.dataOptions
                      , r = e.find(".widget-content");
                    null == r.get(0) && (r = e.parents(".widget-content"));
                    r.parent().append($('\x3cdiv class\x3d"j_subField sub-field"\x3e\x3c/div\x3e'));
                    "percentage" == c.type && "%" == c.statDescribe && r.parent().addClass("field-percentage").append('\x3cspan id\x3d"type-item" class\x3d"input-group-addon"\x3e%\x3c/span\x3e');
                    r.addClass("hide");
                    r = r.next();
                    l = $(r).parents("#field_" + l).attr("componentKey");
                    if (z)
                        for (var q = 0; q < z.length; q++) {
                            var p = z[q].content
                              , w = z[q].type
                              , v = z[q].optionId;
                            if (w && "einvoice" == w) {
                                r.append("\x3cspan class\x3d'einvoice-preview-js'\x3e" + z.length + "\u5f20\u7535\u5b50\u53d1\u7968\x3c/span\x3e");
                                break
                            } else
                                w && "imageFile" == w ? r.append('\x3cimg src\x3d"'+TEAMS.api.downImgUrl+'/' + v  + '?module\x3dform"\x3e') : z[q].targetId && 0 < z[q].targetId.length ? r.append('\x3cimg src\x3d"'+TEAMS.api.downImgUrl+'/' + z[q].targetId + '?module\x3dform" title\x3d"' + p + '"\x3e') : (w = r.parent().find(".widget-content span[id\x3d'" + v + "']").attr("href"),
                                "Mainline" == l || "Task" == l || "Document" == l || "Workflow" == l || "CustomerComponent" == l || "FormComponent" == l || "ContactComponent" == l ? r.append("\x3cspan href\x3d'" + w + "' class\x3d'sub-title router'\x3e" + p + "\x3c/span\x3e") : r.append("\x3cspan class\x3d'sub-title'\x3e" + p + "\x3c/span\x3e"))
                        }
                    if (a)
                        if ("startDate" == e.attr("datetype"))
                            r.prepend("\x3cspan class\x3d'mr-10 j_startDate'\x3e" + a + "\x3c/span\x3e");
                        else if ("endDate" == e.attr("datetype"))
                            r.append("\x3cspan class\x3d'j_endDate'\x3e" + a + "\x3c/span\x3e");
                        else if ("Money" == l)
                            if (w = c.type,
                            c = r.parent().find(".check_js").attr("noedit"),
                            1 != c && "true" != c || r.addClass("subField-editpowers"),
                            w)
                                c = formPlugin.getTypeName(w),
                                r.append("\x3cspan class\x3d'mr-10'\x3e" + a + "\x3c/span\x3e\x3cspan class\x3d''\x3e(" + c + ")\x3c/span\x3e");
                            else {
                                if (c = r.parent().find(".check_js").data("componentData"))
                                    w = c.componentSetup.type,
                                    r.append("\x3cspan class\x3d'mr-10'\x3e" + a + "\x3c/span\x3e\x3cspan class\x3d''\x3e(" + w + ")\x3c/span\x3e")
                            }
                        else
                            r.append("\x3cspan class\x3d'mr-10'\x3e" + a + "\x3c/span\x3e");
                    k && k.content && r.append("\x3cspan\x3e" + k.content + "\x3c/span\x3e");
                    r.siblings(".j_subField").remove()
                }
            }
    }
    ;
    formPlugin.getTypeName = function(h) {
        var g = "\u4eba\u6c11\u5e01";
        switch (h) {
        case "RMB":
            g = "\u4eba\u6c11\u5e01";
            break;
        case "DOLLAR":
            g = "\u7f8e\u5143";
            break;
        case "YEN":
            g = "\u65e5\u5143";
            break;
        case "EURO":
            g = "\u6b27\u5143";
            break;
        case "HK":
            g = "\u6e2f\u5e01";
            break;
        case "TAIWAN":
            g = "\u53f0\u5e01";
            break;
        case "SINGAPORE":
            g = "\u65b0\u52a0\u5761\u5e01";
            break;
        case "POUND":
            g = "\u82f1\u9551"
        }
        return g
    }
    ;
    formPlugin.renderStatSearch = function(h) {
        (new window[h.componentKey](h)).renderStatSearch(h)
    }
    ;
    formPlugin.datepickerHelper = {
        defaults: {
            el: "input.datepicker",
            callback: function(h) {},
            eventType: "focusin.datePicker"
        },
        init: function(h) {
            var g = [];
            $.isArray(h) ? g = h : g.push(h);
            for (var f = 0; f < g.length; f++) {
                h = g[f];
                if ($.isFunction(h)) {
                    var d = h;
                    h = {};
                    h.callback = d
                }
                h = $.extend(!0, {}, this.defaults, h);
                (function(b) {
                    var c = $(b.el)
                      , d = c.attr("format") || "yyyy-mm-dd"
                      , e = c.attr("startView") || "month"
                      , a = c.attr("minView") || "month"
                      , k = c.attr("maxView") || "decade"
                      , f = c.attr("position") || "bottom-right"
                      , g = c.attr("dateGroup")
                      , h = b.callback
                      , p = c.attr("writeValue")
                      , w = c.attr("insertAfter");
                    c.each(function() {
                        var c = $(this);
                        c.on("focusin.datePicker", function() {
                            c.datetimepicker({
                                format: d,
                                language: "zh_CN",
                                todayHighlight: !0,
                                todayBtn: g,
                                autoclose: !0,
                                initialDate: new Date,
                                startView: e,
                                minView: a,
                                maxView: k,
                                pickerPosition: f,
                                showMeridian: !1,
                                writeValue: p
                            }).on("show", function() {
                                w && !c.attr("relocated") && (c.data("datetimepicker").picker.insertAfter(c).css("position", "fixed"),
                                c.attr("relocated", !0))
                            });
                            c.datetimepicker("show");
                            c.off("focusin.datePicker")
                        }).on("changeDate", function(a) {
                            h(a)
                        })
                    })
                }
                )(h)
            }
        },
        remove: function(h) {
            if (arguments)
                for (var g = 0; g < arguments.length; g++)
                    $(arguments[g]).datetimepicker("remove")
        }
    };
    formPlugin.initLayout = function(h) {
        if (!(0 >= h.length)) {
            var g = h.attr("marginbottom") || 0
              , g = h.attr("height")
              , f = h.attr("auto-scroll");
            if (!g)
                var g = h.attr("marginbottom") || 0
                  , d = h.offset().top
                  , g = $(window).height() - d - g;
            g && "yes" != f && h.css("height", g);
            f = h.attr("theme") ? h.attr("theme") : "darkblue";
            h.hasClass("mCustomScrollbar") || h.mCustomScrollbar({
                theme: f
            })
        }
    }
    ;
    formPlugin.destroyLayout = function(h) {
        $(h).mCustomScrollbar("destroy")
    }
    ;
    formPlugin.layout = function(h, g, f) {
        if (h.indexOf && 0 == h.indexOf("#print"))
            $(h).removeClass("scrollwrapper");
        else {
            var d = $(h);
            if (d.get(0)) {
                var b = d.attr("height")
                  , c = d.attr("auto-scroll");
                if (!b)
                    var b = d.attr("marginbottom") || 0
                      , l = d.offset().top
                      , b = $(window).height() - l - b;
                l = d.attr("theme") ? d.attr("theme") : "darkblue";
                if (!d.hasClass("mCustomScrollbar")) {
                    var e = {
                        onScroll: function() {
                            $("body .goto-top").removeClass("hide")
                        },
                        onTotalScrollBack: function() {
                            $("body .goto-top").addClass("hide")
                        }
                    };
                    if (g) {
                        $.isArray(g) && (f = g);
                        f && !f[0].gotoTopButton && (e.onScroll = null,
                        e.onTotalScrollBack = null);
                        var a = $.extend(e, g)
                    }
                    g = {
                        theme: l,
                        callbacks: a ? a : e
                    };
                    if (f)
                        var k = $.extend(g, f[0]);
                    f && "x" == f[0].axis && (c = "yes");
                    b && "yes" != c && d.css("height", b);
                    d.mCustomScrollbar(k ? k : g);
                    f && !f[0].bottomBlank && null != d.parents("#entitybox").get(0) && d.children().children(".mCSB_container").addClass("pb-0");
                    "#chat-container" == h && (d.mCustomScrollbar("update"),
                    d.mCustomScrollbar("scrollTo", "bottom"));
                    setTimeout(function() {
                        $("body .goto-top").addClass("hide")
                    }, 200)
                }
            }
        }
    }
    ;
    formPlugin.insertAtCursor = function(h, g) {
        h = " " + h;
        var f = g.value, d;
        if (d = $(g).data("simditor"))
            if ($(d.selection._selection.focusNode).closest(".simditor-body").length)
                d.trigger("selectionchanged"),
                d.selection.insertNode(document.createTextNode(h)),
                d.trigger("valuechanged"),
                d.trigger("selectionchanged");
            else {
                var b = d.getValue()
                  , c = b;
                $(b).last().is("p") ? (b = $(b).last().append(h),
                c = $("\x3cdiv/\x3e").append(b).html()) : c = b + h;
                d.setValue(c)
            }
        "undefined" != typeof g.selectionStart && "undefined" != typeof g.selectionEnd ? (d = g.selectionStart,
        g.value = f.substring(0, d) + h + f.substring(g.selectionEnd),
        g.selectionStart = g.selectionEnd = d + h.length) : "undefined" != typeof document.selection && "undefined" != typeof document.selection.createRange && (g.focus(),
        f = document.selection.createRange(),
        f.text = h,
        f.select())
    }
    ;
    formPlugin.extend = function(h, g) {
        "undefined" !== typeof h && h || (h = {});
        if ("object" === typeof g)
            for (var f in g)
                g.hasOwnProperty(f) && (h[f] = g[f]);
        return h
    }
    ;
    formPlugin.escapeRegex = function(h) {
        return (h + "").replace(/([.?*+^$[\]\\(){}|-])/g, "\\$1")
    }
    ;
    formPlugin.htmlEntities = function(h) {
        return String(h).replace(/&/g, "\x26amp;").replace(/</g, "\x26lt;").replace(/>/g, "\x26gt;").replace(/"/g, "\x26quot;")
    }
    ;
    formPlugin.datepicker = function(h) {
        formPlugin.datepickerHelper.init(h)
    }
    ;
    formPlugin.sensitiveWordsPage = function(h) {
        window.isEDist && (h = $(h || "body"),
        h.find(".widget-title_js,.field-description,.RadioBox_js span,.CheckBox_js span,.ImageRadioBox_js label span,.ImageRadioBox_mobile_js span,.ImageCheckBox_js label span,.ImageCheckBox_mobile_js span,option.Select_js,option.ComboSelect_js,.subform_js .j_datatableTitle,.subform_js .j_datatableDescription").each(function() {
            var g = $(this).text()
              , g = formPlugin.sensitiveWords(g);
            $(this).text(g)
        }),
        h.find("input[placeholder]").each(function() {
            var g = $(this).attr("placeholder")
              , g = formPlugin.sensitiveWords(g, "html");
            $(this).attr("placeholder", g)
        }),
        h.find(".paragraph_js").each(function() {
            var g = $(this).html()
              , g = formPlugin.sensitiveWords(g, "html");
            $(this).html(g)
        }))
    }
    ;
    formPlugin.sensitiveWords = function(h, g) {
        var f = !1;
        if (window.isEDist) {
            "object" == typeof h && (f = !0,
            h = JSON.stringify(h));
            var d = SPECIAL_REGEX["formPlugin.sensitiveWords"];
            "html" == g ? (h = h.replace(/[\t\n]/g, ""),
            d = SPECIAL_REGEX["formPlugin.sensitiveWords.html"]) : "json" == g && (d = SPECIAL_REGEX["formPlugin.sensitiveWords.json"]);
            null != h && 0 < h.length && (h = h.replace(d, "**"),
            -1 != h.search(d) && (h = formPlugin.sensitiveWords(h, g)))
        }
        f && (h = JSON.parse(h));
        return h
    }
    ;
    formPlugin.confirm = function(h, g) {
        bootbox.setLocale("zh_CN");
        bootbox.confirm(h, function(f) {
            g && g(f)
        })
    }
    ;
    formPlugin.formatMoney = function(h, g) {
        g = 2 < g && 20 >= g ? g : 2;
        h = parseFloat((h + "").replace(/[^\d\.-]/g, "")).toFixed(g) + "";
        var f = h.split(".")[0].split("").reverse()
          , d = h.split(".")[1];
        t = "";
        for (i = 0; i < f.length; i++)
            t += f[i] + (0 == (i + 1) % 3 && i + 1 != f.length ? "," : "");
        return t.split("").reverse().join("") + "." + d
    }
    ;
    formPlugin.notify = function(h, g, f, d) {
        void 0 == d && (d = !0);
        h = {
            sticker: !1,
            shadow: !1,
            history: !1,
            hide: d,
            opacity: .95,
            animation: {
                effect_in: "slide",
                effect_out: "none"
            },
            text: h,
            title: g
        };
        switch (f) {
        case "error":
            h.type = "error";
            break;
        case "info":
            h.type = "info";
            break;
        case "success":
            h.type = "success"
        }
        $.pnotify_remove_all();
        $.pnotify(h)
    }
    ;
    formPlugin.destroyEvents = function(h) {
        $(h) && $(h).get(0) && $(h).find("textarea").trigger("autosize.destroy")
    }
    ;
    formPlugin.isIE = function() {
        return /(msie\s|trident.*rv:)([\w.]+)/.test(navigator.userAgent.toLowerCase())
    }
    ;
    formPlugin.delaySaveFieldData = function(h, g, f) {
        if (null != formPlugin.param && formPlugin.param.formData.id) {
            for (var d = g.formData.dataDetails, b = formPlugin.param.formData.dataDetails, c = [], l = 0; l < d.length; l++)
                c.push(d[l].dataIndex + d[l].formField.id);
            for (l = b.length - 1; 0 <= l; l--)
                -1 < $.inArray(b[l].dataIndex + b[l].formField.id, c) && b.splice(l, 1);
            formPlugin.param.formData.dataDetails = b.concat(d);
            g.subFormId && (formPlugin.param.subFormId = g.subFormId)
        } else
            formPlugin.param = g;
        "undefined" != typeof _saveDataTimer && (clearTimeout(_saveDataTimer),
        delete _saveDataTimer);
        _saveDataTimer = setTimeout(function() {
            formPlugin.param.formData && (g.formData.id ? $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                dataType: "json",
                url: "freeform/saveFieldData.json",
                data: JSON.stringify(formPlugin.param),
                success: function(e) {
                    e.message ? formPlugin.notify(e.message) : "function" == typeof h.afterDataDetailSave && h.afterDataDetailSave(e.formData)
                }
            }) : $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                dataType: "json",
                async: !1,
                url: TEAMS.api.saveData,
                data: JSON.stringify(formPlugin.param),
                success: function(e) {
                    if (e.formData && e.formData.id) {
                        if ("function" == typeof h.afterformDataCreate && h.afterformDataCreate(e.formData)) {
                            var a = h.parentEl.closest(".form-view_js").data("form");
                            null != a && (a.dataId = e.formData.id);
                            "function" == typeof h.afterDataDetailSave && h.afterDataDetailSave(e.formData)
                        }
                    } else
                        e.message ? formPlugin.notify(e.message) : formPlugin.notify("\u4fdd\u5b58\u6570\u636e\u5931\u8d25")
                }
            }));
            formPlugin.param = null;
            delete _saveDataTimer
        }, f)
    }
    ;
    formPlugin.saveFieldData = function(h, g) {
        var f = h.parentEl;
        if (null != f && null != f.get(0)) {
            var d = formPlugin.submitAssembleForm(h, !0);
            h.dataDetails && (d.formData.dataDetails = h.dataDetails);
            d.subFormId = g;
            "function" == typeof h.beforeDataDetailSave && h.beforeDataDetailSave(d.formData);
            var b = !0;
            f.find(".check_js").each(function(c) {
                if (c = $(this).data("componentData"))
                    c.componentSetup.required = !1,
                    c.submitCheck($(this), function(c) {
                        formPlugin.checkPrompt(c) || (b = !1)
                    })
            });
            b && ("function" != typeof h.validate || h.validate(d.formData)) && (d.formData.id || (d = formPlugin.submitAssembleForm({
                parentEl: f.closest(".form-view_js"),
                module: h.module,
                dataStatus: h.dataStatus
            })),
            "app" == h.module && (d.appId = f.closest(".form-view_js").attr("appid")),
            formPlugin.delaySaveFieldData(h, d, 600))
        }
    }
    ;
    formPlugin.getByteLen = function(h) {
        var g = 0;
        if (!$.trim(h).isBlank()) {
            h = $.trim(h);
            var f, d, b = h.length;
            for (f = 0; f < b; f++)
                d = h.charCodeAt(f),
                127 > d ? g += 1 : 128 <= d && 2047 >= d ? g += 2 : 2048 <= d && 65535 >= d && (g += 3)
        }
        return g
    }
    ;
    formPlugin.moveDatetimepicker = function(h) {
        if ($(".datetimepicker.dropdown-menu:visible")[0]) {
            var g = $(h).parents("div.field_js").parent()
              , f = 0;
            $(h).parents("div.field_js").parent().parent().children().each(function(d, b) {
                if ($(b).is("td")) {
                    var c = $(b).attr("colspan");
                    if (c)
                        return f += parseInt(c),
                        !0
                }
                f += 1
            });
            h = g.index();
            h = f - 1 == h;
            g = window.innerWidth;
            g = $(".datetimepicker.dropdown-menu:visible").offset().left + 200 > g;
            h && g && $(".datetimepicker.dropdown-menu:visible").addClass("datetimepicker-form-fix")
        }
    }
    ;
    formPlugin.priToAry = function(h) {
        var g = "\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d".split("")
          , f = ["", "\u5341", "\u767e", "\u5343"]
          , d = ["", "\u4e07", "\u4ebf", "\u5146"]
          , b = function(a) {
            var e = !1;
            0 < d.indexOf(a[0]) && (e = !0);
            return e
        };
        h = function(a) {
            for (var e = [], c = a.length; 0 <= c; c--)
                e.push(a[c]);
            return e.join("")
        }(h + "");
        for (var c = "", l = "", e = -1, a = 0; a < h.length; a++)
            if (0 == a % 4 && (e++,
            l = d[e] + l,
            c = ""),
            "0" == h[a]) {
                switch (a % 4) {
                case 1:
                case 2:
                case 3:
                    "0" != h[a - 1] && (c = "\u96f6")
                }
                l = c + l;
                c = ""
            } else
                l = g[parseInt(h[a])] + f[a % 4] + l;
        for (; 0 == l.indexOf("\u96f6") || b(l); )
            l = l.substr(1);
        return l
    }
    ;
    formPlugin.uid = function() {
        return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function(h) {
            var g = 16 * Math.random() | 0;
            return ("x" == h ? g : g & 3 | 8).toString(16)
        })
    }
    ;
    formPlugin.delayLast = function(h, g, f, d) {
        "undefined" != typeof _saveDataTimer && (clearTimeout(_saveDataTimer),
        delete _saveDataTimer);
        _saveDataTimer = setTimeout(function() {
            null == f && (f = window);
            h.apply(f, d);
            delete _saveDataTimer
        }, g)
    }
    ;
    formPlugin.moduleIsPay = function(h) {
        "formdatareport" == h && (h = "form");
        var g = !1;
        _.each(TEAMS.payModules, function(f) {
            f.module == h && (g = !0)
        });
        return g
    }
    ;
    window.inDistrbute_form && n.async([_formDesign+"/static/js/plugins/bootstrap.datetimepicker.min.js", _formDesign+"/static/js/plugins/bootstrap.all.m.min.js"], function() {});
    u.exports = window.formPlugin
});
define("form/emojiarea", function(n, y, u) {
    return function(m) {
    }
});
define("form/signcompage", ["form/component/signcomview"], function(n) {
    n = n("form/component/signcomview");
    var y = Raphael.sketchpad("signEditor", {
        height: 9 * $(document).width() / 16,
        width: $(document).width(),
        editing: !0
    });
    (new n).render("mb", {
        sketchpad: y,
        parentEl: "#signcomContainer",
        fieldId: $(window.parent.document).find("#signiframe[fieldId]").attr("fieldId"),
        cid: $(window.parent.document).find("#signiframe[fieldId]").attr("cid")
    })
});
define("form/component/paragraph", ["form/component", "form/tplutil"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil");
    window.Paragraph = y.extend({
        initialize: function(h) {
            this.componentSetup = {
                componentKey: "Paragraph",
                content: "\u7a7a\u767d\u7684\u6bb5\u843d",
                style: "alert-success",
                order: 0,
                index: 0
            };
            null != h && (this.componentSetup.content = h.content,
            this.componentSetup.style = h.style,
            this.componentSetup.order = h.order,
            this.componentSetup.index = h.index);
            this.tpl = m.get("paragraph")
        },
        setContent: function(h) {
            this.componentSetup.content = h
        },
        setStyle: function(h) {
            this.componentSetup.style = h
        },
        render: function(h) {
            var g = $(this.tpl).siblings("#form-paragraph");
            h.attr("class", g.attr("class"));
            g.find(".paragraph").html(this.componentSetup.content);
            var f = g.find(".paragraph").attr("class") + " " + this.componentSetup.style;
            g.find(".paragraph").attr("class", f);
            h.html(g.html())
        },
        renderEditor: function() {
            var h = $(this.tpl).siblings("#editor-paragraph");
            h.find("input:radio[name\x3d'paragraphType'][value\x3d'" + this.componentSetup.style + "']").attr("checked", !0);
            $("#editor-component").html(h.html());
            $(document).trigger("renderCkEditor")
        },
        renderPreview: function(h) {
            var g = $(this.tpl).siblings("#preview-paragraph");
            g.find(".paragraph").html(this.componentSetup.content);
            var f = g.find(".paragraph").attr("class") + " " + this.componentSetup.style;
            g.find(".paragraph").attr("class", f);
            h.append(g)
        },
        renderEditPreview: function(h) {
            var g = $(this.tpl).siblings("#form-paragraph");
            g.find(".paragraph").html(this.componentSetup.content);
            var f = g.find(".paragraph").attr("class") + " " + this.componentSetup.style;
            g.find(".paragraph").attr("class", f);
            g.data("componentData", this);
            h.append(g)
        },
        submitCheck: function(h, g) {},
        checkEvents: function(h) {}
    });
    u.exports = window.Paragraph
});
define("form/component/tablestatcomponent", ["form/component", "form/tplutil"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil")
      , h = "#5CBAE3 #E5CF0D #B6A2DE #8D98B3 #95706D #E4B600 #89B600 #D87A80".split(" ")
      , g = {
        etitle: "\u6807\u9898",
        eoptions: [{
            content: "\u9009\u9879\u4e00",
            percentage: "50.00%",
            bgcolor: h[0],
            votes: "50"
        }, {
            content: "\u9009\u9879\u4e8c",
            percentage: "25.00%",
            bgcolor: h[1],
            votes: "25"
        }, {
            content: "\u9009\u9879\u4e09",
            percentage: "10.00%",
            bgcolor: h[2],
            votes: "10"
        }, {
            content: "\u9009\u9879\u56db",
            percentage: "5.00%",
            bgcolor: h[3],
            votes: "5"
        }, {
            content: "\u9009\u9879\u4e94",
            percentage: "2.00%",
            bgcolor: h[4],
            votes: "2"
        }, {
            content: "\u9009\u9879\u516d",
            percentage: "8.00%",
            bgcolor: h[5],
            votes: "8"
        }],
        etotalvotes: 100,
        statfields: []
    };
    window.TableStatComponent = y.extend({
        initialize: function(f) {
            this.componentSetup = {
                componentKey: "TableStatComponent",
                title: "\u7edf\u8ba1",
                titleLayout: "field-hoz",
                order: 0,
                index: 0,
                fieldId: "",
                dataSetId: ""
            };
            null != f && (this.componentSetup.title = f.title,
            this.componentSetup.order = f.order,
            this.componentSetup.index = f.index,
            this.componentSetup.fieldId = f.fieldId,
            this.componentSetup.dataSetId = f.dataSetId);
            this.tpl = m.get("tablestat")
        },
        setTitle: function(f) {
            this.componentSetup.title = f
        },
        setTitleLayout: function(f) {
            this.componentSetup.titleLayout = f
        },
        setRelatDataTableId: function(f) {
            this.componentSetup.tableId = f
        },
        setRelatDataUnitId: function(f) {
            this.componentSetup.colId = f
        },
        setIsOrgtiqu: function(f) {
            this.componentSetup.isOrgtiqu = f
        },
        setIsOrgtiqulist: function(f) {
            this.componentSetup.isOrgtiqulist = f
        },
        setDataSetId: function(f) {
            this.componentSetup.dataSetId = f
        },
        render: function(f) {
            g.etitle = this.componentSetup.title;
            var d = $(_.template(this.tpl, g)).siblings("#form-tablestat");
            f.attr("class", d.attr("class"));
            f.html(d.html());
            this.rendertabel(g, f)
        },
        rendertabel: function(f, d) {
            var b = d.find("tbody");
            $.each(f.eoptions, function() {
                var c = b.find("tr:first").clone().show();
                c.find(".j_content").text(this.content);
                c.find(".j_prograssbar").css({
                    width: this.percentage,
                    "background-color": this.bgcolor
                }).find(".j_percentage").text(this.percentage);
                c.find(".j_votes").text(this.votes);
                b.find("tr:last").before(c)
            })
        },
        renderEditor: function() {
            var f = this, d;
            f.statFields ? f.renderEditorValue() : this.componentmodel.getFormSelectFields(function(b) {
                b.etitle = g.etitle;
                b.eoptions = g.eoptions;
                b.etotalvotes = g.etotalvotes;
                d = $(_.template(f.tpl, b)).siblings("#editor-tablestat");
                f.statFields = b;
                null != b.statfields && 0 < b.statfields.length && (f.componentSetup.dataSetId = f.componentSetup.dataSetId ? f.componentSetup.dataSetId : b.statfields[0].fieldId);
                f.el = d;
                f.renderEditorValue()
            })
        },
        renderEditorValue: function() {
            var f = this.el;
            f.find("#component-title").attr("value", this.componentSetup.title);
            $("#editor-component").html(f.html());
            var d = $("#component-dataset");
            $.each(this.statFields.statfields, function() {
                var b = d.find("option:first").clone().show();
                b.val(this.fieldId).text(this.title);
                d.append(b)
            });
            $("#editor-component").find("#component-dataset").val(this.componentSetup.dataSetId)
        },
        renderPreview: function(f, d, b) {
            var c, l = this, e, a = $("\x3cdiv\x3e\x3c/div\x3e");
            f.append(a);
            l.componentmodel.getFieldStat(this.componentSetup.dataSetId, function(b) {
                b = l.processData(b);
                c = $(_.template(l.tpl, b));
                e = c.siblings("#preview-tablestat");
                a.replaceWith(e);
                l.viewcon = e;
                l.rendertabel(b, e)
            })
        },
        processData: function(f) {
            for (var d = f.fieldChartStatData, b = 0, c = 0, l = d.length; c < l; c++)
                b += d[c].total;
            f.etotalvotes = b;
            c = 0;
            for (l = d.length; c < l; c++)
                d[c].percentage = (100 * d[c].total / b).toFixed(2) + "%",
                d[c].bgcolor = h[c % h.length],
                d[c].content = d[c].name,
                d[c].votes = d[c].total;
            f.eoptions = f.fieldChartStatData;
            f.etitle = this.componentSetup.title;
            f.statfields = [];
            return f
        },
        renderEditPreview: function(f) {
            g.etitle = this.componentSetup.title;
            var d = $(_.template(this.tpl, g)).siblings("#form-tablestat");
            d.attr("id", this.componentSetup.fieldId);
            d.data("componentData", this);
            d.addClass(this.componentSetup.titleLayout);
            f.append(d);
            this.rendertabel(g, d)
        },
        renderStatSearch: function(f) {},
        submitCheck: function(f, d) {},
        checkEvents: function(f) {},
        check: function(f) {},
        getValue: function(f, d) {},
        setValue: function(f, d) {},
        empty: function(f) {},
        readOnly: function(f, d) {}
    });
    u.exports = window.TableStatComponent
});
define("form/component/dateinterval", ["form/editablecomponent", "form/tplutil", "form/componentmodel", "form/component/datetimepicker", "form/component/datecomponent"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel")
      , f = n("form/component/datetimepicker");
    n("form/component/datecomponent");
    window.DateInterval = m.extend({
        initialize: function(d) {
            m.prototype.initialize.call(this, d);
            var b = {
                componentKey: "DateInterval",
                title: "\u65e5\u671f\u533a\u95f4",
                tempId: 0,
                start: (new DateComponent).componentSetup,
                end: (new DateComponent).componentSetup,
                fieldReads: [],
                fieldWrites: []
            };
            null != d && (b.title = d.title,
            b.start = d.start,
            b.end = d.end,
            b.tempId = d.tempId || d.fieldId,
            b.fieldReads = d.fieldReads,
            b.fieldWrites = d.fieldWrites);
            this.componentSetup = $.extend(this.componentSetup, b);
            this.componentSetup.start.title = b.title + "(\u5f00\u59cb\u65f6\u95f4)";
            this.componentSetup.end.title = b.title + "(\u7ed3\u675f\u65f6\u95f4)";
            this.componentModel = new g;
            this.tpl = h.get("dateinterval")
        },
        setTitle: function(d) {
            this.componentSetup.title = d;
            this.componentSetup.start.title = d + "(\u5f00\u59cb\u65f6\u95f4)";
            this.componentSetup.end.title = d + "(\u7ed3\u675f\u65f6\u95f4)"
        },
        setDescribe: function(d) {
            this.componentSetup.describe = d;
            this.componentSetup.start.describe = d;
            this.componentSetup.end.describe = d
        },
        setRequired: function(d) {
            this.componentSetup.required = d;
            this.componentSetup.start.required = d;
            this.componentSetup.end.required = d
        },
        setFormat: function(d) {
            this.componentSetup.start.format = d;
            this.componentSetup.end.format = d
        },
        setAccurateTime: function(d) {
            this.componentSetup.start.accurateTime = d;
            this.componentSetup.end.accurateTime = d
        },
        render: function(d) {
            var b = this
              , c = $(this.tpl).siblings("#form-dateinterval");
            m.prototype.render.call(this, d, c);
            this.componentModel.generatorId(function(c) {
                c = c.generatorId;
                b.componentSetup.tempId = c;
                d.attr("tempId", c)
            });
            d.html(c.html())
        },
        renderEditPreview: function(d) {
            var b = $(this.tpl).siblings("#form-dateinterval");
            b.attr("tempId", this.componentSetup.fieldId);
            b.attr("id", this.componentSetup.fieldId);
            b.find(".widget-title .widget-title_js").text(this.componentSetup.title);
            "true" != this.componentSetup.isHideTitle && 1 != this.componentSetup.isHideTitle || d.hasClass("subtd_js") || b.addClass("field-notitle").find(".widget-title .widget-title_js").addClass("hide");
            "true" != this.componentSetup.required && 1 != this.componentSetup.required || b.find(".widget-title .widget-required_js").text(" *");
            "" != this.componentSetup.describe && (b.find(".field-description").text(this.componentSetup.describe),
            b.find(".field-description").show());
            var c = this.componentSetup.start.format
              , f = this.componentSetup.end.format
              , e = ""
              , a = "";
            if ("yyyy-MM-dd" == c || "HH:mm:ss" == c)
                e = "\u5e74-\u6708-\u65e5";
            else if ("yyyy-MM" == c)
                e = "\u5e74-\u6708";
            else if ("yyyy-MM-dd HH:mm" == c || "YYYY-MM-DD HH:mm:ss" == c)
                e = "\u5e74-\u6708-\u65e5 \u65f6:\u5206";
            if ("yyyy-MM-dd" == f || "HH:mm:ss" == f)
                a = "\u5e74-\u6708-\u65e5";
            else if ("yyyy-MM" == f)
                a = "\u5e74-\u6708";
            else if ("yyyy-MM-dd HH:mm" == f || "YYYY-MM-DD HH:mm:ss" == f)
                a = "\u5e74-\u6708-\u65e5 \u65f6:\u5206";
            b.find("input").eq(0).attr("placeholder", e);
            b.find("input").eq(1).attr("placeholder", a);
            b.find("input").eq(0).attr("id", this.componentSetup.start.fieldId);
            b.find("input").eq(1).attr("id", this.componentSetup.end.fieldId);
            b.data("componentData", this);
            b.addClass(this.componentSetup.titleLayout);
            d.append(b)
        },
        renderEditor: function() {
            var d = $(this.tpl).siblings("#editor-dateinterval");
            m.prototype.renderEditor.call(this, d);
            var b = this.componentSetup.start.format;
            d.find("input:radio[name\x3d'dateFormat'][value\x3d'" + b + "']").attr("checked", "true");
            var c = d.find(".j_earlyContent")
              , f = d.find(".j_latestContent");
            this.renderDateRuleConfig(b, c, f, this.componentSetup.start.earlyType, this.componentSetup.start.lateType, d);
            1 == this.componentSetup.start.earlyDate || "true" == this.componentSetup.start.earlyDate ? d.find("#earlyDate").attr("checked", !0) : d.find("#earlyDate").attr("checked", !1);
            1 == this.componentSetup.start.lateDate || "true" == this.componentSetup.start.lateDate ? d.find("#latestDate").attr("checked", !0) : d.find("#latestDate").attr("checked", !1);
            $("#editor-component").html(d.html())
        },
        renderPreview: function(d, b, c) {
            var f = $(this.tpl)
              , e = f.siblings("#preview-dateinterval");
            "mobile" == window.systemInfo_form && (e = f.siblings("#mobile-preview"));
            e.attr("fieldId", this.componentSetup.fieldId || this.componentSetup.tempId);
            e.attr("id", "field_" + this.componentSetup.fieldId || this.componentSetup.tempId);
            e.find(".widget-title .widget-title_js").text(this.componentSetup.title);
            "true" != this.componentSetup.isHideTitle && 1 != this.componentSetup.isHideTitle || e.addClass("field-notitle").find(".widget-title .widget-title_js").addClass("hide");
            "true" != this.componentSetup.required && 1 != this.componentSetup.required || e.find(".widget-title .widget-required_js").text(" *");
            "" != this.componentSetup.describe && (e.find(".field-description").text(this.componentSetup.describe),
            e.find(".field-description").show());
            var a = this.componentSetup.start.format
              , f = "";
            if ("yyyy-MM-dd" == a || "HH:mm:ss" == a)
                f = "\u5e74-\u6708-\u65e5",
                "mobile" == window.systemInfo_form && (e.find(".j_dateinter_selected").eq(0).attr("format", "{yyyy}-{MM}-{dd}").attr("minview", 2).attr("startview", "month"),
                e.find(".j_dateinter_selected").eq(1).attr("format", "{yyyy}-{MM}-{dd}").attr("minview", 2).attr("startview", "month"));
            else if ("yyyy-MM" == a)
                f = "\u5e74-\u6708",
                "mobile" == window.systemInfo_form && (e.find(".j_dateinter_selected").eq(0).attr("format", "{yyyy}-{MM}").attr("minview", 3).attr("startview", "year"),
                e.find(".j_dateinter_selected").eq(1).attr("format", "{yyyy}-{MM}").attr("minview", 3).attr("startview", "year"));
            else if ("yyyy-MM-dd HH:mm" == a || "YYYY-MM-DD HH:mm:ss" == a)
                f = "\u5e74-\u6708-\u65e5 \u65f6:\u5206",
                "mobile" == window.systemInfo_form && (e.find(".j_dateinter_selected").eq(0).attr("format", "{yyyy}-{MM}-{dd} {HH}:{mm}").attr("minview", 0).attr("startview", "month"),
                e.find(".j_dateinter_selected").eq(1).attr("format", "{yyyy}-{MM}-{dd} {HH}:{mm}").attr("minview", 0).attr("startview", "month"));
            e.find(".form-control").attr("placeholder", f);
            e.find(".form-control").eq(0).parent().attr("id", "field_" + this.componentSetup.start.fieldId).attr("name", this.componentSetup.start.fieldId);
            e.find(".form-control").eq(0).attr("cid", this.cid);
            e.find(".form-control").eq(1).parent().attr("id", "field_" + this.componentSetup.end.fieldId).attr("name", this.componentSetup.end.fieldId);
            e.find(".form-control").eq(1).attr("cid", this.cid);
            "mobile" == window.systemInfo_form && (e.find(".j_dateinter_selected").eq(0).attr("id", this.componentSetup.start.fieldId),
            e.find(".j_dateinter_selected").eq(1).attr("id", this.componentSetup.end.fieldId));
            e.find(".check_js").data("componentData", this);
            e.addClass(this.componentSetup.titleLayout);
            this.el = d;
            d.append(e);
            this.componentSetup.start.fieldId && this.componentSetup.fieldReads && (f = this.componentSetup.fieldReads[this.componentSetup.start.fieldId],
            "undefined" == typeof f || f || d.children().last().addClass("hide"));
            var k = !0;
            this.showUpcoming = this.showTomorrow = this.showToday = !0;
            var g = this.getStartDate()
              , h = this.getEndDate();
            "yyyy-MM-dd HH:mm" == a || "YYYY-MM-DD HH:mm:ss" == a ? a = "yyyy-mm-dd hh:ii" : "yyyy-MM-dd" == a || "HH:mm:ss" == a ? a = "yyyy-mm-dd" : "yyyy-MM" == a && (a = "yyyy-mm");
            this.getShowBtns(g, h, this.componentSetup.start.format);
            "mobile" == window.systemInfo_form && (e.find(".j_dateinter_selected").eq(0).attr("startDate", g).attr("endDate", h).attr("showToday", this.showToday).attr("showTomorrow", this.showTomorrow).attr("showUpcoming", this.showUpcoming),
            e.find(".j_dateinter_selected").eq(1).attr("startDate", g).attr("endDate", h).attr("showToday", this.showToday).attr("showTomorrow", this.showTomorrow).attr("showUpcoming", this.showUpcoming));
            var q = "month"
              , p = "month";
            0 <= a.indexOf("hh:ii") ? q = "hour" : 0 > a.indexOf("dd") && (p = q = "year",
            k = !1);
            b && e.find("input").val("");
            if ("true" == this.componentSetup.isReadOnly || 1 == this.componentSetup.isReadOnly)
                c = !0;
            b = c;
            !c && this.componentSetup.start.fieldId && this.componentSetup.fieldWrites && (f = this.componentSetup.fieldWrites[this.componentSetup.start.fieldId],
            "undefined" == typeof f || f || (b = !0));
            this.readOnly(e, b);
            b && d.children().last().addClass("fieldReadOnly");
            var w = ["someday"];
            1 != this.showToday && "true" != this.showToday || w.push("today");
            1 != this.showTomorrow && "true" != this.showTomorrow || w.push("tomorrow");
            1 != this.showUpcoming && "true" != this.showUpcoming || w.push("upcoming");
            if ("mobile" != window.systemInfo_form && !c)
                e.find(".form-control[cid\x3d'" + this.cid + "']").on("click", function() {
                    $(this).datetimepicker({
                        dateBtnGroup: w,
                        format: a,
                        language: "zh_CN",
                        todayHighlight: !0,
                        todayBtn: k,
                        autoclose: !0,
                        minView: q,
                        startDate: g,
                        endDate: h,
                        startView: p
                    });
                    $(this).datetimepicker("show");
                    formPlugin.moveDatetimepicker($(this))
                })
        },
        getShowBtns: function(d, b, c) {
            var f = ""
              , e = ""
              , a = ""
              , k = new Date;
            "yyyy-MM-dd HH:mm" == c || "YYYY-MM-DD HH:mm:ss" == c ? (f = Date.create(k).format("{yyyy}-{MM}-{dd} {HH}:{mm}"),
            e = Date.create(k.setDate(k.getDate() + 1)).format("{yyyy}-{MM}-{dd} {HH}:{mm}"),
            a = Date.create(k.setDate(k.getDate() + 7)).format("{yyyy}-{MM}-{dd} {HH}:{mm}")) : "yyyy-MM-dd" == c || "HH:mm:ss" == c ? (f = Date.create(k).format("{yyyy}-{MM}-{dd}"),
            e = Date.create(k.setDate(k.getDate() + 1)).format("{yyyy}-{MM}-{dd}"),
            a = Date.create(k.setDate(k.getDate() + 7)).format("{yyyy}-{MM}-{dd}")) : "yyyy-MM" == c && (f = Date.create(k).format("{yyyy}-{MM}"),
            e = Date.create(k.setDate(k.getDate() + 1)).format("{yyyy}-{MM}"),
            a = Date.create(k.setDate(k.getDate() + 7)).format("{yyyy}-{MM}"));
            null != d && null == b ? (f < d ? this.showToday = !1 : f >= d && (this.showToday = !0),
            e < d ? this.showTomorrow = !1 : e >= d && (this.showTomorrow = !0),
            a < d ? this.showUpcoming = !1 : a >= d && (this.showUpcoming = !0)) : null == d && null != b ? (f <= b ? this.showToday = !0 : f > b && (this.showToday = !1),
            e <= b ? this.showTomorrow = !0 : e > b && (this.showTomorrow = !1),
            a <= b ? this.showUpcoming = !0 : a >= b && (this.showUpcoming = !1)) : null != d && null != b && (f < d || f > b ? this.showToday = !1 : f >= d && f <= b && (this.showToday = !0),
            e < d || e > b ? this.showTomorrow = !1 : e >= d && e <= b && (this.showTomorrow = !0),
            a < d || a > b ? this.showUpcoming = !1 : a >= d && a <= b && (this.showUpcoming = !0))
        },
        getStartDate: function() {
            var d = null
              , b = this.componentSetup.start.format
              , c = this.componentSetup.start.earlyDate;
            if (0 == c || "false" == c)
                return d;
            var c = this.componentSetup.start.earlyType
              , f = new Date;
            if ("yyyy-MM-dd HH:mm" == b || "YYYY-MM-DD HH:mm:ss" == b || "YYYY-MM-DD HH:mm" == b)
                if ("currentHour" == c)
                    d = Date.create(f).format("{yyyy}-{MM}-{dd} {HH}:{mm}");
                else if ("specified" == c) {
                    b = this.componentSetup.start.earlySpecDate;
                    if (!b)
                        return d;
                    d = Date.create(b).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                } else if ("currentHourBefore" == c) {
                    b = this.componentSetup.start.earlyBeforeHour;
                    if (!b)
                        return d;
                    d = Date.create(this.getNewDate(b, "before", "hour")).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                } else {
                    if ("currentHourAfter" == c) {
                        b = this.componentSetup.start.earlyAfterHour;
                        if (!b)
                            return d;
                        d = Date.create(this.getNewDate(b, "after", "hour")).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                    }
                }
            else if ("yyyy-MM-dd" == b || "HH:mm:ss" == b || "YYYY-MM-DD" == b)
                if ("currentDay" == c)
                    d = Date.create(f).format("{yyyy}-{MM}-{dd}");
                else if ("specified" == c) {
                    b = this.componentSetup.start.earlySpecDate;
                    if (!b)
                        return d;
                    d = Date.create(b).format("{yyyy}-{MM}-{dd}")
                } else if ("currentDayBefore" == c) {
                    b = this.componentSetup.start.earlyBeforeDay;
                    if (!b)
                        return d;
                    d = Date.create(this.getNewDate(b, "before", "day")).format("{yyyy}-{MM}-{dd}")
                } else {
                    if ("currentDayAfter" == c) {
                        b = this.componentSetup.start.earlyAfterDay;
                        if (!b)
                            return d;
                        d = Date.create(this.getNewDate(b, "after", "day")).format("{yyyy}-{MM}-{dd}")
                    }
                }
            else if ("yyyy-MM" == b || "YYYY-MM" == b)
                if ("currentMonth" == c)
                    d = Date.create(f).format("{yyyy}-{MM}");
                else if ("specified" == c) {
                    b = this.componentSetup.start.earlySpecDate;
                    if (!b)
                        return d;
                    d = Date.create(b).format("{yyyy}-{MM}")
                } else if ("currentMonthBefore" == c) {
                    b = this.componentSetup.start.earlyBeforeMonth;
                    if (!b)
                        return d;
                    d = Date.create(this.getNewDate(b, "before", "month")).format("{yyyy}-{MM}")
                } else if ("currentMonthAfter" == c) {
                    b = this.componentSetup.start.earlyAfterMonth;
                    if (!b)
                        return d;
                    d = Date.create(this.getNewDate(b, "after", "month")).format("{yyyy}-{MM}-{dd}")
                }
            return d
        },
        getEndDate: function() {
            var d = null
              , b = this.componentSetup.start.format
              , c = this.componentSetup.start.lateDate;
            if (0 == c || "false" == c)
                return d;
            var c = this.componentSetup.start.lateType
              , f = new Date;
            if ("yyyy-MM-dd HH:mm" == b || "YYYY-MM-DD HH:mm:ss" == b || "YYYY-MM-DD HH:mm" == b)
                if ("currentHour" == c)
                    d = Date.create(f).format("{yyyy}-{MM}-{dd} {HH}:{mm}");
                else if ("specified" == c) {
                    b = this.componentSetup.start.lateSpecDate;
                    if (!b)
                        return d;
                    d = Date.create(b).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                } else if ("currentHourBefore" == c) {
                    b = this.componentSetup.start.lateBeforeHour;
                    if (!b)
                        return d;
                    d = Date.create(this.getNewDate(b, "before", "hour")).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                } else {
                    if ("currentHourAfter" == c) {
                        b = this.componentSetup.start.lateAfterHour;
                        if (!b)
                            return d;
                        d = Date.create(this.getNewDate(b, "after", "hour")).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                    }
                }
            else if ("yyyy-MM-dd" == b || "HH:mm:ss" == b || "YYYY-MM-DD" == b)
                if ("currentDay" == c)
                    d = Date.create(f).format("{yyyy}-{MM}-{dd}");
                else if ("specified" == c) {
                    b = this.componentSetup.start.lateSpecDate;
                    if (!b)
                        return d;
                    d = Date.create(b).format("{yyyy}-{MM}-{dd}")
                } else if ("currentDayBefore" == c) {
                    b = this.componentSetup.start.lateBeforeDay;
                    if (!b)
                        return d;
                    d = Date.create(this.getNewDate(b, "before", "day")).format("{yyyy}-{MM}-{dd}")
                } else {
                    if ("currentDayAfter" == c) {
                        b = this.componentSetup.start.lateAfterDay;
                        if (!b)
                            return d;
                        d = Date.create(this.getNewDate(b, "after", "day")).format("{yyyy}-{MM}-{dd}")
                    }
                }
            else if ("yyyy-MM" == b || "YYYY-MM" == b)
                if ("currentMonth" == c)
                    d = Date.create(f).format("{yyyy}-{MM}");
                else if ("specified" == c) {
                    b = this.componentSetup.start.lateSpecDate;
                    if (!b)
                        return d;
                    d = Date.create(b).format("{yyyy}-{MM}")
                } else if ("currentMonthBefore" == c) {
                    b = this.componentSetup.start.lateBeforeMonth;
                    if (!b)
                        return d;
                    d = Date.create(this.getNewDate(b, "before", "month")).format("{yyyy}-{MM}")
                } else if ("currentMonthAfter" == c) {
                    b = this.componentSetup.start.lateAfterMonth;
                    if (!b)
                        return d;
                    d = Date.create(this.getNewDate(b, "after", "month")).format("{yyyy}-{MM}-{dd}")
                }
            return d
        },
        renderStatSearch: function(d) {
            var b = $(this.tpl).siblings("#statsearch-dateinterval")
              , c = d.startValue;
            c && b.find("input:first").val(c);
            (c = d.endValue) && b.find("input:last").val(c);
            var c = d.parentEl
              , f = (new Date).getTime();
            d = d.container;
            b.find(".j_datetime").attr("id", "j_datetime" + f);
            c.attr("class", "sch-group j_formFieldSearchGroup");
            c.find(".j_formField-condition").html(b);
            var e = $(d + " #j_datetime" + f + " #startDate")
              , a = $(d + " #j_datetime" + f + " #endDate");
            formPlugin.datepicker({
                el: d + " #j_datetime" + f + " #startDate",
                callback: function(c) {
                    c = Date.create(c.date).format("{yyyy}-{MM}-{dd}");
                    a.val() && c > a.val() ? (utils.notify("\u5f00\u59cb\u65e5\u671f\u4e0d\u80fd\u5927\u4e8e\u7ed3\u675f\u65e5\u671f"),
                    e.val("")) : e.val(c)
                }
            });
            formPlugin.datepicker({
                el: d + " #j_datetime" + f + " #endDate",
                callback: function(c) {
                    c = Date.create(c.date).format("{yyyy}-{MM}-{dd}");
                    e.val() && c < e.val() ? (utils.notify("\u7ed3\u675f\u65e5\u671f\u4e0d\u80fd\u5c0f\u4e8e\u5f00\u59cb\u65e5\u671f"),
                    a.val("")) : a.val(c)
                }
            })
        },
        checkEvents: function(d) {
            var b = this
              , c = b.el || $(document);
            c.on("change", "#field_" + b.componentSetup.start.fieldId + "[datetype\x3d'startDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + this.cid + "']", function() {
                var c = $(this).val()
                  , e = b.componentSetup.end.format;
                if ("yyyy-MM-dd HH:mm" == e)
                    var e = "yyyy-mm-dd hh:ii"
                      , a = parseInt(c.substring(c.indexOf(":") + 1, c.length)) + 5 + ""
                      , c = c.substring(0, c.indexOf(":") + 1) + a;
                else
                    "yyyy-MM-dd" == e ? e = "yyyy-mm-dd" : "yyyy-MM" == e && (e = "yyyy-mm");
                var k = a = "month"
                  , f = !0;
                0 <= e.indexOf("hh:ii") ? a = "hour" : 0 > e.indexOf("dd") && (k = a = "year",
                f = !1);
                var g = b.getEndDate();
                b.getShowBtns(c, g, b.componentSetup.end.format);
                var h = ["someday"];
                1 != b.showToday && "true" != b.showToday || h.push("today");
                1 != b.showTomorrow && "true" != b.showTomorrow || h.push("tomorrow");
                1 != b.showUpcoming && "true" != b.showUpcoming || h.push("upcoming");
                $("#field_" + b.componentSetup.end.fieldId + "[datetype\x3d'endDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + b.cid + "']").datetimepicker({
                    format: e,
                    language: "zh_CN",
                    todayHighlight: !0,
                    todayBtn: f,
                    autoclose: !0,
                    minView: a,
                    startView: k,
                    showMeridian: !1
                }).datetimepicker("setStartDate", c).datetimepicker("setEndDate", g).datetimepicker("setDateBtnGroup", h);
                c = b.check($(this).parents(".check_js"));
                d(c)
            });
            c.on("change", "#field_" + b.componentSetup.end.fieldId + "[datetype\x3d'endDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + this.cid + "']", function() {
                var c = $(this).val();
                if (c) {
                    var e = b.componentSetup.start.format;
                    if ("yyyy-MM-dd HH:mm" == e) {
                        var e = "yyyy-mm-dd hh:ii"
                          , a = c.substring(c.indexOf(":") - 2, c.indexOf(":"))
                          , k = c.substr(0, c.indexOf(" "))
                          , c = parseInt(c.substring(c.indexOf(":") + 1, c.length))
                          , k = new Date(k);
                        k.setHours(a, c - 30);
                        c = Date.create(k.getTime()).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                    } else
                        "yyyy-MM-dd" == e ? e = "yyyy-mm-dd" : "yyyy-MM" == e && (e = "yyyy-mm");
                    var k = a = "month"
                      , f = !0;
                    0 <= e.indexOf("hh:ii") ? a = "hour" : 0 > e.indexOf("dd") && (k = a = "year",
                    f = !1);
                    var g = b.getStartDate();
                    b.getShowBtns(g, c, b.componentSetup.start.format);
                    var h = ["someday"];
                    1 != b.showToday && "true" != b.showToday || h.push("today");
                    1 != b.showTomorrow && "true" != b.showTomorrow || h.push("tomorrow");
                    1 != b.showUpcoming && "true" != b.showUpcoming || h.push("upcoming");
                    $("#field_" + b.componentSetup.start.fieldId + "[datetype\x3d'startDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + b.cid + "']").datetimepicker({
                        format: e,
                        language: "zh_CN",
                        todayHighlight: !0,
                        todayBtn: f,
                        autoclose: !0,
                        minView: a,
                        startView: k,
                        showMeridian: !1
                    }).datetimepicker("setEndDate", c).datetimepicker("setStartDate", g).datetimepicker("setDateBtnGroup", h);
                    e = b.check($(this).parents(".check_js"));
                    d(e)
                }
            });
            "mobile" == window.systemInfo_form && (c.on("dateConfirm", "#field_" + b.componentSetup.start.fieldId + "[datetype\x3d'startDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + this.cid + "']", function(c, e) {
                var a = $(this).attr("endDate");
                $(this).val(e.date);
                b.getShowBtns(e.date, a, b.componentSetup.start.format);
                $(this).parents(".check_js").find("#field_" + b.componentSetup.end.fieldId + "[datetype\x3d'endDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + b.cid + "']").attr("showToday", b.showToday).attr("showTomorrow", b.showTomorrow).attr("showUpcoming", b.showUpcoming);
                $(this).parents(".check_js").find("#field_" + b.componentSetup.end.fieldId + "[datetype\x3d'endDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + b.cid + "']").attr("startDate", e.date).attr("endDate", a);
                a = b.check($(this).parents(".check_js"));
                d(a);
                $(this).trigger("monitor_change")
            }),
            c.on("dateConfirm", "#field_" + b.componentSetup.end.fieldId + "[datetype\x3d'endDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + this.cid + "']", function(c, e) {
                var a = $(this).attr("startDate");
                $(this).val(e.date);
                b.getShowBtns(a, e.date, b.componentSetup.start.format);
                $(this).parents(".check_js").find("#field_" + b.componentSetup.start.fieldId + "[datetype\x3d'startDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + b.cid + "']").attr("showToday", b.showToday).attr("showTomorrow", b.showTomorrow).attr("showUpcoming", b.showUpcoming);
                $(this).parents(".check_js").find("#field_" + b.componentSetup.start.fieldId + "[datetype\x3d'startDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + b.cid + "']").attr("endDate", e.date).attr("startDate", a);
                a = b.check($(this).parents(".check_js"));
                d(a);
                $(this).trigger("monitor_change")
            }),
            $("body").off("tap", ".j_dateinter_selected").on("tap", ".j_dateinter_selected", function(c) {
                c = document.body.scrollTop;
                var e = $(this).parents(".j_page-view")
                  , a = $(this).attr("format")
                  , b = $(this).attr("minview")
                  , d = $(this).attr("startview")
                  , g = $(this).attr("startDate")
                  , h = $(this).attr("showToday")
                  , p = $(this).attr("showTomorrow")
                  , w = $(this).attr("showUpcoming")
                  , m = ["someday"];
                1 != h && "true" != h || m.push("today");
                1 != p && "true" != p || m.push("tomorrow");
                1 != w && "true" != w || m.push("upcoming");
                h = $(this).attr("endDate");
                p = e.attr("id");
                (new f({
                    dateBtnGroup: m,
                    el: $(this),
                    format: a,
                    minView: b,
                    startView: d,
                    startDate: g,
                    endDate: h,
                    scrollvalue: c,
                    preEl: "#" + p
                })).render();
                setTimeout(function() {
                    e.addClass("hide")
                }, 500)
            }))
        },
        autoSaveEvents: function(d) {
            var b = this
              , c = b.el || $(document);
            "mobile" == window.systemInfo_form ? (c.on("dateConfirm", "#" + b.componentSetup.start.fieldId, function(c, e) {
                b.saveComponentValue($(this), d)
            }),
            c.on("dateConfirm", "#" + b.componentSetup.end.fieldId, function(c, e) {
                b.saveComponentValue($(this), d)
            })) : (c.on("change", "#field_" + b.componentSetup.start.fieldId + "[datetype\x3d'startDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + this.cid + "']", function(c, e) {
                e && 0 == e.isAutoSave || b.saveComponentValue($(this), d)
            }),
            c.on("change", "#field_" + b.componentSetup.end.fieldId + "[datetype\x3d'endDate'] input[componentKey\x3d'DateInterval'][cid\x3d'" + this.cid + "']", function(c, e) {
                e && 0 == e.isAutoSave || b.saveComponentValue($(this), d)
            }))
        },
        check: function(d) {
            var b = d.find("input").eq(0)
              , c = d.find("input").eq(1)
              , f = $.trim(b.val())
              , e = $.trim(c.val())
              , b = b.attr("placeholder")
              , c = c.attr("placeholder");
            f == b && (f = "");
            e == c && (e = "");
            1 == this.getCharCount(f, "-") && (f += "-01");
            1 == this.getCharCount(e, "-") && (e += "-01");
            var c = (new Date(f.replace(/-/g, "/"))).getTime()
              , b = (new Date(e.replace(/-/g, "/"))).getTime()
              , a = {};
            a.element = d;
            "" != f || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (a.message = "\u8bf7\u8f93\u5165" + this.componentSetup.title + "\u5f00\u59cb\u65f6\u95f4");
            "" != e || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (a.message = "\u8bf7\u8f93\u5165" + this.componentSetup.title + "\u7ed3\u675f\u65f6\u95f4");
            c > b && (a.message = "\u5f00\u59cb\u65f6\u95f4\u5fc5\u987b\u65e9\u4e8e\u6216\u7b49\u4e8e\u7ed3\u675f\u65f6\u95f4");
            return a
        },
        getValue: function(d, b) {
            var c = []
              , f = $.trim(d.find("input").eq(0).val())
              , e = d.find("input").eq(0).attr("placeholder");
            f == e && (f = "");
            var e = {
                formField: {
                    id: this.componentSetup.start.fieldId
                },
                content: f
            }
              , a = $.trim(d.find("input").eq(1).val())
              , k = d.find("input").eq(1).attr("placeholder");
            a == k && (a = "");
            c.push(e, {
                formField: {
                    id: this.componentSetup.end.fieldId
                },
                content: a
            });
            return "" != f || "" != a || b ? c : null
        },
        setValue: function(d, b) {
            var c = this.getStartDate()
              , f = this.getEndDate();
            if (null != b) {
                var e = b.content
                  , a = d.attr("datetype");
                this.isMobileForm ? (a = d.attr("datetype"),
                "startDate" == a && (this.startHtml = e ? '\x3cdiv class\x3d"input-instead-row"\x3e\u5f00\u59cb\u65f6\u95f4\uff1a' + e + "\x3c/div\x3e" : '\x3cdiv class\x3d"input-instead-row"\x3e\u5f00\u59cb\u65f6\u95f4\uff1a\u672a\u8bbe\u7f6e\x3c/div\x3e'),
                "endDate" == a && (this.endHtml = e ? '\x3cdiv class\x3d"input-instead-row"\x3e\u7ed3\u675f\u65f6\u95f4\uff1a' + e + "\x3c/div\x3e" : '\x3cdiv class\x3d"input-instead-row"\x3e\u7ed3\u675f\u65f6\u95f4\uff1a\u672a\u8bbe\u7f6e\x3c/div\x3e'),
                d.parent().siblings(".j_readOnly").html((this.startHtml ? this.startHtml : "") + (this.endHtml ? this.endHtml : ""))) : ("startDate" == a && (this.startHtml = e),
                "endDate" == a && (this.endHtml = e),
                d.parent().siblings(".j_readOnly").html((this.startHtml ? this.startHtml : "") + " &nbsp;&nbsp; " + (this.endHtml ? this.endHtml : "")));
                d.find("input").val(e);
                if ("mobile" != window.systemInfo_form) {
                    var k = this.componentSetup.start.format;
                    if ("yyyy-MM-dd HH:mm" == k) {
                        if (k = "yyyy-mm-dd hh:ii",
                        null != e && "" != e) {
                            var a = e.substring(e.indexOf(":") - 2, e.indexOf(":"))
                              , g = e.substr(0, e.indexOf(" "))
                              , e = parseInt(e.substring(e.indexOf(":") + 1, e.length))
                              , g = new Date(g);
                            g.setHours(a, e - 30);
                            e = Date.create(g.getTime()).format("{yyyy}-{MM}-{dd} {hh}:{mm}")
                        }
                    } else
                        "yyyy-MM-dd" == k ? k = "yyyy-mm-dd" : "yyyy-MM" == k && (k = "yyyy-mm");
                    var h = g = "month"
                      , q = !0;
                    0 <= k.indexOf("hh:ii") ? g = "hour" : 0 > k.indexOf("dd") && (h = g = "year",
                    q = !1);
                    var a = d.attr("datetype")
                      , p = ["someday"];
                    1 != this.showToday && "true" != this.showToday || p.push("today");
                    1 != this.showTomorrow && "true" != this.showTomorrow || p.push("tomorrow");
                    1 != this.showUpcoming && "true" != this.showUpcoming || p.push("upcoming");
                    "startDate" == a ? d.next().next().find("input").datetimepicker({
                        dateBtnGroup: p,
                        format: k,
                        language: "zh_CN",
                        todayHighlight: !0,
                        todayBtn: q,
                        autoclose: !0,
                        minView: g,
                        startView: h,
                        showMeridian: !1
                    }).datetimepicker("setStartDate", e).datetimepicker("setEndDate", f) : "endDate" == a && d.prev().prev().find("input").datetimepicker({
                        dateBtnGroup: p,
                        format: k,
                        language: "zh_CN",
                        todayHighlight: !0,
                        todayBtn: q,
                        autoclose: !0,
                        minView: g,
                        startView: h,
                        showMeridian: !1
                    }).datetimepicker("setEndDate", e).datetimepicker("setStartDate", c)
                }
            }
        },
        empty: function(d) {
            d.find("input").val("");
            d.find(".j_readOnly").html("")
        },
        readOnly: function(d, b) {
            b ? (d.find(".check_js").addClass("hide"),
            d.find(".j_readOnly").removeClass("hide")) : (d.find(".check_js").removeClass("hide"),
            d.find(".j_readOnly").addClass("hide"))
        },
        getCharCount: function(d, b) {
            for (var c = 0, f = 0; f < d.length; f++)
                d.charAt(f) == b && c++;
            return c
        },
        renderDateRuleConfig: function(d, b, c, f, e, a) {
            var k = ""
              , g = "";
            1 != this.componentSetup.start.earlyDate && "true" != this.componentSetup.start.earlyDate || b.removeClass("hide");
            1 != this.componentSetup.start.lateDate && "true" != this.componentSetup.start.lateDate || c.removeClass("hide");
            if ("yyyy-MM-dd" == d || "HH:mm:ss" == d || "YYYY-MM-DD" == d)
                k = a.find("#option-clone .j_nyr_config").clone(),
                g = a.find("#option-clone .j_nyr_config").clone(),
                b.empty().append(k),
                c.empty().append(g),
                "currentDay" == f ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == f ? (b.find(".j_specDate").removeClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.start.earlySpecDate && b.find(".j_specDate input").attr("value", this.componentSetup.start.earlySpecDate)) : "currentDayBefore" == f ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.earlyBeforeDay && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.earlyBeforeDay)) : "currentDayAfter" == f && (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.earlyAfterDay && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.earlyAfterDay)),
                "currentDay" == e ? (c.find(".j_specDate").addClass("hide"),
                c.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == e ? (c.find(".j_specDate").removeClass("hide"),
                c.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.start.lateSpecDate && c.find(".j_specDate input").attr("value", this.componentSetup.start.lateSpecDate)) : "currentDayBefore" == e ? (c.find(".j_specDate").addClass("hide"),
                c.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.lateBeforeDay && c.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.lateBeforeDay)) : "currentDayAfter" == e && (c.find(".j_specDate").addClass("hide"),
                c.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.lateAfterDay && c.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.lateAfterDay));
            else if ("yyyy-MM" == d || "YYYY-MM" == d)
                k = a.find("#option-clone .j_ny_config").clone(),
                g = a.find("#option-clone .j_ny_config").clone(),
                b.empty().append(k),
                c.empty().append(g),
                "currentMonth" == f ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == f ? (b.find(".j_specDate").removeClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.start.earlySpecDate && b.find(".j_specDate input").attr("value", this.componentSetup.start.earlySpecDate)) : "currentMonthBefore" == f ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.earlyBeforeMonth && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.earlyBeforeMonth)) : "currentMonthAfter" == f && (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.earlyAfterMonth && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.earlyAfterMonth)),
                "currentMonth" == e ? (c.find(".j_specDate").addClass("hide"),
                c.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == e ? (c.find(".j_specDate").removeClass("hide"),
                c.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.start.lateSpecDate && c.find(".j_specDate input").attr("value", this.componentSetup.start.lateSpecDate)) : "currentMonthBefore" == e ? (c.find(".j_specDate").addClass("hide"),
                c.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.lateBeforeMonth && c.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.lateBeforeMonth)) : "currentMonthAfter" == e && (c.find(".j_specDate").addClass("hide"),
                c.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.lateAfterMonth && c.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.lateAfterMonth));
            else if ("yyyy-MM-dd HH:mm" == d || "YYYY-MM-DD HH:mm:ss" == d || "YYYY-MM-DD HH:mm" == d)
                k = a.find("#option-clone .j_nyrsf_config").clone(),
                g = a.find("#option-clone .j_nyrsf_config").clone(),
                b.empty().append(k),
                c.empty().append(g),
                "currentHour" == f ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == f ? (b.find(".j_specDate").removeClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.start.earlySpecDate && b.find(".j_specDate input").attr("value", this.componentSetup.start.earlySpecDate)) : "currentHourBefore" == f ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.earlyBeforeHour && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.earlyBeforeHour)) : "currentHourAfter" == f && (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.earlyAfterHour && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.earlyAfterHour)),
                "currentHour" == e ? (c.find(".j_specDate").addClass("hide"),
                c.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == e ? (c.find(".j_specDate").removeClass("hide"),
                c.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.start.lateSpecDate && c.find(".j_specDate input").attr("value", this.componentSetup.start.lateSpecDate)) : "currentHourBefore" == e ? (c.find(".j_specDate").addClass("hide"),
                c.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.lateBeforeHour && c.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.lateBeforeHour)) : "currentHourAfter" == e && (c.find(".j_specDate").addClass("hide"),
                c.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.start.lateAfterHour && c.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.start.lateAfterHour));
            b.find('select option[value\x3d"' + f + '"]').attr("selected", !0);
            c.find('select option[value\x3d"' + e + '"]').attr("selected", !0)
        },
        getNewDate: function(d, b, c) {
            var f = new Date;
            "before" == b ? "hour" == c ? f.setHours(f.getHours() - parseInt(d)) : "day" == c ? f.setDate(f.getDate() - parseInt(d)) : "month" == c && f.setMonth(f.getMonth() - parseInt(d)) : "after" == b && ("hour" == c ? f.setHours(f.getHours() + parseInt(d)) : "day" == c ? f.setDate(f.getDate() + parseInt(d)) : "month" == c && f.setMonth(f.getMonth() + parseInt(d)));
            return f
        }
    });
    u.exports = window.DateInterval
});
define("form/component/agendalist", ["form/tplutil"], function(n, y, u) {
    var m = n("form/tplutil");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/departselecter", ["form/tplutil"], function(n, y, u) {
    var m = n("form/tplutil");
    n = Backbone.View.extend({
        
    });
    u.exports = n
});
define("form/component/monitoreditor", ["form/tplutil"], function(n, y, u) {
    function m(f, d, b, c) {
        this.value = f;
        this.type = d;
        this.monitorFields = b;
        this.monitorType = c
    }
    var h = n("form/tplutil")
      , g = {
        fields: [],
        monitorFields: [],
        callback: $.noop
    };
    n = Backbone.View.extend({
        initialize: function(f) {
            this.el = "#monitoreditor";
            this.options = $.extend({}, g, f);
            $("body").append(h.get("monitoreditor"))
        },
        delegateEvents: function() {
            var f = this
              , d = $(f.el);
            d.on("hidden.bs.modal", function() {
                f.remove()
            });
            d.on("click", ".j_field", function() {
                $(this).hasClass("disabled") || f.pushMonitorField($(this))
            });
            d.on("click", "#clear", function() {
                0 < f.options.monitorFields.length && (f.options.monitorFields = [],
                f.getFormula())
            });
            d.on("click", "#revoke", function() {
                0 < f.options.monitorFields.length && (f.options.monitorFields.pop(),
                f.getFormula())
            });
            d.on("click", "#cancel", function() {
                d.modal("hide")
            });
            d.on("click", "#success", function() {
                f.checkFormula() && (f.options.callback(f.options.monitorFields),
                d.modal("hide"))
            });
            d.find("#number_input").keyup(function(b) {
                b = $(this).val();
                isNaN(b) && "-" != b && $(this).val(parseFloat(b));
                "." == b.charAt(0) && $(this).val(0 + parseFloat(b))
            });
            d.find("#number_input").keyup(function(b) {
                b = $(this).val();
                $(this).val(b.replace(/[^\d.-]/g, ""))
            });
            d.find("#number_input").blur(function(b) {
                b = $(this).val();
                $(this).val(b.replace(/[^\d.-]/g, ""))
            })
        },
        render: function() {
            $(this.el).modal({
                keyboard: !1,
                backdrop: "static"
            });
            this.renderOptions();
            this.getFormula();
            formPlugin.initLayout($(".j_monitoreditorScr"))
        },
        renderOptions: function() {
            var f = $(this.el)
              , d = this.options.fields
              , f = f.find(".j_fields");
            if (null != d && 0 < d.length)
                for (var b = 0; b < d.length; b++) {
                    var c = d[b];
                    f.append("\x3ca type\x3d'field' class\x3d'btn btn-default j_field' value\x3d'" + c.fieldId + "' monitortype\x3d'" + (c.monitorType ? c.monitorType : "") + "' title\x3d'" + c.title + "'\x3e" + c.title + "\x3c/a\x3e")
                }
            else
                f.html("\u6682\u65e0\u53ef\u76d1\u63a7\u7684\u5b57\u6bb5")
        },
        renderEditor: function() {
            var f = $(this.el)
              , d = this.options.monitorFields
              , f = f.find(".j_field");
            f.removeClass("disabled");
            d && 0 < d.length ? (d = d[d.length - 1],
            "string" == typeof d && (d = JSON.parse(d)),
            "operate" == d.type && (f.filter("[value\x3d')']").addClass("disabled"),
            f.filter("[type\x3d'operate']").addClass("disabled")),
            "bracket" == d.type && ("(" == d.value ? (f.filter("[value\x3d')']").addClass("disabled"),
            f.filter("[type\x3d'operate']").addClass("disabled")) : (f.filter("[value\x3d'(']").addClass("disabled"),
            f.filter("[type\x3d'number']").addClass("disabled"),
            f.filter("[type\x3d'field']").addClass("disabled"))),
            "number" == d.type && (f.filter("[value\x3d'(']").addClass("disabled"),
            f.filter("[type\x3d'number']").addClass("disabled"),
            f.filter("[type\x3d'field']").addClass("disabled")),
            "field" == d.type && (f.filter("[value\x3d'(']").addClass("disabled"),
            f.filter("[type\x3d'number']").addClass("disabled"),
            f.filter("[type\x3d'field']").addClass("disabled"))) : (f.filter("[value\x3d')']").addClass("disabled"),
            f.filter("[type\x3d'operate']").addClass("disabled"))
        },
        pushMonitorField: function(f) {
            var d = f.attr("type")
              , b = "";
            if ("number" == d) {
                b = f.prev().val();
                if ("" === b || "0" == b || "-0" == b || "\u8bf7\u8f93\u5165\u4e0d\u4e3a0\u7684\u6570\u5b57" == b) {
                    formPlugin.notify("\u8bf7\u8f93\u5165\u4e0d\u4e3a0\u7684\u6570\u5b57");
                    return
                }
                f.prev().val("")
            } else
                b = f.attr("value");
            f = f.attr("monitortype");
            var c = null;
            f ? (d = $("div[tempId\x3d'" + b + "']").data("componentData").componentSetup.monitorFields,
            c = new m(b,"field",d,f)) : c = new m(b,d);
            this.options.monitorFields.push(c);
            this.getFormula(c)
        },
        bulidFormulaStr: function(f, d) {
            var b = $(this.el);
            "string" == typeof f && (f = JSON.parse(f));
            "field" == f.type ? (b = b.find(".j_field[value\x3d'" + f.value + "']"),
            d = 0 < b.length ? d + b.attr("title") : d + "\u672a\u77e5\u63a7\u4ef6") : d += f.value;
            return d
        },
        getFormula: function(f) {
            var d = $(this.el).find("#formula")
              , b = d.text();
            if (f)
                b = this.bulidFormulaStr(f, b);
            else
                for (var b = "", c = this.options.monitorFields, l = 0; l < c.length; l++)
                    f = c[l],
                    b = this.bulidFormulaStr(f, b);
            d.text(b);
            this.renderEditor()
        },
        checkFormula: function() {
            for (var f = $(this.el), d = this.options.monitorFields, b = "", c = 0; c < d.length; c++) {
                var l = d[c];
                "string" == typeof l && (l = JSON.parse(l));
                b = "field" == l.type ? 0 < f.find(".j_field[value\x3d'" + l.value + "']").length ? b + "1" : b + "\u672a\u77e5\u63a7\u4ef6" : "number" == l.type ? b + ("(" + l.value + ")") : b + l.value
            }
            try {
                return eval(b),
                !0
            } catch (e) {
                return formPlugin.notify("\u516c\u5f0f\u683c\u5f0f\u4e0d\u6b63\u786e"),
                !1
            }
        },
        remove: function() {
            $(this.el).remove()
        }
    });
    u.exports = n
});
define("form/component/filecomponent", ["form/editablecomponent", "form/component/preview", "form/tplutil", "form/component/imageviewer"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/component/preview")
      , g = n("form/tplutil")
      , f = n("form/component/imageviewer");
    window.FileComponent = m.extend({
        initialize: function(d) {
            m.prototype.initialize.call(this, d);
            var b = {
                componentKey: "FileComponent",
                title: "\u9644\u4ef6",
                isSingle: !1,
                formId: "",
                files: []
            };
            null != d && (b.title = d.title,
            b.isSingle = d.isSingle,
            b.formId = d.formId,
            b.files = d.files);
            this.componentSetup = $.extend(this.componentSetup, b);
            this.tpl = g.get("file")
        },
        setSingle: function(d) {
            this.componentSetup.isSingle = d
        },
        setFiles: function(d) {
            this.componentSetup.files = d
        },
        getFiles: function() {
            return this.componentSetup.files
        },
        render: function(d) {
            var b = $(this.tpl).siblings("#form-file");
            this.componentSetup.formId = $("#formId").val();
            m.prototype.render.call(this, d, b);
            d.html(b.html())
        },
        renderEditPreview: function(d) {
            var b = $(this.tpl).siblings("#form-file");
            m.prototype.renderEditPreview.call(this, d, b);
            d.append(b)
        },
        renderEditor: function() {
            var d = this
              , b = $(this.tpl).siblings("#editor-file");
            m.prototype.renderEditor.call(this, b);
            "true" != this.componentSetup.isSingle && 1 != this.componentSetup.isSingle || b.find("#isSingle").attr("checked", "true");
            $("#editor-component").html(b.html());
            var b = $("#j_default_value")
              , c = this.componentSetup.files;
            if (c && 0 < c.length)
                for (var f = 0; f < c.length; f++) {
                    var e = c[f];
                    "string" == typeof e && (e = JSON.parse(e));
                    var a = null;
                    e.optionObj && (a = e.optionObj,
                    "string" == typeof e && (a = JSON.parse(a)));
                    var k = e.optionId
                      , k = $('\x3cdiv class\x3d"file-item" id\x3d"' + k + '"\x3e\x3ca target\x3d"_blank" class\x3d"remoteDownload" type\x3d"' + e.type + '" docType\x3d"' + (a ? a.docType : "") + '"  href\x3d"' + (TEAMS.api.remoteDownloadUrl + k) + '" data-value\x3d"' + k + '"\x3e' + (e.content ? e.content : "") + "\x3c/a\x3e\x3c/div\x3e");
                    k.append('\x3ca class\x3d"close j_deleteFile" title\x3d"\u5220\u9664"\x3e\x26times;\x3c/a\x3e');
                    k.data("fileObj", e.optionObj);
                    $("#j_default_value .j_formFileContainer").append(k);
                    a && (new h({
                        container: $("#editor-component"),
                        afterJqObj: $("#editor-component").find("#" + a.id).children(":first"),
                        fileObj: a,
                        previewType: "remote"
                    })).render()
                }
            this.initUploader(function() {
                var a = [];
                $("#j_default_value .j_formFileContainer").find(".file-item").each(function() {
                    var e = $(this).find("a").eq(0).attr("data-value")
                      , c = $(this).find("a").eq(0).text()
                      , b = $(this).find("a").eq(0).attr("type");
                    a.push({
                        optionId: e,
                        content: c,
                        type: b,
                        optionObj: $(this).data("fileObj")
                    })
                });
                d.setFiles(a)
            }, "#j_default_value .j_file_input", "#j_default_value .j_formFileContainer", b, !1)
        },
        renderPreview: function(d, b, c) {
            var f = $(this.tpl)
              , e = null
              , e = "mobile" != window.systemInfo_form ? f.siblings("#preview-file") : f.siblings("#mobile-preview");
            e.find(".widget-title .widget-title_js").text(this.componentSetup.title);
            "true" != this.componentSetup.isHideTitle && 1 != this.componentSetup.isHideTitle || e.addClass("field-notitle").find(".widget-title .widget-title_js").addClass("hide");
            "true" != this.componentSetup.required && 1 != this.componentSetup.required || e.find(".widget-title .widget-required_js").text(" *");
            "" != this.componentSetup.describe && (e.find(".field-description").text(this.componentSetup.describe),
            e.find(".field-description").show());
            e.find(".check_js").attr("id", this.componentSetup.fieldId + this.cid);
            e.find(".check_js").siblings(".j_file_input").attr("id", "fileInput" + this.componentSetup.fieldId + this.cid);
            e.find(".check_js").attr("cid", this.cid);
            e.attr("id", "field_" + this.componentSetup.fieldId);
            e.find(".check_js").data("componentData", this);
            e.addClass(this.componentSetup.titleLayout);
            e.find(".form-control").attr("placeholder", "\u8bf7\u586b\u5199" + this.componentSetup.title);
            this.el = d;
            d.append(e);
            if ("true" == c || 1 == c || c)
                e.find("#fileInput" + this.componentSetup.fieldId + this.cid).remove(),
                "mobile" == window.systemInfo_form && e.find("#" + this.componentSetup.fieldId + this.cid).attr("readOnly", "readOnly"),
                this.isReadOnly = c;
            d = this.componentSetup.files;
            b || "true" != this.componentSetup.isDefault && 1 != this.componentSetup.isDefault || !d || window.systemInfo_print || this.setValue(e, {
                dataOptions: d
            });
            if ("true" == this.componentSetup.isReadOnly || 1 == this.componentSetup.isReadOnly)
                this.readOnly(e, !0),
                "mobile" == window.systemInfo_form && e.find("#" + this.componentSetup.fieldId + this.cid).attr("readOnly", "readOnly"),
                this.isReadOnly = !0
        },
        checkEvents: function(d) {
            var b = this
              , c = b.el || $(document)
              , f = b.componentSetup.fieldId + this.cid
              , e = b.componentSetup.formId;
            b.isReadOnly && "false" != b.isReadOnly && 0 != b.isReadOnly || "mobile" == window.systemInfo_form || b.initUploader(d);
            c.on("click", "#" + f + " .j_deleteFile", function() {
                var a = $(this).parents("#" + f);
                b.deleteFile($(this));
                a = b.check(a);
                d(a)
            });
            c.on("click", ".j_fileItemDownload", function(a) {
                a.stopPropagation();
                a = $(this).attr("downUrl");
                (!a || 1 > a.length) && utils.notify("\u4e0b\u8f7d\u51fa\u73b0\u9519\u8bef");
                window.location.href = a
            });
            "mobile" == window.systemInfo_form && ($("#fileInput" + b.componentSetup.fieldId + b.cid).on("input change propertychange paste", function(a) {
                var d = $(this);
                a = 1 == b.componentSetup.isSingle || "true" == b.componentSetup.isSingle;
                var g = $(this).find("#formFileToUpload").get(0).files[0];
                if (g) {
                    var h = 0
                      , h = 1048576 < g.size ? (Math.round(100 * g.size / 1048576) / 100).toString() + "MB" : (Math.round(100 * g.size / 1024) / 100).toString() + "KB";
                    g.size = h;
                    h = $('\x3cdiv\x3e\x3ca style\x3d"font-size:12px;" id\x3d"' + g.id + '"\x3e' + g.name + '\x3ci class\x3d"ml-3 j_percent c-grey"\x3e\x3c/i\x3e\x3c/a\x3e\x3c/div\x3e');
                    $(this).prev().append(h);
                    a && d.hide()
                }
                a = new FormData;
                a.append("data", $(this).find("#formFileToUpload").get(0).files[0]);
                h = new XMLHttpRequest;
                h.upload.addEventListener("progress", function(a) {
                    a.lengthComputable && (a = Math.round(100 * a.loaded / a.total),
                    $("#" + b.componentSetup.fieldId + b.cid + " .j_percent").html(a.toString() + "%"))
                }, !1);
                h.addEventListener("load", function(a) {
                    a = jQuery.parseJSON(a.target.responseText).fileObj;
                    var e = a.id
                      , d = a.name
                      , k = plupload.formatSize(g.size)
                      , h = "file";
                    if ("true" == a.image || 1 == a.image)
                        h = "image";
                    var r = "image" === a.docType ? "image" : "office" === a.docType ? "office" : "video" === a.docType ? "video" : "audio" === a.docType ? "audio" : "pdf" === a.docType ? "pdf" : "text" === a.docType ? "txt" : "html" === a.docType ? "html" : "other"
                      , m = ""
                      , n = TEAMS.api.remoteDownloadUrl  + e ;
                    -1 != n.indexOf("https") && (n += "\x26ssl\x3d1");
                    "office" == a.docType ? m = "/wopi/files/preview/newView?id\x3d" + e + "\x26preType\x3doffOrPdfPre" : "text" == a.docType ? m = "/wopi/files/preview/txtView?id\x3d" + e : "pdf" == a.docType && (m = crmContext.officewebUrl + "?furl\x3d" + n);
                    a = '\x3cdiv id\x3d"' + e + '" fileid\x3d"' + e + '" class\x3d"file-item j_fileItem eui-form-outline file-item-' + r + '"\x3e' + ('\x3cdiv class\x3d"form-quick-tools j_fileQuickTools"\x3e\x3ca class\x3d"download j_fileItemDownload" data-value\x3d"' + e + '" doctype\x3d"' + a.docType + '" type\x3d"' + h + '" downurl\x3d"' + n + '" \x3e\x3ci class\x3d"icon-download"\x3e\x3c/i\x3e\x3cspan\x3e\u4e0b\u8f7d\x3c/span\x3e\x3c/a\x3e\x3ca class\x3d"preview j_fileItemPreview" data-value\x3d"' + e + '" docType\x3d"' + a.docType + '" type\x3d"' + h + '" data-href\x3d"' + m + '"\x3e\x3ci class\x3d"graph"\x3e\x3c/i\x3e\x3cspan\x3e\u9884\u89c8\x3c/span\x3e\x3c/a\x3e' + (b.isReadOnly ? "" : '\x3ca class\x3d"j_deleteFileItem delete"\x3e\x3ci class\x3d"graph"\x3e\x3c/i\x3e\x3cspan\x3e\u5220\u9664\x3cspan\x3e\x3c/a\x3e') + "\x3c/div\x3e") + '\x3cdiv class\x3d"inner"\x3e\x3ci class\x3d"ico-type"\x3e\x3c/i\x3e\x3ca data-value\x3d"' + e + '"  docType\x3d"' + a.docType + '" type\x3d"' + h + '"\x3e' + d + " (" + k + ")\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e";
                    formPlugin.notify("\u6587\u4ef6\u4e0a\u4f20\u6210\u529f");
                    $("#" + g.id).parent().replaceWith(a);
                    c.find("#" + f).triggerHandler("changeVaule")
                }, !1);
                h.addEventListener("error", function(a) {
                    formPlugin.notify("\u6587\u4ef6\u4e0a\u4f20\u5931\u8d25");
                    d.show()
                }, !1);
                h.open("POST", TEAMS.api.uploadRemote+"?module\x3dform\x26refId\x3d" + e);
                h.send(a)
            }),
            $("#" + b.componentSetup.fieldId + b.cid).on("tap", ".j_fileItemPreview", function(a) {
                a = $(this).attr("docType");
                var e = $(this).parents(".j_fileItem").attr("fileid");
                b.fileItemPreview(a, e)
            }),
            $("#" + b.componentSetup.fieldId + b.cid).on("tap", ".j_fileItem", function(a) {
                if (b.isReadOnly) {
                    a = $(this).attr("fileid");
                    var e = $(this).find(".j_fileItemPreview").attr("docType");
                    b.fileItemPreview(e, a)
                } else
                    $(this).find(".j_fileQuickTools").show(),
                    $(this).siblings().find(".j_fileQuickTools").hide()
            }),
            $("#" + b.componentSetup.fieldId + b.cid).on("tap", ".j_deleteFileItem", function(a) {
                var e = $(this).parents(".j_fileItem");
                formPlugin.confirm("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f", function(a) {
                    a && (e.remove(),
                    formPlugin.notify("\u6570\u636e\u5df2\u5220\u9664"),
                    c.find("#" + f).triggerHandler("changeVaule"))
                })
            }),
            c.parents(".page-view").on("click", function(a) {
                null == $(a.target).parents(".j_quicktools").get(0) && null == $(a.target).closest(".j_quicktools").get(0) && c.find(".j_fileQuickTools").hide()
            }))
        },
        fileItemPreview: function(d, b) {
            if ("image" == d) {
                var c = TEAMS.api.remoteDownloadUrl + b;
                (new f({
                    preEl: $("#" + this.componentSetup.fieldId + this.cid).parents(".j_page-view"),
                    imageUrl: c
                })).render()
            } else
                "office" == d || "text" == d || "pdf" == d ? window.location.href = $("#" + this.componentSetup.fieldId + this.cid + ' .j_fileItem[fileid\x3d"' + b + '"] .j_fileItemPreview').attr("data-href") : utils.notify("\u8be5\u6587\u4ef6\u7c7b\u578b\u6682\u4e0d\u652f\u6301\u9884\u89c8")
        },
        autoSaveEvents: function(d) {
            var b = this
              , c = b.el || $(document)
              , f = (b.componentSetup.fieldId || b.componentSetup.tempId) + this.cid;
            c.find("#" + f).on("changeVaule", function() {
                b.saveComponentValue($(this), d)
            });
            if ("mobile" != window.systemInfo_form)
                c.on("click", "#" + f + " .j_deleteFile", function() {
                    b.saveComponentValue(c.find("#" + f), d)
                })
        },
        check: function(d) {
            var b = $(d).find(".file-item")
              , c = b.length
              , f = {};
            f.element = d;
            0 != c || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (f.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            b.each(function(e) {
                $(this).attr("id") || (f.message = "\u6587\u4ef6\u5c1a\u672a\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85")
            });
            return f
        },
        getValue: function(d, b) {
            var c = {
                formField: {
                    id: this.componentSetup.fieldId
                }
            }
              , f = d.find(".file-item");
            if (0 < f.length) {
                var e = [], a;
                f.each(function(c) {
                    a = "mobile" == window.systemInfo_form ? $(this).find(".inner a") : $(this).find("a");
                    var b = a.eq(0).attr("data-value")
                      , d = a.eq(0).text()
                      , f = a.eq(0).attr("type");
                    e[c] = {
                        optionId: b,
                        content: d,
                        type: f
                    }
                });
                c.dataOptions = e
            } else
                b || (c = null);
            return c
        },
        setValue: function(d, b) {
            if (null != b && null != b.dataOptions) {
                d.find(".check_js").html("");
                for (var c = 0; c < b.dataOptions.length; c++) {
                    var f = b.dataOptions[c];
                    "string" == typeof f && (f = JSON.parse(f));
                    var e = f.optionObj;

                    e || $.ajax({
                        async: !1,
                        type: TEAMS.ajaxMethod,
                        url: TEAMS.api.findFileObj,
                        dataType: "json",
                        data: {
                            optionId: f.optionId
                        },
                        success: function(a) {
                            e = a.fileObj
                        }
                    });
                    if (e) {
                        "string" == typeof e && (e = JSON.parse(e));
                        var f = null == f.content ? e.name : f.content
                          , a = e.id
                          , k = "file";
                        if ("true" == e.image || 1 == e.image)
                            k = "image";
                        var g = e.docType
                          , r = "image" === g ? "image" : "office" === g ? "office" : "video" === g ? "video" : "audio" === g ? "audio" : "pdf" === g ? "pdf" : "text" === g ? "txt" : "html" === g ? "html" : "other"
                          , q = null
                          , p = TEAMS.api.remoteDownloadUrl + a
                          , q = TEAMS.api.remoteDownloadUrl + a;
                        -1 != q.indexOf("https") && (q += "\x26ssl\x3d1");
                        "mobile" != window.systemInfo_form ? (q = $('\x3cdiv class\x3d"file-item" id\x3d"' + a + '"\x3e\x3ca class\x3d"name ellipsis" target\x3d"_blank" type\x3d"' + k + '" docType\x3d"' + g + '" href\x3d"' + p + '" data-value\x3d"' + a + '"\x3e' + f + "\x3c/a\x3e\x3c/div\x3e"),
                        null != d.find(".file-input").get(0) && q.append('\x3ca class\x3d"close j_deleteFile" title\x3d"\u5220\u9664"\x3e\x26times;\x3c/a\x3e')) : (p = "",
                        "office" == g ? p = "/wopi/files/preview/newView?id\x3d" + a + "\x26preType\x3doffOrPdfPre" : "text" == g ? p = "/wopi/files/preview/txtView?id\x3d" + a : "pdf" == g && (p = crmContext.officewebUrl + "?furl\x3d" + q),
                        q = $('\x3cdiv fileid\x3d"' + a + '" id\x3d"' + this.componentSetup.fieldId + '" class\x3d"eui-form-outline j_fileItem file-item file-item-' + r + '"\x3e' + ('\x3cdiv class\x3d"form-quick-tools j_fileQuickTools"\x3e\x3ca class\x3d"download j_fileItemDownload" doctype\x3d"' + g + '" type\x3d"' + k + '" downurl\x3d"' + q + '" \x3e\x3ci class\x3d"icon-download"\x3e\x3c/i\x3e\x3cspan\x3e\u4e0b\u8f7d\x3c/span\x3e\x3c/a\x3e\x3ca class\x3d"preview j_fileItemPreview" data-href\x3d"' + p + '" data-value\x3d"' + a + '"  type\x3d"' + k + '"  docType\x3d"' + g + '"\x3e\x3ci class\x3d"graph"\x3e\x3c/i\x3e\x3cspan\x3e\u9884\u89c8\x3c/span\x3e\x3c/a\x3e' + (e.isReadOnly ? "" : '\x3ca class\x3d"j_deleteFileItem delete"\x3e\x3ci class\x3d"graph"\x3e\x3c/i\x3e\x3cspan\x3e\u5220\u9664\x3cspan\x3e\x3c/a\x3e') + "\x3c/div\x3e") + '\x3cdiv class\x3d"inner"\x3e\x3ci class\x3d"ico-type"\x3e\x3c/i\x3e\x3ca data-value\x3d"' + a + '"  type\x3d"' + k + '"  docType\x3d"' + g + '"\x3e' + f + "\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e"));
                        d.find(".check_js").append(q);
                        e && (new h({
                            container: d,
                            afterJqObj: d.find("#" + e.id).children(":first"),
                            fileObj: e,
                            previewType: "remote"
                        })).render()
                    }
                }
                "true" != this.componentSetup.isSingle && 1 != this.componentSetup.isSingle || null == $("#" + this.componentSetup.fieldId + this.cid + " .file-item").get(0) || $("#fileInput" + this.componentSetup.fieldId + this.cid).hide()
            }
        },
        empty: function(d) {
            d.find(".file-item").remove()
        },
        readOnly: function(d, b) {
            var c = d.find("#fileInput" + this.componentSetup.fieldId + this.cid)
              , f = d.find("#" + this.componentSetup.fieldId + this.cid);
            c.remove();
            f.find(".file-item .j_deleteFile").remove();
            c.parents(".field_js").addClass(".form-widget-readonly")
        },
        initUploader: function(d, b, c, f, e) {
            var a = this
              , k = a.el || $(document)
              , g = a.componentSetup.formId
              , r = a.componentSetup.fieldId + this.cid;
            b = b || "#fileInput" + this.componentSetup.fieldId + this.cid;
            c = c || "#" + this.componentSetup.fieldId + this.cid;
            f = f || $(c).parents("#field_" + this.componentSetup.fieldId);
            null == e && (e = 1 == a.componentSetup.isSingle || "true" == a.componentSetup.isSingle);
            f = this.uploader = new plupload.Uploader({
                runtimes: "html5,flash",
                file_data_name: "data",
                browse_button: b,
                drop_element: b,
                container: f,
                max_file_size: "50M",
                url: TEAMS.api.uploadRemote+"?module\x3dform\x26refId\x3d" + g,
                flash_swf_url: "/static/swf/plupload.swf"
            });
            f.init();
            f.bind("FilesAdded", function(a, b) {
                e && (1 < b.length || null != $(c).find(".file-item").get(0)) ? ($.each(b, function(e, c) {
                    a.removeFile(c)
                }),
                formPlugin.notify("\u6b64\u63a7\u4ef6\u4ec5\u80fd\u4e0a\u4f20\u4e00\u4e2a\u6587\u4ef6\u9644\u4ef6", "\u6587\u4ef6\u6570\u8fc7\u591a", "error")) : ($.each(b, function(a, e) {
                    var b = e.id
                      , d = e.name
                      , f = plupload.formatSize(e.size);
                    $(c).append('\x3cdiv class\x3d"file-item"\x3e\x3ca class\x3d"name ellipsis" id\x3d' + b + "\x3e" + d + " " + f + '\x3ci class\x3d"ml-3 c-grey"\x3e\x3c/i\x3e\x3c/a\x3e\x3ca class\x3d"close j_deleteFile" title\x3d"\u5220\u9664"\x3e\x26times;\x3c/a\x3e\x3c/div\x3e')
                }),
                a.refresh(),
                a.start())
            });
            f.bind("UploadProgress", function(a, e) {
                $("#" + e.id + " i").html(e.percent + "%")
            });
            f.bind("Error", function(a, e) {
                -600 == e.code && formPlugin.notify("\u53ea\u80fd\u4e0a\u4f20\u6700\u5927\u4e0d\u8d85\u8fc750M\u7684\u6587\u4ef6", "\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7\u9650\u5236", "error");
                a.refresh()
            });
            f.bind("FileUploaded", function(a, e, c) {
                a = jQuery.parseJSON(c.response).fileObj;
                c = a.id;
                c = '\x3cdiv id\x3d"' + c + '" class\x3d"file-item"\x3e\x3ca class\x3d"name ellipsis" target\x3d"_blank" data-value\x3d"' + c + '" href\x3d"' + (TEAMS.api.remoteDownloadUrl  + c) + '" type\x3d"' + (1 == a.image ? "image" : "file") + '"  docType\x3d"' + a.docType + '" \x3e' + a.name + '\x3c/a\x3e\x3ca class\x3d"close j_deleteFile" title\x3d"\u5220\u9664"\x3e\x26times;\x3c/a\x3e\x3c/div\x3e';
                formPlugin.notify("\u6587\u4ef6\u4e0a\u4f20\u6210\u529f");
                $("#" + e.id).parent().replaceWith(c);
                $("#" + a.id).data("fileObj", a);
                (new h({
                    container: $("body"),
                    afterJqObj: $("#" + a.id).children(":first"),
                    fileObj: a,
                    previewType: "remote"
                })).render()
            });
            f.bind("UploadComplete", function(f, l) {
                e && $(b).hide();
                k.find("#" + r).triggerHandler("changeVaule");
                var g = a.check($(c));
                d(g)
            })
        },
        deleteFile: function(d) {
            d = d.parent();
            "true" != this.componentSetup.isSingle && 1 != this.componentSetup.isSingle || 1 != d.parents(".j_formFileContainer").children().length || d.parents(".field_js").find(".j_file_input").show();
            d.remove()
        }
    });
    u.exports = window.FileComponent
});
define("form/component/datecomponent", ["form/editablecomponent", "form/tplutil", "form/component/datetimepicker"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/datetimepicker");
    window.DateComponent = m.extend({
        initialize: function(f) {
            m.prototype.initialize.call(this, f);
            var d = {
                componentKey: "DateComponent",
                title: "\u65e5\u671f",
                format: "yyyy-MM-dd",
                isSystemDate: !1,
                earlyDate: !1,
                earlyType: "currentDay",
                earlySpecDate: "",
                earlyBeforeDay: "",
                earlyAfterDay: "",
                earlyBeforeMonth: "",
                earlyAfterMonth: "",
                earlyBeforeHour: "",
                earlyAfterHour: "",
                lateDate: !1,
                lateType: "currentDay",
                lateSpecDate: "",
                lateBeforeDay: "",
                lateAfterDay: "",
                lateBeforeMonth: "",
                lateAfterMonth: "",
                lateBeforeHour: "",
                lateAfterHour: ""
            };
            null != f && (d.title = f.title,
            d.format = f.format,
            d.isSystemDate = f.isSystemDate,
            d.isReadonly = f.isReadonly,
            d.isReadOnly = f.isReadonly,
            d.earlyDate = f.earlyDate,
            d.earlyType = f.earlyType,
            d.earlySpecDate = f.earlySpecDate,
            d.earlyBeforeDay = f.earlyBeforeDay,
            d.earlyAfterDay = f.earlyAfterDay,
            d.earlyBeforeMonth = f.earlyBeforeMonth,
            d.earlyAfterMonth = f.earlyAfterMonth,
            d.earlyBeforeHour = f.earlyBeforeHour,
            d.earlyAfterHour = f.earlyAfterHour,
            d.lateDate = f.lateDate,
            d.lateType = f.lateType,
            d.lateSpecDate = f.lateSpecDate,
            d.lateBeforeDay = f.lateBeforeDay,
            d.lateAfterDay = f.lateAfterDay,
            d.lateBeforeMonth = f.lateBeforeMonth,
            d.lateAfterMonth = f.lateAfterMonth,
            d.lateBeforeHour = f.lateBeforeHour,
            d.lateAfterHour = f.lateAfterHour);
            this.componentSetup = $.extend(this.componentSetup, d);
            this.tpl = h.get("date")
        },
        setFormat: function(f) {
            this.componentSetup.format = f
        },
        setIsSystemDate: function(f) {
            this.componentSetup.isSystemDate = f
        },
        setIsReadonly: function(f) {
            this.componentSetup.isReadonly = f;
            this.componentSetup.isReadOnly = f
        },
        setEarlyDate: function(f) {
            this.componentSetup.earlyDate = f
        },
        setEarlyType: function(f) {
            this.componentSetup.earlyType = f
        },
        setEarlySpecDate: function(f) {
            this.componentSetup.earlySpecDate = f
        },
        setEarlyBeforeDay: function(f) {
            this.componentSetup.earlyBeforeDay = f
        },
        setEarlyAfterDay: function(f) {
            this.componentSetup.earlyAfterDay = f
        },
        setEarlyBeforeMonth: function(f) {
            this.componentSetup.earlyBeforeMonth = f
        },
        setEarlyAfterMonth: function(f) {
            this.componentSetup.earlyAfterMonth = f
        },
        setEarlyBeforeHour: function(f) {
            this.componentSetup.earlyBeforeHour = f
        },
        setEarlyAfterHour: function(f) {
            this.componentSetup.earlyAfterHour = f
        },
        setLateDate: function(f) {
            this.componentSetup.lateDate = f
        },
        setLateType: function(f) {
            this.componentSetup.lateType = f
        },
        setLateSpecDate: function(f) {
            this.componentSetup.lateSpecDate = f
        },
        setLateBeforeDay: function(f) {
            this.componentSetup.lateBeforeDay = f
        },
        setLateAfterDay: function(f) {
            this.componentSetup.lateAfterDay = f
        },
        setLateBeforeMonth: function(f) {
            this.componentSetup.lateBeforeMonth = f
        },
        setLateAfterMonth: function(f) {
            this.componentSetup.lateAfterMonth = f
        },
        setLateBeforeHour: function(f) {
            this.componentSetup.lateBeforeHour = f
        },
        setLateAfterHour: function(f) {
            this.componentSetup.lateAfterHour = f
        },
        render: function(f) {
            var d = $(this.tpl).siblings("#form-date");
            m.prototype.render.call(this, f, d);
            f.html(d.html())
        },
        renderEditPreview: function(f) {
            var d = $(this.tpl).siblings("#form-date")
              , b = "";
            if ("yyyy-MM-dd" == this.componentSetup.format || "HH:mm:ss" == this.componentSetup.format || "YYYY-MM-DD" == this.componentSetup.format)
                b = "\u5e74-\u6708-\u65e5";
            else if ("yyyy-MM" == this.componentSetup.format || "YYYY-MM" == this.componentSetup.format)
                b = "\u5e74-\u6708";
            else if ("yyyy-MM-dd HH:mm" == this.componentSetup.format || "YYYY-MM-DD HH:mm:ss" == this.componentSetup.format || "YYYY-MM-DD HH:mm" == this.componentSetup.format)
                b = "\u5e74-\u6708-\u65e5 \u65f6:\u5206";
            d.find("input").attr("placeholder", b);
            m.prototype.renderEditPreview.call(this, f, d);
            f.append(d)
        },
        renderEditor: function() {
            var f = $(this.tpl).siblings("#editor-date")
              , d = this.componentSetup.format;
            f.find("input:radio[name\x3d'dateFormat'][value\x3d'" + d + "']").attr("checked", "true");
            var b = !1
              , c = !1;
            if ("true" == this.componentSetup.isSystemDate || 1 == this.componentSetup.isSystemDate)
                b = !0;
            if ("true" == this.componentSetup.isReadonly || 1 == this.componentSetup.isReadonly)
                c = !0;
            f.find("#systemDate").attr("checked", b);
            f.find("#readonly").attr("checked", c);
            b = f.find(".j_earlyContent");
            c = f.find(".j_latestContent");
            this.renderDateRuleConfig(d, b, c, this.componentSetup.earlyType, this.componentSetup.lateType, f);
            1 == this.componentSetup.earlyDate || "true" == this.componentSetup.earlyDate ? f.find("#earlyDate").attr("checked", !0) : f.find("#earlyDate").attr("checked", !1);
            1 == this.componentSetup.lateDate || "true" == this.componentSetup.lateDate ? f.find("#latestDate").attr("checked", !0) : f.find("#latestDate").attr("checked", !1);
            m.prototype.renderEditor.call(this, f);
            $("#editor-component").html(f.html())
        },
        renderPreview: function(f, d, b) {
            var c = $(this.tpl)
              , l = c.siblings("#preview-date");
            "mobile" == window.systemInfo_form && (l = c.siblings("#mobile-preview"));
            var e = "";
            if ("yyyy-MM-dd" == this.componentSetup.format || "HH:mm:ss" == this.componentSetup.format || "YYYY-MM-DD" == this.componentSetup.format)
                e = "\u5e74-\u6708-\u65e5",
                "mobile" == window.systemInfo_form && l.find(".j_date_selected").attr("format", "{yyyy}-{MM}-{dd}").attr("minview", 2).attr("startview", "month");
            else if ("yyyy-MM" == this.componentSetup.format || "YYYY-MM" == this.componentSetup.format)
                e = "\u5e74-\u6708",
                "mobile" == window.systemInfo_form && l.find(".j_date_selected").attr("format", "{yyyy}-{MM}").attr("minview", 3).attr("startview", "year");
            else if ("yyyy-MM-dd HH:mm" == this.componentSetup.format || "YYYY-MM-DD HH:mm:ss" == this.componentSetup.format || "YYYY-MM-DD HH:mm" == this.componentSetup.format)
                e = "\u5e74-\u6708-\u65e5 \u65f6:\u5206",
                "mobile" == window.systemInfo_form && l.find(".j_date_selected").attr("format", "{yyyy}-{MM}-{dd} {HH}:{mm}").attr("minview", 0).attr("startview", "month");
            l.find(".check_js").attr("placeholder", e);
            if ("true" == this.componentSetup.isReadonly || 1 == this.componentSetup.isReadonly)
                b = !0;
            var c = this.componentSetup.isSystemDate
              , e = this.componentSetup.format
              , a = new Date;
            c && $(document).trigger("currentTime", function(e) {
                a = new Date(e)
            });
            var k = !0;
            this.showUpcoming = this.showTomorrow = this.showToday = !0;
            var g = null
              , h = this.getStartDate()
              , q = this.getEndDate()
              , p = ""
              , w = ""
              , v = ""
              , s = new Date;
            if ("yyyy-MM-dd HH:mm" == e || "YYYY-MM-DD HH:mm:ss" == e || "YYYY-MM-DD HH:mm" == e)
                e = "yyyy-mm-dd hh:ii",
                g = Date.create(a.getTime()).format("{yyyy}-{MM}-{dd} {HH}:{mm}"),
                p = Date.create(s).format("{yyyy}-{MM}-{dd} {HH}:{mm}"),
                w = Date.create(s.setDate(s.getDate() + 1)).format("{yyyy}-{MM}-{dd} {HH}:{mm}"),
                v = Date.create(s.setDate(s.getDate() + 7)).format("{yyyy}-{MM}-{dd} {HH}:{mm}");
            else if ("yyyy-MM-dd" == e || "HH:mm:ss" == e || "YYYY-MM-DD" == e)
                e = "yyyy-mm-dd",
                g = Date.create(a.getTime()).format("{yyyy}-{MM}-{dd}"),
                p = Date.create(s).format("{yyyy}-{MM}-{dd}"),
                w = Date.create(s.setDate(s.getDate() + 1)).format("{yyyy}-{MM}-{dd}"),
                v = Date.create(s.setDate(s.getDate() + 7)).format("{yyyy}-{MM}-{dd}");
            else if ("yyyy-MM" == e || "YYYY-MM" == e)
                e = "yyyy-mm",
                g = Date.create(a.getTime()).format("{yyyy}-{MM}"),
                p = Date.create(s).format("{yyyy}-{MM}"),
                w = Date.create(s.setDate(s.getDate() + 1)).format("{yyyy}-{MM}"),
                v = Date.create(s.setDate(s.getDate() + 7)).format("{yyyy}-{MM}");
            null != h && null == q ? (p < h ? this.showToday = !1 : p >= h && (this.showToday = !0),
            w < h ? this.showTomorrow = !1 : w >= h && (this.showTomorrow = !0),
            v < h ? this.showUpcoming = !1 : v >= h && (this.showUpcoming = !0)) : null == h && null != q ? (p <= q ? this.showToday = !0 : p > q && (this.showToday = !1),
            w <= q ? this.showTomorrow = !0 : w > q && (this.showTomorrow = !1),
            v <= q ? this.showUpcoming = !0 : v >= q && (this.showUpcoming = !1)) : null != h && null != q && (p < h || p > q ? this.showToday = !1 : p >= h && p <= q && (this.showToday = !0),
            w < h || w > q ? this.showTomorrow = !1 : w >= h && w <= q && (this.showTomorrow = !0),
            v < h || v > q ? this.showUpcoming = !1 : v >= h && v <= q && (this.showUpcoming = !0));
            "mobile" == window.systemInfo_form && l.find(".j_date_selected").attr("startDate", h).attr("endDate", q).attr("showToday", this.showToday).attr("showTomorrow", this.showTomorrow).attr("showUpcoming", this.showUpcoming);
            var A = "month"
              , x = "month";
            0 <= e.indexOf("hh:ii") ? A = "hour" : 0 > e.indexOf("dd") && (x = A = "year",
            k = !1);
            if ("true" == c || 1 == c)
                l.find(".check_js").val(g),
                l.find(".j_readOnly").html(g);
            var n = ["someday"];
            1 != this.showToday && "true" != this.showToday || n.push("today");
            1 != this.showTomorrow && "true" != this.showTomorrow || n.push("tomorrow");
            1 != this.showUpcoming && "true" != this.showUpcoming || n.push("upcoming");
            if ("mobile" != window.systemInfo_form && "true" != b && 1 != b)
                l.find(".check_js").off("click").on("click", function() {
                    $(this).datetimepicker({
                        dateBtnGroup: n,
                        format: e,
                        language: "zh_CN",
                        todayHighlight: !0,
                        todayBtn: k,
                        autoclose: !0,
                        minView: A,
                        startDate: h,
                        endDate: q,
                        startView: x
                    });
                    $(this).datetimepicker("show");
                    formPlugin.moveDatetimepicker($(this))
                });
            d && (l.find(".check_js").val(""),
            l.find(".j_readOnly").parent(".form-timebox").addClass("form-timebox-nodata"),
            l.find(".j_readOnly").html(""));
            m.prototype.renderPreview.call(this, f, d, b, l);
            f.append(l)
        },
        getStartDate: function() {
            var f = null
              , d = this.componentSetup.format
              , b = this.componentSetup.earlyDate;
            if (0 == b || "false" == b)
                return f;
            var b = this.componentSetup.earlyType
              , c = new Date;
            if ("yyyy-MM-dd HH:mm" == d || "YYYY-MM-DD HH:mm:ss" == d || "YYYY-MM-DD HH:mm" == d)
                if ("currentHour" == b)
                    f = Date.create(c).format("{yyyy}-{MM}-{dd} {HH}:{mm}");
                else if ("specified" == b) {
                    d = this.componentSetup.earlySpecDate;
                    if (!d)
                        return f;
                    f = Date.create(d).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                } else if ("currentHourBefore" == b) {
                    d = this.componentSetup.earlyBeforeHour;
                    if (!d)
                        return f;
                    f = Date.create(this.getNewDate(d, "before", "hour")).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                } else {
                    if ("currentHourAfter" == b) {
                        d = this.componentSetup.earlyAfterHour;
                        if (!d)
                            return f;
                        f = Date.create(this.getNewDate(d, "after", "hour")).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                    }
                }
            else if ("yyyy-MM-dd" == d || "HH:mm:ss" == d || "YYYY-MM-DD" == d)
                if ("currentDay" == b)
                    f = Date.create(c).format("{yyyy}-{MM}-{dd}");
                else if ("specified" == b) {
                    d = this.componentSetup.earlySpecDate;
                    if (!d)
                        return f;
                    f = Date.create(d).format("{yyyy}-{MM}-{dd}")
                } else if ("currentDayBefore" == b) {
                    d = this.componentSetup.earlyBeforeDay;
                    if (!d)
                        return f;
                    f = Date.create(this.getNewDate(d, "before", "day")).format("{yyyy}-{MM}-{dd}")
                } else {
                    if ("currentDayAfter" == b) {
                        d = this.componentSetup.earlyAfterDay;
                        if (!d)
                            return f;
                        f = Date.create(this.getNewDate(d, "after", "day")).format("{yyyy}-{MM}-{dd}")
                    }
                }
            else if ("yyyy-MM" == d || "YYYY-MM" == d)
                if ("currentMonth" == b)
                    f = Date.create(c).format("{yyyy}-{MM}");
                else if ("specified" == b) {
                    d = this.componentSetup.earlySpecDate;
                    if (!d)
                        return f;
                    f = Date.create(d).format("{yyyy}-{MM}")
                } else if ("currentMonthBefore" == b) {
                    d = this.componentSetup.earlyBeforeMonth;
                    if (!d)
                        return f;
                    f = Date.create(this.getNewDate(d, "before", "month")).format("{yyyy}-{MM}")
                } else if ("currentMonthAfter" == b) {
                    d = this.componentSetup.earlyAfterMonth;
                    if (!d)
                        return f;
                    f = Date.create(this.getNewDate(d, "after", "month")).format("{yyyy}-{MM}-{dd}")
                }
            return f
        },
        getEndDate: function() {
            var f = null
              , d = this.componentSetup.format
              , b = this.componentSetup.lateDate;
            if (0 == b || "false" == b)
                return f;
            var b = this.componentSetup.lateType
              , c = new Date;
            if ("yyyy-MM-dd HH:mm" == d || "YYYY-MM-DD HH:mm:ss" == d || "YYYY-MM-DD HH:mm" == d)
                if ("currentHour" == b)
                    f = Date.create(c).format("{yyyy}-{MM}-{dd} {HH}:{mm}");
                else if ("specified" == b) {
                    d = this.componentSetup.lateSpecDate;
                    if (!d)
                        return f;
                    f = Date.create(d).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                } else if ("currentHourBefore" == b) {
                    d = this.componentSetup.lateBeforeHour;
                    if (!d)
                        return f;
                    f = Date.create(this.getNewDate(d, "before", "hour")).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                } else {
                    if ("currentHourAfter" == b) {
                        d = this.componentSetup.lateAfterHour;
                        if (!d)
                            return f;
                        f = Date.create(this.getNewDate(d, "after", "hour")).format("{yyyy}-{MM}-{dd} {HH}:{mm}")
                    }
                }
            else if ("yyyy-MM-dd" == d || "HH:mm:ss" == d || "YYYY-MM-DD" == d)
                if ("currentDay" == b)
                    f = Date.create(c).format("{yyyy}-{MM}-{dd}");
                else if ("specified" == b) {
                    d = this.componentSetup.lateSpecDate;
                    if (!d)
                        return f;
                    f = Date.create(d).format("{yyyy}-{MM}-{dd}")
                } else if ("currentDayBefore" == b) {
                    d = this.componentSetup.lateBeforeDay;
                    if (!d)
                        return f;
                    f = Date.create(this.getNewDate(d, "before", "day")).format("{yyyy}-{MM}-{dd}")
                } else {
                    if ("currentDayAfter" == b) {
                        d = this.componentSetup.lateAfterDay;
                        if (!d)
                            return f;
                        f = Date.create(this.getNewDate(d, "after", "day")).format("{yyyy}-{MM}-{dd}")
                    }
                }
            else if ("yyyy-MM" == d || "YYYY-MM" == d)
                if ("currentMonth" == b)
                    f = Date.create(c).format("{yyyy}-{MM}");
                else if ("specified" == b) {
                    d = this.componentSetup.lateSpecDate;
                    if (!d)
                        return f;
                    f = Date.create(d).format("{yyyy}-{MM}")
                } else if ("currentMonthBefore" == b) {
                    d = this.componentSetup.lateBeforeMonth;
                    if (!d)
                        return f;
                    f = Date.create(this.getNewDate(d, "before", "month")).format("{yyyy}-{MM}")
                } else if ("currentMonthAfter" == b) {
                    d = this.componentSetup.lateAfterMonth;
                    if (!d)
                        return f;
                    f = Date.create(this.getNewDate(d, "after", "month")).format("{yyyy}-{MM}-{dd}")
                }
            return f
        },
        renderStatSearch: function(f) {
            var d = $(this.tpl)
              , b = f.parentEl
              , c = f.container
              , l = f.term
              , e = f.format
              , a = null;
            if ("mobile" != window.systemInfo_form) {
                a = d.siblings("#statsearch-date");
                if (d = f.startValue)
                    e || (e = 16 == d.length ? "yyyy-MM-dd HH:mm" : 7 == d.length ? "yyyy-MM" : "yyyy-MM-dd"),
                    a.find("input:first").val(d);
                if (f = f.endValue)
                    e || (e = 16 == f.length ? "yyyy-MM-dd HH:mm" : 7 == f.length ? "yyyy-MM" : "yyyy-MM-dd"),
                    a.find("input:last").val(f);
                l && a.find("select:first option[value\x3d" + l + "]").attr("selected", "true");
                f = (new Date).getTime();
                a.find(".j_datetime").attr("id", "j_datetime" + f);
                b.attr("class", "sch-group j_formFieldSearchGroup");
                b.find(".j_formField-condition").html(a);
                var k = $(c + " #j_datetime" + f + " #startDate")
                  , g = $(c + " #j_datetime" + f + " #endDate");
                if ("yyyy-MM-dd HH:mm" == e || "YYYY-MM-DD HH:mm:ss" == e || "YYYY-MM-DD HH:mm" == e)
                    k.attr("format", "yyyy-mm-dd hh:ii"),
                    k.attr("minView", "hour"),
                    k.attr("startView", "month"),
                    k.attr("style", "width:150px;"),
                    g.attr("format", "yyyy-mm-dd hh:ii"),
                    g.attr("minView", "hour"),
                    g.attr("startView", "month"),
                    g.attr("style", "width:150px;");
                else if ("yyyy-MM-dd" == e || "HH:mm:ss" == e || "YYYY-MM-DD" == e)
                    k.attr("format", "yyyy-mm-dd"),
                    k.attr("minView", "month"),
                    k.attr("startView", "month"),
                    g.attr("format", "yyyy-mm-dd"),
                    g.attr("minView", "month"),
                    g.attr("startView", "month");
                else if ("yyyy-MM" == e || "YYYY-MM" == e)
                    k.attr("format", "yyyy-mm"),
                    k.attr("minView", "year"),
                    k.attr("startView", "year"),
                    g.attr("format", "yyyy-mm"),
                    g.attr("minView", "year"),
                    g.attr("startView", "year");
                formPlugin.datepicker({
                    el: c + " #j_datetime" + f + " #startDate",
                    callback: function(a) {
                        a = k.val();
                        g.val() && a > g.val() ? (formPlugin.notify("\u5f00\u59cb\u65e5\u671f\u4e0d\u80fd\u5927\u4e8e\u7ed3\u675f\u65e5\u671f"),
                        k.val("")) : k.val(a)
                    }
                });
                formPlugin.datepicker({
                    el: c + " #j_datetime" + f + " #endDate",
                    callback: function(a) {
                        a = g.val();
                        k.val() && a < k.val() ? (formPlugin.notify("\u7ed3\u675f\u65e5\u671f\u4e0d\u80fd\u5c0f\u4e8e\u5f00\u59cb\u65e5\u671f"),
                        g.val("")) : g.val(a)
                    }
                })
            } else {
                var a = d.siblings("#statsearch-date-mobile")
                  , h = f.fieldId
                  , c = f.fieldTitle
                  , e = f.subFormId
                  , l = f.filterEl;
                f = f.condition;
                l && (d = l.find(".j_filterList .selectd #comp-val span").eq(0).text(),
                l = l.find(".j_filterList .selectd #comp-val span").eq(1).text(),
                a.find(".j_compVal").eq(0).val(d),
                a.find(".j_compVal").eq(1).val(l));
                f && (a.find(".j_condition").find('option[value\x3d"' + f + '"]').attr("selected", !0),
                "null" != f && "notnull" != f || a.find(".j_control").hide());
                a.find(".j_inputName").text(c + ":");
                b.find("#component-div").html(a);
                a.find("#startDate").attr("id", "startDate" + h);
                a.find("#endDate").attr("id", "endDate" + h);
                b.find(".j_comp-ok").attr("comKey", "DateComponent").attr("fieldId", h).attr("title", c).attr("subFormId", e);
                b.off("change", "#statsearch-date-mobile .j_condition").on("change", "#statsearch-date-mobile .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? b.find("#statsearch-date-mobile .j_control").hide() : b.find("#statsearch-date-mobile .j_control").show()
                });
                b.off("dateConfirm", "#startDate" + h).on("dateConfirm", "#startDate" + h, function(a, e) {
                    var c = e.date
                      , d = b.find("#statsearch-date-mobile #startDate" + h).val()
                      , f = new Date(c)
                      , k = new Date(d);
                    null != d && "" != d && f.getTime() > k.getTime() ? (formPlugin.notify("\u5f00\u59cb\u65e5\u671f\u4e0d\u80fd\u5927\u4e8e\u7ed3\u675f\u65e5\u671f"),
                    b.find("#statsearch-date-mobile #startDate" + h).val("")) : b.find("#statsearch-date-mobile #startDate" + h).val(c)
                });
                b.off("dateConfirm", "#endDate" + h).on("dateConfirm", "#endDate" + h, function(a, e) {
                    var c = e.date
                      , d = b.find("#statsearch-date-mobile #startDate" + h).val()
                      , d = new Date(d)
                      , f = new Date(c);
                    null != c && "" != c && f.getTime() < d.getTime() ? (formPlugin.notify("\u7ed3\u675f\u65e5\u671f\u4e0d\u80fd\u5c0f\u4e8e\u5f00\u59cb\u65e5\u671f"),
                    b.find("#statsearch-date-mobile #endDate" + h).val("")) : b.find("#statsearch-date-mobile #endDate" + h).val(c)
                })
            }
        },
        checkEvents: function(f) {
            var d = this
              , b = d.el || $(document);
            b.on("change", "input[componentKey\x3d'DateComponent'][id\x3d'" + (d.componentSetup.fieldId || d.componentSetup.tempId) + "'][cid\x3d'" + this.cid + "']", function() {
                var c = d.check($(this));
                f(c)
            });
            "mobile" == window.systemInfo_form && (b.on("dateConfirm", "input[id\x3d'" + (d.componentSetup.fieldId || d.componentSetup.tempId) + "'][cid\x3d'" + d.cid + "']", function(c, b) {
                $(this).val(b.date);
                var e = d.check($(this));
                f(e)
            }),
            $("body").off("tap", ".j_date_selected").on("tap", ".j_date_selected", function(c) {
                c = document.body.scrollTop;
                var b = $(this).parents(".j_page-view")
                  , e = $(this).attr("format")
                  , a = $(this).attr("minview")
                  , d = $(this).attr("startview")
                  , f = b.attr("id")
                  , h = $(this).attr("startDate")
                  , q = $(this).attr("endDate")
                  , p = $(this).attr("showToday")
                  , w = $(this).attr("showTomorrow")
                  , m = $(this).attr("showUpcoming");
                (new g({
                    showToday: p,
                    showTomorrow: w,
                    showUpcoming: m,
                    el: $(this),
                    format: e,
                    minView: a,
                    startView: d,
                    startDate: h,
                    endDate: q,
                    scrollvalue: c,
                    preEl: "#" + f
                })).render();
                setTimeout(function() {
                    b.addClass("hide")
                }, 500)
            }))
        },
        autoSaveEvents: function(f) {
            var d = this
              , b = d.el || $(document);
            if ("mobile" == window.systemInfo_form)
                b.on("dateConfirm", "input[id\x3d'" + d.componentSetup.fieldId + "'][cid\x3d'" + d.cid + "']", function(c, b) {
                    d.saveComponentValue($(this), f)
                });
            else
                b.on("change", "input[id\x3d'" + d.componentSetup.fieldId + "'][cid\x3d'" + d.cid + "']", function() {
                    d.saveComponentValue($(this), f)
                })
        },
        check: function(f) {
            var d = $.trim(f.val())
              , b = f.attr("placeholder")
              , c = {};
            c.element = f;
            d == b && (d = "");
            "" != d || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (c.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            return c
        },
        getValue: function(f, d) {
            var b = $.trim(f.val())
              , c = f.attr("placeholder")
              , l = {
                formField: {
                    id: this.componentSetup.fieldId
                },
                content: b
            };
            return "" != b && b != c || d ? l : null
        },
        setValue: function(f, d) {
            if (null != d) {
                var b = d.content;
                f.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val(b);
                f.find(".j_readOnly").html(b)
            }
        },
        empty: function(f) {
            f.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val("");
            f.find(".j_readOnly").html("")
        },
        readOnly: function(f, d) {
            var b = f.find("input[id\x3d'" + this.componentSetup.fieldId + "'][cid\x3d'" + this.cid + "']")
              , b = this.isMobileForm ? b.parent() : b;
            "true" == d || 1 == d ? (b.addClass("hide").attr("disabled", d),
            b.siblings(".j_readOnly").removeClass("hide"),
            0 == b.siblings(".j_readOnly").text().length && b.siblings(".j_readOnly").parent(".form-timebox").addClass("form-timebox-nodata")) : (b.removeClass("hide"),
            b.siblings(".j_readOnly").addClass("hide"))
        },
        getNewDate: function(f, d, b) {
            var c = new Date;
            "before" == d ? "hour" == b ? c.setHours(c.getHours() - parseInt(f)) : "day" == b ? c.setDate(c.getDate() - parseInt(f)) : "month" == b && c.setMonth(c.getMonth() - parseInt(f)) : "after" == d && ("hour" == b ? c.setHours(c.getHours() + parseInt(f)) : "day" == b ? c.setDate(c.getDate() + parseInt(f)) : "month" == b && c.setMonth(c.getMonth() + parseInt(f)));
            return c
        },
        renderDateRuleConfig: function(f, d, b, c, l, e) {
            var a = ""
              , k = "";
            1 != this.componentSetup.earlyDate && "true" != this.componentSetup.earlyDate || d.removeClass("hide");
            1 != this.componentSetup.lateDate && "true" != this.componentSetup.lateDate || b.removeClass("hide");
            if ("yyyy-MM-dd" == f || "HH:mm:ss" == f || "YYYY-MM-DD" == f)
                a = e.find("#option-clone .j_nyr_config").clone(),
                k = e.find("#option-clone .j_nyr_config").clone(),
                d.empty().append(a),
                b.empty().append(k),
                "currentDay" == c ? (d.find(".j_specDate").addClass("hide"),
                d.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == c ? (d.find(".j_specDate").removeClass("hide"),
                d.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.earlySpecDate && d.find(".j_specDate input").attr("value", this.componentSetup.earlySpecDate)) : "currentDayBefore" == c ? (d.find(".j_specDate").addClass("hide"),
                d.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.earlyBeforeDay && d.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.earlyBeforeDay)) : "currentDayAfter" == c && (d.find(".j_specDate").addClass("hide"),
                d.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.earlyAfterDay && d.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.earlyAfterDay)),
                "currentDay" == l ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == l ? (b.find(".j_specDate").removeClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.lateSpecDate && b.find(".j_specDate input").attr("value", this.componentSetup.lateSpecDate)) : "currentDayBefore" == l ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.lateBeforeDay && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.lateBeforeDay)) : "currentDayAfter" == l && (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.lateAfterDay && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.lateAfterDay));
            else if ("yyyy-MM" == f || "YYYY-MM" == f)
                a = e.find("#option-clone .j_ny_config").clone(),
                k = e.find("#option-clone .j_ny_config").clone(),
                d.empty().append(a),
                b.empty().append(k),
                "currentMonth" == c ? (d.find(".j_specDate").addClass("hide"),
                d.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == c ? (d.find(".j_specDate").removeClass("hide"),
                d.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.earlySpecDate && d.find(".j_specDate input").attr("value", this.componentSetup.earlySpecDate)) : "currentMonthBefore" == c ? (d.find(".j_specDate").addClass("hide"),
                d.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.earlyBeforeMonth && d.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.earlyBeforeMonth)) : "currentMonthAfter" == c && (d.find(".j_specDate").addClass("hide"),
                d.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.earlyAfterMonth && d.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.earlyAfterMonth)),
                "currentMonth" == l ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == l ? (b.find(".j_specDate").removeClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.lateSpecDate && b.find(".j_specDate input").attr("value", this.componentSetup.lateSpecDate)) : "currentMonthBefore" == l ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.lateBeforeMonth && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.lateBeforeMonth)) : "currentMonthAfter" == l && (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.lateAfterMonth && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.lateAfterMonth));
            else if ("yyyy-MM-dd HH:mm" == f || "YYYY-MM-DD HH:mm:ss" == f || "YYYY-MM-DD HH:mm" == f)
                a = e.find("#option-clone .j_nyrsf_config").clone(),
                k = e.find("#option-clone .j_nyrsf_config").clone(),
                d.empty().append(a),
                b.empty().append(k),
                "currentHour" == c ? (d.find(".j_specDate").addClass("hide"),
                d.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == c ? (d.find(".j_specDate").removeClass("hide"),
                d.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.earlySpecDate && d.find(".j_specDate input").attr("value", this.componentSetup.earlySpecDate)) : "currentHourBefore" == c ? (d.find(".j_specDate").addClass("hide"),
                d.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.earlyBeforeHour && d.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.earlyBeforeHour)) : "currentHourAfter" == c && (d.find(".j_specDate").addClass("hide"),
                d.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.earlyAfterHour && d.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.earlyAfterHour)),
                "currentHour" == l ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide")) : "specified" == l ? (b.find(".j_specDate").removeClass("hide"),
                b.find(".j_beforeOrAfterNum").addClass("hide"),
                this.componentSetup.lateSpecDate && b.find(".j_specDate input").attr("value", this.componentSetup.lateSpecDate)) : "currentHourBefore" == l ? (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.lateBeforeHour && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.lateBeforeHour)) : "currentHourAfter" == l && (b.find(".j_specDate").addClass("hide"),
                b.find(".j_beforeOrAfterNum").removeClass("hide"),
                this.componentSetup.lateAfterHour && b.find(".j_beforeOrAfterNum input").attr("value", this.componentSetup.lateAfterHour));
            d.find('select option[value\x3d"' + c + '"]').attr("selected", !0);
            b.find('select option[value\x3d"' + l + '"]').attr("selected", !0)
        }
    });
    u.exports = window.DateComponent
});
define("form/component/radiobox", ["form/editablecomponent", "form/tplutil", "form/component/option", "form/componentmodel"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/option")
      , f = n("form/componentmodel");
    window.RadioBox = m.extend({
        initialize: function(d) {
            m.prototype.initialize.call(this, d);
            var b = {
                componentKey: "RadioBox",
                title: "\u5355\u9009\u6846",
                layout: "choicelist-inline",
                options: []
            };
            null != d && (b.title = d.title,
            b.layout = d.layout,
            b.options = d.options);
            this.componentSetup = $.extend(this.componentSetup, b);
            if (!this.componentSetup.options || 0 == this.componentSetup.options.length) {
                d = new g;
                d.setName("\u9009\u98791");
                d.setOrder(0);
                b = new g;
                b.setName("\u9009\u98792");
                b.setOrder(1);
                var c = new g;
                c.setName("\u9009\u98793");
                c.setOrder(2);
                this.componentSetup.options = [];
                this.componentSetup.options[0] = d.componentSetup;
                this.componentSetup.options[1] = b.componentSetup;
                this.componentSetup.options[2] = c.componentSetup
            }
            this.tpl = h.get("radiobox", {
                isMobileForm: this.isMobileForm
            });
            this.componentModel = new f
        },
        setLayout: function(d) {
            this.componentSetup.layout = d
        },
        setOptions: function(d) {
            this.componentSetup.options = d
        },
        layoutCheck: function() {
            for (var d = !1, b = this.componentSetup.options, c = [], f = 0; f < b.length; f++) {
                var e = b[f];
                0 != e.other && "false" != e.other || "" == e.name.trim() || c.push(e.name.trim())
            }
            b = c.sort();
            for (f = 0; f < b.length; f++)
                if (b[f] == b[f + 1]) {
                    d = !0;
                    break
                }
            if (d)
                throw formPlugin.notify("\u9009\u9879\u540d\u79f0\u5b58\u5728\u91cd\u590d"),
                $("#widget-control").find(".field_js").removeClass("field-active"),
                $("#widget-control").find('.field_js[componentKey\x3d"' + this.componentSetup.componentKey + '"][tempId\x3d"' + this.componentSetup.tempId + '"]').addClass("field-active"),
                $("#formEdit_js").find("#edit-form").addClass("hide"),
                $("#formEdit_js").find("#edit-widget").removeClass("hide"),
                this.renderEditor(),
                Error();
        },
        render: function(d) {
            var b = this
              , c = $(this.tpl).siblings("#form-radiobox");
            this.componentSetup.formId = $("#formId").val();
            m.prototype.render.call(this, d, c);
            var f = c.find(".choicelist_js");
            f.addClass(this.componentSetup.layout);
            if (this.componentSetup.options && 0 < this.componentSetup.options.length) {
                f.html("");
                for (var e = 0; e < this.componentSetup.options.length; e++)
                    (new g(this.componentSetup.options[e])).render(f, this)
            } else
                f.html("\x3cli class\x3d'j_no_option'\x3e\u8bf7\u5728\u53f3\u4fa7\u6dfb\u52a0\u9009\u9879\x3c/li\x3e");
            "RadioBox" == this.componentSetup.componentKey && (b.componentSetup.tempId ? d.attr("tempId", b.componentSetup.tempId) : this.componentModel.generatorId(function(a) {
                a = a.generatorId;
                b.componentSetup.tempId = a;
                d.attr("tempId", a)
            }));
            d.html(c.html())
        },
        renderEditPreview: function(d, b) {
            var c = $(this.tpl).siblings("#form-radiobox");
            m.prototype.renderEditPreview.call(this, d, c);
            var f = c.find(".choicelist_js");
            f.addClass(this.componentSetup.layout);
            var e = this.componentSetup.options;
            if (null != e && 0 < e.length) {
                f.html("");
                for (var a = 0; a < e.length; a++)
                    (new g(e[a])).render(f, this)
            } else
                f.html("\x3cli class\x3d'j_no_option'\x3e\u8bf7\u5728\u53f3\u4fa7\u6dfb\u52a0\u9009\u9879\x3c/li\x3e");
            b ? d.replaceWith(c) : d.append(c)
        },
        renderEditor: function() {
            var d = $(this.tpl).siblings("#editor-radiobox");
            m.prototype.renderEditor.call(this, d);
            d.find("input:radio[name\x3d'componentType'][value\x3d'" + this.componentSetup.componentKey + "']").attr("checked", "true");
            d.find("input:radio[name\x3d'layout'][value\x3d'" + this.componentSetup.layout + "']").attr("checked", "true");
            for (var b = d.find("ul.choicelistEdit_js"), c = 0; c < this.componentSetup.options.length; c++) {
                var f = this.componentSetup.options[c];
                (new g(f)).renderEditor(b, this);
                "true" != f.other && 1 != f.other || d.find(".btn-default_js").parent().hide()
            }
            $("#editor-component").html(d.html());
            this.optionDrag()
        },
        optionDrag: function() {
            var d = this
              , b = $("#editor-component");
            b.find(".choicelistEdit_js").mousedown(function() {
                document.activeElement.blur()
            });
            b.find(".choicelistEdit_js").sortable({
                cursor: "move",
                scroll: !1,
                containment: "#editor-component",
                placeholder: "combo-select-placeholder",
                items: ".RadioBox_js",
                connectWith: ".choicelistEdit_js",
                update: function(c, f) {
                    f.item.data("update", !0);
                    for (var e = [], a = b.find("ul.choicelistEdit_js li"), k = 0; k < a.length; k++)
                        for (var g = $(a[k]), g = g.find(".option_js").attr("uid"), h = 0; h < d.componentSetup.options.length; h++) {
                            var q = d.componentSetup.options[h]
                              , p = q.uid;
                            if (g) {
                                if (g == p) {
                                    q.order = k;
                                    e.push(q);
                                    break
                                }
                            } else if (1 == q.other || "true" == q.other) {
                                e.push(q);
                                break
                            }
                        }
                    d.componentSetup.options = e;
                    e = $("#widget-control .field-active").find(".choicelist_js li");
                    for (a = 0; a < e.length; a++)
                        g = $(e[a]),
                        g.find("span").text(d.componentSetup.options[a].name)
                },
                receive: function(c, b) {
                    b.item.data("receive", !0)
                },
                stop: function(c, b) {
                    b.item.data("update") && (b.item.data("update", !1),
                    b.item.data("receive") && b.item.data("receive", !1))
                }
            })
        },
        renderPreview: function(d, b, c) {
            var f = $(this.tpl).siblings("#preview-radiobox")
              , e = f.find(".choicelist_js");
            e.addClass(this.componentSetup.layout);
            for (var a = 0; a < this.componentSetup.options.length; a++)
                (new g(this.componentSetup.options[a])).renderPreview(e, this);
            b && (f.find(".check_js input:radio").attr("checked", !1),
            f.find(".check_js .j_ico").removeClass("checked"));
            "true" != this.componentSetup.isReadOnly && 1 != this.componentSetup.isReadOnly || f.find(".check_js input:radio").attr("disabled", !0);
            m.prototype.renderPreview.call(this, d, b, c, f);
            d.append(f)
        },
        change: function(d) {
            var b = d.oldObj;
            d = d.changeEl;
            this.componentSetup.title = b.componentSetup.title;
            this.componentSetup.describe = b.componentSetup.describe;
            this.componentSetup.order = b.componentSetup.order;
            this.componentSetup.index = b.componentSetup.index;
            this.componentSetup.required = b.componentSetup.required;
            this.componentSetup.fieldId = b.componentSetup.fieldId;
            this.componentSetup.tempId = b.componentSetup.tempId;
            this.componentSetup.layout = null == b.componentSetup.layout || "" == b.componentSetup.layout ? "choicelist-inline" : b.componentSetup.layout;
            this.componentSetup.options = b.componentSetup.options;
            this.render(d)
        },
        renderStatSearch: function(d) {
            var b = this
              , c = d.fieldId
              , f = d.subFormId
              , e = d.fieldTitle
              , a = d.parentEl
              , k = d.filterEl
              , g = d.condition
              , h = b.unique(d.ids)
              , q = d.term
              , p = {
                fieldId: c,
                componentModule: d.componentModule
            };
            d = window.getdatastaturl({
                module: d.module
            }, "/findFiledOptions.json");
            $.ajax({
                type: TEAMS.ajaxMethod,
                url: d,
                dataType: "json",
                async: !1,
                data: p,
                success: function(d) {
                    "mobile" != window.systemInfo_form ? b.pcStatSearch(a, h, q, d) : b.mobileStatSearch(c, e, a, h, q, d, f, k, g)
                }
            })
        },
        pcStatSearch: function(d, b, c, f) {
            for (var e = $(this.tpl).siblings("#statsearch-radiobox"), a = e.find(".j_resultList"), k = 0; k < f.fieldOptions.length; k++) {
                var g = f.fieldOptions[k]
                  , h = g.name
                  , q = g.id
                  , g = g["delete"]
                  , p = $(a.find("option")[0]).clone();
                p.attr("id", q).text(h);
                1 != g && "true" != g || p.addClass("finished-line").attr("id", q).text(h);
                a.append(p)
            }
            d.attr("class", "sch-group j_formFieldSearchGroup");
            d.find(".j_formField-condition").html("").append(e);
            if (b)
                for (k = 0; k < b.length; k++)
                    e = '\x3cspan class\x3d"entity-item"\x3e\x3ca id\x3d"' + b[k].id + '" title\x3d"' + b[k].text + '"\x3e' + b[k].text + "\x3c/a\x3e\x3c/span\x3e",
                    d.find(".j_formField-condition .entity-container").append(e);
            c && d.find(".j_formField-condition select:first option[value\x3d" + c + "]").attr("selected", "true")
        },
        mobileStatSearch: function(d, b, c, f, e, a, k, g, h) {
            var q = $(this.tpl).siblings("#statsearch-radiobox-mobile");
            h && (q.find(".j_condition").find('option[value\x3d"' + h + '"]').attr("selected", !0),
            "null" != h && "notnull" != h || q.find(".j_control").hide());
            g && (q.find("#seleted-list").empty(),
            g.find(".j_filterList .selectd #comp-val span").each(function() {
                var a = $(this).attr("optionId")
                  , e = $(this).text()
                  , c = $("\x3cspan\x3e\x3c/span\x3e");
                c.attr("id", a).text(e);
                q.find("#seleted-list").append(c)
            }));
            q.find(".j_optionUl").empty();
            q.find("#seleted-list").attr("fieldId", d);
            for (f = 0; f < a.fieldOptions.length; f++) {
                e = a.fieldOptions[f];
                g = e.name;
                h = e.id;
                var p = q.find("#li-clone li").clone();
                0 < q.find("#seleted-list").find("#" + h).length && p.addClass("selected");
                p.find(".j_optionname").text(g);
                p.attr("id", h);
                p.data("fieldOption", e);
                q.find(".j_optionUl").append(p)
            }
            c.find("#component-div").html(q);
            c.find(".j_comp-ok").attr("comKey", "RadioBox").attr("fieldId", d).attr("title", b).attr("subFormId", k);
            c.off("change", "#statsearch-radiobox-mobile .j_condition").on("change", "#statsearch-radiobox-mobile .j_condition", function() {
                var a = $(this).val();
                "null" == a || "notnull" == a ? c.find("#statsearch-radiobox-mobile .j_control").hide() : c.find("#statsearch-radiobox-mobile .j_control").show()
            });
            c.off("tap", "#statsearch-radiobox-mobile .j_optionli").on("tap", "#statsearch-radiobox-mobile .j_optionli", function() {
                var a = $(this);
                a.hasClass("selected") ? a.removeClass("selected") : a.addClass("selected");
                var e = a.data("fieldOption")
                  , a = e.id
                  , e = '\x3cspan id\x3d"' + a + '"\x3e' + e.name + "\x3c/span\x3e";
                0 < c.find("#statsearch-radiobox-mobile #seleted-list #" + a).length ? c.find("#statsearch-radiobox-mobile #seleted-list #" + a).remove() : c.find("#statsearch-radiobox-mobile #seleted-list").append(e)
            })
        },
        checkEvents: function(d) {
            var b = this
              , c = b.el || $(document);
            c.on("change", "input:radio[name\x3d'" + b.componentSetup.fieldId + this.cid + "']", function(c, e) {
                var a = $(this).parents(".check_js")
                  , f = $(this).data("componentData");
                "true" == f.componentSetup.other || 1 == f.componentSetup.other ? $(this).is(":checked") && a.find("input:text").attr("disabled", !1).show() : a.find("input:text").attr("disabled", !0).hide();
                e && 0 == e.isCheck ? d({
                    element: a
                }) : (a = b.check(a),
                d(a))
            });
            if ("mobile" == window.systemInfo_form)
                c.on("click", "input:radio", function() {
                    $(this).parent().siblings(".j_ico").addClass("checked").parents(".RadioBox_js").siblings().find(".j_ico").removeClass("checked")
                })
        },
        autoSaveEvents: function(d) {
            var b = this
              , c = b.el || $(document);
            c.on("change", "#" + b.componentSetup.fieldId + "[cid\x3d'" + this.cid + "'] input:text", function() {
                b.saveComponentValue($(this), d)
            });
            c.on("change", "input:radio[name\x3d'" + b.componentSetup.fieldId + this.cid + "']", function(c) {
                if (c.isTrigger)
                    return !0;
                b.saveComponentValue($(this), d)
            })
        },
        check: function(d) {
            var b = d.find("input:radio[name\x3d'" + this.componentSetup.fieldId + this.cid + "']:checked").val()
              , c = {};
            c.element = d;
            "" != b && null != b || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (c.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            return c
        },
        getValue: function(d, b) {
            var c = {
                formField: {
                    id: this.componentSetup.fieldId
                }
            }
              , f = d.find("input:radio[name\x3d'" + this.componentSetup.fieldId + this.cid + "']:checked")
              , e = f.val();
            if (null == f.get(0))
                return null;
            var f = f.data("componentData")
              , a = "";
            "true" == f.componentSetup.other || 1 == f.componentSetup.other ? (a = d.find("input:text").val(),
            0 == a.length && (a = "\u5176\u4ed6")) : a = f.componentSetup.name;
            c.dataOptions = [{
                optionId: e,
                content: a
            }];
            return null != e && "" != $.trim(e) || b ? c : null
        },
        setValue: function(d, b) {
            if (null != b && null != b.dataOptions)
                for (var c = 0; c < b.dataOptions.length; c++) {
                    var f = b.dataOptions[c]
                      , e = f.optionId
                      , m = d.find(".choicelist")
                      , n = f.content
                      , a = null
                      , a = b.isMacthByName ? d.find("span").filter(function() {
                        return $(this).text() == f.content
                    }).prev() : d.find("input:radio[name\x3d'" + this.componentSetup.fieldId + this.cid + "'][value\x3d'" + e + "']")
                      , e = a.get(0);
                    m.find(".RadioBox_js span").filter(function() {
                        if($(this).text() == f.content) {
                            $(this).siblings('input').get(0).checked = !0;
                        }
                    })
                    
                    if (!e)
                        break;
                    e.checked = !0;
                    var k = a.data("componentData").componentSetup.other;
                    "true" == k || 1 == k ? (d.find("input:text").val(f.content).show(),
                    d.find(".j_readOnly").html(f.content)) : d.find(".j_readOnly").html(a.next().text());
                    $(e).parent().siblings(".j_ico").addClass("checked")
                }
        },
        empty: function(d) {
            d.find("input:radio").each(function() {
                this.checked = !1
            });
            d.find(".j_ico").removeClass("checked");
            d.find(".j_readOnly").html("");
            d.find("input:text").val("").hide()
        },
        readOnly: function(d, b) {
            d.find("input:radio[name\x3d'" + this.componentSetup.fieldId + this.cid + "']");
            b ? (d.find(".check_js").addClass("hide"),
            d.find(".j_readOnly").removeClass("hide")) : (d.find(".check_js").removeClass("hide"),
            d.find(".j_readOnly").addClass("hide"))
        }
    });
    u.exports = window.RadioBox
});
define("form/component/department", ["form/editablecomponent", "form/tplutil", "form/component/departselecter", "form/abposview"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/departselecter")
      , f = n("form/abposview");
    window.Department = m.extend({
    });
    u.exports = window.Department
});
define("form/component/customercomponent", "form/relatecomponent form/tplutil form/componentmodel form/component/entityselecter form/component/customerlist form/component/typeahead form/component/relevancecontrol form/abposview".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel")
      , f = n("form/component/entityselecter")
      , d = n("form/component/customerlist")
      , b = n("form/component/typeahead")
      , c = n("form/component/relevancecontrol")
      , l = n("form/abposview");
    window.CustomerComponent = m.extend({
    });
    u.exports = window.CustomerComponent
});
define("form/component/relatefieldconfig", ["form/form-plugin", "form/tplutil"], function(n, y, u) {
    n("form/form-plugin");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/numbercomponent", ["form/editablecomponent", "form/tplutil", "form/componentmodel"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel");
    window.NumberComponent = m.extend({
        initialize: function(f) {
            m.prototype.initialize.call(this, f);
            var d = {
                componentKey: "NumberComponent",
                title: "\u6570\u5b57\u8f93\u5165\u6846",
                tempId: 0,
                numberType: "number",
                pointSize: "",
                isCapital: !1,
                minNum: "",
                maxNum: ""
            };
            null != f && (d.title = f.title,
            d.tempId = f.tempId || f.fieldId,
            d.pointSize = f.pointSize,
            d.numberType = f.numberType || "number",
            d.isCapital = f.isCapital,
            d.minNum = f.minNum,
            d.maxNum = f.maxNum);
            this.componentSetup = $.extend(this.componentSetup, d);
            this.tpl = h.get("numbercomponent", {
                isMobileForm: this.isMobileForm
            });
            this.componentModel = new g
        },
        setPointSize: function(f) {
            this.componentSetup.pointSize = f
        },
        setIsCapital: function(f) {
            this.componentSetup.isCapital = f
        },
        setMinNum: function(f) {
            this.componentSetup.minNum = f
        },
        setMaxNum: function(f) {
            this.componentSetup.maxNum = f
        },
        render: function(f) {
            var d = this
              , b = $(this.tpl).siblings("#form-number");
            m.prototype.render.call(this, f, b);
            this.componentModel.generatorId(function(c) {
                c = c.generatorId;
                d.componentSetup.tempId = c;
                f.attr("tempId", c)
            });
            f.html(b.html())
        },
        renderEditPreview: function(f) {
            var d = $(this.tpl).siblings("#form-number");
            m.prototype.renderEditPreview.call(this, f, d);
            d.attr("tempId", this.componentSetup.fieldId);
            "percentage" == this.componentSetup.numberType ? ($(d).find("#type-item").removeClass("hide"),
            $(d).find("#type-item").parent().find(".field-value_js").css("padding-right", "50px")) : "number" == this.componentSetup.numberType && $(d).find("#type-item").parent().find(".field-value_js").css("padding-right", "10px");
            f.append(d)
        },
        renderEditor: function() {
            var f = $(this.tpl).siblings("#editor-number")
              , d = this.componentSetup.pointSize;
            "" != d && null != d && "sel" != d ? f.find(".j_number_point-select option[value\x3d'" + d + "']").attr("selected", !0) : f.find(".j_number_point-select option[value\x3d'sel']").attr("selected", !0);
            "percentage" == this.componentSetup.numberType ? f.find(".j_isCapital_Div").addClass("hide") : f.find(".j_isCapital_Div").removeClass("hide");
            d = this.componentSetup.isCapital;
            1 != d && "true" != d || f.find("#isCapital").attr("checked", "true");
            var d = this.componentSetup.minNum
              , b = this.componentSetup.maxNum;
            null != b && "" != b && f.find("#text-max-num").attr("value", b);
            null != d && "" != d && f.find("#text-min-num").attr("value", d);
            m.prototype.renderEditor.call(this, f);
            $("#editor-component").html(f.html())
        },
        renderPreview: function(f, d, b) {
            var c = $(this.tpl).siblings("#preview-number");
            c.attr("tempId", "field_" + (this.componentSetup.fieldId || this.componentSetup.tempId));
            c.attr("fieldId", this.componentSetup.fieldId || this.componentSetup.tempId);
            d && c.find(".check_js").val("");
            c.find(".form-control").attr("placeholder", null == this.componentSetup.placeholder || 1 > this.componentSetup.placeholder.length ? "\u8bf7\u586b\u5199" + this.componentSetup.title : this.componentSetup.placeholder);
            "percentage" == this.componentSetup.numberType ? ($(c).find("#type-item").removeClass("hide"),
            $(c).find("#type-item").parent().find(".input-instead").addClass("input-instead-border"),
            $(c).find("#type-item").parent().find(".field-value_js").css("padding-right", "50px")) : "number" == this.componentSetup.numberType && $(c).find("#type-item").parent().find(".field-value_js").css("padding-right", "10px");
            m.prototype.renderPreview.call(this, f, d, b, c);
            if ("true" == this.componentSetup.isDefault || 1 == this.componentSetup.isDefault)
                d = this.componentSetup.isCapital,
                1 != d && "true" != d || "mobile" == window.systemInfo_form || (d = this.numberToChinese(this.componentSetup.content),
                c.find(".j_capital_num").text(d).removeClass("hide-im"));
            f.append(c)
        },
        renderStatSearch: function(f) {
            var d = $(this.tpl)
              , b = f.endValue
              , c = f.parentEl
              , l = f.term
              , e = null;
            if ("mobile" != window.systemInfo_form)
                e = d.siblings("#statsearch-number"),
                (f = f.startValue) && e.find("input:first").val(f),
                b && e.find("input:last").val(b),
                l && e.find("select:first option[value\x3d" + l + "]").attr("selected", "true"),
                c.attr("class", "sch-group j_formFieldSearchGroup"),
                c.find(".j_formField-condition").html(e);
            else {
                var e = d.siblings("#statsearch-number-mobile")
                  , b = f.fieldId
                  , l = f.fieldTitle
                  , d = f.subFormId
                  , a = f.filterEl;
                f = f.condition;
                if (a) {
                    var k = a.find(".j_filterList .selectd #comp-val span").eq(0).text()
                      , a = a.find(".j_filterList .selectd #comp-val span").eq(1).text();
                    e.find(".j_numberCheck").eq(0).val(k);
                    e.find(".j_numberCheck").eq(1).val(a)
                }
                f && (e.find(".j_condition").find('option[value\x3d"' + f + '"]').attr("selected", !0),
                "null" != f && "notnull" != f || e.find(".j_control").hide());
                e.find(".j_inputName").text(l + ":");
                c.find("#component-div").html(e);
                c.find(".j_comp-ok").attr("comKey", "NumberComponent").attr("fieldId", b).attr("title", l).attr("subFormId", d);
                c.off("change", "#statsearch-number-mobile .j_condition").on("change", "#statsearch-number-mobile .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? c.find("#statsearch-number-mobile .j_control").hide() : c.find("#statsearch-number-mobile .j_control").show()
                });
                c.on("keydown", ".j_numberCheck", function(a) {
                    a = parseInt(a.keyCode);
                    var e = $(this).val();
                    if ((110 == a || 190 == a) && 0 <= e.indexOf(".") || (109 == a || 173 == a) && 0 <= e.indexOf("-"))
                        return !1
                });
                c.on("keyup", ".j_numberCheck", function(a) {
                    a = $(this).val();
                    isNaN(a) && "-" != a && $(this).val(parseFloat(a));
                    "." == a.charAt(0) && $(this).val(0 + parseFloat(a))
                });
                c.on("keyup", ".j_numberCheck", function(a) {
                    a = $(this).val();
                    $(this).val(a.replace(/[^\d.-]/g, ""))
                })
            }
        },
        checkEvents: function(f, d) {
            var b = this
              , c = b.el || $(document)
              , l = b.componentSetup.fieldId || b.componentSetup.tempId;
            c.on("blur", "input[componentKey\x3d'NumberComponent'][id\x3d'" + l + "'][cid\x3d'" + this.cid + "']", function() {
                var e = b.check($(this));
                f(e)
            });
            c.on("keydown", "input[componentKey\x3d'NumberComponent'][id\x3d'" + l + "'][cid\x3d'" + this.cid + "']", function(e) {
                e = parseInt(e.keyCode);
                var a = $(this).val();
                if ((110 == e || 190 == e) && 0 <= a.indexOf(".") || (109 == e || 173 == e) && 0 <= a.indexOf("-"))
                    return !1
            });
            c.on("keyup", "input[componentKey\x3d'NumberComponent'][id\x3d'" + l + "'][cid\x3d'" + this.cid + "']", function(e) {
                e = $(this).val();
                isNaN(e) && "-" != e && $(this).val(parseFloat(e));
                "." == e.charAt(0) && $(this).val(0 + parseFloat(e))
            });
            c.on("keyup", "input[componentKey\x3d'NumberComponent'][id\x3d'" + l + "'][cid\x3d'" + this.cid + "']", function(e) {
                e = $(this).val();
                var a = b.componentSetup.pointSize;
                if (null != a && "" != a && "sel" != a)
                    if (0 < a) {
                        if (0 < e.indexOf(".")) {
                            var c = e.substring(0, e.indexOf("."))
                              , d = e.substring(e.indexOf(".") + 1);
                            0 < d.length && d.length > a && (d = d.substring(0, a),
                            e = c + "." + d)
                        }
                    } else
                        0 < e.indexOf(".") && (e = e.substring(0, e.indexOf(".")));
                $(this).val(e.replace(/[^\d.-]/g, ""))
            });
            c.on("blur", "input[componentKey\x3d'NumberComponent'][id\x3d'" + l + "'][cid\x3d'" + this.cid + "']", function(e, a) {
                var f = $(this).val();
                if ("-" == f)
                    $(this).val("");
                else {
                    var g = b.componentSetup.isCapital
                      , h = b.componentSetup.numberType;
                    "mobile" == window.systemInfo_form || "number" != h || 1 != g && "true" != g || (g = b.numberToChinese(f),
                    h = c.find(".field_js[componentKey\x3d'NumberComponent'][id\x3d'field_" + l + "']"),
                    h.find(".j_capital_num").text(g).removeClass("hide-im"),
                    h.find(".j_number-inputarea .field-value_js").css("padding-right", "50px"));
                    g = b.componentSetup.pointSize;
                    if (f && null != g && "" != g && 0 < g)
                        if (0 > f.indexOf(".")) {
                            for (var h = "", q = 0; q < g; q++)
                                h += "0";
                            f = f + "." + h
                        } else {
                            for (var p = f.substring(0, f.indexOf(".")), f = f.substring(f.indexOf(".") + 1), h = "", q = 0; q < g - f.length; q++)
                                h += "0";
                            f = p + "." + (f + h)
                        }
                    $(this).val(f.replace(/[^\d.-]/g, ""));
                    !d || a && 0 == a.isAutoSave || b.saveComponentValue($(this), d)
                }
            })
        },
        autoSaveEvents: function(f) {
            this.el || $(document)
        },
        check: function(f) {
            var d = $.trim(f.val())
              , b = f.attr("placeholder")
              , c = {};
            c.element = f;
            d == b && (d = "");
            f = this.componentSetup.minNum;
            b = this.componentSetup.maxNum;
            if ("" != d || "true" != this.componentSetup.required && 1 != this.componentSetup.required) {
                var l = "";
                "mobile" == window.systemInfo_form && (l = this.componentSetup.title);
                "" != f && parseInt(f) > parseInt(d) && "" == b && (c.message = l + "\u8bf7\u8f93\u5165\u5927\u4e8e" + f + "\u7684\u6570\u503c");
                "" != b && parseInt(b) < parseInt(d) && "" == f && (c.message = l + "\u8bf7\u8f93\u5165\u5c0f\u4e8e" + b + "\u7684\u6570\u503c");
                "" != b && "" != f && (parseInt(b) < parseInt(d) || parseInt(f) > parseInt(d)) && (c.message = l + "\u8bf7\u8f93\u5165" + f + "-" + b + "\u4e4b\u95f4\u7684\u6570\u503c")
            } else
                c.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a";
            return c
        },
        getValue: function(f, d) {
            var b = $.trim(f.val())
              , c = f.attr("placeholder")
              , l = {
                formField: {
                    id: this.componentSetup.fieldId
                },
                content: b
            };
            l.type = this.componentSetup.numberType;
            l.statDescribe = "percentage" == this.componentSetup.numberType ? "%" : "";
            return "" != b && b != c && !isNaN(b) || d ? l : null
        },
        setValue: function(f, d) {
            var b = this.componentSetup.isCapital
              , c = this.componentSetup.numberType
              , l = "";
            if (null != d) {
                var e = d.content + "";
                e && 0 < (e + "").length && ("mobile" == window.systemInfo_form || "number" != c || 1 != b && "true" != b || (l = this.numberToChinese(e),
                f.find(".j_capital_num").text(l).removeClass("hide-im"),
                f.find(".j_number-inputarea .field-value_js").css("padding-right", "50px")),
                f.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val(e),
                d.statDescribe && (e += d.statDescribe),
                f.find(".j_readOnly").html(e))
            }
        },
        empty: function(f) {
            f.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val("");
            f.find(".j_capital_num").text("");
            f.find(".j_readOnly").html("")
        },
        readOnly: function(f, d) {
            var b = f.find("input[id\x3d'" + this.componentSetup.fieldId + "'][cid\x3d'" + this.cid + "']")
              , b = this.isMobileForm ? b.parent() : b;
            d ? (b.addClass("hide"),
            b.siblings(".j_readOnly").removeClass("hide"),
            b.siblings(".j_readOnly").removeClass("input-instead-border"),
            b.siblings("#type-item").addClass("hide")) : (b.removeClass("hide"),
            b.siblings(".j_readOnly").addClass("hide"))
        },
        numberToChinese: function(f) {
            var d = parseFloat(f)
              , b = parseFloat("10000000000000000");
            if (d >= b)
                return "\u8d85\u51fa\u6700\u5927\u5904\u7406\u6570\u5b57";
            d = "";
            0 == (f + "").indexOf("-") && (d += "\u8d1f",
            f = f.substring(1));
            strUnit = "\u4edf\u4f70\u62fe\u4e07\u4edf\u4f70\u62fe\u4ebf\u4edf\u4f70\u62fe\u4e07\u4edf\u4f70\u62fe\u5143\u89d2\u5206";
            f += "00";
            b = f.indexOf(".");
            0 <= b && (f = f.substring(0, b) + f.substr(b + 1, 2));
            strUnit = strUnit.substr(strUnit.length - f.length);
            for (b = 0; b < f.length; b++)
                d += "\u96f6\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c\u7396".substr(f.substr(b, 1), 1) + strUnit.substr(b, 1);
            return d.replace(/\u96f6\u5206$/, "").replace(/\u96f6\u89d2\u96f6\u5206$/, "").replace(/\u96f6[\u4edf\u4f70\u62fe]/g, "\u96f6").replace(/\u96f6{2,}/g, "\u96f6").replace(/\u96f6([\u4ebf|\u4e07])/g, "$1").replace(/\u96f6+\u5143/, "\u5143").replace(/\u4ebf\u96f6{0,3}\u4e07/, "\u4ebf").replace(/^\u5143/, "\u96f6\u5143").replace(/\u96f6\u89d2$/, "").replace(/\u96f6\u5143$/, "")
        }
    });
    u.exports = window.NumberComponent
});
define("form/component/formdatalist", ["form/tplutil", "form/componentmodel", "form/component/formsearchview"], function(n, y, u) {
    var m = n("form/tplutil")
      , h = n("form/componentmodel")
      , g = n("form/component/formsearchview");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/raty", ["form/editablecomponent", "form/tplutil"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil");
    window.Raty = m.extend({
        initialize: function(g) {
            m.prototype.initialize.call(this, g);
            var f = {
                componentKey: "Raty",
                title: "\u8bc4\u5206",
                half: "no",
                defaultstar: 0,
                ratypic: "star"
            };
            null != g && (f.title = g.title,
            f.half = g.half,
            f.defaultstar = g.defaultstar,
            f.ratypic = g.ratypic);
            this.componentSetup = $.extend(this.componentSetup, f);
            this.tpl = h.get("raty", {
                isMobileForm: this.isMobileForm
            })
        },
        sethalf: function(g) {
            this.componentSetup.half = g
        },
        setDefaultstar: function(g) {
            this.componentSetup.defaultstar = g
        },
        setRatypic: function(g) {
            this.componentSetup.ratypic = g
        },
        render: function(g) {
            for (var f = $(this.tpl), d = f.siblings("#form-raty"), b = 1; 5 >= b; b++) {
                var c = f.siblings("#img-clone").find("img").clone();
                c.attr("value", b);
                d.find("#star").append(c)
            }
            m.prototype.render.call(this, g, d);
            g.html(d.html())
        },
        renderEditPreview: function(g) {
            var f = $(this.tpl)
              , d = f.siblings("#form-raty")
              , b = this.componentSetup.ratypic;
            null == b && (b = "star");
            var c = this.componentSetup.defaultstar
              , l = Math.round(c)
              , f = f.siblings("#img-clone");
            if (0 < c)
                if (c == l)
                    for (var e = 1; 5 >= e; e++) {
                        var a = f.find("img").clone()
                          , k = a.attr("src");
                        e <= c && (k = k.replace("off", "on"));
                        var h = k.substring(0, k.lastIndexOf("/"))
                          , k = k.substring(k.indexOf("-"))
                          , h = h + "/" + b + k;
                        a.attr("src", h).attr("value", e);
                        d.find("#star").append(a)
                    }
                else
                    for (e = 1; 5 >= e; e++)
                        a = f.find("img").clone(),
                        k = a.attr("src"),
                        e <= l - 1 ? k = k.replace("off", "on") : e == l && (k = k.replace("off", "half")),
                        h = k.substring(0, k.lastIndexOf("/")),
                        k = k.substring(k.indexOf("-")),
                        h = h + "/" + b + k,
                        a.attr("value", e).attr("src", h),
                        d.find("#star").append(a);
            else
                for (e = 1; 5 >= e; e++)
                    a = f.find("img").clone(),
                    k = a.attr("src"),
                    h = k.substring(0, k.lastIndexOf("/")),
                    k = k.substring(k.indexOf("-")),
                    h = h + "/" + b + k,
                    a.attr("value", e).attr("src", h),
                    d.find("#star").append(a);
            m.prototype.renderEditPreview.call(this, g, d);
            g.append(d)
        },
        renderEditor: function() {
            var g = $(this.tpl)
              , f = g.siblings("#editor-raty")
              , d = this.componentSetup.ratypic;
            null == d && (d = "star");
            m.prototype.renderEditor.call(this, f);
            f.find("input:radio[name\x3d'half'][value\x3d'" + this.componentSetup.half + "']").attr("checked", !0);
            f.find("select[name\x3d'raty-picture']").find('option[value\x3d"' + d + '"]').attr("selected", !0);
            d = this.componentSetup.half;
            g = g.siblings("#img-clone");
            if ("no" == d)
                for (f.find(".j_default-star").empty(),
                d = 0; 5 >= d; d++) {
                    var b = g.find("option").clone();
                    b.attr("value", d).text(d);
                    f.find(".j_default-star").append(b)
                }
            else
                for (f.find(".j_default-star").empty(),
                d = 0; 5 >= d; d += .5)
                    b = g.find("option").clone(),
                    b.attr("value", d).text(d),
                    f.find(".j_default-star").append(b);
            f.find("option[value\x3d'" + this.componentSetup.defaultstar + "']").attr("selected", !0);
            $("#editor-component").html(f.html())
        },
        renderPreview: function(g, f, d) {
            var b = $(this.tpl)
              , c = b.siblings("#preview-raty")
              , l = this.componentSetup.ratypic;
            null == l && (l = "star");
            var e = this.componentSetup.defaultstar
              , a = Math.round(e)
              , b = b.siblings("#img-clone");
            if (e == a)
                for (var k = 1; 5 >= k; k++) {
                    var h = b.find("img").clone()
                      , r = h.attr("src");
                    k <= e && (r = r.replace("off", "on"));
                    var q = r.substring(0, r.lastIndexOf("/"))
                      , r = r.substring(r.indexOf("-"))
                      , q = q + "/" + l + r;
                    h.attr("value", k).attr("src", q);
                    c.find("#star-preview").append(h)
                }
            else
                for (k = 1; 5 >= k; k++)
                    h = b.find("img").clone(),
                    r = h.attr("src"),
                    k <= a - 1 ? r = r.replace("off", "on") : k == a && (r = r.replace("off", "half")),
                    q = r.substring(0, r.lastIndexOf("/")),
                    r = r.substring(r.indexOf("-")),
                    q = q + "/" + l + r,
                    h.attr("value", k).attr("src", q),
                    c.find("#star-preview").append(h);
            f && c.find(".check_js").val("");
            c.find(".form-control").attr("placeholder", "\u8bf7\u586b\u5199" + this.componentSetup.title);
            m.prototype.renderPreview.call(this, g, f, d, c);
            g.append(c)
        },
        renderStatSearch: function(g) {
            var f = $(this.tpl)
              , d = g.parentEl
              , b = null
              , c = g.term;
            if ("mobile" != window.systemInfo_form) {
                var b = f.siblings("#statsearch-raty")
                  , l = g.startValue;
                l && b.find("input:first").val(l);
                (l = g.endValue) && b.find("input:last").val(l);
                c && b.find("select:first option[value\x3d" + c + "]").attr("selected", "true");
                d.attr("class", "sch-group j_formFieldSearchGroup");
                d.find(".j_formField-condition").html(b)
            } else {
                var c = g.fieldId
                  , l = g.fieldTitle
                  , e = g.subFormId
                  , b = f.siblings("#statsearch-raty-mobile")
                  , f = g.filterEl;
                g = g.condition;
                if (f) {
                    var a = f.find(".j_filterList .selectd #comp-val span").eq(0).text()
                      , f = f.find(".j_filterList .selectd #comp-val span").eq(1).text();
                    b.find(".j_numberCheck").eq(0).val(a);
                    b.find(".j_numberCheck").eq(1).val(f)
                }
                g && (b.find(".j_condition").find('option[value\x3d"' + g + '"]').attr("selected", !0),
                "null" != g && "notnull" != g || b.find(".j_control").hide());
                b.find(".j_inputName").text(l + ":");
                d.find("#component-div").html(b);
                d.find(".j_comp-ok").attr("comKey", "Raty").attr("fieldId", c).attr("title", l).attr("subFormId", e);
                d.off("change", "#statsearch-raty-mobile .j_condition").on("change", "#statsearch-raty-mobile .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? d.find("#statsearch-raty-mobile .j_control").hide() : d.find("#statsearch-raty-mobile .j_control").show()
                });
                d.on("keydown", ".j_numberCheck", function(a) {
                    a = parseInt(a.keyCode);
                    var e = $(this).val();
                    if ((110 == a || 190 == a) && 0 <= e.indexOf(".") || (109 == a || 173 == a) && 0 <= e.indexOf("-"))
                        return !1
                });
                d.on("keyup", ".j_numberCheck", function(a) {
                    a = $(this).val();
                    isNaN(a) && "-" != a && $(this).val(parseFloat(a));
                    "." == a.charAt(0) && $(this).val(0 + parseFloat(a))
                });
                d.on("keyup", ".j_numberCheck", function(a) {
                    a = $(this).val();
                    $(this).val(a.replace(/[^\d.-]/g, ""))
                })
            }
        },
        checkEvents: function(g) {
            var f = this;
            g = f.el || $(document);
            var d = this.componentSetup.ratypic;
            null == d && (d = "star");
            var b = g.find("div[id\x3d'field_" + (this.componentSetup.fieldId || this.componentSetup.tempId) + "']").find("[cid\x3d'" + this.cid + "']");
            if (this.rdOnly || "true" == this.componentSetup.isReadOnly || 1 == this.componentSetup.isReadOnly)
                b.attr("style", "");
            else {
                var c = this.componentSetup.half;
                g = b.find("img[src*\x3d'half']").length;
                var l = b.find("img[src*\x3d'on']").length
                  , e = 0
                  , e = 0 < g ? l + .5 : l;
                f.selectValue = this.componentSetup.defaultstar;
                b.on("mousemove", "img", function(e) {
                    var l = $(this).offset().left
                      , g = $(this).attr("value")
                      , h = $(this).width()
                      , p = l + h / 2
                      , h = h + l;
                    e.pageX >= l && e.pageX < p ? "no" == c ? b.find("img[value\x3d'" + g + "']").attr("src", _formDesign+"/static/img/form/" + d + "-on-big" + (f.isMobileForm ? "-m" : "") + ".png") : b.find("img[value\x3d'" + g + "']").attr("src", _formDesign+"/static/img/form/" + d + "-half-big" + (f.isMobileForm ? "-m" : "") + ".png") : e.pageX >= p && e.pageX < h && b.find("img[value\x3d'" + g + "']").attr("src", _formDesign+"/static/img/form/" + d + "-on-big" + (f.isMobileForm ? "-m" : "") + ".png");
                    a(g)
                });
                b.on("mouseout", "img", function() {
                    var e = Math.round(f.selectValue);
                    e == f.selectValue ? b.find("img[value\x3d'" + e + "']").attr("src", _formDesign+"/static/img/form/" + d + "-on-big" + (f.isMobileForm ? "-m" : "") + ".png") : b.find("img[value\x3d'" + e + "']").attr("src", _formDesign+"/static/img/form/" + d + "-half-big" + (f.isMobileForm ? "-m" : "") + ".png");
                    a(e)
                });
                b.on("click", "img", function(k) {
                    f.selectValue = $(this).attr("value");
                    var l = $(this).offset().left
                      , g = $(this).width()
                      , h = l + g / 2
                      , g = g + l;
                    k.pageX >= l && k.pageX < h ? (f.selectValue = "no" == c ? f.selectValue : f.selectValue - 1 + .5,
                    e == f.selectValue ? e = f.selectValue = 0 : ("no" == c ? b.find("img[value\x3d'" + f.selectValue + "']").attr("src", _formDesign+"/static/img/form/" + d + "-on-big" + (f.isMobileForm ? "-m" : "") + ".png") : b.find("img[value\x3d'" + Math.round(f.selectValue) + "']").attr("src", _formDesign+"/static/img/form/" + d + "-half-big" + (f.isMobileForm ? "-m" : "") + ".png"),
                    e = f.selectValue)) : k.pageX >= h && k.pageX < g && (e == f.selectValue ? e = f.selectValue = 0 : (b.find("img[value\x3d'" + f.selectValue + "']").attr("src", _formDesign+"/static/img/form/" + d + "-on-big" + (f.isMobileForm ? "-m" : "") + ".png"),
                    e = f.selectValue));
                    a(Math.round(f.selectValue))
                });

                var a = function(a) {
                    for (var e = 1; e <= a - 1; e++)
                        b.find("img[value\x3d'" + e + "']").attr("src", _formDesign+"/static/img/form/" + d + "-on-big" + (f.isMobileForm ? "-m" : "") + ".png");
                    for (e = 5; e > a; e--)
                        b.find("img[value\x3d'" + e + "']").attr("src", _formDesign+"/static/img/form/" + d + "-off-big" + (f.isMobileForm ? "-m" : "") + ".png")
                }
            }
        },
        autoSaveEvents: function(g) {
            var f = this
              , d = $("div[id\x3d'" + this.componentSetup.fieldId + "'][cid\x3d'" + this.cid + "']");
            if (!this.rdOnly && "true" != this.componentSetup.isReadOnly && 1 != this.componentSetup.isReadOnly) {
                var b = function(c, b) {
                    "undefined" != typeof _ratyTimer && (clearTimeout(_ratyTimer),
                    delete _ratyTimer);
                    _ratyTimer = setTimeout(function() {
                        c();
                        delete _ratyTimer
                    }, b)
                };
                d.on("click", "img", function(c) {
                    var d = $(this);
                    b(function() {
                        f.saveComponentValue(d, g)
                    }, 400)
                })
            }
        },
        check: function(g) {
            var f = g.find("img[src*\x3d'off']").length
              , d = g.attr("placeholder")
              , b = {};
            b.element = g;
            f == d && (f = "");
            5 != f && "5" != f || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (b.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            return b
        },
        getValue: function(g, f) {
            var d = $(g).find("img[src*\x3d'on']").length;
            0 < $(g).find("img[src*\x3d'half']").length && (d += .5);
            var b = g.attr("placeholder")
              , c = {
                formField: {
                    id: this.componentSetup.fieldId
                },
                content: d + ""
            };
            return 0 != d.length && d != b && !isNaN(d) || f ? c : null
        },
        setValue: function(g, f) {
            var d = this
              , b = this.componentSetup.ratypic;
            null == b && (b = "star");
            if (null != f) {
                var c = f.content
                  , l = Math.round(c);
                g.find("#" + this.componentSetup.fieldId).find("img").each(function() {
                    $(this).attr("src", _formDesign+"/static/img/form/" + b + "-off-big" + (d.isMobileForm ? "-m" : "") + ".png")
                });
                if (0 < c)
                    if (c == l)
                        for (var e = 1; 5 >= e; e++) {
                            var a = g.find("#" + this.componentSetup.fieldId).find("img[value\x3d'" + e + "']").attr("src");
                            e <= l ? (a = a.replace("off", "on"),
                            a = a.replace("half", "on")) : (a = a.replace("on", "off"),
                            a = a.replace("half", "off"));
                            g.find("#" + this.componentSetup.fieldId).find("img[value\x3d'" + e + "']").attr("src", a)
                        }
                    else
                        for (e = 1; 5 >= e; e++)
                            a = g.find("#" + this.componentSetup.fieldId).find("img[value\x3d'" + e + "']").attr("src"),
                            e <= l - 1 ? (a = a.replace("off", "on"),
                            a = a.replace("half", "on")) : e == l ? (a = a.replace("off", "half"),
                            a = a.replace("on", "off")) : (a = a.replace("on", "off"),
                            a = a.replace("half", "off")),
                            g.find("#" + this.componentSetup.fieldId).find("img[value\x3d'" + e + "']").attr("src", a);
                g.find(".j_readOnly").html(c);
                this.selectValue = c || 0
            }
        },
        empty: function(g) {
            this.setValue(g, {
                content: 0
            })
        },
        readOnly: function(g, f) {
            g.find("div[id\x3d'" + this.componentSetup.fieldId + "'][cid\x3d'" + this.cid + "']");
            f && (this.rdOnly = f)
        }
    });
    u.exports = window.Raty
});
define("form/component/positionselecter", ["form/tplutil"], function(n, y, u) {
    var m = n("form/tplutil");
    y = Backbone.View.extend({
        initialize: function() {},
        render: function(h, g) {
            "pc" == h ? this.initPC.init(g) : this.initMb.init(g)
        },
        initPC: {
            init: function(h) {
                this.level = h.level;
                this.lng = h.lng;
                this.lat = h.lat;
                this.address = h.address;
                this.parentEl = h.parentEl;
                this.readOnly = h.readOnly;
                this.tpl = m.get("positionselecter");
                this.el = "#position-selecter";
                this.first = !1;
                $("body").append($(this.tpl).siblings("#position-selecter"));
                this.render();
                this.delegateEvents()
            },
            delegateEvents: function() {
                var h = this
                  , g = $(h.el);
                g.on("shown.bs.modal", function(f) {
                    h.lng && h.lat && (f = !1,
                    h.first || (f = !0),
                    h.renderMap(h.lng, h.lat, h.address, h.level, f))
                });
                g.on("hidden.bs.modal.positionsel", function(f) {
                    h.remove()
                });
                g.off("setPlace.positionsel").on("setPlace.positionsel", function(f) {
                    var d = $(h.el).find(".j_searchAddr");
                    if (f = d.text()) {
                        formPlugin.notify("\u5b9a\u4f4d\u5730\u5740\u6dfb\u52a0\u6210\u529f");
                        var b = d.attr("lng")
                          , d = d.attr("lat")
                          , c = {};
                        c.address = f;
                        c.lng = b;
                        c.lat = d;
                        h.parentEl.trigger("selectAddr", c);
                        g.modal("hide")
                    }
                });
                g.off("click", "#mapconfig-close").on("click", "#mapconfig-close", function(f) {
                    g.modal("hide")
                })
            },
            render: function() {
                var h = this
                  , g = $(h.el);
                !h.readOnly || 1 != h.readOnly && "true" != h.readOnly || g.find(".j_mapSearch").remove();
                h.lng || h.lat || $.ajax({
                    url: "https://api.map.baidu.com/location/ip?ak\x3dXKXXQG69VnCYhXvtrfjVuWjh\x26coor\x3dbd09ll",
                    type: TEAMS.ajaxMethod,
                    dataType: "jsonp",
                    success: function(f) {
                        f.content && f.content.point && (h.lng = f.content.point.x,
                        h.lat = f.content.point.y,
                        h.level = 11,
                        h.first = !0)
                    }
                });
                g.modal()
            },
            renderMap: function(h, g, f, d, b) {
                var c = this;
                window.HOST_TYPE = "2";
                window.BMap_loadScriptTime = (new Date).getTime();
                n.async(["https://api.map.baidu.com/getscript?v\x3d2.0\x26ak\x3dXKXXQG69VnCYhXvtrfjVuWjh\x26services\x3d\x26t\x3d" + TEAMS.version], function() {
                    var l = new BMap.Map("j_mapAreaSel",{
                        enableMapClick: !1
                    });
                    new BMap.Geocoder;
                    var e = new BMap.Point(h,g);
                    l.centerAndZoom(e, d);
                    l.enableDragging();
                    l.enableScrollWheelZoom();
                    b && (c.addMarker(l, e, f, !0),
                    c.addMarker(l, e, f, !0));
                    (!c.readOnly || 1 != c.readOnly && "true" != c.readOnly) && c.addEvents(l)
                })
            },
            addMarker: function(h, g, f, d) {
                var b = new BMap.Marker(g);
                f = new BMap.InfoWindow(f,{
                    offset: new BMap.Size(-4,-14),
                    enableCloseOnClick: !1
                });
                b.infoWindow = f;
                h.clearOverlays();
                h.addOverlay(b);
                d && h.openInfoWindow(f, g);
                $("#loading").hide()
            },
            addEvents: function(h) {
                var g = this
                  , f = $(g.el);
                h.addEventListener("click", function(b) {
                    var c = new BMap.Geocoder
                      , d = b.point;
                    c.getLocation(d, function(e) {
                        e = e.addressComponents;
                        var a = e.province + e.city + e.district + e.street + e.streetNumber;
                        formPlugin.confirm("\u786e\u5b9a\u4ee5\u5730\u5740\uff1a" + a + " \u4e3a\u5b9a\u4f4d\u5730\u5740\u5417?", function(e) {
                            e && (formPlugin.notify("\u5b9a\u4f4d\u5730\u5740\u6dfb\u52a0\u6210\u529f"),
                            e = {},
                            e.address = a,
                            e.lng = d.lng,
                            e.lat = d.lat,
                            g.parentEl.trigger("selectAddr", e),
                            e = new BMap.Point(d.lng,d.lat),
                            g.addMarker(h, e, "\u5730\u5740\uff1a" + a, !0),
                            f.modal("hide"))
                        })
                    })
                });
                f.off("keyup.positionsel", "#j_cityNameSel").on("keyup.positionsel", "#j_cityNameSel", function(b) {
                    b = $(this).val();
                    "" != b && h.centerAndZoom(b, 12)
                });
                var d = new BMap.Autocomplete({
                    input: "j_addressInputSel",
                    location: h
                });
                d.addEventListener("onhighlight", function(b) {
                    var c = ""
                      , d = b.fromitem.value
                      , e = "";
                    -1 < b.fromitem.index && (e = d.province + d.city + d.district + d.street + d.business);
                    c = "FromItem\x3cbr /\x3eindex \x3d " + b.fromitem.index + "\x3cbr /\x3evalue \x3d " + e;
                    e = "";
                    -1 < b.toitem.index && (d = b.toitem.value,
                    e = d.province + d.city + d.district + d.street + d.business);
                    c += "\x3cbr /\x3eToItem\x3cbr /\x3eindex \x3d " + b.toitem.index + "\x3cbr /\x3evalue \x3d " + e;
                    $("#searchResultPanel").innerHTML = c
                });
                d.addEventListener("onconfirm", function(b) {
                    f.find(".j_addrs-list").empty().addClass("hide");
                    var c = b.item.value;
                    myValue = c.province + c.city + c.district + c.street + c.business;
                    $("#searchResultPanel").innerHTML = "onconfirm\x3cbr /\x3eindex \x3d " + b.item.index + "\x3cbr /\x3emyValue \x3d " + myValue;
                    g.setPlace(h, myValue)
                });
                f.off("refreshValue.positionsel", "#j_addressInputSel").on("refreshValue.positionsel", "#j_addressInputSel", function(b) {
                    var c = $(this);
                    c.val(c.val() + " ");
                    setTimeout(function() {
                        c.val($.trim(c.val()))
                    }, 150)
                });
                f.off("keyup.positionsel", "#j_addressInputSel").on("keyup.positionsel", "#j_addressInputSel", function(b) {
                    if (13 == b.keyCode) {
                        b = $(this);
                        b = $.trim(b.val());
                        var c = $.trim(f.find("#j_cityNameSel").val());
                        c || (c = b);
                        $.ajax({
                            url: "https://api.map.baidu.com/place/v2/search",
                            dataType: "jsonp",
                            type: TEAMS.ajaxMethod,
                            data: {
                                q: b,
                                region: c,
                                output: "json",
                                ak: "XKXXQG69VnCYhXvtrfjVuWjh"
                            },
                            crossDomain: !0,
                            success: function(c) {
                                g.renderSearchAddrs(c.results)
                            }
                        })
                    }
                });
                f.off("click.positionsel", ".j_addrs-list li").on("click.positionsel", ".j_addrs-list li", function(b) {
                    var c = $(this);
                    f.find(".j_addrs-list").empty().addClass("hide");
                    b = $.trim(c.find(".j_addr-info").attr("addr"));
                    var d = c.find(".j_addr-info").attr("lon")
                      , e = c.find(".j_addr-info").attr("lat")
                      , c = new BMap.Point(d,e);
                    h.clearOverlays();
                    h.centerAndZoom(c, 18);
                    var a = new BMap.Marker(c);
                    b = new BMap.InfoWindow('\x3cspan class\x3d"j_searchAddr" lng\x3d"' + d + '" lat\x3d"' + e + '"\x3e' + b + "\x3c/span\x3e\x3cbr/\x3e\x3ca class\x3d\"fr j_settingPoint\" onclick\x3d\"$('#position-selecter').trigger('setPlace')\"\x3e\u8bbe\u7f6e\u4e3a\u5b9a\u4f4d\u5730\u5740\x3c/a\x3e",{
                        offset: new BMap.Size(-4,-14),
                        enableCloseOnClick: !1
                    });
                    a.infoWindow = b;
                    h.addOverlay(a);
                    h.openInfoWindow(b, c)
                })
            },
            setPlace: function(h, g) {
                h.clearOverlays();
                var f = new BMap.LocalSearch(h,{
                    onSearchComplete: function() {
                        var d = f.getResults().getPoi(0).point;
                        h.centerAndZoom(d, 18);
                        var b = new BMap.Marker(d);
                        g = '\x3cspan class\x3d"j_searchAddr" lng\x3d"' + d.lng + '" lat\x3d"' + d.lat + '"\x3e' + g + "\x3c/span\x3e\x3cbr/\x3e\x3ca class\x3d\"fr j_settingPoint\" onclick\x3d\"$('#position-selecter').trigger('setPlace')\"\x3e\u8bbe\u7f6e\u4e3a\u5b9a\u4f4d\u5730\u5740\x3c/a\x3e";
                        var c = new BMap.InfoWindow(g,{
                            offset: new BMap.Size(-4,-14),
                            enableCloseOnClick: !1
                        });
                        b.infoWindow = c;
                        h.addOverlay(b);
                        h.openInfoWindow(c, d)
                    }
                });
                f.search(g)
            },
            renderSearchAddrs: function(h) {
                var g = $(this.el)
                  , f = 0;
                g.find(".j_addrs-list").empty().removeClass("hide");
                for (var d = 0, b = h.length; d < b; d++) {
                    var c = h[d];
                    if (c.name && c.address && c.location && c.location.lat && c.location.lng) {
                        var f = f + 1
                          , l = g.find("#j_addr-liCLone").clone().removeAttr("id");
                        l.find(".j_addr-info").attr({
                            addr: c.address + c.name,
                            lon: c.location.lng,
                            lat: c.location.lat,
                            title: c.name + " " + c.address
                        }).text(c.name);
                        l.find(".j_tip-info").text(c.address);
                        g.find(".j_addrs-list").append(l)
                    }
                }
                0 >= f && (g.find(".j_addrs-list").addClass("hide"),
                g.find("#j_addressInputSel\t").trigger("refreshValue"))
            },
            remove: function() {
                $(this.el).off(".positionsel");
                $(this.el).remove()
            }
        },
        initMb: {
            init: function(h) {
                this.lng = h.lng;
                this.lat = h.lat;
                this.address = h.address;
                this.parentEl = h.parentEl;
                this.parentView = h.parentView;
                this.readOnly = h.readOnly;
                this.el = "#position-selecter-m";
                this.tpl = m.get("positionselecter");
                $("body").append($(this.tpl).siblings("#position-selecter-m"));
                this.render();
                this.delegateEvents()
            },
            delegateEvents: function() {
                var h = this
                  , g = $(h.el);
                g.on("setPlace.selectermb", function(f) {
                    var d = $(h.el).find(".j_searchAddr");
                    if (f = d.text()) {
                        var b = d.attr("lng")
                          , d = d.attr("lat");
                        g.find(".j_address").text(f).attr("lng", b).attr("lat", d);
                        g.find(".j_lng").text("\u7ecf\u5ea6\uff1a" + b);
                        g.find(".j_lat").text("\u7eac\u5ea6\uff1a" + d)
                    }
                });
                g.on("click.selectermb", ".j_btn-ok", function(f) {
                    f = g.find(".j_address").text();
                    var d = g.find(".j_address").attr("lng")
                      , b = g.find(".j_address").attr("lat")
                      , c = {};
                    c.address = f;
                    c.lng = d;
                    c.lat = b;
                    $(h.parentEl).trigger("addressConfirm", c);
                    h.parentView.removeClass("hide");
                    g.remove()
                });
                g.on("click.selectermb", ".j_btn-cancel", function(f) {
                    h.parentView.removeClass("hide");
                    g.remove()
                })
            },
            render: function() {
                var h = this;
                !h.readOnly || 1 != h.readOnly && "true" != h.readOnly || $(h.el).find(".position-search").remove();
                window.HOST_TYPE = "2";
                window.BMap_loadScriptTime = (new Date).getTime();
                n.async(["https://api.map.baidu.com/getscript?v\x3d2.0\x26ak\x3dXKXXQG69VnCYhXvtrfjVuWjh\x26services\x3d\x26t\x3d" + TEAMS.version], function() {
                    if (h.lng && h.lat) {
                        window.qdgps = h;
                        var g = {}
                          , f = {};
                        f.longitude = h.lng;
                        f.latitude = h.lat;
                        g.coords = f;
                        h.showPosition(g)
                    } else
                        navigator.geolocation ? (window.qdgps = h,
                        navigator.geolocation.getCurrentPosition(h.showPosition, h.showError, {
                            enableHighAccuracy: !0
                        })) : formPlugin.notify("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301!")
                })
            },
            showPosition: function(h) {
                var g = window.qdgps;
                h = [new BMap.Point(h.coords.longitude,h.coords.latitude)];
                g.lng && g.lat ? (g.initMap(h[0], g.address),
                $("#checkbox").show()) : (new BMap.Convertor).translate(h, 1, 5, function(f) {
                    0 === f.status && (g.initMap(f.points[0]),
                    $("#checkbox").show())
                })
            },
            initMap: function(h, g) {
                var f = window.qdgps
                  , d = $(f.el)
                  , b = new BMap.Map("map-area");
                f.mapObj = b;
                b.centerAndZoom(h, 15);
                b.enableDragging();
                b.enableScrollWheelZoom(!0);
                (new BMap.Geocoder).getLocation(h, function(c) {
                    c = c.addressComponents;
                    g || (g = c.city + c.district + c.street + c.streetNumber);
                    f.addMarker(b, h, g, !0);
                    d.find(".j_address").text(g).attr("lng", h.lng).attr("lat", h.lat);
                    c = h.lng + "";
                    var l = h.lat + ""
                      , e = c.substring(0, c.indexOf(".") + 1);
                    c = c.substring(c.indexOf("."));
                    c = c.substring(c.indexOf("."), 7);
                    c = e + c;
                    e = l.substring(0, l.indexOf(".") + 1);
                    l = l.substring(l.indexOf("."));
                    l = l.substring(l.indexOf("."), 7);
                    l = e + l;
                    d.find(".j_lng").text("\u7ecf\u5ea6\uff1a" + c);
                    d.find(".j_lat").text("\u7eac\u5ea6\uff1a" + l)
                });
                (!f.readOnly || 1 != f.readOnly && "true" != f.readOnly) && f.addEvents(b)
            },
            addEvents: function(h) {
                var g = window.qdgps
                  , f = $(this.el);
                h.addEventListener("dragging", function() {
                    var b = h.getCenter()
                      , b = new BMap.Point(b.lng,b.lat)
                      , b = new BMap.Marker(b);
                    h.clearOverlays();
                    h.addOverlay(b)
                });
                h.addEventListener("dragend", function() {
                    var b = h.getCenter()
                      , c = new BMap.Point(b.lng,b.lat);
                    h.clearOverlays();
                    (new BMap.Geocoder).getLocation(c, function(d) {
                        d = d.addressComponents;
                        d = d.province + d.city + d.district + d.street + d.streetNumber;
                        g.addMarker(h, c, d, !0);
                        f.find(".j_address").text(d).attr("lng", b.lng).attr("lat", b.lat);
                        f.find(".j_lng").text("\u7ecf\u5ea6\uff1a" + b.lng);
                        f.find(".j_lat").text("\u7eac\u5ea6\uff1a" + b.lat)
                    })
                });
                var d = new BMap.Autocomplete({
                    input: "search-address",
                    location: h
                });
                d.addEventListener("onhighlight", function(b) {
                    var c = ""
                      , d = b.fromitem.value
                      , e = "";
                    -1 < b.fromitem.index && (e = d.province + d.city + d.district + d.street + d.business);
                    c = "FromItem\x3cbr /\x3eindex \x3d " + b.fromitem.index + "\x3cbr /\x3evalue \x3d " + e;
                    e = "";
                    -1 < b.toitem.index && (d = b.toitem.value,
                    e = d.province + d.city + d.district + d.street + d.business);
                    c += "\x3cbr /\x3eToItem\x3cbr /\x3eindex \x3d " + b.toitem.index + "\x3cbr /\x3evalue \x3d " + e;
                    $("#searchResultPanel").innerHTML = c
                });
                d.addEventListener("onconfirm", function(b) {
                    f.find(".j_addrs-list").empty().addClass("hide");
                    var c = b.item.value;
                    myValue = c.province + c.city + c.district + c.street + c.business;
                    $("#searchResultPanel").innerHTML = "onconfirm\x3cbr /\x3eindex \x3d " + b.item.index + "\x3cbr /\x3emyValue \x3d " + myValue;
                    g.setPlace(h, myValue)
                });
                f.off("refreshValue.selectermb", "#search-address").on("refreshValue.selectermb", "#search-address", function(b) {
                    var c = $(this);
                    c.val(c.val() + " ");
                    setTimeout(function() {
                        c.val($.trim(c.val()))
                    }, 150)
                });
                f.off("keyup.selectermb", "#search-address").on("keyup.selectermb", "#search-address", function(b) {
                    13 == b.keyCode && (b = $(this),
                    region = b = $.trim(b.val()),
                    $.ajax({
                        url: "https://api.map.baidu.com/place/v2/search",
                        dataType: "jsonp",
                        type: TEAMS.ajaxMethod,
                        data: {
                            q: b,
                            region: region,
                            output: "json",
                            ak: "XKXXQG69VnCYhXvtrfjVuWjh"
                        },
                        crossDomain: !0,
                        success: function(c) {
                            g.renderSearchAddrs(c.results)
                        }
                    }))
                });
                f.off("click.selectermb", ".j_addrs-list li").on("click.selectermb", ".j_addrs-list li", function(b) {
                    var c = $(this);
                    f.find(".j_addrs-list").empty().addClass("hide");
                    b = $.trim(c.find(".j_addr-info").attr("addr"));
                    var d = c.find(".j_addr-info").attr("lon")
                      , e = c.find(".j_addr-info").attr("lat")
                      , c = new BMap.Point(d,e);
                    h.clearOverlays();
                    h.centerAndZoom(c, 18);
                    var a = new BMap.Marker(c);
                    b = new BMap.InfoWindow('\x3cspan class\x3d"j_searchAddr" lng\x3d"' + d + '" lat\x3d"' + e + '"\x3e' + b + "\x3c/span\x3e\x3cbr/\x3e\x3ca class\x3d\"fr j_settingPoint\" onclick\x3d\"$('#position-selecter-m').trigger('setPlace')\"\x3e\u8bbe\u7f6e\u5730\u70b9\x3c/a\x3e",{
                        offset: new BMap.Size(-4,-14),
                        enableCloseOnClick: !1
                    });
                    a.infoWindow = b;
                    h.addOverlay(a);
                    h.openInfoWindow(b, c)
                })
            },
            renderSearchAddrs: function(h) {
                var g = $(window.qdgps.el)
                  , f = 0;
                g.find(".j_addrs-list").empty().removeClass("hide");
                for (var d = 0, b = h.length; d < b; d++) {
                    var c = h[d];
                    if (c.name && c.address && c.location && c.location.lat && c.location.lng) {
                        var f = f + 1
                          , l = g.find("#j_addr-liCLone").clone().removeAttr("id");
                        l.find(".j_addr-info").attr({
                            addr: c.address + c.name,
                            lon: c.location.lng,
                            lat: c.location.lat,
                            title: c.name + " " + c.address
                        }).text(c.name);
                        l.find(".j_tip-info").text(c.address);
                        g.find(".j_addrs-list").append(l)
                    }
                }
                0 >= f && (g.find(".j_addrs-list").addClass("hide"),
                g.find("#search-address").trigger("refreshValue"))
            },
            setPlace: function(h, g) {
                h.clearOverlays();
                var f = new BMap.LocalSearch(h,{
                    onSearchComplete: function() {
                        var d = f.getResults().getPoi(0).point;
                        h.centerAndZoom(d, 18);
                        var b = new BMap.Marker(d);
                        g = '\x3cspan class\x3d"j_searchAddr" lng\x3d"' + d.lng + '" lat\x3d"' + d.lat + '"\x3e' + g + "\x3c/span\x3e\x3cbr/\x3e\x3ca class\x3d\"fr j_settingPoint\" onclick\x3d\"$('#position-selecter-m').trigger('setPlace')\"\x3e\u8bbe\u7f6e\u5730\u70b9\x3c/a\x3e";
                        var c = new BMap.InfoWindow(g,{
                            offset: new BMap.Size(-4,-14),
                            enableCloseOnClick: !1
                        });
                        b.infoWindow = c;
                        h.addOverlay(b);
                        h.openInfoWindow(c, d)
                    }
                });
                f.search(g)
            },
            addMarker: function(h, g, f, d) {
                var b = new BMap.Marker(g);
                f = new BMap.InfoWindow(f,{
                    offset: new BMap.Size(-4,-14),
                    enableCloseOnClick: !1
                });
                b.infoWindow = f;
                b.point = g;
                h.addOverlay(b);
                d && h.openInfoWindow(f, g);
                $("#loading").hide()
            },
            showError: function(h) {
                switch (h.code) {
                case h.PERMISSION_DENIED:
                    formPlugin.notify("\u7531\u4e8e\u60a8\u8bbe\u7f6e\u4e86\u7981\u6b62\u83b7\u53d6\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f\uff0c\u5f53\u524d\u5e94\u7528\u83b7\u53d6\u4e0d\u5230\u60a8\u5f53\u524d\u7684\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u65b0\u83b7\u53d6");
                    break;
                case h.POSITION_UNAVAILABLE:
                    formPlugin.notify("\u60a8\u5f53\u524d\u7684\u4f4d\u7f6e\u4fe1\u606f\u4e0d\u53ef\u7528\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u65b0\u83b7\u53d6");
                    break;
                case h.TIMEOUT:
                    formPlugin.notify("\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u4fe1\u606f\u8d85\u65f6\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u65b0\u83b7\u53d6");
                    break;
                case h.UNKNOWN_ERROR:
                    formPlugin.notify("\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u65b0\u83b7\u53d6")
                }
                $("#loading").hide()
            },
            translate: function(h, g, f) {
                var d = window.qdgps
                  , b = "cbk_" + Math.round(1E4 * Math.random());
                d.load_script("https://api.map.baidu.com/ag/coord/convert?from\x3d" + g + "\x26to\x3d4\x26x\x3d" + h.lng + "\x26y\x3d" + h.lat + "\x26callback\x3dBMap.Convertor." + b);
                BMap.Convertor[b] = function(c) {
                    delete BMap.Convertor[b];
                    c = new BMap.Point(c.x,c.y);
                    f && f(c)
                }
            },
            load_script: function(h, g) {
                var f = document.getElementsByTagName("head")[0]
                  , d = document.createElement("script");
                d.type = "text/javascript";
                d.src = h;
                d.onload = d.onreadystatechange = function() {
                    this.readyState && "loaded" !== this.readyState && "complete" !== this.readyState || (g && g(),
                    d.onload = d.onreadystatechange = null,
                    f && d.parentNode && f.removeChild(d))
                }
                ;
                f.insertBefore(d, f.firstChild)
            },
            remove: function() {
                var h = $(this.el);
                h.off(".selectermb");
                h.remove()
            }
        }
    });
    u.exports = y
});
define("form/component/chartcomponent", ["form/component", "form/componentmodel", "form/tplutil"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/componentmodel")
      , h = n("form/tplutil")
      , g = "#5CBAE3 #E5CF0D #B6A2DE #8D98B3 #95706D #E4B600 #89B600 #D87A80".split(" ")
    window.ChartComponent = y.extend({
    });
    u.exports = window.ChartComponent
});
define("form/component/imagecut", ["form/tplutil"], function(n, y, u) {
    var m = n("form/tplutil")
      , h = {
        callback: $.noop,
        imageId: null,
        formId: null,
        minHeight: 100,
        minWidth: 150,
        aspectRatio: "1.5:1",
        resizable: !0
    };
    n = Backbone.View.extend({
        initialize: function(g) {
            this.el = "#imagecut";
            this.options = $.extend({}, h, g);
            this.imageArea = {
                id: this.options.imageId
            };
            $("body").append(m.get("imagecut"))
        },
        delegateEvents: function() {
            var g = this
              , f = $(g.el);
            f.on("hidden.bs.modal", function() {
                g.remove()
            });
            f.on("click", "#cancel", function() {
                f.modal("hide")
            });
            f.on("click", "#avatar-cut", function(d) {
                var b = $(this);
                b.hasClass("disabled") || (b.addClass("disabled").text("\u88c1\u526a\u4e2d..."),
                d.stopPropagation(),
                g.cut(function(c) {
                    b.removeClass("disabled").text("\u88c1\u526a");
                    f.find("img.avatar-img").imgAreaSelect({
                        instance: !0
                    }).cancelSelection();
                    formPlugin.notify("\u526a\u88c1\u6210\u529f!");
                    f.modal("hide");
                    g.options.imageId = c.imageArea.id
                    g.imageArea.id = c.imageArea.id
                    g.options.callback(c)

                }))
            })
        },
        render: function() {
            var g = $(this.el);
            g.modal({
                keyboard: !1,
                backdrop: "static"
            });
            g.find("#avatar-img-preview").attr("src", TEAMS.api.downImgUrl+"/" + this.options.imageId);
            g.find("#avatar-img").attr("src", TEAMS.api.downImgUrl+"/" + this.options.imageId);
            g.find("#avatar-preview").css({
                width: this.options.minWidth,
                height: this.options.minHeight
            });
            g.find("#avatar-cut-p").text("\u9884\u89c8(" + this.options.minWidth + "*" + this.options.minHeight + "):");
            this.initImgSelect()
        },
        initImgSelect: function() {
            var g = this
              , f = $(g.el);
            f.find("#avatar-img").imgAreaSelect({
                parent: "#imagecut",
                minHeight: g.options.minHeight,
                minWidth: g.options.minWidth,
                aspectRatio: g.options.aspectRatio,
                resizable: g.options.resizable,
                handles: !0,
                fadeSpeed: 200,
                onSelectStart: function() {
                    f.find(".avatar-preview-wrapper").removeClass("hide");
                    f.find("#avatar-cut").removeClass("hide")
                },
                onSelectChange: function(d, b) {
                    if (b.width && b.height) {
                        f.find("#avatar-img-preview").attr("src", f.find("#avatar-img").attr("src"));
                        var c = g.options.minWidth / (b.width || 1)
                          , l = g.options.minHeight / (b.height || 1)
                          , e = f.find("#avatar-img").width()
                          , a = f.find("#avatar-img").height();
                        f.find("#avatar-img-preview").css({
                            width: Math.round(c * e) + "px",
                            height: Math.round(l * a) + "px",
                            marginLeft: "-" + Math.round(c * b.x1) + "px",
                            marginTop: "-" + Math.round(l * b.y1) + "px"
                        })
                    }
                },
                onSelectEnd: function(d, b) {
                    g.imageArea.x = b.x1;
                    g.imageArea.y = b.y1;
                    g.imageArea.width = b.width;
                    g.imageArea.height = b.height
                }
            });
            g.initImg = !0
        },
        cut: function(g) {
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                url: TEAMS.api.cutImage,
                dataType: "json",
                data: JSON.stringify({
                    imageArea: this.imageArea
                }),
                success: function(f) {
                    g && g(f)
                }
            })
        },
        remove: function() {
            this.uploaderimg && this.uploaderimg.destroy();
            $(this.el).remove()
        }
    });
    u.exports = n
});
define("form/component/datetimepicker", ["form/tplutil"], function(n, y, u) {
    var m = n("form/tplutil");
    DateTimePicker = Backbone.View.extend({
        initialize: function(h) {
            this.el = h.el;
            this.scrollvalue = h.scrollvalue;
            this.preEl = h.preEl;
            this.startView = h.startView ? h.startView : 2;
            this.format = h.format ? h.format : "{yyyy}-{MM}-{dd}";
            this.minView = h.minView ? h.minView : 2;
            this.startDate = h.startDate ? h.startDate : null;
            this.endDate = h.endDate ? h.endDate : null;
            this.dateBtnGroup = h.dateBtnGroup;
            $("body").append(m.get("datetimepicker"))
        },
        delegateEvents: function() {
            var h = this;
            $("#datetime-back").on("tap", function() {
                $(h.preEl).removeClass("hide");
                $("#date-selected").addClass("hide");
                window.scrollTo(0, h.scrollvalue);
                h.remove()
            })
        },
        render: function() {
            var h = this;
            $("#datetimepicker").datetimepicker({
                dateBtnGroup: h.dateBtnGroup,
                format: h.format,
                weekStart: 1,
                todayBtn: 1,
                todayHighlight: 1,
                startView: h.startView,
                minView: h.minView,
                startDate: h.startDate,
                endDate: h.endDate,
                language: "zh_CN"
            }).on("changeDate", function(g) {
                g = g.date;
                16 < h.format.length && g.setHours(g.getHours() - 8);
                g || (g = "");
                g instanceof Date && (g = g.format(h.format));
                h.el.trigger("dateConfirm", {
                    date: g
                });
                $("#date-selected").addClass("hide");
                $(h.preEl).removeClass("hide");
                window.scrollTo(0, h.scrollvalue);
                h.remove()
            });
            setTimeout(function() {
                $("#date-selected").removeClass("hide")
            }, 100)
        },
        remove: function() {
            $("#date-selected").remove()
        }
    });
    u.exports = DateTimePicker
});
define("form/component/text", ["form/editablecomponent", "form/tplutil", "form/componentmodel"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel");
    window.Text = m.extend({
        initialize: function(f) {
            m.prototype.initialize.call(this, f);
            var d = {
                componentKey: "Text",
                title: "\u6587\u672c\u8f93\u5165\u6846",
                maxlen: 200,
                unique: !1
            };
            null != f && (d.title = f.title,
            d.maxlen = f.maxlen,
            d.unique = f.unique);
            this.componentSetup = $.extend(this.componentSetup, d);
            this.tpl = h.get("text", {
                isMobileForm: this.isMobileForm
            });
            this.componentModel = new g
        },
        setMaxlen: function(f) {
            this.componentSetup.maxlen = f
        },
        setUnique: function(f) {
            this.componentSetup.unique = f
        },
        render: function(f) {
            var d = $(this.tpl).siblings("#form-text");
            m.prototype.render.call(this, f, d);
            "true" != this.componentSetup.isDefault && 1 != this.componentSetup.isDefault || d.find(".field-value_js").attr("value", this.componentSetup.content);
            f.html(d.html())
        },
        renderEditPreview: function(f) {
            var d = $(this.tpl).siblings("#form-text");
            m.prototype.renderEditPreview.call(this, f, d);
            f.append(d)
        },
        renderEditor: function() {
            var f = $(this.tpl).siblings("#editor-text");
            f.find("input:radio[name\x3d'componentType'][value\x3d'" + this.componentSetup.componentKey + "']").attr("checked", "true");
            "true" != this.componentSetup.unique && 1 != this.componentSetup.unique || f.find("#unique").attr("checked", !0);
            var d = this.componentSetup.maxlen;
            null != d && f.find("#text-max-input").attr("value", d);
            m.prototype.renderEditor.call(this, f);
            $("#editor-component").html(f.html());
            f = $("#editor-component").find("#content").val();
            null != f && null != d && f.length > d && ($("#editor-component").find("#content").attr("value", f.substring(0, d)),
            this.componentSetup.content = f.substring(0, d))
        },
        renderPreview: function(f, d, b) {
            var c = $(this.tpl).siblings("#preview-text");
            c.find(".form-control").attr("placeholder", null == this.componentSetup.placeholder || 1 > this.componentSetup.placeholder.length ? "\u8bf7\u586b\u5199" + this.componentSetup.title : this.componentSetup.placeholder);
            d && c.find(".check_js").val("");
            m.prototype.renderPreview.call(this, f, d, b, c);
            f.append(c)
        },
        change: function(f) {
            var d = f.oldObj;
            f = f.changeEl;
            this.componentSetup.title = d.componentSetup.title;
            this.componentSetup.describe = d.componentSetup.describe;
            this.componentSetup.required = d.componentSetup.required;
            this.componentSetup.fieldId = d.componentSetup.fieldId;
            this.componentSetup.tempId = d.componentSetup.tempId;
            this.componentSetup.size = d.componentSetup.size;
            this.componentSetup.isDefault = d.componentSetup.isDefault;
            this.componentSetup.isReadOnly = d.componentSetup.isReadOnly;
            this.componentSetup.content = d.componentSetup.content;
            this.componentSetup.maxlen = d.componentSetup.maxlen;
            this.render(f)
        },
        renderStatSearch: function(f) {
            var d = $(this.tpl)
              , b = f.term
              , c = f.parentEl
              , g = f.value
              , e = null;
            if ("mobile" != window.systemInfo_form)
                e = d.siblings("#statsearch-text"),
                g && e.find("input").val(g),
                b && e.find("select:first option[value\x3d" + b + "]").attr("selected", "true"),
                c.attr("class", "sch-group j_formFieldSearchGroup"),
                c.find(".j_formField-condition").html(e);
            else {
                var e = d.siblings("#statsearch-text-mobile")
                  , d = f.fieldId
                  , b = f.subFormId
                  , g = f.fieldTitle
                  , a = f.filterEl;
                f = f.condition;
                a && (a = a.find(".j_filterList .selectd #comp-val span").text(),
                e.find(".j_compVal").val(a));
                f && (e.find(".j_condition").find('option[value\x3d"' + f + '"]').attr("selected", !0),
                "null" != f && "notnull" != f || e.find(".j_control").hide());
                e.find(".j_inputName").text(g + ":");
                c.find("#component-div").html(e);
                c.find(".j_comp-ok").attr("comKey", "Text").attr("fieldId", d).attr("title", g).attr("subFormId", b);
                c.off("change", "#statsearch-text-mobile .j_condition").on("change", "#statsearch-text-mobile .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? c.find("#statsearch-text-mobile .j_control").hide() : c.find("#statsearch-text-mobile .j_control").show()
                })
            }
        },
        checkEvents: function(f, d) {
            var b = this
              , c = b.el || $(document);
            d || (c.on("keyup", "input[componentKey\x3d'Text'][id\x3d'" + (b.componentSetup.fieldId || b.componentSetup.tempId) + "'][cid\x3d'" + b.cid + "']", function() {
                var c = $(this).val()
                  , e = b.componentSetup.maxlen;
                c.length > parseInt(e) && (c = c.substring(0, e),
                $(this).val(c))
            }),
            c.on("blur", "input[id\x3d'" + (b.componentSetup.fieldId || b.componentSetup.tempId) + "'][cid\x3d'" + b.cid + "']", function() {
                var c = b.check($(this));
                f(c)
            }))
        },
        autoSaveEvents: function(f) {
            var d = this
              , b = d.el || $(document);
            b.on("keyup", "input[componentKey\x3d'Text'][id\x3d'" + d.componentSetup.fieldId + "'][cid\x3d'" + d.cid + "']", function() {
                var c = $(this).val()
                  , b = d.componentSetup.maxlen;
                $(this).data("maxed");
                c.length > parseInt(b) && (c = c.substring(0, b),
                $(this).val(c),
                $(this).data("maxed", !0))
            });
            b.on("blur", "input[id\x3d'" + d.componentSetup.fieldId + "'][cid\x3d'" + d.cid + "']", function() {
                $(this).val();
                var c = $(this).data("maxed")
                  , b = $(this).data("saved");
                c && !b && (d.saveComponentValue($(this), f),
                $(this).data("saved", !0))
            });
            b.on("change", "input[id\x3d'" + d.componentSetup.fieldId + "'][cid\x3d'" + d.cid + "']", function() {
                d.saveComponentValue($(this), f);
                $(this).data("saved", !0)
            })
        },
        check: function(f) {
            var d = this
              , b = $.trim(f.val())
              , c = f.attr("placeholder")
              , g = {};
            g.element = f;
            b == c && (b = "");
            if ("" == b && ("true" == this.componentSetup.required || 1 == this.componentSetup.required))
                return g.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a",
                g;
            "" == b || "true" != this.componentSetup.unique && 1 != this.componentSetup.unique || (b = d.getValue(f),
            f = f.closest(".form-view_js").data("form"),
            b.formId = $("#formId").val(),
            b.dataId = $("#dataId").val(),
            this.componentModel.checkUnique({
                dataDetail: b,
                module: f.module
            }, function(e) {
                e.message && e.message && (g.message = d.componentSetup.title + e.message)
            }));
            return g
        },
        getValue: function(f, d) {
            var b = $.trim(f.val())
              , c = f.attr("placeholder")
              , g = {
                formField: {
                    id: this.componentSetup.fieldId
                },
                content: b
            };
            return "" != b && b != c || d ? g : null
        },
        setValue: function(f, d) {
            if (null != d) {
                var b = d.content;
                this.componentSetup.fieldId ? (f.find("#" + this.componentSetup.fieldId).val(b),
                f.find(".j_readOnly").html(b)) : f.find("[cid\x3d'" + this.cid + "']").val(b)
            }
        },
        empty: function(f) {
            this.componentSetup.fieldId ? f.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val("") : f.find("[cid\x3d'" + this.cid + "']").val("");
            f.find(".j_readOnly").html("")
        },
        readOnly: function(f, d) {
            var b = f.find("input[id\x3d'" + this.componentSetup.fieldId + "'][cid\x3d'" + this.cid + "']")
              , b = this.isMobileForm ? b.parent() : b;
            d ? (b.addClass("hide"),
            b.siblings(".j_readOnly").removeClass("hide")) : (b.removeClass("hide"),
            b.siblings(".j_readOnly").addClass("hide"))
        }
    });
    u.exports = window.Text
});
define("form/component/textarea", ["form/editablecomponent", "form/tplutil", _formDesign+"/static/js/ckeditor/ckeditor.js"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil");
    n(_formDesign+"/static/js/ckeditor/ckeditor.js");
    window.TextArea = m.extend({
        initialize: function(g) {
            m.prototype.initialize.call(this, g);
            var f = {
                componentKey: "TextArea",
                title: "\u591a\u884c\u6587\u672c\u6846",
                maxlen: 200,
                minhg: 80,
                richEditor: !1
            };
            null != g && (f.title = g.title,
            f.maxlen = g.maxlen,
            f.minhg = g.minhg,
            f.richEditor = g.richEditor,
            1 == f.richEditor || "true" == f.richEditor) && (f.richText = g.content);
            this.componentSetup = $.extend(this.componentSetup, f);
            this.tpl = h.get("textarea", {
                isMobileForm: this.isMobileForm
            })
        },
        setMinHg: function(g) {
            this.componentSetup.minhg = g
        },
        setRichEditor: function(g) {
            this.componentSetup.richEditor = g
        },
        render: function(g) {
            var f = $(this.tpl).siblings("#form-textarea");
            m.prototype.render.call(this, g, f);
            if ("true" == this.componentSetup.isDefault || 1 == this.componentSetup.isDefault)
                f.find(".field-value_js").attr("value", this.componentSetup.content),
                f.find(".field-value_js").text(this.componentSetup.content);
            g.html(f.html())
        },
        renderEditPreview: function(g) {
            var f = $(this.tpl).siblings("#form-textarea");
            m.prototype.renderEditPreview.call(this, g, f);
            f.find(".field-value_js").css("min-height", this.componentSetup.minhg);
            g.append(f)
        },
        renderEditor: function() {
            var g = $(this.tpl).siblings("#editor-textarea");
            g.find("input:radio[name\x3d'componentType'][value\x3d'" + this.componentSetup.componentKey + "']").attr("checked", "true");
            m.prototype.renderEditor.call(this, g);
            g.find("#textarea-min-height-input").attr("value", this.componentSetup.minhg);
            g.find("#content").text(this.componentSetup.content);
            if (1 == this.componentSetup.richEditor || "true" == this.componentSetup.richEditor)
                g.find("#richEditor").attr("checked", "true"),
                g.find(".j_type_switch").addClass("hide"),
                g.find(".j_control_size").addClass("hide");
            $("#editor-component").html(g.html())
        },
        renderPreview: function(g, f, d) {
            var b = this
              , c = $(this.tpl).siblings("#preview-textarea");
            f && c.find(".check_js").val("");
            c.find(".form-control").attr("placeholder", null == this.componentSetup.placeholder || 1 > this.componentSetup.placeholder.length ? "\u8bf7\u586b\u5199" + this.componentSetup.title : this.componentSetup.placeholder);
            m.prototype.renderPreview.call(this, g, f, d, c);
            c.find("textarea[id\x3d'" + (b.componentSetup.fieldId || b.componentSetup.tempId) + "'][cid\x3d'" + b.cid + "']").css('min-height', this.componentSetup.minhg);

            f = b.componentSetup.fieldId || b.componentSetup.tempId;
            var l = f + b.cid;
            c.find("#" + f).addClass(l);
            g.append(c);
            "mobile" == window.systemInfo_form || window.inPrintPage || (this.componentSetup.isReadOnly = d,
            1 != this.componentSetup.richEditor && "true" != this.componentSetup.richEditor || "true" == d || 1 == d || setTimeout(function() {
                b.renderCkEditor(l, d)
            }, 1),
            1 == this.componentSetup.richEditor || "true" == this.componentSetup.richEditor || d || setTimeout(function() {
                g.find("#" + (b.componentSetup.fieldId || b.componentSetup.tempId)).autosize()
            }))
        },
        change: function(g) {
            var f = g.oldObj;
            g = g.changeEl;
            this.componentSetup.title = f.componentSetup.title;
            this.componentSetup.describe = f.componentSetup.describe;
            this.componentSetup.required = f.componentSetup.required;
            this.componentSetup.fieldId = f.componentSetup.fieldId;
            this.componentSetup.tempId = f.componentSetup.tempId;
            this.componentSetup.size = f.componentSetup.size;
            this.componentSetup.isDefault = f.componentSetup.isDefault;
            this.componentSetup.isReadOnly = f.componentSetup.isReadOnly;
            this.componentSetup.maxlen = f.componentSetup.maxlen;
            this.componentSetup.minhg = f.componentSetup.minhg;
            this.componentSetup.content = f.componentSetup.content;
            this.componentSetup.richEditor = f.componentSetup.richEditor;
            this.render(g)
        },
        renderStatSearch: function(g) {
            var f = $(this.tpl)
              , d = g.value
              , b = g.term
              , c = g.parentEl
              , l = null;
            if ("mobile" != window.systemInfo_form)
                l = f.siblings("#statsearch-textarea"),
                d && l.find("input").val(d),
                b && l.find("select:first option[value\x3d" + b + "]").attr("selected", "true"),
                c.attr("class", "sch-group j_formFieldSearchGroup"),
                c.find(".j_formField-condition").html(l);
            else {
                var l = f.siblings("#statsearch-textarea-mobile")
                  , f = g.fieldId
                  , d = g.subFormId
                  , e = g.filterEl
                  , b = g.fieldTitle;
                g = g.condition;
                e && (e = e.find(".j_filterList .selectd #comp-val span").text(),
                l.find(".j_compVal").val(e));
                g && (l.find(".j_condition").find('option[value\x3d"' + g + '"]').attr("selected", !0),
                "null" != g && "notnull" != g || l.find(".j_control").hide());
                l.find(".j_inputName").text(b + ":");
                c.find("#component-div").html(l);
                c.find(".j_comp-ok").attr("comKey", "TextArea").attr("fieldId", f).attr("title", b).attr("subFormId", d);
                c.off("change", "#statsearch-textarea-mobile .j_condition").on("change", "#statsearch-textarea-mobile .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? c.find("#statsearch-textarea-mobile .j_control").hide() : c.find("#statsearch-textarea-mobile .j_control").show()
                })
            }
        },
        checkEvents: function(g) {
            var f = this;
            (f.el || $(document)).on("blur", "textarea[id\x3d'" + (f.componentSetup.fieldId || f.componentSetup.tempId) + "'][cid\x3d'" + f.cid + "']", function() {
                var d = f.check($(this));
                g(d)
            })
        },
        autoSaveEvents: function(g) {
            var f = this;
            if (1 == this.componentSetup.richEditor || "true" == this.componentSetup.richEditor)
                f.componentSetup.autoSaveTemp = g;
            (f.el || $(document)).on("change", "textarea[id\x3d'" + f.componentSetup.fieldId + "'][cid\x3d'" + f.cid + "']", function() {
                f.saveComponentValue($(this), g)
            })
        },
        check: function(g) {
            var f = $.trim(g.val());
            "mobile" == window.systemInfo_form || 1 != this.componentSetup.richEditor && "true" != this.componentSetup.richEditor || (f = this.componentSetup.richText);
            var d = {};
            d.element = g;
            f || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (d.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            return d
        },
        ltrim: function(g) {
            return (g || "").replace(/^\s+/g, "")
        },
        rtrim: function(g) {
            return (g || "").replace(/\s+$/g, "")
        },
        getValue: function(g, f) {
            var d = this.rtrim(g.val())
              , b = "";
            "mobile" == window.systemInfo_form || 1 != this.componentSetup.richEditor && "true" != this.componentSetup.richEditor || !(d = this.componentSetup.richText) || (b = this.componentSetup.richEditorContent);
            var c = g.attr("placeholder")
              , b = {
                formField: {
                    id: this.componentSetup.fieldId
                },
                dataText: {
                    content: d,
                    richContent: b
                }
            };
            return "" != d && d != c || f ? b : null
        },
        setValue: function(g, f) {
            if (null != f) {
                var d = f.content;
                null != f.dataText && ("mobile" == window.systemInfo_form || !f.dataText.richContent || 1 != this.componentSetup.richEditor && "true" != this.componentSetup.richEditor ? d = f.dataText.content : (d = f.dataText.richContent,
                this.componentSetup.richEditorContent = f.dataText.richContent,
                this.componentSetup.richText = f.dataText.content));
                d = d + "" || "";
                g.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val(d);
                "mobile" == window.systemInfo_form || !this.componentSetup.richEditor || 1 != this.componentSetup.richEditor && "true" != this.componentSetup.richEditor || (this.ckeditor && this.ckeditor.setData(d),
                this.componentSetup.richEditorContent = d);
                1 != this.componentSetup.richEditor && "true" != this.componentSetup.richEditor && (d = d.replace(/ /g, "\x26nbsp;").replace(/\n/g, "\x3cbr/\x3e"));
                g.find(".j_readOnly").html(d)
            }
        },
        empty: function(g) {
            g.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val("");
            g.find(".j_readOnly").html("")
        },
        readOnly: function(g, f) {
            var d = g.find("textarea[id\x3d'" + this.componentSetup.fieldId + "'][cid\x3d'" + this.cid + "']")
              , d = this.isMobileForm ? d.parent() : d;
            f ? (d.addClass("hide"),
            d.siblings(".j_readOnly").removeClass("hide")) : (d.removeClass("hide"),
            d.siblings(".j_readOnly").addClass("hide"))
        },
        renderCkEditor: function(g, f) {
            var d = this
              , b = CKEDITOR.replaceAll(g);
            if (b) {
                d.ckeditor = b;
                b.config.toolbar = [{
                    name: "tools",
                    items: "Bold Italic Underline TextColor BGColor NumberedList BulletedList - JustifyLeft JustifyCenter JustifyRight JustifyBlock Font FontSize".split(" ")
                }, {
                    name: "colors"
                }];
                b.config.height = "100px";
                b.config.removePlugins = "elementspath";
                b.config.toolbarCanCollapse = !0;
                b.config.toolbarStartupExpanded = !0;
                b.config.disableNativeSpellChecker = !1;
                var c = d.componentSetup.fieldId;
                c || (c = d.componentSetup.tempId);
                b.on("blur", function() {
                    d.componentSetup.richEditorContent = this.getData();
                    d.componentSetup.richText = this.document.getBody().getText();
                    d.componentSetup.autoSaveTemp && (d.el || $(document),
                    d.saveComponentValue($("#" + c), d.componentSetup.autoSaveTemp))
                });
                b.on("change", function(c) {
                    d.componentSetup.richEditorContent = this.getData();
                    d.componentSetup.richText = this.document.getBody().getText()
                });
                b.on("instanceReady", function() {
                    !f || 1 != f && "true" != f || this.setReadOnly(!0);
                    d.componentSetup.richEditorContent ? b.setData(d.componentSetup.richEditorContent) : b.setData(d.componentSetup.content)
                })
            }
        }
    });
    u.exports = window.TextArea
});
define("form/component/productioncomponent", "form/relatecomponent form/tplutil form/componentmodel form/component/productionlist form/component/entityselecter form/component/typeahead form/component/relevancecontrol form/abposview".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel")
      , f = n("form/component/productionlist")
      , d = n("form/component/entityselecter")
      , b = n("form/component/typeahead")
      , c = n("form/component/relevancecontrol")
      , l = n("form/abposview");
    window.ProductionComponent = m.extend({
    });
    u.exports = window.ProductionComponent
});
define("form/component/contractlist", ["form/tplutil", "form/component/formfilter"], function(n, y, u) {
    var m = n("form/tplutil")
      , h = n("form/component/formfilter");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/entityselecter", ["form/component", "form/tplutil", "form/component/formfilter", "form/component/documentselecter"], function(n, y, u) {
    n("form/component");
    var m = n("form/tplutil")
      , h = n("form/component/formfilter")
      , g = n("form/component/documentselecter");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/formfilter", ["form/tplutil"], function(n, y, u) {
    var m = n("form/tplutil");
    n = Backbone.View.extend({
        initialize: function(h) {
            this.managers = [];
            this.tags = [];
            this.mainlines = [];
            this.comments = [];
            this.searchs = [];
            this.status = [];
            this.formtypes = [];
            this.creators = [];
            this.showRepeat = "";
            this.el = h.el;
            this.module = h.module;
            this.userId = h.userId;
            this.scroll = h.scroll;
            this.scrollheight = h.scrollheight;
            this.targetObj = h.targetObj;
            this.isRelevance = h.isRelevance;
            this.tpl = m.get("formfilter");
            $(this.el).append($(this.tpl))
        },
        delegateEvents: function() {
            var h = this
              , g = $(this.el).find("#formfilter-div");
            g.off("click.filter", ".filter-cancle").on("click.filter", ".filter-cancle", function(f) {
                h.resetArray();
                g.find(".employee-click").removeClass("checked");
                g.find(".comment-click").removeClass("checked");
                g.find(".tag-click").removeClass("checked");
                g.find(".mainline-click").removeClass("checked");
                g.find(".repeat-click").removeClass("checked");
                g.find(".status-click").removeClass("checked");
                g.find(".datepicker").val("");
                "formdatareport" === h.module ? h.queryDefaultData("", "formdatareport", function(d) {
                    h.renderDataList(d.employees, "employee");
                    d = d.newForms;
                    for (var b = $(h.el).find("#form-filter").html(""), c = 0; c < d.length; c++) {
                        var f = d[c];
                        b.append('\x3cspan class\x3d"filter-item"\x3e\x3ca data-entity\x3d"' + f.id + '" class\x3d"comment-click"\x3e' + f.name + "\x3c/a\x3e\x3c/span\x3e")
                    }
                }) : "subordinate" === h.module ? h.queryDefaultData("subordinate", h.module, function(d) {
                    h.renderDataList(d.directsubordinates, "directsubordinate");
                    h.renderDataList(d.indirectsubordinates, "indirectsubordinate")
                }) : "biaoge" == h.module ? h.queryDefaultData("", h.module, function(d) {
                    h.renderDataList(d.employees, "employee");
                    $(h.el).find("#formtag-filter").html("");
                    d = d.formtags;
                    for (var b = 0; b < d.length; b++) {
                        var c = d[b]
                          , c = '\x3cspan class\x3d"filter-item"\x3e\x3ca data-entity\x3d"' + c.id + '" class\x3d"tag-click"\x3e' + c.name + "\x3c/a\x3e\x3c/span\x3e";
                        $(h.el).find("#formtag-filter").append(c)
                    }
                }) : "task" == h.module || "mainline" == h.module || "document" == h.module ? h.queryDefaultData("", h.module, function(d) {
                    h.renderDataList(d.employees, "employee-manager");
                    h.renderDataList(d.employees, "employee-creator");
                    h.renderDataList(d.tags, "tag");
                    h.renderDataList(d.mainlines, "mainline")
                }) : h.queryDefaultData("", h.module, function(d) {
                    h.renderDataList(d.employees, "employee");
                    h.renderDataList(d.tags, "tag");
                    h.renderDataList(d.mainlines, "mainline")
                });
                $(".typehead").val("");
                h.triggerFilter()
            });
            g.off("click.filter", ".filter-submit").on("click.filter", ".filter-submit", function(f) {
                var d = []
                  , b = f = !1
                  , c = !1
                  , l = !1;
                if ("formdatareport" === h.module)
                    return h.targetObj.trigger("filter"),
                    !0;
                $.each(h.$el.find("#due-time-filter input"), function(e, a) {
                    var c = $(a);
                    c.val() && d.push('"' + c.attr("name") + '" : "' + c.val() + '"')
                });
                $.each(h.$el.find("#entrust-time-filter input"), function(e, a) {
                    var c = $(a);
                    c.val() && d.push('"' + c.attr("name") + '" : "' + c.val() + 'T00:00:00.000+0800"')
                });
                "task" == h.module || "mainline" == h.module || "document" == h.module ? h.managers && 0 < h.managers.length && (f = '"managers":' + JSON.stringify(h.managers)) : h.managers && 0 < h.managers.length && (f = '"primarys":' + JSON.stringify(h.managers));
                h.creators && 0 < h.creators.length && (b = '"creators":' + JSON.stringify(h.creators));
                h.tags && 0 < h.tags.length && (c = '"tags":' + JSON.stringify(h.tags));
                h.mainlines && 0 < h.mainlines.length && (l = '"mainlines":' + JSON.stringify(h.mainlines));
                h.showRepeat && 0 < h.showRepeat.length && d.push('"showRepeat":"' + h.showRepeat + '"');
                h.status && 0 < h.status.length && d.push('"status":"' + h.status[0] + '"');
                f && d.push(f);
                b && d.push(b);
                c && d.push(c);
                l && d.push(l);
                "customer" == h.module || "task" == h.module || "saleChance" == h.module || "production" == h.module || "competitor" == h.module || "marketactivity" == h.module || "contract" == h.module ? 0 < h.comments.length && d.push('"commentType":"' + h.comments[0] + '"') : "document" == h.module ? 0 < h.comments.length && d.push('"docType":' + JSON.stringify(h.comments)) : ("workflow" == h.module || "entrustWorkflow" == h.module) && 0 < h.comments.length && d.push('"formIds":' + JSON.stringify(h.comments));
                h.targetObj.data("data-filter", d.join(","));
                h.targetObj.trigger("filter")
            });
            null != $(h.el).parents(".modal").get(0) && ($(h.el + " input#due-time-begin").removeAttr("insertafter"),
            $(h.el + " input#due-time-end").removeAttr("insertafter"));
            formPlugin.datepicker([{
                el: h.el + " input#due-time-begin",
                callback: function(f) {
                    h.setDueDate(f, h.el + " input#due-time-begin");
                    h.triggerFilter()
                }
            }, {
                el: h.el + " input#due-time-end",
                callback: function(f) {
                    h.setDueDate(f, h.el + " input#due-time-end");
                    h.triggerFilter()
                }
            }]);
            "biaoge" === h.module && formPlugin.datepicker([{
                el: "input#formcreate-time-begin",
                callback: function(f) {
                    h.triggerFilter()
                }
            }, {
                el: "input#formcreate-time-end",
                callback: function(f) {
                    h.triggerFilter()
                }
            }]);
            "formdatareport" === h.module && formPlugin.datepicker([{
                el: "input#report-time-begin",
                callback: function(f) {
                    h.triggerFilter()
                }
            }, {
                el: "input#report-time-end",
                callback: function(f) {
                    h.triggerFilter()
                }
            }]);
            "entrustWorkflow" === h.module && formPlugin.datepicker([{
                el: "input#entrust-time-begin",
                callback: function(f) {
                    h.triggerFilter()
                }
            }, {
                el: "input#entrust-time-end",
                callback: function(f) {
                    h.triggerFilter()
                }
            }]);
            g.off("click.filter", ".employee-click").on("click.filter", ".employee-click", function(f) {
                var d = $(this).attr("data-entity");
                $(this).hasClass("checked") ? (h.managers.remove(function(b) {
                    return b == d
                }),
                $(this).removeClass("checked")) : (h.managers.push(d),
                $(this).addClass("checked"));
                h.triggerFilter()
            });
            g.off("click.filter", ".employee-manager-click").on("click.filter", ".employee-manager-click", function(f) {
                var d = $(this).attr("data-entity");
                $(this).hasClass("checked") ? (h.managers.remove(function(b) {
                    return b == d
                }),
                $(this).removeClass("checked")) : (h.managers.push(d),
                $(this).addClass("checked"));
                h.triggerFilter()
            });
            g.off("click.filter", ".employee-creator-click").on("click.filter", ".employee-creator-click", function(f) {
                var d = $(this).attr("data-entity");
                $(this).hasClass("checked") ? (h.creators.remove(function(b) {
                    return b == d
                }),
                $(this).removeClass("checked")) : (h.creators.push(d),
                $(this).addClass("checked"));
                h.triggerFilter()
            });
            g.off("click.filter", ".comment-click").on("click.filter", ".comment-click", function(f) {
                var d = $(this).attr("data-entity");
                "task" == h.module || "customer" == h.module || "saleChance" == h.module || "production" == h.module || "competitor" == h.module || "marketactivity" == h.module || "contract" == h.module ? $(this).hasClass("checked") ? ($(this).removeClass("checked"),
                h.comments = []) : ($(".comment-click").removeClass("checked"),
                $(this).addClass("checked"),
                h.comments = [],
                h.comments.push(d)) : $(this).hasClass("checked") ? ($(this).removeClass("checked"),
                h.comments.remove(function(b) {
                    return b == d
                })) : ($(this).removeClass("checked"),
                $(this).addClass("checked"),
                h.comments.push(d));
                h.triggerFilter()
            });
            g.off("click.filter", ".tag-click").on("click.filter", ".tag-click", function(f) {
                var d = $(this).attr("data-entity");
                $(this).hasClass("checked") ? (h.tags.remove(function(b) {
                    return b == d
                }),
                $(this).removeClass("checked")) : (h.tags.push(d),
                $(this).addClass("checked"));
                h.triggerFilter()
            });
            g.off("click.filter", ".status-click").on("click.filter", ".status-click", function(f) {
                var d = $(this).attr("data-entity");
                $(this).hasClass("checked") ? (h.status.remove(function(b) {
                    return b == d
                }),
                $(this).removeClass("checked")) : (h.status.push(d),
                $(this).addClass("checked"));
                h.triggerFilter()
            });
            g.off("click.filter", ".formtype-click").on("click.filter", ".formtype-click", function(f) {
                var d = $(this).attr("data-entity");
                $(this).hasClass("checked") ? (h.formtypes.remove(function(b) {
                    return b == d
                }),
                $(this).removeClass("checked")) : (h.formtypes.push(d),
                $(this).addClass("checked"));
                h.triggerFilter()
            });
            g.off("click.filter", ".mainline-click").on("click.filter", ".mainline-click", function(f) {
                var d = $(this).attr("data-entity");
                $(this).hasClass("checked") ? (h.mainlines.remove(function(b) {
                    return b == d
                }),
                $(this).removeClass("checked")) : (h.mainlines.push(d),
                $(this).addClass("checked"));
                h.triggerFilter()
            });
            g.off("click.filter", ".repeat-click").on("click.filter", ".repeat-click", function(f) {
                f = $(this).attr("data-entity");
                $(this).hasClass("checked") ? (h.showRepeat = "",
                $(this).removeClass("checked")) : (h.showRepeat = f,
                $(this).addClass("checked"));
                h.triggerFilter()
            });
            g.off("search.filter", ".input").on("search.filter", "input", function(f) {
                f = $.trim($(this).val());
                var d = $(this).attr("data-entity");
                f && 0 < f.length ? h.searchData(f, d) : (f = "",
                "subordinate" == h.module && (f = "subordinate"),
                h.queryDefaultData(f, h.module, function(b) {
                    if ("employee" == d || "employee-manager" == d || "employee-creator" == d)
                        h.renderDataList(b.employees, d);
                    else if ("tag" == d)
                        h.renderDataList(b.tags, "tag");
                    else if ("mainline" == d)
                        h.renderDataList(b.mainlines, "mainline");
                    else if ("subordinate" == h.module)
                        h.renderDataList(b.directsubordinates, "directsubordinate"),
                        h.renderDataList(b.indirectsubordinates, "indirectsubordinate");
                    else if ("formtag" == d) {
                        $(h.el).find("#formtag-filter").html("");
                        b = b.formtags;
                        for (var c = 0; c < b.length; c++) {
                            var f = b[c]
                              , f = '\x3cspan class\x3d"filter-item"\x3e\x3ca data-entity\x3d"' + f.id + '" class\x3d"tag-click"\x3e' + f.name + "\x3c/a\x3e\x3c/span\x3e";
                            $(h.el).find("#formtag-filter").append(f)
                        }
                    } else
                        "workflow" == d && (b = b.newForms,
                        c = [],
                        c = b && 10 > b.length ? b.slice(0, b.length) : b.slice(0, 10),
                        h.renderDataList(c, "workflow"))
                }))
            });
            g.off("keyup.filter", ".input").on("keyup.filter", "input", function(f) {
                13 == (f ? f : window.event ? window.event : null).keyCode && $(this).trigger("search")
            });
            g.off("click.filter", ".status-click").on("click.filter", ".status-click", function(f) {
                f = $(this).attr("data-entity");
                $(this).hasClass("checked") ? (h.status = [],
                $(this).removeClass("checked")) : ($(".status-click").removeClass("checked"),
                $(this).addClass("checked"),
                h.status = [],
                h.status.push(f));
                h.triggerFilter()
            })
        },
        render: function() {
            var h = this;
            "mainline" == h.module ? ($("#employee-title").parent(".filter-group").addClass("hide"),
            h.isRelevance && ($(h.el).find("#filter-ifrepeat").parent(".filter-group").append('\x3cdiv id\x3d"tag-filter" class\x3d"filter-content tag-div"\x3e\x3c/div\x3e'),
            $(h.el).find("#mainline-status").parent(".filter-group").removeClass("hide")),
            $(h.el).find("#employee-type-creator-" + h.module).removeClass("hide").parents(".filter-group").removeClass("hide"),
            $(h.el).find("#employee-type-manager-" + h.module).removeClass("hide").parents(".filter-group").removeClass("hide"),
            $(".comment-div").addClass("hide"),
            $(".mainline-div").addClass("hide")) : "tag" == h.module ? ($("#employee-type-" + h.module).removeClass("hide"),
            $(".comment-div").addClass("hide"),
            $(".mainline-div").addClass("hide"),
            $(".tag-div").addClass("hide")) : "blog" == h.module ? ($("#blog-group-tab").removeClass("hide"),
            $("#employee-type-" + h.module).removeClass("hide"),
            $("#mainline").addClass("hide"),
            $("#mainline-filter").addClass("hide"),
            $("#tag").addClass("hide"),
            $("#tag-filter").addClass("hide"),
            $("#comment").addClass("hide")) : "formmanage" == h.module ? ($(".comment-div").addClass("hide"),
            $(".mainline-div").addClass("hide"),
            $(".tag-div").addClass("hide"),
            $("#employee-filter").addClass("hide"),
            $("#employee-title").addClass("hide"),
            $(".formstatus-div").removeClass("hide"),
            $(".relatedstatus-div").removeClass("hide"),
            $("#btns").addClass("hide")) : "formdatareport" == h.module ? ($(h.el).find(".comment-div").addClass("hide"),
            $(h.el).find(".mainline-div").addClass("hide"),
            $(h.el).find(".tag-div").addClass("hide"),
            $(h.el).find(".datareport-div").removeClass("hide"),
            $(h.el).find("#employee-type-formdatareport").removeClass("hide")) : "subordinate" == h.module ? ($("#employee-type-direct" + h.module).parent().parent().removeClass("hide"),
            $("#employee-type-indirect" + h.module).parent().parent().removeClass("hide"),
            $("#employee-title").addClass("hide"),
            $("#mainline").addClass("hide"),
            $("#mainline-filter").addClass("hide"),
            $("#tag").addClass("hide"),
            $("#tag-filter").addClass("hide"),
            $("#comment").addClass("hide")) : "biaoge" == h.module ? ($("#employee-type-" + h.module).removeClass("hide"),
            $(".comment-div").addClass("hide"),
            $(".mainline-div").addClass("hide"),
            $(".tag-div").addClass("hide"),
            $(h.el).find("#formcreate-time").removeClass("hide"),
            $(h.el).find("#formcreate-time-filter").removeClass("hide"),
            $(h.el).find("#form-tag").removeClass("hide"),
            $(h.el).find(".j_formtag-input").removeClass("hide"),
            $(h.el).find("#formtag-filter").removeClass("hide"),
            $(h.el).find("#formtag-filter").empty(),
            $(".formtype-div").removeClass("hide")) : "task" == h.module || "document" == h.module || "customer" == h.module || "saleChance" == h.module || "competitor" == h.module || "marketactivity" == h.module || "contract" == h.module || "production" == h.module ? ($(h.el).find("#employee-title").parent(".filter-group").addClass("hide"),
            $(h.el).find("#comment-type-" + h.module).removeClass("hide"),
            $(h.el).find("#employee-type-creator-" + h.module).removeClass("hide").parents(".filter-group").removeClass("hide"),
            $(h.el).find("#employee-type-manager-" + h.module).removeClass("hide").parents(".filter-group").removeClass("hide"),
            $(h.el).find("#comment-filter-" + h.module).removeClass("hide"),
            "task" == h.module && ($("#filter-ifrepeat").parent(".filter-group").removeClass("hide"),
            h.isRelevance && ($(h.el).find("#filter-ifrepeat").parent(".filter-group").append('\x3cdiv id\x3d"tag-filter" class\x3d"filter-content tag-div"\x3e\x3c/div\x3e'),
            $(h.el).find("#task-status").parent(".filter-group").removeClass("hide")),
            $(h.el).find("#comment-filter-task #three_day-no").find("a").text("{0}{1}\u5929\u672a\u53cd\u9988\u7684\u4efb\u52a1".I18N(3)),
            $(h.el).find("#comment-filter-task #one_day-no").find("a").text("{0}\u5929\u672a\u53cd\u9988\u7684\u4efb\u52a1".I18N(1))),
            "customer" == h.module && ($(h.el).find("#comment-filter-customer #3day-no").find("a").text("{0}{1}\u5929\u672a\u8054\u7cfb\u7684\u5ba2\u6237".I18N(3)),
            $(h.el).find("#comment-filter-customer #1day-no").find("a").text("{0}\u5929\u672a\u8054\u7cfb\u7684\u5ba2\u6237".I18N(1))),
            "marketactivity" == h.module && ($(h.el).find("#comment-filter-marketactivity #3day-no").find("a").text("{0}{1}\u5929\u672a\u53cd\u9988\u7684\u5e02\u573a\u6d3b\u52a8".I18N(3)),
            $(h.el).find("#comment-filter-marketactivity #1day-no").find("a").text("{0}\u5929\u672a\u53cd\u9988\u7684\u5e02\u573a\u6d3b\u52a8".I18N(1))),
            "saleChance" == h.module && ($(h.el).find("#comment-filter-saleChance #3day-no").find("a").text("{0}{1}\u5929\u672a\u53cd\u9988\u7684\u5546\u673a".I18N(3)),
            $(h.el).find("#comment-filter-saleChance #1day-no").find("a").text("{0}\u5929\u672a\u53cd\u9988\u7684\u5546\u673a".I18N(1))),
            "production" == h.module && ($(h.el).find("#comment-filter-production #3day-no").find("a").text("{0}{1}\u5929\u672a\u53cd\u9988\u7684\u4ea7\u54c1".I18N(3)),
            $(h.el).find("#comment-filter-production #1day-no").find("a").text("{0}\u5929\u672a\u53cd\u9988\u7684\u4ea7\u54c1".I18N(1))),
            "competitor" == h.module && ($(h.el).find("#comment-filter-competitor #3day-no").find("a").text("{0}{1}\u5929\u672a\u53cd\u9988\u7684\u7ade\u4e89\u5bf9\u624b".I18N(3)),
            $(h.el).find("#comment-filter-competitor #1day-no").find("a").text("{0}\u5929\u672a\u53cd\u9988\u7684\u7ade\u4e89\u5bf9\u624b".I18N(1))),
            "contract" == h.module && ($(h.el).find("#comment-filter-contract #3day-no").find("a").text("{0}{1}\u5929\u672a\u53cd\u9988\u7684\u5408\u540c".I18N(3)),
            $(h.el).find("#comment-filter-contract #1day-no").find("a").text("{0}\u5929\u672a\u53cd\u9988\u7684\u5408\u540c".I18N(1)))) : "entrustWorkflow" == h.module ? ($(h.el).find("#comment-type-" + h.module).removeClass("hide"),
            $(h.el).find("#employee-type-" + h.module).removeClass("hide"),
            $(h.el).find("#comment-filter-" + h.module).removeClass("hide"),
            $(h.el).find(".entrust-div").removeClass("hide"),
            $(h.el).find(".j_mainlineDiv").addClass("hide"),
            $(h.el).find(".j_tagDiv").addClass("hide")) : "formselect" == h.module ? ($("#employee-type-biaoge").removeClass("hide"),
            $(".comment-div").addClass("hide"),
            $(".mainline-div").addClass("hide"),
            $(".tag-div").addClass("hide"),
            $(".formtype-div").removeClass("hide")) : ($(h.el).find("#comment-type-" + h.module).removeClass("hide"),
            $(h.el).find("#employee-type-" + h.module).removeClass("hide"),
            $(h.el).find("#comment-filter-" + h.module).removeClass("hide"));
            "competitor" != h.module && "production" != h.module && "marketactivity" != h.module && "contract" != h.module || $(h.el).find(".j_mainlineDiv").addClass("hide");
            "task" === h.module ? ($(h.el).find("#due-time").removeClass("hide"),
            $(h.el).find("#due-time-filter").removeClass("hide")) : ($(h.el).find("#due-time").addClass("hide"),
            $(h.el).find("#due-time-filter").addClass("hide"));
            var g = "";
            "subordinate" == h.module && (g = "subordinate");
            var f = h.module;
            "entrustWorkflow" == h.module && (f = "workflow");
            h.queryDefaultData(g, f, function(d) {
                if ("blog" == h.module)
                    h.renderDataList(d.employees, "employee");
                else if ("formdatareport" == h.module) {
                    h.renderDataList(d.employees, "employee");
                    var b = d.newForms;
                    for (d = 0; d < b.length; d++) {
                        var c = b[d]
                          , c = '\x3cspan class\x3d"filter-item"\x3e\x3ca data-entity\x3d"' + c.id + ' "title\x3d"' + c.name + '" class\x3d"comment-click"\x3e' + c.name + "\x3c/a\x3e\x3c/span\x3e";
                        $(h.el).find("#form-filter").append(c)
                    }
                } else if ("biaoge" == h.module)
                    for (h.renderDataList(d.employees, "employee"),
                    $(h.el).find("#formtag-filter").html(""),
                    b = d.formtags,
                    d = 0; d < b.length; d++)
                        c = b[d],
                        c = '\x3cspan class\x3d"filter-item"\x3e\x3ca data-entity\x3d"' + c.id + '" class\x3d"tag-click"\x3e' + c.name + "\x3c/a\x3e\x3c/span\x3e",
                        $(h.el).find("#formtag-filter").append(c);
                else if ("subordinate" == h.module)
                    h.renderDataList(d.directsubordinates, "directsubordinate"),
                    h.renderDataList(d.indirectsubordinates, "indirectsubordinate");
                else if ("task" == h.module || "mainline" == h.module || "document" == h.module || "customer" == h.module || "saleChance" == h.module || "competitor" == h.module || "marketactivity" == h.module || "contract" == h.module || "production" == h.module)
                    h.renderDataList(d.employees, "employee-manager"),
                    h.renderDataList(d.employees, "employee-creator"),
                    h.renderDataList(d.tags, "tag"),
                    h.renderDataList(d.mainlines, "mainline");
                else if ("entrustWorkflow" == h.module) {
                    if (h.renderDataList(d.employees, "employee"),
                    h.renderDataList(d.tags, "tag"),
                    d.newForms) {
                        var b = d.newForms
                          , f = 10;
                        10 > b.length && (f = b.length);
                        for (d = 0; d < f; d++)
                            c = b[d],
                            c = '\x3cspan class\x3d"filter-item"\x3e\x3ca data-entity\x3d"' + c.id + '" class\x3d"comment-click" title\x3d"' + c.name + '"\x3e' + c.name + "\x3c/a\x3e\x3c/span\x3e",
                            $(h.el).find("#comment-filter-entrustWorkflow").append(c)
                    }
                } else if (h.renderDataList(d.employees, "employee"),
                h.renderDataList(d.tags, "tag"),
                h.renderDataList(d.mainlines, "mainline"),
                "workflow" == h.module && d.newForms)
                    for (b = d.newForms,
                    f = 10,
                    10 > b.length && (f = b.length),
                    d = 0; d < f; d++)
                        c = b[d],
                        c = '\x3cspan class\x3d"filter-item"\x3e\x3ca data-entity\x3d"' + c.id + '" class\x3d"comment-click" title\x3d"' + c.name + '"\x3e' + c.name + "\x3c/a\x3e\x3c/span\x3e",
                        $(h.el).find("#comment-filter-workflow").append(c);
                h.scroll && (d = h.scrollheight ? h.scrollheight : 500,
                $(h.el).css("max-height", d + "px").attr("auto-scroll", "yes"),
                h.layout(h.el, [{
                    mouseWheel: {
                        enable: !0,
                        axis: "y",
                        preventDefault: !0
                    },
                    gotoTopButton: !1
                }]));
                $(h.el).find(".loading_large").hide();
                $(h.el).find("#info-div").show()
            })
        },
        queryDefaultData: function(h, g, f) {
            $.ajax({
                type: TEAMS.ajaxMethod,
                url: "/search/filter.json",
                dataType: "json",
                data: {
                    searchType: h,
                    module: g
                },
                success: function(d) {
                    f && f(d)
                }
            })
        },
        renderDataList: function(h, g) {
            var f = 0;
            h && (f = 30 < h.length ? 30 : h.length);
            "workflow" == g || "entrustWorkflow" == g ? $(this.el).find("#comment-filter-" + g).html("") : $(this.el).find("#" + g + "-filter").html("");
            for (var d = "", b = "", c = "", l = "", e = 0; e < f; e++) {
                var a = h[e];
                if (0 > d.indexOf(a.id))
                    if (d += a.id + ",",
                    "tag" == g && (b = a.privacy ? "privacy-tag" : "common-tag",
                    c = a.privacy ? "\u6211\u7684\u6807\u7b7e:" : "\u516c\u5171\u6807\u7b7e:"),
                    "workflow" == g || "entrustWorkflow" == g)
                        l = '\x3cspan class\x3d"filter-item"\x3e\x3ca data-entity\x3d"' + a.id + '" class\x3d"comment-click" title\x3d"' + a.name + '"\x3e' + a.name + "\x3c/a\x3e\x3c/span\x3e",
                        $(this.el).find("#comment-filter-" + g).append(l);
                    else if ("form" == g)
                        l = '\x3cspan class\x3d"filter-item"\x3e\x3ca data-entity\x3d"' + a.id + '" class\x3d"comment-click" title\x3d"' + a.name + '"\x3e' + a.name + "\x3c/a\x3e\x3c/span\x3e",
                        $(this.el).find("#form-filter").append(l);
                    else {
                        var k = $('\x3cspan class\x3d"' + b + ' filter-item"\x3e\x3ca\x3e\x3c/a\x3e\x3c/span\x3e')
                          , l = a.name.replace(/</g, "\x26lt").replace(/>/g, "\x26gt").replace("/[\r\n]/g", " ");
                        k.find("a").html(l).attr("data-entity", a.id).attr("title", c + l);
                        "indirectsubordinate" == g || "directsubordinate" == g ? k.find("a").addClass("employee-click") : k.find("a").addClass(g + "-click");
                        $(this.el).find("#" + g + "-filter").append(k)
                    }
            }
        },
        resetArray: function() {
            this.mainlines.length = 0;
            this.tags.length = 0;
            this.managers.length = 0;
            this.creators.length = 0;
            this.comments.length = 0;
            this.searchs.length = 0;
            this.status.length = 0;
            this.formtypes.length = 0;
            this.showRepeat = "";
            $(".filter-item .checked").each(function() {
                $(this).removeClass("checked")
            })
        },
        searchData: function(h, g) {
            this.resetArray();
            var f = this, d;
            0 == h.length && (f.searchs.length = 0);
            "tag" == g && (d = !0);
            f.arrayIndexOf(f.searchs, h) || (f.searchs.push(h),
            0 < h.length && $.ajax({
                type: TEAMS.ajaxMethod,
                url: TEAMS.api.suggestion,
                dataType: "json",
                contentType: "application/x-www-form-urlencoded;charset\x3dutf-8",
                data: "employee-creator" == g || "employee-manager" == g ? {
                    searchType: "employee",
                    module: f.module,
                    allTag: d,
                    keywords: h
                } : {
                    searchType: g,
                    module: f.module,
                    allTag: d,
                    keywords: h
                },
                success: function(b) {
                    b = "workflow" == g || "form" == g || "entrustWorkflow" == g ? b.newForms : "employee-creator" == g || "employee-manager" == g ? b.employees : b[g + "s"];
                    f.renderDataList(b, g);
                    return b
                }
            }))
        },
        arrayIndexOf: function(h, g) {
            if (h && 0 < h.length) {
                for (var f = 0; f < h.length; f++)
                    if (h[f] == g)
                        return !0;
                return !1
            }
        },
        triggerFilter: function() {
            $(this.el).find("#formfilter-div").find(".filter-submit").trigger("click.filter")
        },
        setDueDate: function(h, g) {
            var f = h.date.format("{yyyy}-{MM}-{dd}");
            $(g).val(f)
        },
        remove: function() {
            this.scroll && $(this.el).hasClass("mCustomScrollbar") && ($(this.el).mCustomScrollbar("destroy"),
            $(this.el).css("max-height", "none").removeAttr("auto-scroll"));
            $(this.el).find("#formfilter-div").off(".filter");
            this.managers && (this.managers.length = 0,
            this.managers = null);
            this.tags && (this.tags.length = 0,
            this.tags = null);
            this.searchs && (this.searchs.length = 0,
            this.searchs = null);
            this.comments && (this.comments.length = 0,
            this.comments = null);
            this.mainlines && (this.mainlines.length = 0,
            this.mainlines = null);
            this.status && (this.status.length = 0,
            this.status = null);
            this.formtypes && (this.formtypes.length = 0,
            this.formtypes = null);
            this.showRepeat && (this.showRepeat = "")
        },
        layout: function(h, g, f) {
            if (0 == h.indexOf("#print"))
                $(h).removeClass("scrollwrapper");
            else {
                var d = $(h);
                if (d.get(0)) {
                    var b = d.attr("height")
                      , c = d.attr("auto-scroll");
                    if (!b)
                        var b = d.attr("marginbottom") || 0
                          , l = d.offset().top
                          , b = $(window).height() - l - b;
                    l = d.attr("theme") ? d.attr("theme") : "darkblue";
                    if (!d.hasClass("mCustomScrollbar")) {
                        var e = {
                            onScroll: function() {
                                $("body .goto-top").removeClass("hide")
                            },
                            onTotalScrollBack: function() {
                                $("body .goto-top").addClass("hide")
                            }
                        };
                        if (g) {
                            $.isArray(g) && (f = g);
                            f && !f[0].gotoTopButton && (e.onScroll = null,
                            e.onTotalScrollBack = null);
                            var a = $.extend(e, g)
                        }
                        g = {
                            theme: l,
                            callbacks: a ? a : e
                        };
                        if (f)
                            var k = $.extend(g, f[0]);
                        f && "x" == f[0].axis && (c = "yes");
                        b && "yes" != c && d.css("height", b);
                        d.mCustomScrollbar(k ? k : g);
                        f && !f[0].bottomBlank && null != d.parents("#entitybox").get(0) && d.children().children(".mCSB_container").addClass("pb-0");
                        "#chat-container" == h && (d.mCustomScrollbar("update"),
                        d.mCustomScrollbar("scrollTo", "bottom"));
                        setTimeout(function() {
                            $("body .goto-top").addClass("hide")
                        }, 200)
                    }
                }
            }
        }
    });
    u.exports = n
});
define("form/component/dividingline", ["form/component", "form/tplutil"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil");
    window.DividingLine = y.extend({
        initialize: function(h) {
            this.componentSetup = {
                componentKey: "DividingLine",
                type: "solid",
                color: "#000000",
                order: 0,
                index: 0
            };
            null != h && (this.componentSetup.type = h.type,
            this.componentSetup.color = h.color,
            this.componentSetup.order = h.order,
            this.componentSetup.index = h.index);
            this.tpl = m.get("dividingline")
        },
        setType: function(h) {
            this.componentSetup.type = h
        },
        setColor: function(h) {
            this.componentSetup.color = h
        },
        render: function(h) {
            var g = $(this.tpl).siblings("#form-dividingline");
            h.attr("class", g.attr("class"));
            h.html(g.html())
        },
        renderEditor: function() {
            var h = $(this.tpl).siblings("#editor-dividingline")
              , g = this.componentSetup.type;
            "soliddouble" == g ? g = "solid-double" : "thicksoliddouble" == g && (g = "thicksolid-double");
            h.find("input:radio[name\x3d'dividingLineType'][value\x3d'" + g + "']").attr("checked", "true");
            $("#editor-component").html(h.html());
            $("#editor-component").find(".color-box").colpick({
                flat: !0,
                layout: "hex",
                color: this.componentSetup.color,
                submit: 0,
                onChange: function(f, d, b, c) {
                    $("#widget-control .field-active .divider-line").css("border-color", "#" + d);
                    $("#widget-control .field-active").data("componentData").setColor("#" + d)
                }
            })
        },
        renderPreview: function(h) {
            var g = $(this.tpl).siblings("#preview-dividingline");
            g.find(".divider-line").css("border-color", this.componentSetup.color);
            g.find(".divider-line").attr("class", "divider-line " + this.componentSetup.type);
            h.append(g)
        },
        renderEditPreview: function(h) {
            var g = $(this.tpl).siblings("#form-dividingline");
            g.find(".divider-line").css("border-color", this.componentSetup.color);
            var f = this.componentSetup.type;
            "soliddouble" == f ? f = "solid-double" : "thicksoliddouble" == f && (f = "thicksolid-double");
            g.find(".divider-line").attr("class", "divider-line " + f);
            g.data("componentData", this);
            h.append(g)
        },
        submitCheck: function(h, g) {},
        checkEvents: function(h) {}
    });
    u.exports = window.DividingLine
});
define("form/component/imageviewer", function(m, y, w) {
    y = Backbone.View.extend({
        initialize: function(k) {
            this.el = "#formImageViewer";
            this.imageUrl = k.imageUrl;
            this.imageId = k.imageId;
            this.preEl = k.preEl;
            this.preEl.css({
                "-webkit-filter": "blur(8px)"
            });
            $("body").append('\x3cdiv class\x3d"form-image-viewer hide" id\x3d"formImageViewer"\x3e\x3ca class\x3d"j_imageViewBack viewer-close"\x3e\x3c/a\x3e\x3cdiv class\x3d"image-frame j_bindHammer"\x3e\x3c/div\x3e\x3c/div\x3e');
            $("#formImageViewer,.j_bindHammer").css({
                width: $(window).width(),
                height: $(window).height()
            });
            $(window).on("orientationchange.imageviewer resize.imageviewer", function() {
                $("#formImageViewer,.j_bindHammer").css({
                    width: $(window).width(),
                    height: $(window).height()
                })
            })
        },
        delegateEvents: function() {
            var k = this;
            $(k.el).on("tap", ".j_imageViewBack", function() {
                k.remove()
            })
        },
        render: function() {
            var k = this
              , e = $(this.el);
            m.async("/static/js/plugins/hammer.min.js", function() {
                $(k.el).fadeIn("fast", function() {
                    e.find(".j_bindHammer").append('\x3cimg id\x3d"imgid' + k.imageId + '" style\x3d"opacity:0" src\x3d"' + k.imageUrl + '"/\x3e');
                    var d = e.find("img#imgid" + k.imageId);
                    d[0].onload = function() {
                        setTimeout(function() {
                            d.css({
                                position: "absolute",
                                "max-width": "none",
                                height: "auto",
                                opacity: 1,
                                "transform-origin": "center center",
                                left: "50%",
                                top: "50%",
                                width: d.width() >= $(window).width() ? $(window).width() : d.width()
                            });
                            d.css({
                                "margin-left": -(d.width() / 2),
                                "margin-top": -(d.height() / 2)
                            });
                            var a = d.width() / 2
                              , b = d.height() / 2
                              , c = $(k.el + " .j_bindHammer");
                            var f = new Hammer(c[0],{
                                domEvents: !0
                            })
                              , l = 0
                              , g = 0
                              , h = d.width()
                              , n = d.height();
                            c.on("panstart", function(a) {
                                l = parseInt(d.css("margin-left"), 10);
                                g = parseInt(d.css("margin-top"), 10)
                            });
                            c.on("pan", function(h) {
                                d.css({
                                    "margin-left": l + h.originalEvent.gesture.deltaX,
                                    "margin-top": g + h.originalEvent.gesture.deltaY
                                });
                                a = Math.abs(parseInt(d.css("margin-left")));
                                b = Math.abs(parseInt(d.css("margin-top")))
                            });
                            f.get("pinch").set({
                                enable: !0
                            });
                            c.on("pinch", function(g) {
                                d.css({
                                    width: h * g.originalEvent.gesture.scale,
                                    "margin-left": -a * g.originalEvent.gesture.scale,
                                    height: n * g.originalEvent.gesture.scale,
                                    "margin-top": -b * g.originalEvent.gesture.scale
                                })
                            });
                            c.on("pinchend", function(g) {
                                h *= g.originalEvent.gesture.scale;
                                n *= g.originalEvent.gesture.scale;
                                a *= g.originalEvent.gesture.scale;
                                b *= g.originalEvent.gesture.scale;
                            })
                        })
                    }
                })
            })
        },
        remove: function() {
            var k = this;
            $(this.el).animate({
                opacity: 1
            }, 200, function() {
                $(k.el).remove();
                k.preEl.css({
                    "-webkit-filter": "none"
                })
            });
            $(".form-quick-tools").hide();
            $(window).off("orientationchange.imageviewer resize.imageviewer")
        }
    });
    w.exports = y
});
define("form/component/tablecomponent", ["form/component", "form/tplutil", _formDesign+"/static/js/plugins/bootstrap-paginator"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil");
    n( _formDesign+"/static/js/plugins/bootstrap-paginator");
    window.TableComponent = y.extend({
        initialize: function(h) {
            this.componentSetup = {
                componentKey: "TableComponent",
                title: "\u8868\u683c",
                titleLayout: "field-hoz",
                order: 0,
                index: 0,
                fieldId: "",
                dataSetIds: {}
            };
            null != h && (this.componentSetup.title = h.title,
            this.componentSetup.order = h.order,
            this.componentSetup.index = h.index,
            this.componentSetup.fieldId = h.fieldId,
            _.isObject(h.dataSetIds) ? this.componentSetup.dataSetIds = h.dataSetIds : this.componentSetup.dataSetIds = JSON.parse(h.dataSetIds));
            this.tpl = m.get("table");
            this.isAdmin = TEAMS.currentUser.admin
        },
        setTitle: function(h) {
            this.componentSetup.title = h
        },
        setTitleLayout: function(h) {
            this.componentSetup.titleLayout = h
        },
        setRelatDataTableId: function(h) {
            this.componentSetup.tableId = h
        },
        setRelatDataUnitId: function(h) {
            this.componentSetup.colId = h
        },
        setIsOrgtiqu: function(h) {
            this.componentSetup.isOrgtiqu = h
        },
        setIsOrgtiqulist: function(h) {
            this.componentSetup.isOrgtiqulist = h
        },
        setIsBorderLayout: function(h) {
            this.componentSetup.isBorderLayout = h
        },
        setDataSetId: function(h) {
            this.componentSetup.dataSetId = h
        },
        addDataSet: function(h, g) {
            var f = _.keys(this.componentSetup.dataSetIds)
              , d = {};
            _.contains(f, h) || (d.id = h,
            d.title = g,
            this.componentSetup.dataSetIds[h] = d)
        },
        removeDataSet: function(h) {
            var g = _.keys(this.componentSetup.dataSetIds);
            _.contains(g, h) && delete this.componentSetup.dataSetIds[h]
        },
        render: function(h) {
            var g = $(this.tpl).siblings("#form-table");
            h.attr("class", g.attr("class"));
            h.html(g.html())
        },
        renderEditor: function() {
            var h = this, g;
            h.statFields ? h.renderEditorValue() : this.componentmodel.getFormTableSelectFields(function(f) {
                f.formFields = [];
                f.listStats = [];
                g = $(_.template(h.tpl, f)).siblings("#editor-table");
                h.statFields = f;
                h.el = g;
                h.renderEditorValue()
            })
        },
        renderEditorValue: function() {
            var h = this.el
              , g = _.keys(this.componentSetup.dataSetIds);
            h.find("#component-title").attr("value", this.componentSetup.title);
            $("#editor-component").html(h.html());
            var f = $(".j_datasource");
            $.each(this.statFields.tablestatfields, function() {
                var c = f.find("li:first").clone().show();
                c.find(".table_field").val(this.fieldId).attr("title", this.title);
                this["delete"] ? c.find("span").text(this.title + "(\u5df2\u5220\u9664)") : c.find("span").text(this.title);
                f.append(c)
            });
            for (var d = 0, b = g.length; d < b; d++)
                h = $("#editor-component").find("input[value\x3d'" + g[d] + "']"),
                h.prop("checked", !0)
        },
        renderPreview: function(h, g, f, d, b) {
            var c = this
              , l = {}
              , e = $(this.tpl).siblings("#preview-table");
            e.find(".panel-heading").html(this.componentSetup.title).attr("title", this.componentSetup.title);
            h.append(e);
            this.viewcon = e;
            l.fieldIds = _.keys(this.componentSetup.dataSetIds).join(",");
            l.pageNo = 1;
            l.pageSize = 10;
            l.param = h.closest(".form-view_js").data("param");
            h = h.closest(".form-view_js").data("form") || {};
            l.module = h.module || "workflow";
            this.componentmodel.getTablePageData(l, function(a) {
                a = {
                    currentPage: a.pageDatas.pageNo,
                    totalPages: a.pageDatas.totalPages,
                    onPageClicked: function(a, e, b, d) {
                        l.pageNo = d;
                        c.renderTableView(l)
                    }
                };
                e.find(".pageNav").bootstrapPaginator(a);
                c.renderTableView(l)
            })
        },
        renderTableView: function(h) {
            var g = this;
            table = $(g.tpl).siblings("#formDatas");
            g.viewcon.find(".tablecontent").html("").append(table);
            var f = g.viewcon;
            this.componentmodel.getTablePageData(h, function(d) {
                pageNo = d.pageNo;
                1 == pageNo && ($(f).find("#stat_table tbody").html(),
                $(f).find("#stat_table tbody").empty());
                var b = d.formFields
                  , c = d.formDatas
                  , l = d.listStats;
                g.formFields = b;
                if (null == b || 0 == b.length)
                    $(f).find("#formDatas").html('\x3cdiv class\x3d"formstat-noresult"\x3e\u5f53\u524d\u8868\u5355\u6ca1\u6709\u4efb\u4f55\u5b57\u6bb5\uff01\x3c/div\x3e');
                else {
                    if (0 == $(f).find("#stat_table thead tr th").length)
                        for (d = 0; d < b.length; d++) {
                            var e = b[d];
                            $(f).find("#stat_table thead tr").append("\x3cth title\x3d'" + e.title + "'\x3e\x3cdiv\x3e" + e.title + "\x3c/div\x3e\x3c/th\x3e");
                            var a = ""
                              , k = "";
                            if ("Money" == e.componentKey || "NumberComponent" == e.componentKey)
                                a = "ta-r";
                            "Money" == e.componentKey && (k = "Money");
                            $(f).find("#stat_table tfoot tr").append("\x3ctd id\x3d'tfoot_" + e.id + "' class\x3d'" + a + "' type\x3d'" + k + "'\x3e\x3c/td\x3e")
                        }
                    if (null == c || 0 == c.length)
                        $(f).find("#statbody #data_message").html("\u6682\u65e0\u6570\u636e...").show();
                    else {
                        $(f).find("#statbody #data_message").hide();
                        k = {};
                        if (l)
                            for (d = 0; d < l.length; d++) {
                                var h = l[d]
                                  , a = h.FORM_DATA + "_" + h.DATA_INDEX;
                                k[a] = h
                            }
                        $(document).off(".fb-start");
                        for (d = 0; d < c.length; d++) {
                            var l = c[d]
                              , h = l.maxIndex || 1
                              , r = l.id;
                            if (!(0 < $(" stat_table tr #" + r).length))
                                for (var q = 0; q < h; q++) {
                                    var a = r + "_" + (q + 1)
                                      , p = k[a]
                                      , m = $("\x3ctr id\x3d" + r + "\x3e\x3c/tr\x3e");
                                    Date.create(l.flowCreateTime);
                                    for (var v = 0; v < b.length; v++) {
                                        var e = b[v]
                                          , s = e.id
                                          , A = e.componentKey
                                          , n = "";
                                        p && (n = p["C_" + s] || "");
                                        var C = "noSub_" + r + "_" + s;
                                        e.subForm && (C = "");
                                        a = "";
                                        if ("Money" == A || "NumberComponent" == A)
                                            a = "ta-r";
                                        e = r + "_" + (q + 1) + "_" + s;
                                        try {
                                            var B = JSON.parse(n);
                                            ocount = "";
                                            if (0 < B.length && null != B[0].optionId) {
                                                for (s = 0; s < B.length; s++)
                                                    option = B[s],
                                                    ocount += option.content + ",";
                                                n = ocount.substring(0, ocount.length - 1)
                                            }
                                        } catch (D) {}
                                        m.append("\x3ctd id\x3d" + e + " class\x3d'" + C + " " + a + "' title\x3d'" + n + "'\x3e" + n + "\x3c/td\x3e")
                                    }
                                    $(f).find("#stat_table tbody").append(m)
                                }
                        }
                        g.mergerCells(b, c)
                    }
                }
            })
        },
        mergerCells: function(h, g) {
            if (h && g)
                for (var f = this.viewcon, d = 0; d < g.length; d++) {
                    var b = g[d]
                      , c = b.maxIndex || 1
                      , b = b.id;
                    this.isAdmin && ($(f).find("#stat_table .noSub_flowCheck_" + b + ":eq(0)").attr("rowspan", c),
                    $(f).find("#stat_table .noSub_flowCheck_" + b + ":gt(0)").remove());
                    for (var l = 0; l < h.length; l++) {
                        var e = h[l];
                        e.subForm || (e = e.id,
                        $(f).find("#stat_table .noSub_" + b + "_" + e + ":eq(0)").attr("rowspan", c),
                        $(f).find("#stat_table .noSub_" + b + "_" + e + ":gt(0)").remove())
                    }
                }
        },
        renderEditPreview: function(h) {
            var g = $(this.tpl).siblings("#form-table");
            g.attr("id", this.componentSetup.fieldId);
            g.data("componentData", this);
            g.addClass(this.componentSetup.titleLayout);
            h.append(g)
        },
        renderStatSearch: function(h) {},
        submitCheck: function(h, g) {},
        checkEvents: function(h) {},
        check: function(h) {},
        getValue: function(h) {},
        setValue: function(h, g) {},
        empty: function(h) {},
        readOnly: function(h, g) {}
    });
    u.exports = window.TableComponent
});
define("form/component/datasource", "form/relatecomponent form/tplutil form/component/entityselecter form/component/relevancecontrol form/abposview form/component/option".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/entityselecter")
      , f = n("form/component/relevancecontrol")
      , d = n("form/abposview");
    n("form/component/option");
    window.DataSource = m.extend({
        initialize: function(b) {
            m.prototype.initialize.call(this, b);
            var c = {
                componentKey: "DataSource",
                title: "\u6570\u636e\u6e90",
                sourceModule: "",
                dataTemplateId: ""
            };
            null != b && (c.title = b.title,
            c.sourceModule = b.sourceModule,
            c.dataTemplateId = b.dataTemplateId);
            this.componentSetup = $.extend(this.componentSetup, c);
            this.tpl = h.get("datasource", {
                isMobileForm: this.isMobileForm
            })
        },
        setDataTemplateId: function(b) {
            this.componentSetup.dataTemplateId = b
        },
        setSourceModule: function(b) {
            this.componentSetup.sourceModule = b
        },
        render: function(b) {
            var c = $(this.tpl).siblings("#form-datasource");
            m.prototype.render.call(this, b, c);
            b.html(c.html())
        },
        renderEditPreview: function(b) {
            var c = $(this.tpl).siblings("#form-datasource");
            m.prototype.renderEditPreview.call(this, b, c);
            b.append(c)
        },
        renderEditor: function() {
            var b = $(this.tpl).siblings("#editor-datasource")
              , c = !1;
            if ("true" == this.componentSetup.isUnique || 1 == this.componentSetup.isUnique)
                c = !0;
            b.find("#isUnique").attr("checked", c);
            c = $("#module").val();
            if (("biaoge" == c || "workflow" == c) && (c = this.getTemplates()) && 0 < c.length)
                for (var d = 0; d < c.length; d++) {
                    var e = c[d];
                    b.find("#source_module_select").append('\x3coption value\x3d"dataTemplate" templateId\x3d"' + e.id + '" type\x3d"' + e.type + '"\x3e' + e.name + "\x3c/option\x3e")
                }
            this.componentSetup.dataTemplateId ? b.find("option[templateId\x3d'" + this.componentSetup.dataTemplateId + "']").attr("selected", !0) : b.find("option[value\x3d'" + this.componentSetup.sourceModule + "']").attr("selected", !0);
            this.componentSetup.fieldId && this.componentSetup.sourceModule && b.find("#source_module_select").attr("disabled", "disabled");
            m.prototype.renderEditor.call(this, b);
            $("#editor-component").html(b.html())
        },
        getTemplates: function() {
            var b = {}
              , c = [];
            b.levelType = "DataSource";
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                url: TEAMS.api.queryDataListByLayout,
                dataType: "json",
                async: !1,
                data: JSON.stringify(b),
                success: function(b) {
                    b.message ? formPlugin.notify(b.message) : c = b.formdataTemplatesList
                }
            });
            return c
        },
        renderPreview: function(b, c, d) {
            var e = $(this.tpl);
            c = null;
            $("body").find("#scanReport").val() || null != TEAMS.currentUser ? c = "mobile" != window.systemInfo_form ? e.siblings("#preview-datasource") : e.siblings("#mobile-preview") : (c = e.siblings("#nodatasource-preview"),
            c.find(".field_message_js").attr("cid", this.cid));
            c.find(".widget-title .widget-title_js").text(this.componentSetup.title);
            "true" != this.componentSetup.isHideTitle && 1 != this.componentSetup.isHideTitle || c.addClass("field-notitle").find(".widget-title .widget-title_js").addClass("hide");
            "true" != this.componentSetup.required && 1 != this.componentSetup.required || c.find(".widget-title .widget-required_js").text(" *");
            "" != this.componentSetup.describe && (c.find(".field-description").text(this.componentSetup.describe),
            c.find(".field-description").show());
            c.find(".check_js").attr("id", this.componentSetup.fieldId + this.cid).attr("name", this.componentSetup.fieldId);
            c.find(".check_js").attr("cid", this.cid);
            c.find(".check_js").data("componentData", this);
            c.attr("id", "field_" + (this.componentSetup.fieldId || this.componentSetup.tempId));
            c.attr("fieldId", this.componentSetup.fieldId);
            c.addClass(this.componentSetup.titleLayout);
            "mobile" == window.systemInfo_form && c.find(".datasource-seleted").attr("id", this.componentSetup.fieldId);
            e = this.componentSetup.isUnique;
            "true" != e && 1 != e || c.find(".js_datasource").attr("data-multi", "false");
            if (1 == d || "true" == d)
                "mobile" != window.systemInfo_form ? this.readOnly(c, !0) : c.find(".js_datasource").removeClass("datasource-seleted").text("");
            this.el = b;
            b.append(c)
        },
        renderStatSearch: function(b) {
            var c = this
              , d = $(this.tpl)
              , e = b.ids
              , a = b.term
              , f = b.parentEl
              , g = b.container
              , h = b.fieldId
              , q = b.fieldTitle
              , p = b.subFormId
              , m = b.filterEl
              , v = b.condition;
            b = b.module;
            var s = ""
              , A = null;
            if ("mobile" != window.systemInfo_form) {
                A = d.siblings("#statsearch-entity");
                if (e)
                    for (h = 0; h < e.length; h++)
                        q = '\x3cspan class\x3d"entity-item"\x3e\x3ca id\x3d"' + e[h].id + '" title\x3d"' + e[h].text + '"\x3e' + e[h].text + "\x3c/a\x3e\x3c/span\x3e",
                        A.find(".entity-container").append(q);
                a && A.find("select:first option[value\x3d" + a + "]").attr("selected", "true");
                e = (new Date).getTime();
                A.find(".j_entityContainer").attr("id", "j_datasource" + e);
                f.attr("class", "sch-group j_formFieldSearchGroup");
                f.find(".j_formField-condition").html(A);
                var n = $(g + " #j_datasource" + e + " #typeahead-datasource");
                $.ajax({
                    type: TEAMS.ajaxMethod,
                    async: !1,
                    url: "freeform/queryFieldLayoutDetail.json",
                    data: {
                        fieldId: c.componentSetup.fieldId,
                        module: b
                    },
                    success: function(a) {
                        a.layoutDetail && (a = JSON.parse(a.layoutDetail),
                        n.attr("sourceModule", a.sourceModule),
                        A.find(".j_entityContainer a").attr("templateId", a.dataTemplateId),
                        s = a.dataTemplateId)
                    }
                });
                window.typeahead && window.typeahead.init && window.typeahead.init({
                    el: g + " #j_datasource" + e + " #typeahead-datasource",
                    templateId: s,
                    callback: function(a) {
                        if (a && !$.isEmptyObject(a)) {
                            var e = n.parents(".j_entityContainer").find(".j_selected");
                            c.renderTypeheader(e, a)
                        }
                    }
                })
            } else {
                A = d.siblings("#statsearch-datasource-mobile");
                v && (A.find(".j_condition").find('option[value\x3d"' + v + '"]').attr("selected", !0),
                "null" != v && "notnull" != v || A.find(".j_control").hide());
                m && (A.find("#seleted-list").empty(),
                m.find(".j_filterList .selectd #comp-val span").each(function() {
                    var a = $(this).attr("optionId")
                      , e = $(this).text()
                      , c = $("\x3cspan\x3e\x3c/span\x3e");
                    c.attr("id", a).text(e);
                    A.find("#seleted-list").append(c)
                }));
                var C = null;
                $.ajax({
                    type: TEAMS.ajaxMethod,
                    async: !1,
                    url: "freeform/queryFieldLayoutDetail.json",
                    data: {
                        fieldId: c.componentSetup.fieldId,
                        module: b
                    },
                    success: function(a) {
                        a.layoutDetail && (a = JSON.parse(a.layoutDetail),
                        C = a.sourceModule,
                        s = a.dataTemplateId)
                    }
                });
                g = {};
                g.sourceModule = C;
                g.templateId = s;
                g.pageNo = 1;
                g.pageSize = 20;
                c.searchDataSource(g, A, h, q, f, p);
                f.off("change", "#statsearch-datasource-mobile .j_condition").on("change", "#statsearch-datasource-mobile .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? f.find("#statsearch-datasource-mobile .j_control").hide() : f.find("#statsearch-datasource-mobile .j_control").show()
                });
                f.off("tap", "#statsearch-datasource-mobile .j_optionli").on("tap", "#statsearch-datasource-mobile .j_optionli", function() {
                    var a = $(this);
                    a.hasClass("selected") ? a.removeClass("selected") : a.addClass("selected");
                    var e = a.find(".j_optionname").text()
                      , a = a.attr("id")
                      , e = '\x3cspan id\x3d"' + a + '"\x3e' + e + "\x3c/span\x3e";
                    0 < f.find("#statsearch-datasource-mobile #seleted-list #" + a).length ? f.find("#statsearch-datasource-mobile #seleted-list #" + a).remove() : f.find("#statsearch-datasource-mobile #seleted-list").append(e)
                });
                f.off("tap", "#statsearch-datasource-mobile .j_more").on("tap", "#statsearch-datasource-mobile .j_more", function() {
                    var a = $(this)
                      , e = a.attr("pageNo")
                      , b = a.attr("fieldId")
                      , a = a.attr("title")
                      , d = {};
                    d.sourceModule = C;
                    d.templateId = s;
                    d.pageNo = e;
                    d.pageSize = 20;
                    c.searchDataSource(d, A, b, a, f, p)
                })
            }
        },
        searchDataSource: function(b, c, d, e, a, f) {
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                url: "/appfreeform/queryDataSourceOption.json",
                dataType: "json",
                data: JSON.stringify(b),
                success: function(b) {
                    var g = b.optionPage;
                    if (0 == g.totalCount)
                        c.find(".j_noresult").removeClass("hide");
                    else {
                        g.hasNext && c.find(".j_more").removeClass("hide").attr("pageNo", g.pageNo + 1).attr("fieldId", d).attr("title", e);
                        b = g.result;
                        1 == g.pageNo && c.find(".j_optionUl").empty();
                        c.find("#seleted-list").attr("fieldId", d);
                        for (g = 0; g < b.length; g++) {
                            var h = b[g]
                              , p = h.name
                              , h = h.id
                              , m = c.find("#li-clone li").clone();
                            0 < c.find("#seleted-list").find("#" + h).length && m.addClass("selected");
                            m.find(".j_optionname").text(p);
                            m.attr("id", h);
                            c.find(".j_optionUl").append(m)
                        }
                        a.find("#component-div").html(c);
                        a.find(".j_comp-ok").attr("comKey", "DataSource").attr("fieldId", d).attr("title", e).attr("subFormId", f)
                    }
                }
            })
        },
        renderTypeheader: function(b, c) {
            var d = c.name
              , e = c.id;
            if (d && e) {
                var a = '\x3cspan class\x3d"entity-item j_entity_item" name\x3d"j_entity_item"\x3e\x3ca id\x3d"' + e + '" title\x3d"' + d + '"\x3e' + d + "\x3c/a\x3e\x3c/span\x3e";
                b.find(".entity-item").each(function(c) {
                    e == $(this).find("a").attr("id") && (a = null)
                });
                b.append(a);
                b.find(".j_entity_item").data("object", c)
            }
        },
        submitCheck: function(b, c) {
            var d = this.check(b);
            c(d)
        },
        checkEvents: function(b) {
            var c = this;
            b = c.el || $(document);
            var d = c.componentSetup.fieldId + this.cid;
            (new this.datasourceAhead({})).initAhead({
                fieldId: d,
                sourceModule: c.componentSetup.sourceModule,
                dataTemplateId: c.componentSetup.dataTemplateId
            });
            var e = $("#" + d + " #searchdatasource")
              , a = c.componentSetup.isUnique;
            if ("mobile" == window.systemInfo_form)
                b.on("click", "#" + d + " .datasource-seleted", function(e) {
                    $(this).attr("data-module");
                    e = $(this).attr("data-targetId");
                    var b = $(this).attr("data-multi")
                      , h = $(this).parents(".j_page-view")
                      , q = h.attr("id")
                      , p = $(this);
                    if (!$(this).parents(".j_formpreview").hasClass("form-noedit")) {
                        var m = $("#" + d + " .datasource-seleted .js_form-datasourceItem")
                          , v = [];
                        m && 0 < m.length && m.each(function(a) {
                            a = $(this).find(".j_data_source").attr("datasourceId");
                            var e = $(this).find(".j_data_source").text();
                            v.push({
                                name: e,
                                id: a
                            })
                        });
                        "true" == a || 1 == a ? (p = new g,
                        p.render("mb", {
                            targetEl: $(this),
                            targetId: e,
                            module: "datasource",
                            sourceModule: c.componentSetup.sourceModule,
                            dataTemplateId: c.componentSetup.dataTemplateId,
                            multi: b,
                            preEl: "#" + q,
                            seletedList: v
                        })) : 0 == v.length ? (p = new g,
                        p.render("mb", {
                            targetEl: $(this),
                            targetId: e,
                            module: "datasource",
                            sourceModule: c.componentSetup.sourceModule,
                            dataTemplateId: c.componentSetup.dataTemplateId,
                            multi: b,
                            preEl: "#" + q,
                            seletedList: v
                        })) : (new f({
                            targetEl: p,
                            targetId: e,
                            module: "datasource",
                            sourceModule: c.componentSetup.sourceModule,
                            dataTemplateId: c.componentSetup.dataTemplateId,
                            multi: b,
                            preEl: "#" + q,
                            seletedList: v
                        })).render();
                        h.addClass("hide")
                    }
                });
            else
                e && 0 < e.size() && e.click(function() {
                    var e = $("#" + d + " .js_datasource .js_form-datasourceItem");
                    $("#" + d + " .control-input").trigger("focusout", "tt");
                    var b = [];
                    e && 0 < e.length && e.each(function(a) {
                        a = $(this).find(".j_data_source").attr("datasourceId");
                        var e = $(this).find(".j_data_source").text();
                        b.push({
                            name: e,
                            id: a
                        })
                    });
                    var e = $(this)
                      , f = e.parent().find("input");
                    (new g).render("pc", {
                        targetEl: e,
                        keyword: f ? f.val() : "",
                        module: "datasource",
                        sourceModule: c.componentSetup.sourceModule,
                        isUnique: a,
                        dataTemplateId: c.componentSetup.dataTemplateId,
                        seletedList: b
                    })
                });
            b.off("entitySelected", "#" + d + " #searchdatasource").on("entitySelected", "#" + d + " #searchdatasource", function(a) {
                $("#" + d + " .js_datasource").empty();
                for (var e = $("#" + d), b = 1; b < arguments.length; b++) {
                    var f = arguments[b];
                    e.parents(".field_js").find(".form-error").text("");
                    e.parents(".field_js").find(".form-error").hide();
                    var g = f.id
                      , f = f.name
                      , f = '\x3cspan name\x3d"js_form-datasourceItem" class\x3d"js_form-datasourceItem j_component employee-item"\x3e\x3ca data-id\x3d"' + g + '"  datasourceId\x3d' + g + ' class\x3d"j_data_source" title\x3d"' + f + '"\x3e' + f + '\x3c/a\x3e\x3ca class\x3d"close js_deleteDataSource" title\x3d"\u5220\u9664"\x3e\x26times;\x3c/a\x3e\x3c/span\x3e'
                      , h = $("#" + d + " .js_datasource .js_form-datasourceItem");
                    h && h.each(function(a) {
                        g == $(this).find(".j_data_source").attr("datasourceId") && ($(this).remove(),
                        flag = !1)
                    });
                    e.find(".js_datasource").append(f)
                }
                e.closest(".field_js ").trigger("datacheck");
                c.triggerFillRelate(e)
            });
            b.on("mouseenter.typeahead", "#" + d + " .typeahead-wrapper", function(a) {
                $(this).data("enter", !0)
            }).on("mouseleave.typeahead", "#" + d + " .typeahead-wrapper", function(a) {
                $(this).data("enter", !1)
            });
            b.on("click", "#" + d + " .control-btn", function(a) {
                a.stopPropagation();
                $(this).addClass("hide");
                $(this).prev(".typeahead-wrapper").removeClass("hide");
                $(this).prev(".typeahead-wrapper").find(".control-input").focus()
            });
            b.on("focusout", "#" + d + " .control-input", function(a, e) {
                var c = $(this).parents(".typeahead-wrapper");
                c.data("enter") && "tt" != e || (c.addClass("hide"),
                c.next(".control-btn").removeClass("hide"))
            });
            b.on("click.tt", "#" + d + " #searchList\x3ep", function() {
                var a = $("#" + d);
                a.parents(".field_js").find(".form-error").text("");
                a.parents(".field_js").find(".form-error").hide();
                var e = $(this).data("obj")
                  , b = e.id
                  , e = e.name
                  , e = '\x3cspan name\x3d"js_form-datasourceItem" class\x3d"js_form-datasourceItem j_component employee-item"\x3e\x3ca data-id\x3d"' + b + '"  datasourceId\x3d' + b + ' class\x3d"j_data_source" title\x3d"' + e + '"\x3e' + e + '\x3c/a\x3e\x3ca class\x3d"close js_deleteDataSource" title\x3d"\u5220\u9664"\x3e\x26times;\x3c/a\x3e\x3c/span\x3e'
                  , f = c.componentSetup.isUnique
                  , g = $("#" + d + " .js_datasource .js_form-datasourceItem");
                "true" == f || 1 == f ? a.find(".js_datasource").empty() : g && g.each(function(a) {
                    b == $(this).find(".j_data_source").attr("datasourceId") && ($(this).remove(),
                    flag = !1)
                });
                a.find(".js_datasource").append(e);
                a.closest(".field_js ").trigger("datacheck");
                c.triggerFillRelate(a)
            });
            b.on("click", "#" + d + " .js_deleteDataSource", function() {
                var a = $(this).parents("#" + d);
                $(this).parent().remove();
                a.closest(".field_js ").trigger("datacheck");
                c.triggerFillRelate(a)
            });
            "mobile" == window.systemInfo_form && (b.on("objsComfirm", "#" + d + " .datasource-seleted", function(a, e) {
                var b = $("#" + d + " .js_datasource")
                  , f = c.componentSetup.isUnique;
                b.text("");
                b.parents("#field_" + c.componentSetup.fieldId).find(".form-error").text("");
                "true" != f && 1 != f || b.empty();
                if (0 < e.objs.length) {
                    var f = e.objs, g;
                    for (g in f) {
                        var h = f[g];
                        if (h) {
                            var m = $("\x3cspan id\x3d" + h.id + ' name\x3d"js_form-datasourceItem" class\x3d"js_form-datasourceItem j_component employee-item"\x3e\x3ca datasourceId\x3d' + h.id + ' data-module\x3d"datasource" data-value\x3d' + h.id + " data-id\x3d" + h.id + ' class\x3d"j_data_source entitybox-toggle"\x3e' + h.name + "\x3c/a\x3e\x3c/span\x3e");
                            b.append(m)
                        }
                    }
                } else
                    h = e.objs,
                    m = $("\x3cspan id\x3d" + h.id + ' name\x3d"js_form-datasourceItem" class\x3d"js_form-datasourceItem j_component employee-item"\x3e\x3ca datasourceId\x3d' + h.id + ' data-module\x3d"datasource" data-value\x3d' + h.id + " data-id\x3d" + h.id + ' class\x3d"j_data_source entitybox-toggle"\x3e' + h.name + "\x3c/a\x3e\x3c/span\x3e"),
                    0 == h.length ? b.html('\x3cdiv class\x3d"widget-link-holder"\x3e\x3ci class\x3d"icon-plus2"\x3e\x3c/i\x3e\u8bf7\u9009\u62e9\x3c/div\x3e') : b.append(m);
                b.closest(".field_js ").trigger("datacheck");
                c.triggerFillRelate(b)
            }),
            b.on("deleteObj", "#" + d + " .datasource-seleted", function(a, e) {
                var b = $("#" + d + " .js_datasource");
                b.find('span[id\x3d"' + e + '"]').remove();
                0 == b.find("span").length && b.html('\x3cdiv class\x3d"widget-link-holder"\x3e\x3ci class\x3d"icon-plus2"\x3e\x3c/i\x3e\u8bf7\u9009\u62e9\x3c/div\x3e');
                b.closest(".field_js ").trigger("datacheck");
                c.triggerFillRelate(b)
            }))
        },
        autoSaveEvents: function(b) {
            var c = this
              , d = c.el || $(document)
              , e = (c.componentSetup.fieldId || c.componentSetup.tempId) + this.cid;
            d.on("click", "#" + e + " .js_deleteDataSource", function() {
                c.saveComponentValue(d.find("#" + e), b)
            });
            "mobile" == window.systemInfo_form ? (d.on("objsComfirm", "#" + e + " .datasource-seleted", function(a, e) {
                c.saveComponentValue($(this), b)
            }),
            d.on("deleteObj", "#" + e + " .datasource-seleted", function(a, e) {
                c.saveComponentValue($(this), b)
            })) : (d.on("click", "#" + e + " #searchList\x3ep", function() {
                c.saveComponentValue($(this), b)
            }),
            d.on("entitySelected", "#" + e + " #searchdatasource", function(a) {
                c.saveComponentValue($(this), b)
            }))
        },
        check: function(b) {
            var c = $(b).find('span[name\x3d"js_form-datasourceItem"]').length
              , d = {};
            d.element = b;
            0 != c || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (d.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            return d
        },
        getValue: function(b, c) {
            var d = this.componentSetup.sourceModule
              , e = {
                formField: {
                    id: this.componentSetup.fieldId
                }
            }
              , a = b.find(".js_datasource .js_form-datasourceItem");
            if (0 < a.length) {
                var f = [];
                a.each(function(a) {
                    var e = $(this).find(".j_data_source").attr("datasourceId")
                      , c = $(this).find(".j_data_source").text();
                    f[a] = {
                        optionId: e,
                        content: c,
                        type: d
                    }
                });
                e.dataOptions = f
            } else
                c || (e = null);
            return e
        },
        setValue: function(b, c) {
            $(this.tpl).siblings("#datasource-clone");
            b.find(".js_datasource").empty();
            if (null != c && null != c.dataOptions)
                for (var d = 0; d < c.dataOptions.length; d++) {
                    var e = c.dataOptions[d]
                      , a = null == e.content ? "" : e.content
                      , e = e.optionId
                      , f = null;
                    "mobile" == window.systemInfo_form ? (f = TEAMS.currentUser && TEAMS.currentUser.id ? '\x3cspan href\x3d"/mobile/datasources/' + TEAMS.currentUser.id : '\x3cspan href\x3d"/mobile/datasources',
                    f = f + "/" + e + '" name\x3d"js_form-datasourceItem" id\x3d"' + e + '" class\x3d"router js_form-datasourceItem j_component employee-item"\x3e\x3ca data-module\x3d"datasource" data-id\x3d"' + e + '" data-value\x3d"' + e + '" datasourceId\x3d' + e + ' class\x3d"j_data_source entitybox-toggle"\x3e' + a + "\x3c/a\x3e\x3c/span\x3e") : f = null != b.find(".js_form-datasource-add").get(0) ? '\x3cspan name\x3d"js_form-datasourceItem" id\x3d"' + e + '" class\x3d"js_form-datasourceItem j_component employee-item"\x3e\x3ca data-module\x3d"datasource" data-id\x3d"' + e + '" data-value\x3d"' + e + '" datasourceId\x3d' + e + ' class\x3d"j_data_source" title\x3d"' + a + '"\x3e' + a + '\x3c/a\x3e\x3ca class\x3d"close js_deleteDataSource" title\x3d"\u5220\u9664"\x3e\x26times;\x3c/a\x3e\x3c/span\x3e' : '\x3cspan name\x3d"js_form-datasourceItem" id\x3d"' + e + '" class\x3d"js_form-datasourceItem j_component employee-item"\x3e\x3ca data-module\x3d"datasource" data-id\x3d"' + e + '" data-value\x3d"' + e + '" datasourceId\x3d' + e + ' class\x3d"j_data_source" title\x3d"' + a + '"\x3e' + a + "\x3c/a\x3e\x3c/span\x3e";
                    b.find(".js_datasource").append(f)
                }
        },
        empty: function(b) {
            b.find(".js_datasource").html("")
        },
        readOnly: function(b, c) {
            var d = this.componentSetup.fieldId + this.cid
              , e = b.find('div[id\x3d"' + d + '"] span[name\x3d"js_form-datasource-add"]')
              , a = b.find('div[id\x3d"' + d + '"] span[name\x3d"js_form-datasourceItem"]')
              , f = b.find('div[id\x3d"' + d + '"] .js_deleteDataSource');
            c ? (e.remove(),
            f.remove()) : e && 0 != e.length && null != e || (e = $(this.tpl).siblings("#preview-datasource").find('span[name\x3d"js_form-datasource-add"]'),
            b.find('div[id\x3d"' + d + '"]').find(".js_datasource").after(e),
            a.append('\x3ca class\x3d"close js_deleteDataSource" title\x3d"\u5220\u9664"\x3e\x26times;\x3c/a\x3e'))
        },
        datasourceAhead: Backbone.View.extend({
            defaults: function(b) {
                this.suggestion = "";
                this.remote = "freeform/queryDataSourceOption.json";
                this.sourceModule = b.sourceModule;
                this.fieldId = b.fieldId;
                this.dataTemplateId = b.dataTemplateId;
                this.tpl = h.get("datasource");
                this.$continer = $("#" + this.fieldId)
            },
            initAhead: function(b) {
                this.defaults(b);
                this._htmlEvents()
            },
            _htmlEvents: function() {
                var b = this
                  , c = b.$continer
                  , d = $("#" + b.fieldId + " #typeahead-datasource");
                d.off("focus.tt").on("focus.tt", function(e) {
                    b._search($(this))
                });
                d.off("click.tt").on("click.tt", function(e) {
                    e.stopPropagation()
                });
                d.off("keyup.tt").on("keyup.tt", function(e) {
                    e = e.which;
                    0 < $("body").find("#form-abposselect").length && (c = $("body").find("#form-abposselect").find(".field_js"));
                    13 == e ? (c.find("#typeahead-datasource-div p.active").trigger("click.tt"),
                    window.abposview && window.abposview.remove()) : 27 == e ? (d.trigger("focusout", "tt"),
                    window.abposview && window.abposview.remove()) : 38 == e ? (e = $("#typeahead-datasource-div p.active"),
                    1 > e.length ? c.find("#typeahead-datasource-div p").last().addClass("active") : (e.removeClass("active"),
                    (0 < e.prev().length ? e.prev() : c.find("#typeahead-datasource-div p").last()).addClass("active"))) : 40 == e ? (e = c.find("#typeahead-datasource-div p.active"),
                    1 > e.length ? c.find("#typeahead-datasource-div p").first().addClass("active") : (e.removeClass("active"),
                    (0 < e.next().length ? e.next() : c.find("#typeahead-datasource-div p").first()).addClass("active"))) : b._search($(this))
                });
                c.find("#typeahead-datasource-div").off("mouseenter.tt", "p").on("mouseenter.tt", "p", function() {
                    0 < $("body").find("#form-abposselect").length && (c = $("body").find("#form-abposselect").find(".field_js"));
                    $(this).addClass("active");
                    c.find("#typeahead-datasource-div p.active").removeClass("active")
                });
                c.off("click.tt", "#typeahead-datasource-div p").on("click.tt", "#typeahead-datasource-div p", function(e) {
                    d.trigger("focusout", "tt")
                })
            },
            _search: function(b) {
                var c = this
                  , d = c.$continer
                  , e = $.trim(b.val());
                e == b.attr("placeholder") && (e = "");
                d.find("#typeahead-datasource-div #searchList").html("");
                0 < $("body").find("#form-abposselect").length ? ($("body").find("#form-abposselect").find(".field_js").find("#typeahead-typeahead-div .loading_small").addClass(a).show(),
                d.find("#typeahead-typeahead-div .loading_small").hide()) : d.find("#typeahead-datasource-div .loading_small").addClass(a).show();
                window.abposview && window.abposview.remove();
                if (c.list && c.suggestion === e)
                    c._loadList(c.list);
                else {
                    var a = c.entity;
                    b = c.remote;
                    d = {};
                    this.suggestion = e;
                    d.keyword = e;
                    d.sourceModule = c.sourceModule;
                    d.pageNo = 1;
                    d.pageSize = 10;
                    d.templateId = c.dataTemplateId;
                    $.ajax({
                        type: TEAMS.ajaxMethod,
                        url: b,
                        dataType: "json",
                        data: d,
                        success: function(a) {
                            var e = [];
                            a.optionPage && a.optionPage.result && (e = a.optionPage.result);
                            c.list = e;
                            c._loadList(e)
                        }
                    })
                }
            },
            _loadList: function(b) {
                var c = this.$continer;
                0 < $("body").find("#form-abposselect").length ? $("body").find("#form-abposselect").find(".field_js").find("#typeahead-typeahead-div .loading_small").hide() : c.find("#typeahead-datasource-div .loading_small").hide();
                if (b && 0 < b.length) {
                    c.find("#typeahead-datasource-div #searchList").empty();
                    for (var f = 0, e = b.length; f < e; f++) {
                        var a = b[f];
                        a.name = a.name.replace(/</g, "\x26lt").replace(/>/g, "\x26gt").replace("/[\r\n]/g", " ");
                        var k = $(this.tpl).siblings("#datasource-clone").find(".j_datasource").clone();
                        k.text(a.name);
                        k.attr("title", a.describe || a.name);
                        k.data("obj", a);
                        c.find("#typeahead-datasource-div #searchList").append(k)
                    }
                }
                c.find("#typeahead-datasource-div #searchList").show();
                window.abposview && window.abposview.remove();
                window.abposview = new d({
                    continer: c,
                    entity: this.entity
                });
                window.abposview.render()
            }
        })
    });
    u.exports = window.DataSource
});
define("form/component/customerlist", ["form/tplutil", "form/component/formfilter"], function(n, y, u) {
    var m = n("form/tplutil")
      , h = n("form/component/formfilter");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/numberstatcomponent", ["form/component", "form/tplutil"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil");
    window.NumberStatComponent = y.extend({
        initialize: function(h) {
            this.componentSetup = {
                componentKey: "NumberStatComponent",
                title: "\u6807\u9898",
                titleLayout: "field-hoz",
                order: 0,
                index: 0,
                fieldId: "",
                dataSetId: "",
                stattype: "sum"
            };
            null != h && (this.componentSetup.title = h.title,
            this.componentSetup.order = h.order,
            this.componentSetup.index = h.index,
            this.componentSetup.fieldId = h.fieldId,
            this.componentSetup.dataSetId = h.dataSetId,
            this.componentSetup.stattype = h.stattype);
            this.tpl = m.get("numberstat")
        },
        setTitle: function(h) {
            this.componentSetup.title = h
        },
        setTitleLayout: function(h) {
            this.componentSetup.titleLayout = h
        },
        setRelatDataTableId: function(h) {
            this.componentSetup.tableId = h
        },
        setRelatDataUnitId: function(h) {
            this.componentSetup.colId = h
        },
        setIsOrgtiqu: function(h) {
            this.componentSetup.isOrgtiqu = h
        },
        setIsOrgtiqulist: function(h) {
            this.componentSetup.isOrgtiqulist = h
        },
        setDataSetId: function(h) {
            this.componentSetup.dataSetId = h
        },
        setStatType: function(h) {
            this.componentSetup.stattype = h
        },
        render: function(h) {
            var g = $(this.tpl).siblings("#form-numberstat");
            h.attr("class", g.attr("class"));
            h.html(g.html())
        },
        renderEditor: function() {
            var h = this, g;
            h.statFields ? h.renderEditorValue() : this.componentmodel.getFormNumberSelectFields(function(f) {
                g = $(_.template(h.tpl, f)).siblings("#editor-numberstat");
                h.statFields = f;
                null != f.numberStatfields && 0 < f.numberStatfields.length && (h.componentSetup.dataSetId = h.componentSetup.dataSetId ? h.componentSetup.dataSetId : f.numberStatfields[0].fieldId);
                h.el = g;
                h.renderEditorValue()
            })
        },
        renderEditorValue: function() {
            var h = this.el;
            h.find("#component-title").attr("value", this.componentSetup.title);
            $("#editor-component").html(h.html());
            var g = $("#component-dataset");
            $.each(this.statFields.numberStatfields, function() {
                var f = g.find("option:first").clone().show();
                this["delete"] ? f.val(this.fieldId).text(this.title + "(\u5df2\u5220\u9664)") : f.val(this.fieldId).text(this.title);
                g.append(f)
            });
            $("#editor-component").find("#component-dataset").val(this.componentSetup.dataSetId);
            $("#editor-component").find("#component-stattype").val(this.componentSetup.stattype)
        },
        renderPreview: function(h, g, f) {
            var d = this;
            g = $(this.tpl).siblings("#preview-numberstat");
            h.append(g);
            this.viewcon = g;
            this.componentSetup.dataSetId ? (this.viewcon.find(".widget-title_js").html(this.componentSetup.title).attr("title", this.componentSetup.title),
            this.componentmodel.getNumberFieldStatData(this, function(b) {
                d.viewcon.find(".statdata").html(b.numberData || 0)
            })) : (this.viewcon.find(".widget-title_js").html(this.componentSetup.title).attr("title", this.componentSetup.title),
            this.viewcon.find(".statdata").html("\u65e0\u6570\u5b57\u5b57\u6bb5"))
        },
        renderEditPreview: function(h) {
            var g = $(this.tpl).siblings("#form-numberstat");
            g.attr("id", this.componentSetup.fieldId);
            g.find(".widget-title_js").text(this.componentSetup.title);
            g.data("componentData", this);
            g.addClass(this.componentSetup.titleLayout);
            h.append(g)
        },
        renderStatSearch: function(h) {
            var g = $(this.tpl).siblings("#statsearch-text")
              , f = h.value;
            f && g.find("input").val(f);
            (f = h.term) && g.find("select:first option[value\x3d" + f + "]").attr("selected", "true");
            h = h.parentEl;
            h.attr("class", "sch-group j_formFieldSearchGroup");
            h.find(".j_formField-condition").html(g)
        },
        submitCheck: function(h, g) {},
        checkEvents: function(h) {},
        check: function(h) {},
        getValue: function(h, g) {},
        setValue: function(h, g) {},
        empty: function(h) {},
        readOnly: function(h, g) {}
    });
    u.exports = window.NumberStatComponent
});
define("form/component/imagecomponent", ["form/editablecomponent", "form/tplutil", "form/component/imageviewer", "form/component/imagecut"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/imageviewer")
      , f = n("form/component/imagecut");
    window.ImageComponent = m.extend({
        initialize: function(d) {
            m.prototype.initialize.call(this, d);
            var b = {
                componentKey: "ImageComponent",
                title: "\u56fe\u7247",
                isSingle: !1,
                formId: "",
                images: [],
                onlyPhoto: !1,
                timeWaterMark: {
                    selected: !1,
                    order: "1",
                    font: "SimSun",
                    fontSize: "20px",
                    fontColor: "#FF00FF",
                    horizontal: "center",
                    vertical: "middle",
                    alpha: "50",
                    type: "time"
                },
                placeWaterMark: {
                    selected: !1,
                    order: "2",
                    font: "SimSun",
                    fontSize: "20px",
                    fontColor: "#FF00FF",
                    horizontal: "center",
                    vertical: "middle",
                    alpha: "50",
                    type: "place"
                },
                nameWaterMark: {
                    selected: !1,
                    order: "3",
                    font: "SimSun",
                    fontSize: "20px",
                    fontColor: "#FF00FF",
                    horizontal: "center",
                    vertical: "middle",
                    alpha: "50",
                    type: "name"
                },
                selfWaterMark: {
                    selected: !1,
                    order: "4",
                    selfTxt: "\u81ea\u5b9a\u4e49\u6587\u5b57",
                    font: "SimSun",
                    fontSize: "20px",
                    fontColor: "#FF00FF",
                    horizontal: "center",
                    vertical: "middle",
                    alpha: "50",
                    type: "self"
                }
            };
            null != d && (b.title = d.title,
            b.isSingle = d.isSingle,
            b.formId = d.formId,
            b.images = d.images,
            b.onlyPhoto = d.onlyPhoto,
            b.timeWaterMark = d.timeWaterMark,
            b.placeWaterMark = d.placeWaterMark,
            b.nameWaterMark = d.nameWaterMark,
            b.selfWaterMark = d.selfWaterMark);
            this.componentSetup = $.extend(this.componentSetup, b);
            this.tpl = h.get("image", {
                isMobileForm: this.isMobileForm
            })
        },
        setSingle: function(d) {
            this.componentSetup.isSingle = d
        },
        setImages: function(d) {
            this.componentSetup.images = d
        },
        getImages: function() {
            return this.componentSetup.images
        },
        setOnlyPhoto: function(d) {
            this.componentSetup.onlyPhoto = d
        },
        setTimeWaterMark: function(d) {
            this.componentSetup.timeWaterMark = d
        },
        setPlaceWaterMark: function(d) {
            this.componentSetup.placeWaterMark = d
        },
        setNameWaterMark: function(d) {
            this.componentSetup.nameWaterMark = d
        },
        setSelfWaterMark: function(d) {
            this.componentSetup.selfWaterMark = d
        },
        render: function(d) {
            var b = $(this.tpl).siblings("#form-image");
            this.componentSetup.formId = $("#formId").val();
            m.prototype.render.call(this, d, b);
            d.html(b.html())
        },
        renderEditPreview: function(d) {
            var b = $(this.tpl).siblings("#form-image");
            m.prototype.renderEditPreview.call(this, d, b);
            d.append(b)
        },
        renderEditor: function() {
            var d = this
              , b = $(this.tpl).siblings("#editor-image");
            m.prototype.renderEditor.call(this, b);
            "true" != this.componentSetup.isSingle && 1 != this.componentSetup.isSingle || b.find("#isSingle").attr("checked", "true");
            b.find("#required").closest(".form-group").before($(h.get("editablecomponent")).siblings(".j_condition_group"));
            var c = this.componentSetup.onlyPhoto;
            1 == c || "true" == c ? b.find("#onlyPhoto").attr("checked", !0) : b.find("#onlyPhoto").attr("checked", !1);
            $("#editor-component").html(b.html());
            var b = $("#j_default_value")
              , c = this.componentSetup.images
              , f = this.componentSetup.formId;
            if (c && 0 < c.length)
                for (var e = 0; e < c.length; e++) {
                    var a = c[e];
                    "string" == typeof a && (a = JSON.parse(a));
                    var k = a.optionId
                      , a = a.content
                      , k = $('\x3cdiv id\x3d"' + k + '" imageid\x3d"' + k + '" class\x3d"img-item j_imageItem"\x3e\x3cdiv class\x3d"img-box"\x3e\x3ca  class\x3d"gallery-pic" onclick\x3d"$.openPhotoGallery(this)" rel\x3d"0" type\x3d"image" imghref\x3d"'+TEAMS.api.downImgUrl+'/' + k + '?module\x3dform"\x3e\x3cimg imageId\x3d"' + k + '" src\x3d"'+TEAMS.api.downImgUrl+'/' + k + '?module\x3dform"\x3e\x3c/div\x3e\x3cdiv class\x3d"img-opt"\x3e\x3ca class\x3d"delet"\x3e\x3ci class\x3d"icon-minus-sign j_deleteImage"\x3e\x3c/i\x3e\x3c/a\x3e\x3ca class\x3d"cut j_cut_image" imageId\x3d"' + k + '"\x3e\x3ci class\x3d"icon-crop"\x3e\x3c/i\x3e\x3cdiv class\x3d"background"\x3e\x3c/div\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
                    k.data("name", a);
                    $("#j_default_value .j_formImageContainer").append(k)
                }
            this.initUploader(function() {
                var a = [];
                $("#j_default_value .j_formImageContainer").find(".j_imageItem").each(function() {
                    a.push({
                        optionId: $(this).attr("id"),
                        content: $(this).data("name")
                    });
                    $(this).find(".j_cut_image").removeClass("hide")
                });
                d.setImages(a)
            }, "#j_default_value .j_img_add", "#j_default_value .j_formImageContainer", b, !1)
        },
        renderPreview: function(d, b, c) {
            var f = $(this.tpl)
              , e = null;
            "mobile" != window.systemInfo_form ? e = f.siblings("#preview-image") : (e = f.siblings("#mobile-preview"),
            "false" != this.componentSetup.isSingle && 0 != this.componentSetup.isSingle || e.find("#formFileToUpload").attr("multiple", "multiple"));
            e.find(".widget-title .widget-title_js").text(this.componentSetup.title);
            "true" != this.componentSetup.isHideTitle && 1 != this.componentSetup.isHideTitle || e.addClass("field-notitle").find(".widget-title .widget-title_js").addClass("hide");
            "true" != this.componentSetup.required && 1 != this.componentSetup.required || e.find(".widget-title .widget-required_js").text(" *");
            "" != this.componentSetup.describe && (e.find(".field-description").text(this.componentSetup.describe),
            e.find(".field-description").show());
            e.find(".check_js").attr("id", this.componentSetup.fieldId + this.cid);
            e.find(".check_js").siblings(".j_imageaddwrap").attr("id", "imageAdd" + this.componentSetup.fieldId + this.cid);
            e.find(".check_js").attr("cid", this.cid);
            e.attr("id", "field_" + this.componentSetup.fieldId);
            e.attr("cid", this.cid);
            e.find(".check_js").data("componentData", this);
            e.addClass(this.componentSetup.titleLayout);
            e.find(".form-control").attr("placeholder", "\u8bf7\u586b\u5199" + this.componentSetup.title);
            this.el = d;
            d.append(e);
            if ("true" == c || 1 == c || c)
                e.find("#imageAdd" + this.componentSetup.fieldId + this.cid).remove(),
                this.isReadOnly = c,
                "mobile" == window.systemInfo_form && e.find("#" + this.componentSetup.fieldId + this.cid).attr("readOnly", "readOnly");
            d = this.componentSetup.images;
            b || "true" != this.componentSetup.isDefault && 1 != this.componentSetup.isDefault || !d || window.systemInfo_print || this.setValue(e, {
                dataOptions: d
            });
            if ("true" == this.componentSetup.isReadOnly || 1 == this.componentSetup.isReadOnly)
                this.readOnly(e, !0),
                this.isReadOnly = !0,
                "mobile" == window.systemInfo_form && e.find("#" + this.componentSetup.fieldId + this.cid).attr("readOnly", "readOnly");
            this.isMobileForm && this.calcImgHeight()
        },
        calcImgHeight: function() {
            var d = ($(window).width() - 20) / 3;
            this.el.find("#imageAdd" + this.componentSetup.fieldId + this.cid).height(d);
            this.el.find(".j_imageItem").height(d - 10)
        },
        checkEvents: function(d) {
            var b = this
              , c = b.componentSetup.formId
              , f = b.el || $(document)
              , e = b.componentSetup.fieldId + this.cid;
            if ((!b.isReadOnly || "false" == b.isReadOnly || 0 == b.isReadOnly) && "mobile" != window.systemInfo_form) {
                var a = b.componentSetup.onlyPhoto;
                1 == a || "true" == a ? (f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_imageaddwrap").addClass("hide"),
                f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_onlyPhoto").removeClass("hide")) : (f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_imageaddwrap").removeClass("hide"),
                f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_onlyPhoto").addClass("hide"),
                b.initUploader(d))
            }
            f.on("click", "#" + e + " .j_deleteImage", function() {
                var a = $(this).parents("#" + e);
                b.deleteImage($(this), d);
                a = b.check(a);
                d(a)
            });
            if (this.isMobileForm)
                $(window).on("resize.imagecomponent", function() {
                    b.calcImgHeight()
                });
            if ("mobile" == window.systemInfo_form) {
                var k = !1;
                !b.componentSetup.timeWaterMark || 1 != b.componentSetup.timeWaterMark.selected && "true" != b.componentSetup.timeWaterMark.selected || (k = !0);
                !b.componentSetup.placeWaterMark || 1 != b.componentSetup.placeWaterMark.selected && "true" != b.componentSetup.placeWaterMark.selected || (k = !0);
                !b.componentSetup.nameWaterMark || 1 != b.componentSetup.nameWaterMark.selected && "true" != b.componentSetup.nameWaterMark.selected || (k = !0);
                !b.componentSetup.selfWaterMark || 1 != b.componentSetup.selfWaterMark.selected && "true" != b.componentSetup.selfWaterMark.selected || (k = !0);
                var a = b.componentSetup.onlyPhoto
                  , h = !1
                  , r = b.componentSetup.isSingle;
                if (1 == r || "true" == r)
                    h = !0;
                f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_imageAdd").removeClass("hide");
                f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_onlyPhoto").addClass("hide");
                1 == a || "true" == a ? window.androidwv ? (f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_imageAdd #formFileToUpload").attr("type", ""),
                $("#imageAdd" + b.componentSetup.fieldId + b.cid).on("tap", function(a) {
                    window.androidwv.openCamera(!0, c, b.componentSetup.fieldId, b.cid, b.isReadOnly, b.componentSetup.isSingle, "openCameraCallback")
                })) : window.ioswv ? (f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_imageAdd #formFileToUpload").attr("type", ""),
                $("#imageAdd" + b.componentSetup.fieldId + b.cid).on("tap", function(a) {
                    window.ioswv.openCamera(!0, c, b.componentSetup.fieldId, b.cid, b.isReadOnly, h, "openCameraCallback")
                })) : (f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_imageAdd").addClass("hide"),
                f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_onlyPhoto").removeClass("hide")) : window.androidwv ? (f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_imageAdd #formFileToUpload").attr("type", ""),
                $("#imageAdd" + b.componentSetup.fieldId + b.cid).on("tap", function(a) {
                    window.androidwv.openCamera(!1, c, b.componentSetup.fieldId, b.cid, b.isReadOnly, b.componentSetup.isSingle, "openCameraCallback")
                })) : window.ioswv && (f.find("#field_" + b.componentSetup.fieldId + "[cid\x3d" + b.cid + "]").find(".j_imageAdd #formFileToUpload").attr("type", ""),
                $("#imageAdd" + b.componentSetup.fieldId + b.cid).on("tap", function(a) {
                    window.ioswv.openCamera(!1, c, b.componentSetup.fieldId, b.cid, b.isReadOnly, h, "openCameraCallback")
                }));
                window.openCameraCallback = function(a, e, c, b, d, f, k) {
                    var l = $(document)
                      , g = !1;
                    if (1 == f || "true" == f)
                        g = !0;
                    1 != k && "true" != k || $("#imageAdd" + b + d).hide();
                    a ? (a = $('\x3cdiv id\x3d"' + a + '" imageid\x3d"' + a + '" class\x3d"img-item j_imageItem"\x3e' + ('\x3cdiv class\x3d"form-quick-tools j_quicktools"\x3e\x3ca imageid\x3d"' + a + '" formid\x3d"' + c + '" class\x3d"preview j_imageView"\x3e\x3ci class\x3d"graph"\x3e\x3c/i\x3e\x3cspan\x3e\u9884\u89c8\x3c/span\x3e\x3c/a\x3e' + (g ? "" : '\x3ca class\x3d"j_m_deleteImage delete"\x3e\x3ci class\x3d"graph"\x3e\x3c/i\x3e\x3cspan\x3e\u5220\u9664\x3cspan\x3e\x3c/a\x3e') + "\x3c/div\x3e") + '\x3cdiv class\x3d"img-box"\x3e\x3cimg src\x3d"'+TEAMS.api.downImgUrl+'/' + a + '?module\x3dform"\x3e\x3c/div\x3e\x3c/div\x3e'),
                    a.data("name", e),
                    $("#" + b + d).append(a),
                    l.find("#" + b + d).triggerHandler("changeVaule")) : formPlugin.notify("\u6587\u4ef6\u683c\u5f0f\u4e0d\u6b63\u786e");
                    e = ($(window).width() - 20) / 3;
                    l.find("#imageAdd" + b + d).height(e);
                    l.find("#" + b + d).find(".j_imageItem").height(e - 10)
                }
                ;
                $("#imageAdd" + b.componentSetup.fieldId + b.cid).on("input change propertychange paste", function(a) {
                    var d = $(this);
                    b.callback = function(a) {
                        var g = 1 == b.componentSetup.isSingle || "true" == b.componentSetup.isSingle
                          , h = d.find("#formFileToUpload").get(0).files;
                        if (k && 1 < h.length)
                            formPlugin.notify("\u8bbe\u7f6e\u6c34\u5370\u540e\u6bcf\u6b21\u53ea\u80fd\u4e0a\u4f20\u4e00\u5f20\u56fe\u7247");
                        else if (h && 0 < h.length)
                            for (var z = 0; z < h.length; z++) {
                                var r = h[z];
                                if (r) {
                                    var q = 0;
                                    if (k && 10485760 < r.size) {
                                        formPlugin.notify("\u6c34\u5370\u56fe\u7247\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc710M");
                                        break
                                    }
                                    k && ($("#imageAdd" + b.componentSetup.fieldId + b.cid).find("#documentFiles").addClass("hide"),
                                    $("#imageAdd" + b.componentSetup.fieldId + b.cid).find("#documentFiles-showOnly p").empty().text("\u4e0a\u4f20\u56fe\u7247"),
                                    $("#imageAdd" + b.componentSetup.fieldId + b.cid).find("#documentFiles-showOnly").removeClass("hide"));
                                    q = 1048576 < r.size ? (Math.round(100 * r.size / 1048576) / 100).toString() + "MB" : (Math.round(100 * r.size / 1024) / 100).toString() + "KB";
                                    r.size = q;
                                    q = $('\x3cdiv class\x3d"info-subitem attachment"\x3e\x3ca id\x3d"' + r.id + '"\x3e' + r.name + '\x3ci class\x3d"ml-3 j_percent c-grey"\x3e\x3c/i\x3e\x3c/a\x3e\x3c/div\x3e');
                                    d.next().append(q);
                                    g && d.hide();
                                    var q = b.componentSetup.fieldId || b.componentSetup.tempId
                                      , m = new FormData;
                                    m.append("data", r);
                                    r = new XMLHttpRequest;
                                    r.upload.addEventListener("progress", function(a) {
                                        a.lengthComputable && (a = Math.round(100 * a.loaded / a.total),
                                        $("#" + b.componentSetup.fieldId + b.cid + " .j_percent").html(a.toString() + "%"))
                                    }, !1);
                                    r.addEventListener("load", function(a) {
                                        var g = jQuery.parseJSON(a.target.responseText)
                                          , h = g.fileObj;
                                        a = h.name;
                                        "true" == h.image || 1 == h.image ? (g = g.imageFile.id,
                                        g = $('\x3cdiv id\x3d"' + g + '" imageid\x3d"' + g + '" class\x3d"img-item j_imageItem"\x3e' + ('\x3cdiv class\x3d"form-quick-tools j_quicktools"\x3e\x3ca imageid\x3d"' + g + '" formid\x3d"' + c + '" class\x3d"preview j_imageView"\x3e\x3ci class\x3d"graph"\x3e\x3c/i\x3e\x3cspan\x3e\u9884\u89c8\x3c/span\x3e\x3c/a\x3e' + (b.isReadOnly ? "" : '\x3ca class\x3d"j_m_deleteImage delete"\x3e\x3ci class\x3d"graph"\x3e\x3c/i\x3e\x3cspan\x3e\u5220\u9664\x3cspan\x3e\x3c/a\x3e') + "\x3c/div\x3e") + '\x3cdiv class\x3d"img-box"\x3e\x3cimg src\x3d"'+TEAMS.api.downImgUrl+'/' + g + '?module\x3dform"\x3e\x3c/div\x3e\x3c/div\x3e'),
                                        g.data("name", a),
                                        $("#" + b.componentSetup.fieldId + b.cid).append(g),
                                        f.find("#" + e).triggerHandler("changeVaule"),
                                        formPlugin.notify("\u6587\u4ef6\u4e0a\u4f20\u6210\u529f")) : (formPlugin.notify("\u6587\u4ef6\u683c\u5f0f\u4e0d\u6b63\u786e"),
                                        d.show());
                                        k && ($("#imageAdd" + b.componentSetup.fieldId + b.cid).find("#documentFiles").removeClass("hide"),
                                        a = $("\x3cp\x3e\u4ec5\u652f\u6301\u62cd\u7167\u4e0a\u4f20\x3cbr\x3e\u8bf7\u81f3\u624b\u673a\u7aef\u4e0a\u4f20\x3c/p\x3e"),
                                        $("#imageAdd" + b.componentSetup.fieldId + b.cid).find("#documentFiles-showOnly p").remove(),
                                        $("#imageAdd" + b.componentSetup.fieldId + b.cid).find("#documentFiles-showOnly").append(a),
                                        $("#imageAdd" + b.componentSetup.fieldId + b.cid).find("#documentFiles-showOnly").addClass("hide"));
                                        b.calcImgHeight();
                                        $("#" + b.componentSetup.fieldId + b.cid).find(".info-subitem").remove()
                                    }, !1);
                                    r.addEventListener("error", function(a) {
                                        formPlugin.notify("\u6587\u4ef6\u4e0a\u4f20\u5931\u8d25");
                                        d.show()
                                    }, !1);
                                    var n = "";
                                    TEAMS && TEAMS.currentUser && TEAMS.currentUser.username && (n = TEAMS.currentUser.username);
                                    r.open(TEAMS.ajaxMethod, TEAMS.api.uploadImage+"?module\x3dform\x26refId\x3d" + c + "\x26fieldId\x3d" + q + "\x26position\x3d" + a + "\x26userName\x3d" + n);
                                    r.send(m)
                                }
                            }
                    }
                    ;
                    b.getPosition()
                });
                $("#" + b.componentSetup.fieldId + b.cid).on("tap", ".j_imageView", function(a) {
                    a = $(this).attr("imageid");
                    (new g({
                        preEl: $(this).parents(".j_page-view"),
                        imageId: a,
                        imageUrl: TEAMS.api.downImgUrl+"/" + a
                    })).render()
                });
                $("#" + b.componentSetup.fieldId + b.cid).on("tap", ".j_imageItem", function(a) {
                    b.isReadOnly ? (a = $(this).attr("imageid"),
                    (new g({
                        preEl: $(this).parents(".j_page-view"),
                        imageId: a,
                        imageUrl: $(this).attr("href")
                    })).render()) : ($(this).find(".j_quicktools").show(),
                    $(this).siblings().find(".j_quicktools").hide())
                });
                $("#" + b.componentSetup.fieldId + b.cid).on("tap", ".j_m_deleteImage", function(a) {
                    var c = $(this);
                    formPlugin.confirm("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f", function(a) {
                        var d = c.parents(".j_imageItem");
                        a && (d.remove(),
                        formPlugin.notify("\u6570\u636e\u5df2\u5220\u9664"),
                        f.find("#" + e).triggerHandler("changeVaule"),
                        "true" != b.componentSetup.isSingle && 1 != b.componentSetup.isSingle || $("#" + b.componentSetup.fieldId + b.cid).next(".j_imageaddwrap").show())
                    })
                });
                f.parents(".page-view").on("click", function(a) {
                    null == $(a.target).parents(".j_quicktools").get(0) && null == $(a.target).closest(".j_quicktools").get(0) && f.find(".j_quicktools").hide()
                })
            }
        },
        autoSaveEvents: function(d) {
            var b = this
              , c = b.el || $(document)
              , f = (b.componentSetup.fieldId || b.componentSetup.tempId) + this.cid;
            c.find("#" + f).on("changeVaule", function() {
                b.saveComponentValue($(this), d)
            });
            if ("mobile" != window.systemInfo_form)
                c.on("click", "#" + f + " .j_deleteImage", function() {
                    b.saveComponentValue(c.find("#" + f), d)
                })
        },
        check: function(d) {
            var b = $(d).find(".j_imageItem")
              , c = b.length
              , f = {};
            f.element = d;
            0 != c || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (f.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            b.each(function(e) {
                $(this).attr("id") || (f.message = "\u56fe\u7247\u5c1a\u672a\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85")
            });
            return f
        },
        getValue: function(d, b) {
            var c = {
                formField: {
                    id: this.componentSetup.fieldId
                }
            }
              , f = d.find(".j_imageItem");
            if (0 < f.length) {
                var e = [];
                f.each(function(a) {
                    var c = $(this).attr("imageid")
                      , b = $(this).data("name");
                    e[a] = {
                        optionId: c,
                        content: b,
                        type: "imageFile"
                    }
                });
                c.dataOptions = e
            } else
                b || (c = null);
            return c
        },
        setValue: function(d, b) {
            var c = this.componentSetup.formId;
            if (null != b && null != b.dataOptions) {
                d.find(".check_js").html("");
                for (var f = 0; f < b.dataOptions.length; f++) {
                    var e = b.dataOptions[f];
                    "string" == typeof e && (e = JSON.parse(e));
                    var a = null == e.content ? "" : e.content
                      , e = e.optionId
                      , k = null;
                    "mobile" != window.systemInfo_form ? (k = window.systemInfo_print ? $('\x3cdiv id\x3d"' + e + '" imageid\x3d"' + e + '" class\x3d"img-item j_imageItem j_imgSizeChange"\x3e\x3cdiv class\x3d"img-box"\x3e\x3cimg id\x3d"' + e + '" count\x3d"1" imageid\x3d"' + e + '" src\x3d"'+TEAMS.api.downImgUrl+'/' + e + "?module\x3dform\x26v\x3d" + (new Date).getTime() + '"\x3e\x3c/div\x3e\x3cdiv class\x3d"img-opt"\x3e\x3ca class\x3d"delet"\x3e\x3ci class\x3d"icon-minus-sign j_deleteImage"\x3e\x3c/i\x3e\x3c/div\x3e\x3c/div\x3e') : $('\x3cdiv id\x3d"' + e + '" imageid\x3d"' + e + '" class\x3d"img-item j_imageItem"\x3e\x3cdiv class\x3d"img-box"\x3e\x3ca class\x3d"gallery-pic" onclick\x3d"$.openPhotoGallery(this)" rel\x3d"0" type\x3d"image" imghref\x3d"'+TEAMS.api.downImgUrl+'/' + e + '?module\x3dform"\x3e\x3cimg imageid\x3d"' + e + '" src\x3d"'+TEAMS.api.downImgUrl+'/' + e + "?module\x3dform\x26v\x3d" + (new Date).getTime() + '"\x3e\x3c/div\x3e\x3cdiv class\x3d"img-opt"\x3e\x3ca class\x3d"delet"\x3e\x3ci class\x3d"icon-minus-sign j_deleteImage"\x3e\x3c/i\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e'),
                    k.data("name", a),
                    null == d.find(".j_imageAdd").get(0) && k.find(".j_deleteImage").parent().remove()) : (k = $('\x3cdiv imageid\x3d"' + e + '" id\x3d"' + this.componentSetup.fieldId + '" class\x3d"img-item j_imageItem" href\x3d"'+TEAMS.api.downImgUrl+'/' + e + '?module\x3dform"\x3e' + ('\x3cdiv class\x3d"form-quick-tools j_quicktools"\x3e\x3ca imageid\x3d"' + e + '" formid\x3d"' + c + '" class\x3d"preview j_imageView"\x3e\x3ci class\x3d"graph"\x3e\x3c/i\x3e\x3cspan\x3e\u9884\u89c8\x3c/span\x3e\x3c/a\x3e' + (this.isReadOnly ? "" : '\x3ca class\x3d"j_m_deleteImage delete"\x3e\x3ci class\x3d"graph"\x3e\x3c/i\x3e\x3cspan\x3e\u5220\u9664\x3cspan\x3e\x3c/a\x3e') + "\x3c/div\x3e") + '\x3cdiv class\x3d"img-box"\x3e\x3cimg imageid\x3d"' + e + '" src\x3d"'+TEAMS.api.downImgUrl+'/' + e + "?module\x3dform\x26v\x3d" + (new Date).getTime() + '"\x3e\x3c/div\x3e\x3c/div\x3e'),
                    k.data("name", a));
                    d.find(".check_js").append(k)
                }
                this.isMobileForm && this.calcImgHeight();
                "true" != this.componentSetup.isSingle && 1 != this.componentSetup.isSingle || null == $("#" + this.componentSetup.fieldId + this.cid + " .j_imageItem").get(0) || $("#imageAdd" + this.componentSetup.fieldId + this.cid).find(".j_imageAdd").hide()
            }
        },
        empty: function(d) {
            d.find(".j_imageItem").remove()
        },
        readOnly: function(d, b) {
            var c = d.find("#imageAdd" + this.componentSetup.fieldId + this.cid)
              , f = d.find("#" + this.componentSetup.fieldId + this.cid);
            b && (c.remove(),
            "mobile" == window.systemInfo_form && d.find(".j_deleteImage").remove(),
            d.addClass("form-widget-readonly"),
            f.find(".j_imageItem .j_deleteImage").parent().html(""))
        },
        errorBack: function(d) {
            d = window.qdgps;
            d.callback && d.callback("")
        },
        showPosition: function(d) {
            var b = window.qdgps;
            window.HOST_TYPE = "2";
            window.BMap_loadScriptTime = (new Date).getTime();
            n.async(["https://api.map.baidu.com/getscript?v\x3d2.0\x26ak\x3dXKXXQG69VnCYhXvtrfjVuWjh\x26services\x3d\x26t\x3d" + TEAMS.version], function() {
                var c = [new BMap.Point(d.coords.longitude,d.coords.latitude)];
                (new BMap.Convertor).translate(c, 1, 5, function(c) {
                    0 === c.status && (c = c.points[0],
                    (new BMap.Geocoder).getLocation(c, function(e) {
                        e = e.addressComponents;
                        e = e.city + e.district + e.street + e.streetNumber;
                        b.callback && b.callback(e)
                    }))
                })
            })
        },
        translate: function(d, b, c) {
            var f = "cbk_" + Math.round(1E4 * Math.random());
            this.load_script("https://api.map.baidu.com/ag/coord/convert?from\x3d" + b + "\x26to\x3d4\x26x\x3d" + d.lng + "\x26y\x3d" + d.lat + "\x26callback\x3dBMap.Convertor." + f);
            BMap.Convertor[f] = function(e) {
                delete BMap.Convertor[f];
                e = new BMap.Point(e.x,e.y);
                c && c(e)
            }
        },
        load_script: function(d, b) {
            var c = document.getElementsByTagName("head")[0]
              , f = document.createElement("script");
            f.type = "text/javascript";
            f.src = d;
            f.onload = f.onreadystatechange = function() {
                this.readyState && "loaded" !== this.readyState && "complete" !== this.readyState || (b && b(),
                f.onload = f.onreadystatechange = null,
                c && f.parentNode && c.removeChild(f))
            }
            ;
            c.insertBefore(f, c.firstChild)
        },
        getPosition: function() {
            var d = this
              , b = d.componentSetup.placeWaterMark;
            b ? !b || "false" != b.selected && 0 != b.selected ? "mobile" == window.systemInfo_form ? (window.qdgps = d,
            navigator.geolocation ? navigator.geolocation.getCurrentPosition(d.showPosition, d.errorBack, {
                enableHighAccuracy: !0
            }) : d.callback && d.callback("")) : $.ajax({
                url: "https://api.map.baidu.com/location/ip?ak\x3dXKXXQG69VnCYhXvtrfjVuWjh\x26coor\x3dbd09ll",
                type: 'post',
                dataType: "jsonp",
                success: function(c) {
                    if (c.content && c.content.point) {
                        c = c.content.address_detail;
                        var b = "";
                        c.province && (b += c.province);
                        c.city && c.province && c.city != c.province && (b += c.city);
                        c.district && (b += c.district);
                        c.street && (b += c.street);
                        c.streetNumber && (b += c.streetNumber);
                        d.callback && d.callback(b)
                    }
                }
            }) : d.callback && d.callback("") : d.callback && d.callback("")
        },
        initUploader: function(d, b, c, f, e) {
            var a = this
              , k = a.el
              , g = a.componentSetup.fieldId + this.cid;
            b = b || "#imageAdd" + this.componentSetup.fieldId + this.cid + " .j_imageAdd";
            c = c || "#" + this.componentSetup.fieldId + this.cid;
            f = f || $(c).parents("#field_" + this.componentSetup.fieldId + "[cid\x3d" + a.cid + "]");
            null == e && (e = 1 == a.componentSetup.isSingle || "true" == a.componentSetup.isSingle);
            var h = !1;
            !a.componentSetup.timeWaterMark || 1 != a.componentSetup.timeWaterMark.selected && "true" != a.componentSetup.timeWaterMark.selected || (h = !0);
            !a.componentSetup.placeWaterMark || 1 != a.componentSetup.placeWaterMark.selected && "true" != a.componentSetup.placeWaterMark.selected || (h = !0);
            !a.componentSetup.nameWaterMark || 1 != a.componentSetup.nameWaterMark.selected && "true" != a.componentSetup.nameWaterMark.selected || (h = !0);
            !a.componentSetup.selfWaterMark || 1 != a.componentSetup.selfWaterMark.selected && "true" != a.componentSetup.selfWaterMark.selected || (h = !0);
            var q = a.componentSetup.formId
              , p = a.componentSetup.fieldId || a.componentSetup.tempId;
            0 < $(b).parents("#j_default_value").length && (p = "");
            var m = "50M";
            h && (m = "10M");
            f = this.uploader = new plupload.Uploader({
                runtimes: "html5,flash",
                file_data_name: "data",
                browse_button: b,
                container: f,
                max_file_size: m,
                url: TEAMS.api.uploadImage+"?module\x3dform\x26refId\x3d" + q + "\x26fieldId\x3d" + p,
                flash_swf_url: "/static/swf/plupload.swf",
                multipart_params: {}
            });
            f.init();
            f.bind("FilesAdded", function(b, d) {
                a.callback = function(f) {
                    var l = "";
                    TEAMS && TEAMS.currentUser && TEAMS.currentUser.username && (l = TEAMS.currentUser.username);
                    b.settings.multipart_params.position = f;
                    b.settings.multipart_params.userName = l;
                    e && (1 < d.length || null != $(c).find(".j_imageItem").get(0)) ? ($.each(d, function(a, e) {
                        b.removeFile(e)
                    }),
                    formPlugin.notify("\u6b64\u63a7\u4ef6\u4ec5\u80fd\u4e0a\u4f20\u4e00\u5f20\u56fe\u7247", "\u56fe\u7247\u6570\u8fc7\u591a", "error")) : h && 1 < d.length ? ($.each(d, function(a, e) {
                        b.removeFile(e)
                    }),
                    formPlugin.notify("\u8bbe\u7f6e\u6c34\u5370\u540e\u6bcf\u6b21\u53ea\u80fd\u4e0a\u4f20\u4e00\u5f20\u56fe\u7247", "\u56fe\u7247\u6570\u8fc7\u591a", "error")) : ($.each(d, function(a, e) {
                        plupload.formatSize(e.size)
                    }),
                    b.refresh(),
                    b.start(),
                    h && (f = k.find("#field_" + a.componentSetup.fieldId + "[cid\x3d" + a.cid + "]"),
                    f.find(".j_imageaddwrap").addClass("hide"),
                    f.find(".j_onlyPhoto").removeClass("hide"),
                    f.find(".j_onlyPhoto .j_onlyPhotoShow p").empty().text("\u4e0a\u4f20\u56fe\u7247"),
                    f.off("click", ".j_onlyPhotoShow").on("click", ".j_onlyPhotoShow", function() {
                        formPlugin.notify("\u6bcf\u6b21\u53ea\u80fd\u4e0a\u4f20\u4e00\u5f20\u56fe\u7247\u54e6")
                    })))
                }
                ;
                a.getPosition()
            });
            f.bind("UploadProgress", function(a, e) {
                $("#" + e.id + " i").html(e.percent + "%")
            });
            f.bind("Error", function(a, e) {
                -600 == e.code && formPlugin.notify("\u53ea\u80fd\u4e0a\u4f20\u6700\u5927\u4e0d\u8d85\u8fc7" + m + "\u7684\u6587\u4ef6", "\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7\u9650\u5236", "error");
                a.refresh()
            });
            f.bind("FileUploaded", function(f, l, m) {
                l = jQuery.parseJSON(m.response);
                m = l.fileObj;
                f = m.name;
                m = m.image;
                "true" == m || 1 == m ? (l = l.imageFile.id,
                l = $('\x3cdiv id\x3d"' + l + '" imageid\x3d"' + l + '" class\x3d"img-item j_imageItem"\x3e\x3cdiv class\x3d"img-box"\x3e\x3ca class\x3d"gallery-pic" onclick\x3d"$.openPhotoGallery(this)" rel\x3d"0" type\x3d"image" imghref\x3d"'+TEAMS.api.downImgUrl+'/' + l  + '?module\x3dform"\x3e\x3cimg src\x3d"'+TEAMS.api.downImgUrl+'/' + l + '?module\x3dform" imageId\x3d"' + l + '"\x3e\x3c/div\x3e\x3cdiv class\x3d"img-opt"\x3e\x3ca class\x3d"delet"\x3e\x3ci class\x3d"icon-minus-sign j_deleteImage"\x3e\x3c/i\x3e\x3c/a\x3e\x3ca class\x3d"cut j_cut_image hide" imageId\x3d"' + l + '"\x3e\x3ci class\x3d"icon-crop"\x3e\x3c/i\x3e\x3cdiv class\x3d"background"\x3e\x3c/div\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e'),
                l.data("name", f),
                $(c).append(l),
                f = a.check($(c)),
                "function" == typeof d && d(f),
                e && $(b).hide(),
                formPlugin.notify("\u56fe\u7247\u4e0a\u4f20\u6210\u529f"),
                k && 0 < k.length && (k.find("#" + g).triggerHandler("changeVaule"),
                k.find(".img-item .image-add").height(k.find(".img-item").width()))) : formPlugin.notify("\u8bf7\u4e0a\u4f20\u56fe\u7247\u6587\u4ef6", "\u6587\u4ef6\u683c\u5f0f\u4e0d\u6b63\u786e", "error");
                h && (f = k.find("#field_" + a.componentSetup.fieldId + "[cid\x3d" + a.cid + "]"),
                f.find(".j_imageaddwrap").removeClass("hide"),
                f.find(".j_onlyPhoto").addClass("hide"),
                l = $("\x3cp\x3e\u4ec5\u652f\u6301\u62cd\u7167\u4e0a\u4f20\x3cbr\x3e\u8bf7\u81f3\u624b\u673a\u7aef\u4e0a\u4f20\x3c/p\x3e"),
                f.find(".j_onlyPhoto .j_onlyPhotoShow p").remove(),
                f.find(".j_onlyPhoto .j_onlyPhotoShow").append(l),
                f.off("click", ".j_onlyPhotoShow").on("click", ".j_onlyPhotoShow", function() {}))
            })
        },
        deleteImage: function(d, b) {
            var c = d.parents(".j_imageItem");
            "true" != this.componentSetup.isSingle && 1 != this.componentSetup.isSingle || 1 != c.parents(".j_formImageContainer").children().length || c.parents(".field_js").find(".j_imageAdd").show();
            c.remove()
        },
        initFancyBox: function(d) {
            d.find(".fancybox-button").fancybox({
                nextEffect: "fade",
                prevEffect: "fade",
                closeBtn: !0,
                afterLoad: function() {
                    this.title = "Image " + (this.index + 1) + " of " + this.group.length + (this.title ? " - " + this.title : "")
                }
            })
        },
        cutImage: function(b,t) {
            (new f({
                formId: this.componentSetup.formId,
                imageId: b,
                minHeight: 120,
                minWidth: 120,
                aspectRatio: "1:1",
                callback: function(e) {
                    $("img[imageId\x3d'" + b + "']").each(function() {
                        t.attr("imageid", e.imageArea.id);
                        $(this).attr("imageid", e.imageArea.id);
                        var c = TEAMS.api.downImgUrl+"/"+e.imageArea.id 
                        $(this).attr("src", c);
                        $(this).parent('.gallery-pic').attr("imghref", c + "?module\x3dform");
                    })
                }
            })).render()
        },
        layoutCheck: function(a) {
            var d = this,
                l = a.find('.imageslist-inline'),
                o = this.componentSetup.options;
            l.each(function(index) {
                $(this).children('.ImageCheckBox_js').each(function(i, el) {
                    var imgId = $(this).find('img').attr('imageid');
                    for (var d = !1, b = o, c = [], f = 0; f < b.length; f++) {
                        if(f == i) {
                            var e = b[f];
                            e.objId = imgId
                        }
                        
                    }
                }); 
            });
        }
    });
    u.exports = window.ImageComponent
});
define("form/component/employee", ["form/editablecomponent", "form/tplutil", "form/component/userselecter", "form/abposview"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/userselecter")
      , f = n("form/abposview");
    window.Employee = m.extend({
    });
    u.exports = window.Employee
});
define("form/component/signcomview", ["form/componentmodel", "form/tplutil"], function(n, y, u) {
    var m = n("form/componentmodel")
      , h = n("form/tplutil");
    y = Backbone.View.extend({
    });
    u.exports = y
});
define("form/component/relevancecontrol", ["form/tplutil", "form/component/entityselecter"], function(n, y, u) {
    var m = n("form/tplutil")
      , h = n("form/component/entityselecter");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/agendacomponent", "form/relatecomponent form/tplutil form/componentmodel form/component/agendalist form/component/entityselecter form/component/typeahead form/component/relevancecontrol form/abposview".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel")
      , f = n("form/component/agendalist")
      , d = n("form/component/entityselecter")
      , b = n("form/component/typeahead")
      , c = n("form/component/relevancecontrol")
      , l = n("form/abposview");
    window.AgendaComponent = m.extend({
    });
    u.exports = window.AgendaComponent
});
define("form/component/columnpanel", ["form/component", "form/tplutil"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil");
    window.ColumnPanel = y.extend({
        initialize: function(h) {
            this.componentSetup = {
                componentKey: "ColumnPanel",
                title: "",
                layoutDetail: [],
                order: 0,
                index: 0,
                size: "1",
                isBorder: !1
            };
            null != h && (this.componentSetup.title = h.title,
            this.componentSetup.layoutDetail = h.layoutDetail,
            this.componentSetup.order = h.order,
            this.componentSetup.index = h.index,
            this.componentSetup.size = h.size,
            this.componentSetup.isBorder = h.isBorder);
            this.tpl = m.get("columnpanel")
        },
        setIsBorder: function(h) {
            this.componentSetup.isBorder = h
        },
        render: function(h) {
            var g = $(this.tpl);
            this.componentSetup.size = h.attr("componentsize");
            g = g.siblings("#form-columnpanel-" + this.componentSetup.size);
            h.attr("class", g.attr("class"));
            h.html(g.html())
        },
        renderEditor: function() {
            var h = $(this.tpl).siblings("#editor-datatable");
            "true" != this.componentSetup.isBorder && 1 != this.componentSetup.isBorder || h.find("#delBorder").attr("checked", "true");
            $("#editor-component").html(h);  
        },
        renderPreview: function(h) {
            var g = h.data("form");
            if (1 < this.componentSetup.size) {
                var f = $(this.tpl).siblings("#preview-columnpanel-" + this.componentSetup.size);
                f.attr("id", "");
                if ("true" == this.componentSetup.isBorder || 1 == this.componentSetup.isBorder) {
                    f.addClass('noborder');
                } else {
                    f.removeClass('noborder');
                }
                f.find(".columns_js").children().data("form", g);
                h.append(f);
                return f.find(".columns_js").children() 
            }
        },
        renderEditPreview: function(h) {
            if (1 < this.componentSetup.size) {   
                var g = $(this.tpl).siblings("#form-columnpanel-" + this.componentSetup.size);
                g.attr("id", "");
                g.data("componentData", this);
                h.append(g);
                return g.find(".columns_js").children()
            }
        },
        submitCheck: function(h, g) {},
        checkEvents: function(h) {}
    });
    u.exports = window.ColumnPanel
});
define("form/component/barcomponent", ["form/component", "form/tplutil"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil");
    window.BarComponent = y.extend({
    });
    u.exports = window.BarComponent
});
define("form/component/money", ["form/editablecomponent", "form/tplutil", "form/componentmodel"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel");
    window.Money = m.extend({
        initialize: function(f) {
            m.prototype.initialize.call(this, f);
            var d = {
                componentKey: "Money",
                title: "\u91d1\u989d",
                type: "\u4eba\u6c11\u5e01",
                tempId: 0,
                isMinus: !0,
                pointSize: "",
                submitSel: !1,
                typesArray: [{
                    key: "RMB",
                    value: "\u4eba\u6c11\u5e01"
                }, {
                    key: "DOLLAR",
                    value: "\u7f8e\u5143"
                }, {
                    key: "YEN",
                    value: "\u65e5\u5143"
                }, {
                    key: "EURO",
                    value: "\u6b27\u5143"
                }, {
                    key: "HK",
                    value: "\u6e2f\u5e01"
                }, {
                    key: "TAIWAN",
                    value: "\u53f0\u5e01"
                }, {
                    key: "SINGAPORE",
                    value: "\u65b0\u52a0\u5761\u5e01"
                }, {
                    key: "POUND",
                    value: "\u82f1\u9551"
                }],
                isCapital: !1,
                minNum: "",
                maxNum: ""
            };
            null != f && (d.title = f.title,
            d.type = f.type,
            d.tempId = f.tempId || f.fieldId,
            d.isMinus = f.isMinus,
            d.pointSize = f.pointSize,
            d.submitSel = f.submitSel,
            d.isCapital = f.isCapital,
            d.minNum = f.minNum,
            d.maxNum = f.maxNum);
            this.componentSetup = $.extend(this.componentSetup, d);
            this.tpl = h.get("money", {
                isMobileForm: this.isMobileForm
            });
            this.componentModel = new g
        },
        setPointSize: function(f) {
            this.componentSetup.pointSize = f
        },
        setType: function(f) {
            this.componentSetup.type = f
        },
        setSubmitSel: function(f) {
            this.componentSetup.submitSel = f
        },
        setIsCapital: function(f) {
            this.componentSetup.isCapital = f
        },
        setMinNum: function(f) {
            this.componentSetup.minNum = f
        },
        setMaxNum: function(f) {
            this.componentSetup.maxNum = f
        },
        render: function(f) {
            var d = this
              , b = $(this.tpl).siblings("#form-money");
            b.find(".form-amountbox .money_type_js").text("(" + this.componentSetup.type + ")");
            this.componentModel.generatorId(function(c) {
                c = c.generatorId;
                d.componentSetup.tempId = c;
                f.attr("tempId", c)
            });
            m.prototype.render.call(this, f, b);
            b.find("#moneyType").removeClass("small medium large");
            f.html(b.html())
        },
        renderEditPreview: function(f) {
            var d = $(this.tpl).siblings("#form-money")
              , b = this.componentSetup.submitSel
              , c = this.componentSetup.type
              , l = this.componentSetup.isReadOnly;
            d.find("#moneyType").find("option").attr("selected", !1);
            d.find("#moneyType").find('option[value\x3d"' + c + '"]').attr("selected", !0);
            "true" == l || 1 == l ? (d.find(".money_type_js").removeClass("hide-im hide").text("(" + c + ")"),
            d.find("#moneyType").addClass("hide")) : 1 == b || "true" == b ? (d.find(".money_type_js").addClass("hide-im hide").text("(" + c + ")"),
            d.find("#moneyType").removeClass("hide")) : (d.find(".form-amountbox .money_type_js").removeClass("hide-im hide").text("(" + c + ")"),
            d.find("#moneyType").addClass("hide"));
            d.attr("tempId", this.componentSetup.fieldId);
            m.prototype.renderEditPreview.call(this, f, d);
            d.find("#moneyType").removeClass("small medium large");
            f.append(d)
        },
        renderEditor: function() {
            var f = $(this.tpl).siblings("#editor-money");
            f.find("select[id\x3d'moneyType'] option[value\x3d'" + this.componentSetup.type + "']").attr("selected", "selected");
            var d = this.componentSetup.pointSize
              , b = this.componentSetup.isCapital;
            1 != b && "true" != b || f.find("#isCapital").attr("checked", "true");
            "" != d && null != d && "sel" != d ? f.find(".j_money_point-select option[value\x3d'" + d + "']").attr("selected", !0) : f.find(".j_money_point-select option[value\x3d'sel']").attr("selected", !0);
            d = this.componentSetup.submitSel;
            "true" != d && 1 != d || f.find("#submitSel").attr("checked", "true");
            d = this.componentSetup.minNum;
            b = this.componentSetup.maxNum;
            null != d && "" != d && f.find("#text-min-num").attr("value", d);
            null != b && "" != b && f.find("#text-max-num").attr("value", b);
            m.prototype.renderEditor.call(this, f);
            $("#editor-component").html(f.html())
        },
        renderPreview: function(f, d, b) {
            var c = $(this.tpl).siblings("#preview-money")
              , l = this.componentSetup.submitSel
              , e = this.transLangType(this.componentSetup.type)
              , a = this.componentSetup.isReadOnly;
            c.attr("tempId", "field_" + this.componentSetup.fieldId);
            c.attr("fieldid", this.componentSetup.fieldId || this.componentSetup.tempId);
            d && c.find(".check_js").val("");
            c.find(".form-control").attr("placeholder", null == this.componentSetup.placeholder || 1 > this.componentSetup.placeholder.length ? "\u8bf7\u586b\u5199" + this.componentSetup.title : this.componentSetup.placeholder);
            m.prototype.renderPreview.call(this, f, d, b, c);
            if ("true" == this.componentSetup.isDefault || 1 == this.componentSetup.isDefault)
                if (d = this.componentSetup.isCapital,
                1 == d || "true" == d)
                    d = this.numberToChinese(this.componentSetup.content),
                    c.find(".j_capital_money").text(d).removeClass("hide-im");
            b ? c.find(".check_js").attr("noedit", !0) : "true" == a || 1 == a ? (c.find(".money_type_js").removeClass("hide-im hide").text("(" + e + ")"),
            c.find("#moneyType").addClass("hide")) : 1 == l || "true" == l ? (c.find(".money_type_js").addClass("hide-im hide").text("(" + e + ")"),
            c.find("#moneyType").find("option").attr("selected", !1),
            c.find("#moneyType").find('option[value\x3d"' + e + '"]').prop("selected", !0),
            c.find("#moneyType").removeClass("hide")) : (c.find(".money_type_js").removeClass("hide-im hide").text("(" + e + ")"),
            c.find("#moneyType").addClass("hide"));
            f.append(c)
        },
        renderStatSearch: function(f) {
            var d = $(this.tpl)
              , b = f.parentEl
              , c = f.term
              , l = null;
            if ("mobile" != window.systemInfo_form) {
                var l = d.siblings("#statsearch-money")
                  , e = f.startValue;
                e && l.find("input:first").val(e);
                (e = f.endValue) && l.find("input:last").val(e);
                c && l.find("select:first option[value\x3d" + c + "]").attr("selected", "true");
                b.attr("class", "sch-group j_formFieldSearchGroup");
                b.find(".j_formField-condition").html(l)
            } else {
                var c = f.fieldId
                  , e = f.fieldTitle
                  , a = f.subFormId
                  , l = d.siblings("#statsearch-money-mobile")
                  , d = f.filterEl;
                f = f.condition;
                if (d) {
                    var k = d.find(".j_filterList .selectd #comp-val span").eq(0).text()
                      , d = d.find(".j_filterList .selectd #comp-val span").eq(1).text();
                    l.find(".j_numberCheck").eq(0).val(k);
                    l.find(".j_numberCheck").eq(1).val(d)
                }
                f && (l.find(".j_condition").find('option[value\x3d"' + f + '"]').attr("selected", !0),
                "null" != f && "notnull" != f || l.find(".j_control").hide());
                l.find(".j_inputName").text(e + ":");
                b.find("#component-div").html(l);
                b.find(".j_comp-ok").attr("comKey", "Money").attr("fieldId", c).attr("title", e).attr("subFormId", a);
                b.off("change", "#statsearch-money-mobile .j_condition").on("change", "#statsearch-money-mobile .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? b.find("#statsearch-money-mobile .j_control").hide() : b.find("#statsearch-money-mobile .j_control").show()
                });
                b.on("keydown", ".j_numberCheck", function(a) {
                    a = parseInt(a.keyCode);
                    var e = $(this).val();
                    if ((110 == a || 190 == a) && 0 <= e.indexOf(".") || (109 == a || 173 == a) && 0 <= e.indexOf("-"))
                        return !1
                });
                b.on("keyup", ".j_numberCheck", function(a) {
                    a = $(this).val();
                    isNaN(a) && ("-" != a && $(this).val(parseFloat(a)),
                    "-" == a && $(this).val(a));
                    "." == a.charAt(0) && $(this).val(0 + parseFloat(a))
                });
                b.on("keyup", ".j_numberCheck", function(a) {
                    a = $(this).val();
                    $(this).val(a.replace(/[^\d.-]/g, ""))
                })
            }
        },
        submitCheck: function(f, d) {
            var b = this.check(f);
            d(b)
        },
        checkEvents: function(f, d) {
            var b = this
              , c = b.el || $(document)
              , l = b.componentSetup.fieldId || b.componentSetup.tempId;
            c.on("blur", "input[componentKey\x3d'Money'][id\x3d'" + l + "'][cid\x3d'" + this.cid + "']", function() {
                var e = b.check($(this));
                f(e)
            });
            c.on("keydown", "input[componentKey\x3d'Money'][id\x3d'" + l + "'][cid\x3d'" + this.cid + "']", function(e) {
                e = parseInt(e.keyCode);
                var a = $(this).val();
                if ((110 == e || 190 == e) && 0 <= a.indexOf(".") || (!b.componentSetup.isMinus || 109 == e || 173 == e) && 0 <= a.indexOf("-"))
                    return !1
            });
            c.on("keyup", "input[componentKey\x3d'Money'][id\x3d'" + l + "'][cid\x3d'" + this.cid + "']", function(e) {
                e = $(this).val();
                isNaN(e) && ("-" != e && $(this).val(parseFloat(e)),
                b.componentSetup.isMinus && "-" == e && $(this).val(e));
                "." == e.charAt(0) && $(this).val(0 + parseFloat(e))
            });
            c.on("keyup", "input[componentKey\x3d'Money'][id\x3d'" + l + "'][cid\x3d'" + this.cid + "']", function(e) {
                e = $(this).val();
                var a = b.componentSetup.pointSize;
                if (null != a && "" != a && "sel" != a)
                    if (0 < a) {
                        if (0 < e.indexOf(".")) {
                            var c = e.substring(0, e.indexOf("."))
                              , d = e.substring(e.indexOf(".") + 1);
                            0 < d.length && d.length > a && (d = d.substring(0, a),
                            e = c + "." + d)
                        }
                    } else
                        0 < e.indexOf(".") && (e = e.substring(0, e.indexOf(".")));
                $(this).val(e.replace(/[^\d.-]/g, ""))
            });
            c.on("blur", "input[componentKey\x3d'Money'][id\x3d'" + l + "'][cid\x3d'" + this.cid + "']", function(e, a) {
                var f = $(this).val();
                if ("-" == f)
                    $(this).val("");
                else {
                    var g = b.componentSetup.isCapital;
                    if (1 == g || "true" == g)
                        g = b.numberToChinese(f),
                        c.find(".field_js[componentKey\x3d'Money'][id\x3d'field_" + l + "']").find(".j_capital_money").text(g).removeClass("hide-im");
                    g = b.componentSetup.pointSize;
                    if (f && null != g && "" != g && 0 < g)
                        if (0 > f.indexOf(".")) {
                            for (var h = "", q = 0; q < g; q++)
                                h += "0";
                            f = f + "." + h
                        } else {
                            for (var m = f.substring(0, f.indexOf(".")), f = f.substring(f.indexOf(".") + 1), h = "", q = 0; q < g - f.length; q++)
                                h += "0";
                            f = m + "." + (f + h)
                        }
                    f.replace(/[^\d.-]/g, "") && (null != g && "" != g && "sel" != g ? $(this).val(b.formatMoney(f, g)) : $(this).val(b.formatMoney(f, 0 < f.indexOf(".") ? f.length - (f.indexOf(".") + 1) : -1)));
                    !d || a && 0 == a.isAutoSave || (b.saveComponentValue($(this), d),
                    "" == f && ($(this).parent().find("#moneyType option").attr("selected", !1),
                    $(this).parent().find('#moneyType option[value\x3d"' + b.componentSetup.type + '"]').attr("selected", !0)))
                }
            });
            c.on("focus", "input[componentKey\x3d'Money'][id\x3d'" + l + "'][cid\x3d'" + this.cid + "']", function(e) {
                e = $(this).val();
                e.replace(/[^\d.-]/g, "") && $(this).val(parseFloat(e.replace(/[^\d.-]/g, "")))
            });
            c.off("change", "#field_" + l + " #moneyType").on("change", "#field_" + l + " #moneyType", function(e) {
                d && (e = $(this).closest(".field_js").find('input[componentKey\x3d"Money"]'),
                "" != e.val() && b.saveComponentValue(e, d))
            })
        },
        autoSaveEvents: function(f) {},
        renderTotal: function(f) {
            var d = f.attr("name");
            f = f.parents(".subform_js");
            var b = f.find('input[name\x3d"' + d + '"]'), c, b = new String(formPlugin.calculateTotal(b));
            0 < b.length && (c = this.componentSetup.pointSize,
            c = null != c && "" != c && "sel" != c ? this.formatMoney(b, c) : this.formatMoney(b, 0 < b.indexOf(".") ? b.length - (b.indexOf(".") + 1) : -1));
            "\u4eba\u6c11\u5e01" == f.find('span[name\x3d"' + d + '"]').attr("tp") && (f.find('span[name\x3d"' + d + '"]').attr("type", "Money"),
            b = c + " " + ("" == this.numberToChinese(b) ? this.numberToChinese(b) : "(" + this.numberToChinese(b) + ")"));
            f.find('span[name\x3d"' + d + '"]').html(b)
        },
        numberToChinese: function(f) {
            var d = "";
            f = f.replace(/,/g, "");
            0 == f.indexOf("-") && (d += "\u8d1f",
            f = f.substring(1));
            strUnit = "\u4edf\u4f70\u62fe\u4e07\u4edf\u4f70\u62fe\u4ebf\u4edf\u4f70\u62fe\u4e07\u4edf\u4f70\u62fe\u5143\u89d2\u5206";
            f += "00";
            var b = f.indexOf(".");
            0 <= b && (f = f.substring(0, b) + f.substr(b + 1, 2));
            strUnit = strUnit.substr(strUnit.length - f.length);
            for (b = 0; b < f.length; b++)
                d += "\u96f6\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c\u7396".substr(f.substr(b, 1), 1) + strUnit.substr(b, 1);
            return d.replace(/\u96f6\u5206$/, "").replace(/\u96f6\u89d2\u96f6\u5206$/, "").replace(/\u96f6[\u4edf\u4f70\u62fe]/g, "\u96f6").replace(/\u96f6{2,}/g, "\u96f6").replace(/\u96f6([\u4ebf|\u4e07])/g, "$1").replace(/\u96f6+\u5143/, "\u5143").replace(/\u4ebf\u96f6{0,3}\u4e07/, "\u4ebf").replace(/^\u5143/, "\u96f6\u5143").replace(/\u96f6\u89d2$/, "").replace(/\u96f6\u5143$/, "")
        },
        check: function(f) {
            var d = $.trim(f.val())
              , b = f.attr("placeholder")
              , c = {};
            c.element = f;
            d == b && (d = "");
            f = this.componentSetup.minNum;
            b = this.componentSetup.maxNum;
            if ("" != d || "true" != this.componentSetup.required && 1 != this.componentSetup.required) {
                var l = ""
                  , d = d.replace(/,/g, "");
                "mobile" == window.systemInfo_form && (l = this.componentSetup.title);
                "" != f && parseInt(f) > parseInt(d) && "" == b && (c.message = l + "\u8bf7\u8f93\u5165\u5927\u4e8e" + f + "\u7684\u91d1\u989d");
                "" != b && parseInt(b) < parseInt(d) && "" == f && (c.message = l + "\u8bf7\u8f93\u5165\u5c0f\u4e8e" + b + "\u7684\u91d1\u989d");
                "" != b && "" != f && (parseInt(b) < parseInt(d) || parseInt(f) > parseInt(d)) && (c.message = l + "\u8bf7\u8f93\u5165" + f + "-" + b + "\u4e4b\u95f4\u7684\u91d1\u989d")
            } else
                c.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a";
            return c
        },
        getValue: function(f, d) {
            var b = f.val();
            0 < b.length && (b = f.val().replace(/[^\d.-]/g, "") + "");
            var c = f.attr("placeholder")
              , l = {
                formField: {
                    id: this.componentSetup.fieldId
                },
                content: b
            }
              , e = this.componentSetup.isReadOnly;
            "true" == e || 1 == e ? e = this.componentSetup.type : "true" == this.componentSetup.submitSel || 1 == this.componentSetup.submitSel ? (e = f.parent().find("#moneyType").val(),
            "mobile" == window.systemInfo_form && (e = f.parent().parent().find("#moneyType").val())) : e = this.componentSetup.type;
            e = this.transType(e);
            l.type = e;
            return 0 != b.length && b != c && !isNaN(b) || d ? (null != l.type && 0 < l.type.length && (l.statDescribe = this.getTypeName(l.type)),
            l) : null
        },
        setValue: function(f, d) {
            if (null != d) {
                var b = "";
                d.content && (b = d.content + "");
                var c = ""
                  , l = d.type;
                if (0 < b.length) {
                    c = this.componentSetup.isCapital;
                    if (1 == c || "true" == c)
                        c = this.numberToChinese(b),
                        f.find(".j_capital_money").text(c).removeClass("hide-im"),
                        "mobile" == window.systemInfo_form && (f.find(".input-instead").css("display", "inline"),
                        f.find(".money_type_js").css({
                            position: "static",
                            margin: 0
                        }));
                    c = this.componentSetup.pointSize;
                    b = null != c && "" != c && "sel" != c ? this.formatMoney(b, c) : this.formatMoney(b, 0 < b.indexOf(".") ? b.length - (b.indexOf(".") + 1) : -1)
                }
                f.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val(b);
                f.find(".j_readOnly").html(b);
                l ? (b = this.getTypeName(l),
                f.find("#moneyType").find("option").attr("selected", !1),
                f.find("#moneyType").find('option[value\x3d"' + b + '"]').prop("selected", !0)) : b = this.componentSetup.type;
                f.find(".money_type_js").text("(" + b + ")")
            }
        },
        empty: function(f) {
            f.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val("");
            f.find(".j_readOnly").html("");
            f.find(".j_capital_money").html("");
            f.find(".money_type_js").text("")
        },
        formatMoney: function(f, d) {
            var b = this.componentSetup.pointSize;
            if (null == b || "" == b || "sel" == b)
                d = 2 < d && 20 >= d ? d : 2;
            f = parseFloat((f + "").replace(/[^\d\.-]/g, "")).toFixed(d) + "";
            var c = f.split(".")[0].split("").reverse()
              , b = f.split(".")[1];
            t = "";
            for (i = 0; i < c.length; i++)
                t += c[i] + (0 == (i + 1) % 3 && i + 1 != c.length ? "," : "");
            c = t.split("").reverse().join("");
            "-" == c.charAt(0) && "," == c.charAt(1) && (c = c.replace(",", ""));
            return b ? c + "." + b : c
        },
        readOnly: function(f, d) {
            var b = f.find("input[id\x3d'" + this.componentSetup.fieldId + "'][cid\x3d'" + this.cid + "']")
              , b = this.isMobileForm ? b.parent() : b;
            d ? (b.hide(),
            f.find("#moneyType").addClass("hide"),
            b.siblings(".j_readOnly").removeClass("hide"),
            f.find(".money_type_js").removeClass("hide-im hide")) : (b.show(),
            b.siblings(".j_readOnly").addClass("hide"))
        },
        transLangType: function(f) {
            for (var d = [], b = 0; b < f.length; b++)
                d[b] = ("00" + f.charCodeAt(b).toString(16)).slice(-4);
            for (var d = "*u" + d.join("*u"), b = "%u4eba%u6c11%u5e63 %u7f8e%u5143 %u65e5%u5143 %u6b50%u5143 %u6e2f%u5e63 %u53f0%u5e63 %u65b0%u52a0%u5761%u5e63 %u82f1%u938a".split(" "), c = "", l = 0; l < b.length; l++)
                if ((d + "").replace(/\*/g, "%") == b[l] + "") {
                    c = l;
                    break
                }
            l = "%u0052%u004d%u0042 %u0055%u0053%u0020%u0064%u006f%u006c%u006c%u0061%u0072%u0073 %u004a%u0050%u0059 %u0045%u0055%u0052 %u0048%u004b%u0044 %u0054%u0057%u0044 %u0053%u0047%u0044 %u0047%u0042%u0050".split(" ");
            if (!c)
                for (var e = 0; e < l.length; e++)
                    if ((d + "").replace(/\*/g, "%") == l[e] + "") {
                        c = e;
                        break
                    }
            e = "%u4eba%u6c11%u5e01 %u7f8e%u5143 %u65e5%u5143 %u6b27%u5143 %u6e2f%u5e01 %u53f0%u5e01 %u65b0%u52a0%u5761%u5e01 %u82f1%u9551".split(" ");
            if (!c)
                for (var a = 0; a < e.length; a++)
                    if ((d + "").replace(/\*/g, "%") == e[a] + "") {
                        c = a;
                        break
                    }
            "zh_TW" == TEAMS.perLang ? c && (f = unescape(b[c])) : "en_US" == TEAMS.perLang ? c && (f = unescape(l[c])) : c && (f = unescape(e[c]));
            return f
        },
        transType: function(f) {
            for (var d = [], b = 0; b < f.length; b++)
                d[b] = ("00" + f.charCodeAt(b).toString(16)).slice(-4);
            f = "*u" + d.join("*u");
            d = "RMB";
            f = "" + f.replace(/\*/g, "%");
            if ("%u4eba%u6c11%u5e63" == f || "%u0052%u004d%u0042" == f || "%u4eba%u6c11%u5e01" == f)
                d = "RMB";
            else if ("%u7f8e%u5143" == f || "%u0055%u0053%u0020%u0064%u006f%u006c%u006c%u0061%u0072%u0073" == f)
                d = "DOLLAR";
            else if ("%u65e5%u5143" == f || "%u004a%u0050%u0059" == f)
                d = "YEN";
            else if ("%u6b27%u5143" == f || "%u0045%u0055%u0052" == f || "%u6b50%u5143" == f)
                d = "EURO";
            else if ("%u6e2f%u5e01" == f || "%u6e2f%u5e63" == f || "%u0048%u004b%u0044" == f)
                d = "HK";
            else if ("%u53f0%u5e01" == f || "%u0054%u0057%u0044" == f || "%u53f0%u5e63" == f)
                d = "TAIWAN";
            else if ("%u65b0%u52a0%u5761%u5e01" == f || "%u65b0%u52a0%u5761%u5e63" == f || "%u0053%u0047%u0044" == f)
                d = "SINGAPORE";
            else if ("%u82f1%u9551" == f || "%u82f1%u938a" == f || "%u0047%u0042%u0050" == f)
                d = "POUND";
            return d
        },
        getTypeName: function(f) {
            var d = "\u4eba\u6c11\u5e01";
            switch (f) {
            case "RMB":
                d = "\u4eba\u6c11\u5e01";
                break;
            case "DOLLAR":
                d = "\u7f8e\u5143";
                break;
            case "YEN":
                d = "\u65e5\u5143";
                break;
            case "EURO":
                d = "\u6b27\u5143";
                break;
            case "HK":
                d = "\u6e2f\u5e01";
                break;
            case "TAIWAN":
                d = "\u53f0\u5e01";
                break;
            case "SINGAPORE":
                d = "\u65b0\u52a0\u5761\u5e01";
                break;
            case "POUND":
                d = "\u82f1\u9551"
            }
            return d
        }
    });
    u.exports = window.Money
});
define("form/component/mobile", ["form/editablecomponent", "form/tplutil"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil");
    window.Mobile = m.extend({
        initialize: function(g) {
            m.prototype.initialize.call(this, g);
            var f = {
                componentKey: "Mobile",
                title: "\u624b\u673a"
            };
            null != g && (f.title = g.title);
            this.componentSetup = $.extend(this.componentSetup, f);
            this.tpl = h.get("mobile", {
                isMobileForm: this.isMobileForm
            })
        },
        render: function(g) {
            var f = $(this.tpl).siblings("#form-mobile");
            m.prototype.render.call(this, g, f);
            g.html(f.html())
        },
        renderEditPreview: function(g) {
            var f = $(this.tpl).siblings("#form-mobile");
            m.prototype.renderEditPreview.call(this, g, f);
            g.append(f)
        },
        renderEditor: function() {
            var g = $(this.tpl).siblings("#editor-mobile");
            m.prototype.renderEditor.call(this, g);
            $("#editor-component").html(g.html())
        },
        renderPreview: function(g, f, d) {
            var b = $(this.tpl).siblings("#preview-mobile");
            d && b.find(".check_js").prop("readOnly", !0);
            f && b.find(".check_js").val("");
            b.find(".form-control").attr("placeholder", null == this.componentSetup.placeholder || 1 > this.componentSetup.placeholder.length ? "\u8bf7\u586b\u5199" + this.componentSetup.title : this.componentSetup.placeholder);
            m.prototype.renderPreview.call(this, g, f, d, b);
            g.append(b)
        },
        renderStatSearch: function(g) {
            var f = $(this.tpl)
              , d = f.siblings("#statsearch-mobile")
              , b = g.value
              , c = g.term
              , l = g.parentEl;
            if ("mobile" != window.systemInfo_form)
                b && d.find("input").val(b),
                c && d.find("select:first option[value\x3d" + c + "]").attr("selected", "true"),
                l.attr("class", "sch-group j_formFieldSearchGroup"),
                l.find(".j_formField-condition").html(d);
            else {
                var b = g.fieldId
                  , c = g.fieldTitle
                  , e = g.subFormId
                  , d = f.siblings("#statsearch-mobile-mobile")
                  , f = g.filterEl;
                g = g.condition;
                f && (f = f.find(".j_filterList .selectd #comp-val span").text(),
                d.find(".j_compVal").val(f));
                g && (d.find(".j_condition").find('option[value\x3d"' + g + '"]').attr("selected", !0),
                "null" != g && "notnull" != g || d.find(".j_control").hide());
                d.find(".j_inputName").text(c + ":");
                l.find("#component-div").html(d);
                l.find(".j_comp-ok").attr("comKey", "Mobile").attr("fieldId", b).attr("title", c).attr("subFormId", e);
                l.off("change", "#statsearch-mobile-mobile .j_condition").on("change", "#statsearch-mobile-mobile .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? l.find("#statsearch-mobile-mobile .j_control").hide() : l.find("#statsearch-mobile-mobile .j_control").show()
                })
            }
        },
        checkEvents: function(g) {
            var f = this;
            (f.el || $(document)).on("blur", "input[id\x3d'" + (f.componentSetup.fieldId || f.componentSetup.tempId) + "'][cid\x3d'" + f.cid + "']", function() {
                var d = f.check($(this));
                g(d)
            })
        },
        autoSaveEvents: function(g) {
            var f = this;
            (f.el || $(document)).on("change", "input[id\x3d'" + f.componentSetup.fieldId + "'][cid\x3d'" + f.cid + "']", function() {
                f.saveComponentValue($(this), g)
            })
        },
        check: function(g) {
            var f = $.trim(g.val())
              , d = g.attr("placeholder")
              , b = {};
            b.element = g;
            f == d && (f = "");
            "" != f || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (b.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            "" == f || this.mobile(f) || (b.message = this.componentSetup.title + "\u683c\u5f0f\u6709\u8bef\uff0c\u8bf7\u8f93\u5165\u6709\u6548\u7684\u624b\u673a\u53f7\u7801");
            return b
        },
        mobile: function(g) {
            var f = !1;
            /^13\d{9}$/.test(g) && (f = !0);
            /^14\d{9}$/.test(g) && (f = !0);
            /^15\d{9}$/.test(g) && (f = !0);
            /^18\d{9}$/.test(g) && (f = !0);
            /^17\d{9}$/.test(g) && (f = !0);
            /^((\+)?86)?1(3|4|5|7|8)\d{9}$/.test(g) && (f = !0);
            /^19\d{9}$/.test(g) && (f = !0);
            /^16\d{9}$/.test(g) && (f = !0);
            return f ? !0 : !1
        },
        getValue: function(g, f) {
            var d = $.trim(g.val())
              , b = g.attr("placeholder")
              , c = {
                formField: {
                    id: this.componentSetup.fieldId
                },
                content: d
            };
            return "" != d && d != b && this.mobile(d) || f ? c : null
        },
        setValue: function(g, f) {
            if (null != f) {
                var d = f.content;
                g.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val(d);
                g.find(".j_readOnly").html(d)
            }
        },
        empty: function(g) {
            g.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val("");
            g.find(".j_readOnly").html("")
        },
        readOnly: function(g, f) {
            var d = g.find("input[id\x3d'" + this.componentSetup.fieldId + "'][cid\x3d'" + this.cid + "']")
              , d = this.isMobileForm ? d.parent() : d;
            f ? (d.addClass("hide"),
            d.siblings(".j_readOnly").removeClass("hide")) : (d.removeClass("hide"),
            d.siblings(".j_readOnly").addClass("hide"))
        }
    });
    u.exports = window.Mobile
});
define("form/component/mainline", "form/relatecomponent form/tplutil form/component/entityselecter form/component/relevancecontrol form/componentmodel form/abposview".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/entityselecter")
      , f = n("form/component/relevancecontrol")
      , d = n("form/componentmodel")
      , b = n("form/abposview");
    window.Mainline = m.extend({
    });
    u.exports = window.Mainline
});
define("form/component/formcomponent", "form/relatecomponent form/tplutil form/component/formdatalist form/component/entityselecter form/component/typeahead form/component/relevancecontrol form/componentmodel form/abposview".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/formdatalist")
      , f = n("form/component/entityselecter")
      , d = n("form/component/typeahead")
      , b = n("form/component/relevancecontrol")
      , c = n("form/componentmodel")
      , l = n("form/abposview");
    window.FormComponent = m.extend({
    });
    u.exports = window.FormComponent
});
define("form/component/form-select", function(n, y, u) {
    (function(m) {
        function h(b) {
            var c = b.attr("data-target");
            c || (c = (c = b.attr("href")) && /#[A-Za-z]/.test(c) && c.replace(/.*(?=#[^\s]*$)/, ""));
            return (c = c && m(c)) && c.length ? c : b.parent()
        }
        function g(b) {
            b && 3 === b.which || (m(".dropdown-backdrop").remove(),
            m('[data-toggle\x3d"dropdown"]').each(function() {
                var c = m(this)
                  , d = h(c)
                  , e = {
                    relatedTarget: this
                };
                if (d.hasClass("open") && !(b && "click" == b.type && /input|textarea/i.test(b.target.tagName) && m.contains(d[0], b.target)) && (d.trigger(b = m.Event("hide.bs.dropdown", e)),
                !b.isDefaultPrevented())) {
                    c.attr("aria-expanded", "false");
                    if ("mobile" != window.systemInfo_form && 0 < c.nextAll("select").length && 0 < m("body").find("#form-abposselect").length) {
                        d.find("ul").parent().css("display", "");
                        if (null == m("body").find("#form-abposselect").attr("entity") || "select" != m("body").find("#form-abposselect").attr("entity")) {
                            m("body").find("#form-abposselect").remove();
                            0 < m("body").find(".form-preview").find(".field-item_js").length && m("body").find(".form-preview").find(".field-item_js").removeClass("field-item_js");
                            d.removeClass("open").trigger(m.Event("hidden.bs.dropdown", e));
                            c.click();
                            return
                        }
                        m("body").find("#form-abposselect").remove();
                        0 < m("body").find(".form-preview").find(".field-item_js").length && m("body").find(".form-preview").find(".field-item_js").removeClass("field-item_js")
                    }
                    d.removeClass("open").trigger(m.Event("hidden.bs.dropdown", e))
                }
            }))
        }
        var f = function(b) {
            m(b).on("click.bs.dropdown", this.toggle)
        };
        f.VERSION = "3.3.7";
        f.prototype.toggle = function(b) {
            var c = m(this);
            if (!c.is(".disabled, :disabled")) {
                var d = h(c);
                b = d.hasClass("open");
                g();
                if (!b) {
                    if ("mobile" == window.systemInfo_form)
                        m(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(m(this)).on("click", g);
                    var e = {
                        relatedTarget: this
                    };
                    d.trigger(b = m.Event("show.bs.dropdown", e));
                    if (b.isDefaultPrevented())
                        return;
                    c.trigger("focus").attr("aria-expanded", "true");
                    d.toggleClass("open").trigger(m.Event("shown.bs.dropdown", e));
                    if ("mobile" != window.systemInfo_form && 0 < c.nextAll("select").length && d.hasClass("open")) {
                        0 < m("body").find("#form-abposselect").length && (m("body").find("#form-abposselect").remove(),
                        0 < m("body").find(".form-preview").find(".field-item_js").length && m("body").find(".form-preview").find(".field-item_js").removeClass("field-item_js"));
                        b = m(window).height();
                        e = d[0].getBoundingClientRect();
                        if (0 < c.parents("td").length)
                            d.find("ul").parent().css("display", "none"),
                            c.parents("td"),
                            d = c.parents("td").find(".field_js").clone(!0, !0);
                        else
                            return !1;
                        c.closest(".field_js").addClass("field-item_js");
                        m(d).find("ul").parent().show();
                        m(d).find("button").hide();
                        m(d).find(".widget-title").addClass("hide");
                        m(d).find(".field-description").hide();
                        m(d).find(".form-error").hide();
                        m(d).find(".combo-select-div").each(function() {
                            m(this).children().hasClass("open") || m(this).remove()
                        });
                        10 > m(d).find("ul").find("li").length && m(d).find(".bs-searchbox").remove();
                        var a = e.top + e.height
                          , f = e.left
                          , e = e.width;
                        m("body").append('\x3cdiv id\x3d"form-abposselect" class\x3d"form-dropselector-view ' + (0 < c.parents("td").length ? "form-dropselector-indatabox" : "") + '" style\x3d"left:' + f + "px; top:" + a + "px; width:" + e + 'px;" entity \x3d "select"\x3e\x3c/div\x3e');
                        m("#form-abposselect").append(d);
                        0 < m(d).find(".bs-searchbox").find("input").length ? m(m(d).find(".bs-searchbox").find("input")[0]).focus() : 0 < m(d).find("ul").find(".selected").length ? d.find("ul").find(".selected").addClass("action") : m(m(d).find("ul").find("li")[0]).addClass("action");
                        d = m("body").find("#form-abposselect").find(".dropdown-menu.open")[0].getBoundingClientRect();
                        c = d.top;
                        d = d.height;
                        c + d > b && (c = c - (c + d - b) - 3);
                        m("body").find("#form-abposselect").css("top", c + "px")
                    }
                }
                return !1
            }
        }
        ;
        f.prototype.keydown = function(b) {
            if (/(38|40|27|32)/.test(b.which) && !/input|textarea/i.test(b.target.tagName)) {
                var c = m(this);
                b.preventDefault();
                b.stopPropagation();
                if (!c.is(".disabled, :disabled")) {
                    var d = h(c)
                      , e = d.hasClass("open");
                    if (!e && 27 != b.which || e && 27 == b.which)
                        return 27 == b.which && d.find('[data-toggle\x3d"dropdown"]').trigger("focus"),
                        c.trigger("click");
                    c = d.find(".dropdown-menu li:not(.disabled):visible a");
                    c.length && (d = c.index(b.target),
                    38 == b.which && 0 < d && d--,
                    40 == b.which && d < c.length - 1 && d++,
                    ~d || (d = 0),
                    c.eq(d).trigger("focus"))
                }
            }
        }
        ;
        var d = m.fn.dropdown;
        m.fn.dropdown = function(b) {
            return this.each(function() {
                var c = m(this)
                  , d = c.data("bs.dropdown");
                d || c.data("bs.dropdown", d = new f(this));
                "string" == typeof b && d[b].call(c)
            })
        }
        ;
        m.fn.dropdown.Constructor = f;
        m.fn.dropdown.noConflict = function() {
            m.fn.dropdown = d;
            return this
        }
        ;
        m(document).on("click.bs.dropdown.data-api", g).on("click.bs.dropdown.data-api", ".bootstrap-select .dropdown form", function(b) {
            b.stopPropagation()
        }).on("click.bs.dropdown.data-api", '[data-toggle\x3d"dropdown"]', f.prototype.toggle).on("keydown.bs.dropdown.data-api", '[data-toggle\x3d"dropdown"]', f.prototype.keydown).on("keydown.bs.dropdown.data-api", ".bootstrap-select .dropdown-menu", f.prototype.keydown)
    }
    )(jQuery);
    (function(m) {
        function h(e) {
            m.each([{
                re: /[\xC0-\xC6]/g,
                ch: "A"
            }, {
                re: /[\xE0-\xE6]/g,
                ch: "a"
            }, {
                re: /[\xC8-\xCB]/g,
                ch: "E"
            }, {
                re: /[\xE8-\xEB]/g,
                ch: "e"
            }, {
                re: /[\xCC-\xCF]/g,
                ch: "I"
            }, {
                re: /[\xEC-\xEF]/g,
                ch: "i"
            }, {
                re: /[\xD2-\xD6]/g,
                ch: "O"
            }, {
                re: /[\xF2-\xF6]/g,
                ch: "o"
            }, {
                re: /[\xD9-\xDC]/g,
                ch: "U"
            }, {
                re: /[\xF9-\xFC]/g,
                ch: "u"
            }, {
                re: /[\xC7-\xE7]/g,
                ch: "c"
            }, {
                re: /[\xD1]/g,
                ch: "N"
            }, {
                re: /[\xF1]/g,
                ch: "n"
            }], function() {
                e = e.replace(this.re, this.ch)
            });
            return e
        }
        function g(e) {
            var a = {
                "\x26": "\x26amp;",
                "\x3c": "\x26lt;",
                "\x3e": "\x26gt;",
                '"': "\x26quot;",
                "'": "\x26#x27;",
                "`": "\x26#x60;"
            }
              , c = "(?:" + Object.keys(a).join("|") + ")"
              , b = new RegExp(c,"g");
            e = null == e ? "" : "" + e;
            return (new RegExp(c)).test(e) ? e.replace(b, function(e) {
                return a[e]
            }) : e
        }
        String.prototype.includes || function() {
            var e = {}.toString
              , a = function() {
                try {
                    var a = {}
                      , e = Object.defineProperty
                      , c = e(a, a, a) && e
                } catch (b) {}
                return c
            }()
              , c = "".indexOf
              , b = function(a) {
                if (null == this)
                    throw new TypeError;
                var b = String(this);
                if (a && "[object RegExp]" == e.call(a))
                    throw new TypeError;
                var d = b.length
                  , f = String(a)
                  , g = f.length
                  , l = 1 < arguments.length ? arguments[1] : void 0
                  , l = l ? Number(l) : 0;
                l != l && (l = 0);
                var h = Math.min(Math.max(l, 0), d);
                return g + h > d ? !1 : -1 != c.call(b, f, l)
            };
            a ? a(String.prototype, "includes", {
                value: b,
                configurable: !0,
                writable: !0
            }) : String.prototype.includes = b
        }();
        String.prototype.startsWith || function() {
            var e = function() {
                try {
                    var a = {}
                      , e = Object.defineProperty
                      , c = e(a, a, a) && e
                } catch (b) {}
                return c
            }()
              , a = {}.toString
              , c = function(e) {
                if (null == this)
                    throw new TypeError;
                var c = String(this);
                if (e && "[object RegExp]" == a.call(e))
                    throw new TypeError;
                var b = c.length
                  , d = String(e)
                  , f = d.length
                  , k = 1 < arguments.length ? arguments[1] : void 0
                  , k = k ? Number(k) : 0;
                k != k && (k = 0);
                k = Math.min(Math.max(k, 0), b);
                if (f + k > b)
                    return !1;
                for (b = -1; ++b < f; )
                    if (c.charCodeAt(k + b) != d.charCodeAt(b))
                        return !1;
                return !0
            };
            e ? e(String.prototype, "startsWith", {
                value: c,
                configurable: !0,
                writable: !0
            }) : String.prototype.startsWith = c
        }();
        Object.keys || (Object.keys = function(e, a, c) {
            c = [];
            for (a in e)
                c.hasOwnProperty.call(e, a) && c.push(a);
            return c
        }
        );
        var f = !1
          , d = m.valHooks.select.set;
        m.valHooks.select.set = function(e, a) {
            a && !f && m(e).data("selected", !0);
            return d.apply(this, arguments)
        }
        ;
        var b = null;
        m.fn.triggerNative = function(e) {
            var a = this[0], c;
            a.dispatchEvent ? ("function" === typeof Event ? c = new Event(e,{
                bubbles: !0
            }) : (c = document.createEvent("Event"),
            c.initEvent(e, !0, !1)),
            a.dispatchEvent(c)) : a.fireEvent ? (c = document.createEventObject(),
            c.eventType = e,
            a.fireEvent("on" + e, c)) : this.trigger(e)
        }
        ;
        m.expr.pseudos.icontains = function(e, a, c) {
            e = m(e);
            return (e.data("tokens") || e.text()).toString().toUpperCase().includes(c[3].toUpperCase())
        }
        ;
        m.expr.pseudos.ibegins = function(e, a, c) {
            e = m(e);
            return (e.data("tokens") || e.text()).toString().toUpperCase().startsWith(c[3].toUpperCase())
        }
        ;
        m.expr.pseudos.aicontains = function(e, a, c) {
            e = m(e);
            return (e.data("tokens") || e.data("normalizedText") || e.text()).toString().toUpperCase().includes(c[3].toUpperCase())
        }
        ;
        m.expr.pseudos.aibegins = function(e, a, c) {
            e = m(e);
            return (e.data("tokens") || e.data("normalizedText") || e.text()).toString().toUpperCase().startsWith(c[3].toUpperCase())
        }
        ;
        var c = function(e, a, b) {
            f || (m.valHooks.select.set = d,
            f = !0);
            b && (b.stopPropagation(),
            b.preventDefault());
            this.$element = m(e);
            this.$lis = this.$menu = this.$button = this.$newElement = null;
            this.options = a;
            null === this.options.title && (this.options.title = this.$element.attr("title"));
            this.val = c.prototype.val;
            this.render = c.prototype.render;
            this.refresh = c.prototype.refresh;
            this.setStyle = c.prototype.setStyle;
            this.selectAll = c.prototype.selectAll;
            this.deselectAll = c.prototype.deselectAll;
            this.destroy = c.prototype.destroy;
            this.remove = c.prototype.remove;
            this.show = c.prototype.show;
            this.hide = c.prototype.hide;
            this.init()
        };
        c.VERSION = "1.11.0";
        c.DEFAULTS = {
            noneSelectedText: "Nothing selected",
            noneResultsText: "No results matched {0}",
            countSelectedText: function(e, a) {
                return 1 == e ? "{0} item selected" : "{0} items selected"
            },
            maxOptionsText: function(e, a) {
                return [1 == e ? "Limit reached ({n} item max)" : "Limit reached ({n} items max)", 1 == a ? "Group limit reached ({n} item max)" : "Group limit reached ({n} items max)"]
            },
            selectAllText: "Select All",
            deselectAllText: "Deselect All",
            doneButton: !1,
            doneButtonText: "Close",
            multipleSeparator: ", ",
            styleBase: "btn",
            style: "btn-default",
            size: "auto",
            title: null,
            selectedTextFormat: "values",
            width: !1,
            container: !1,
            hideDisabled: !1,
            showSubtext: !1,
            showIcon: !0,
            showContent: !0,
            dropupAuto: !0,
            header: !1,
            liveSearch: !1,
            liveSearchPlaceholder: null,
            liveSearchNormalize: !1,
            liveSearchStyle: "contains",
            actionsBox: !1,
            iconBase: "glyphicon",
            tickIcon: "glyphicon-ok",
            showTick: !1,
            template: {
                caret: '\x3cspan class\x3d"caret"\x3e\x3c/span\x3e'
            },
            maxOptions: !1,
            mobile: "mobile" != window.systemInfo_form ? !1 : !0,
            selectOnTab: !1,
            dropdownAlignRight: !1
        };
        c.prototype = {
            constructor: c,
            init: function() {
                var e = this
                  , a = this.$element.attr("id");
                this.$element.addClass("bs-select-hidden");
                this.liObj = {};
                this.multiple = this.$element.prop("multiple");
                this.autofocus = this.$element.prop("autofocus");
                this.$newElement = this.createView();
                this.$element.after(this.$newElement).appendTo(this.$newElement);
                this.$button = this.$newElement.children("button");
                this.$menu = this.$newElement.children(".dropdown-menu");
                this.$menuInner = this.$menu.children(".inner");
                this.$searchbox = this.$menu.find("input");
                this.$element.removeClass("bs-select-hidden");
                !0 === this.options.dropdownAlignRight && this.$menu.addClass("dropdown-menu-right");
                "undefined" !== typeof a && (this.$button.attr("data-id", a),
                m('label[for\x3d"' + a + '"]').click(function(a) {
                    a.preventDefault();
                    e.$button.focus()
                }));
                this.checkDisabled();
                this.clickListener();
                this.options.liveSearch && this.liveSearchListener();
                this.render();
                this.setStyle();
                this.setWidth();
                this.options.container && this.selectPosition();
                this.$menu.data("this", this);
                this.$newElement.data("this", this);
                this.options.mobile && this.mobile();
                this.$newElement.on({
                    "hide.bs.dropdown": function(a) {
                        e.$menuInner.attr("aria-expanded", !1);
                        e.$element.trigger("hide.bs.select", a)
                    },
                    "hidden.bs.dropdown": function(a) {
                        e.$element.trigger("hidden.bs.select", a)
                    },
                    "show.bs.dropdown": function(a) {
                        e.$menuInner.attr("aria-expanded", !0);
                        e.$element.trigger("show.bs.select", a)
                    },
                    "shown.bs.dropdown": function(a) {
                        e.$element.trigger("shown.bs.select", a)
                    }
                });
                if (e.$element[0].hasAttribute("required"))
                    this.$element.on("invalid", function() {
                        e.$button.addClass("bs-invalid").focus();
                        e.$element.on({
                            "focus.bs.select": function() {
                                e.$button.focus();
                                e.$element.off("focus.bs.select")
                            },
                            "shown.bs.select": function() {
                                e.$element.val(e.$element.val()).off("shown.bs.select")
                            },
                            "rendered.bs.select": function() {
                                this.validity.valid && e.$button.removeClass("bs-invalid");
                                e.$element.off("rendered.bs.select")
                            }
                        })
                    });
                setTimeout(function() {
                    e.$element.trigger("loaded.bs.select")
                })
            },
            createDropdown: function() {
                var e = this.multiple || this.options.showTick ? " show-tick" : ""
                  , a = this.$element.parent().hasClass("input-group") ? " input-group-btn" : ""
                  , c = this.autofocus ? " autofocus" : ""
                  , b = this.options.header ? '\x3cdiv class\x3d"popover-title"\x3e\x3cbutton type\x3d"button" class\x3d"close" aria-hidden\x3d"true"\x3e\x26times;\x3c/button\x3e' + this.options.header + "\x3c/div\x3e" : "";
                this.options.liveSearch = !0;
                var d = this.options.liveSearch ? '\x3cdiv class\x3d"bs-searchbox"\x3e\x3cinput type\x3d"text" class\x3d"form-control" autocomplete\x3d"off"' + (null === this.options.liveSearchPlaceholder ? "" : ' placeholder\x3d"' + g(this.options.liveSearchPlaceholder) + '"') + ' role\x3d"textbox" aria-label\x3d"Search"\x3e\x3c/div\x3e' : "";
                return m('\x3cdiv class\x3d"btn-group bootstrap-select ' + e + (this.options.liveSearch ? " bootstrap-select-more " : "") + a + '"\x3e\x3cbutton type\x3d"button" class\x3d"' + this.options.styleBase + ' btn-sm dropdown-toggle" data-toggle\x3d"dropdown"' + c + ' role\x3d"button"\x3e\x3cspan class\x3d"filter-option pull-left"\x3e\x3c/span\x3e' + ("mobile" == window.systemInfo_form ? "" : "\x26nbsp;") + '\x3cspan class\x3d"bs-caret"\x3e' + this.options.template.caret + '\x3c/span\x3e\x3c/button\x3e\x3cdiv class\x3d"dropdown-menu open" role\x3d"combobox"\x3e' + b + d + (this.multiple && this.options.actionsBox ? '\x3cdiv class\x3d"bs-actionsbox"\x3e\x3cdiv class\x3d"btn-group btn-group-sm btn-block"\x3e\x3cbutton type\x3d"button" class\x3d"actions-btn bs-select-all btn btn-default"\x3e' + this.options.selectAllText + '\x3c/button\x3e\x3cbutton type\x3d"button" class\x3d"actions-btn bs-deselect-all btn btn-default"\x3e' + this.options.deselectAllText + "\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e" : "") + '\x3cul class\x3d"dropdown-menu inner eui-scroll j_no_scrollbar" style\x3d"max-height:240px;overflow-y:auto;" role\x3d"listbox" aria-expanded\x3d"false"\x3e\x3c/ul\x3e' + (this.multiple && this.options.doneButton ? '\x3cdiv class\x3d"bs-donebutton"\x3e\x3cdiv class\x3d"btn-group btn-block"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default"\x3e' + this.options.doneButtonText + "\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e" : "") + "\x3c/div\x3e\x3c/div\x3e")
            },
            createView: function() {
                var e = this.createDropdown()
                  , a = this.createLi();
                e.find("ul")[0].innerHTML = a;
                return e
            },
            reloadLi: function() {
                this.destroyLi();
                var e = this.createLi();
                this.$menuInner[0].innerHTML = e
            },
            destroyLi: function() {
                this.$menu.find("li").remove()
            },
            createLi: function() {
                var e = this
                  , a = []
                  , c = 0
                  , b = document.createElement("option")
                  , d = -1
                  , f = function(a, e, c, b) {
                    return "\x3cli" + ("undefined" !== typeof c & "" !== c ? ' class\x3d"' + c + '"' : "") + ("undefined" !== typeof e & null !== e ? ' data-original-index\x3d"' + e + '"' : "") + ("undefined" !== typeof b & null !== b ? 'data-optgroup\x3d"' + b + '"' : "") + "\x3e" + a + "\x3c/li\x3e"
                }
                  , l = function(a, c, b, d) {
                    return '\x3ca tabindex\x3d"0"' + ("undefined" !== typeof c ? ' class\x3d"' + c + '"' : "") + ("undefined" !== typeof b ? ' style\x3d"' + b + '"' : "") + (e.options.liveSearchNormalize ? ' data-normalized-text\x3d"' + h(g(a)) + '"' : "") + ("undefined" !== typeof d || null !== d ? ' data-tokens\x3d"' + d + '"' : "") + ' role\x3d"option"\x3e' + a + '\x3cspan class\x3d"' + e.options.iconBase + " " + e.options.tickIcon + ' check-mark"\x3e\x3c/span\x3e\x3c/a\x3e'
                };
                if (this.options.title && !this.multiple && (d--,
                !this.$element.find(".bs-title-option").length)) {
                    var w = this.$element[0];
                    b.className = "bs-title-option";
                    b.appendChild(document.createTextNode(this.options.title));
                    b.value = "";
                    w.insertBefore(b, w.firstChild);
                    void 0 === m(w.options[w.selectedIndex]).attr("selected") && void 0 === this.$element.data("selected") && (b.selected = !0)
                }
                this.$element.find("option").each(function(b) {
                    var g = m(this);
                    d++;
                    if (!g.hasClass("bs-title-option")) {
                        var h = this.className || ""
                          , z = this.style.cssText
                          , w = g.data("content") ? g.data("content") : g.html()
                          , n = g.data("tokens") ? g.data("tokens") : null
                          , D = "undefined" !== typeof g.data("subtext") ? '\x3csmall class\x3d"text-muted"\x3e' + g.data("subtext") + "\x3c/small\x3e" : ""
                          , E = "undefined" !== typeof g.data("icon") ? '\x3cspan class\x3d"' + e.options.iconBase + " " + g.data("icon") + '"\x3e\x3c/span\x3e ' : ""
                          , u = g.parent()
                          , y = "OPTGROUP" === u[0].tagName
                          , N = y && u[0].disabled
                          , F = this.disabled || N;
                        "" !== E && F && (E = "\x3cspan\x3e" + E + "\x3c/span\x3e");
                        if (e.options.hideDisabled && (F && !y || N))
                            d--;
                        else {
                            g.data("content") || (w = E + '\x3cspan class\x3d"text" title\x3d"' + w + D + '"\x3e' + w + D + "\x3c/span\x3e");
                            if (y && !0 !== g.data("divider")) {
                                if (e.options.hideDisabled && F && (void 0 === u.data("allOptionsDisabled") && (D = u.children(),
                                u.data("allOptionsDisabled", D.filter(":disabled").length === D.length)),
                                u.data("allOptionsDisabled"))) {
                                    d--;
                                    return
                                }
                                D = " " + u[0].className || "";
                                0 === g.index() && (c += 1,
                                g = u[0].label,
                                E = "undefined" !== typeof u.data("subtext") ? '\x3csmall class\x3d"text-muted"\x3e' + u.data("subtext") + "\x3c/small\x3e" : "",
                                g = (u.data("icon") ? '\x3cspan class\x3d"' + e.options.iconBase + " " + u.data("icon") + '"\x3e\x3c/span\x3e ' : "") + '\x3cspan class\x3d"text" title\x3d"' + g + E + '"\x3e' + g + E + "\x3c/span\x3e",
                                0 !== b && 0 < a.length && (d++,
                                a.push(f("", null, "divider", c + "div"))),
                                d++,
                                a.push(f(g, null, "dropdown-header" + D, c)));
                                if (e.options.hideDisabled && F) {
                                    d--;
                                    return
                                }
                                a.push(f(l(w, "opt " + h + D, z, n), b, "", c))
                            } else if (!0 === g.data("divider"))
                                a.push(f("", b, "divider"));
                            else if (!0 === g.data("hidden"))
                                a.push(f(l(w, h, z, n), b, "hidden is-hidden"));
                            else {
                                u = this.previousElementSibling && "OPTGROUP" === this.previousElementSibling.tagName;
                                if (!u && e.options.hideDisabled)
                                    for (F = m(this).prevAll(),
                                    g = 0; g < F.length; g++)
                                        if ("OPTGROUP" === F[g].tagName) {
                                            for (E = D = 0; E < g; E++)
                                                y = F[E],
                                                (y.disabled || !0 === m(y).data("hidden")) && D++;
                                            D === g && (u = !0);
                                            break
                                        }
                                u && (d++,
                                a.push(f("", null, "divider", c + "div")));
                                a.push(f(l(w, h, z, n), b))
                            }
                            e.liObj[b] = d
                        }
                    }
                });
                this.multiple || 0 !== this.$element.find("option:selected").length || this.options.title || this.$element.find("option").eq(0).prop("selected", !0).attr("selected", "selected");
                return a.join("")
            },
            findLis: function() {
                null == this.$lis && (this.$lis = this.$menu.find("li"));
                return this.$lis
            },
            render: function(e) {
                var a = this, c;
                !1 !== e && this.$element.find("option").each(function(e) {
                    var c = a.findLis().eq(a.liObj[e]);
                    a.setDisabled(e, this.disabled || "OPTGROUP" === this.parentNode.tagName && this.parentNode.disabled, c);
                    a.setSelected(e, this.selected, c)
                });
                this.togglePlaceholder();
                this.tabIndex();
                e = this.$element.find("option").map(function() {
                    if (this.selected && (!a.options.hideDisabled || !(this.disabled || "OPTGROUP" === this.parentNode.tagName && this.parentNode.disabled))) {
                        var e = m(this), c = e.data("icon") && a.options.showIcon ? '\x3ci class\x3d"' + a.options.iconBase + " " + e.data("icon") + '"\x3e\x3c/i\x3e ' : "", b;
                        b = a.options.showSubtext && e.data("subtext") && !a.multiple ? ' \x3csmall class\x3d"text-muted"\x3e' + e.data("subtext") + "\x3c/small\x3e" : "";
                        return "undefined" !== typeof e.attr("title") ? e.attr("title") : e.data("content") && a.options.showContent ? e.data("content") : c + e.html() + b
                    }
                }).toArray();
                c = this.multiple ? e.join(this.options.multipleSeparator) : e[0];
                if (this.multiple && -1 < this.options.selectedTextFormat.indexOf("count")) {
                    var b = this.options.selectedTextFormat.split("\x3e");
                    if (1 < b.length && e.length > b[1] || 1 == b.length && 2 <= e.length)
                        c = this.options.hideDisabled ? ", [disabled]" : "",
                        c = this.$element.find("option").not('[data-divider\x3d"true"], [data-hidden\x3d"true"]' + c).length,
                        c = ("function" === typeof this.options.countSelectedText ? this.options.countSelectedText(e.length, c) : this.options.countSelectedText).replace("{0}", e.length.toString()).replace("{1}", c.toString())
                }
                void 0 == this.options.title && (this.options.title = this.$element.attr("title"));
                "static" == this.options.selectedTextFormat && (c = this.options.title);
                c || (c = "undefined" !== typeof this.options.title ? this.options.title : this.options.noneSelectedText);
                this.$button.attr("title", m.trim(c.replace(/<[^>]*>?/g, "")));
                this.$button.children(".filter-option").html(c);
                this.$element.trigger("rendered.bs.select")
            },
            setStyle: function(e, a) {
                this.$element.attr("class") && this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|choicelist_js|check_js|combo_select_js|mobile-device|bs-select-hidden|validate\[.*\]/gi, ""));
                var c = e ? e : this.options.style;
                "add" == a ? this.$button.addClass(c) : "remove" == a ? this.$button.removeClass(c) : (this.$button.removeClass(this.options.style),
                this.$button.addClass(c))
            },
            liHeight: function(e) {
                if (e || !1 !== this.options.size && !this.sizeInfo) {
                    e = document.createElement("div");
                    var a = document.createElement("div")
                      , c = document.createElement("ul")
                      , b = document.createElement("li")
                      , d = document.createElement("li")
                      , f = document.createElement("a")
                      , g = document.createElement("span")
                      , l = this.options.header && 0 < this.$menu.find(".popover-title").length ? this.$menu.find(".popover-title")[0].cloneNode(!0) : null
                      , h = this.options.liveSearch ? document.createElement("div") : null
                      , s = this.options.actionsBox && this.multiple && 0 < this.$menu.find(".bs-actionsbox").length ? this.$menu.find(".bs-actionsbox")[0].cloneNode(!0) : null
                      , n = this.options.doneButton && this.multiple && 0 < this.$menu.find(".bs-donebutton").length ? this.$menu.find(".bs-donebutton")[0].cloneNode(!0) : null;
                    g.className = "text";
                    e.className = this.$menu[0].parentNode.className + " open";
                    a.className = "dropdown-menu open";
                    c.className = "dropdown-menu inner";
                    b.className = "divider";
                    g.appendChild(document.createTextNode("Inner text"));
                    f.appendChild(g);
                    d.appendChild(f);
                    c.appendChild(d);
                    c.appendChild(b);
                    l && a.appendChild(l);
                    h && (d = document.createElement("span"),
                    h.className = "bs-searchbox",
                    d.className = "form-control",
                    h.appendChild(d),
                    a.appendChild(h));
                    s && a.appendChild(s);
                    a.appendChild(c);
                    n && a.appendChild(n);
                    e.appendChild(a);
                    document.body.appendChild(e);
                    c = f.offsetHeight;
                    l = l ? l.offsetHeight : 0;
                    h = h ? h.offsetHeight : 0;
                    s = s ? s.offsetHeight : 0;
                    n = n ? n.offsetHeight : 0;
                    b = m(b).outerHeight(!0);
                    d = (f = "function" === typeof getComputedStyle ? getComputedStyle(a) : !1) ? null : m(a);
                    a = {
                        vert: parseInt(f ? f.paddingTop : d.css("paddingTop")) + parseInt(f ? f.paddingBottom : d.css("paddingBottom")) + parseInt(f ? f.borderTopWidth : d.css("borderTopWidth")) + parseInt(f ? f.borderBottomWidth : d.css("borderBottomWidth")),
                        horiz: parseInt(f ? f.paddingLeft : d.css("paddingLeft")) + parseInt(f ? f.paddingRight : d.css("paddingRight")) + parseInt(f ? f.borderLeftWidth : d.css("borderLeftWidth")) + parseInt(f ? f.borderRightWidth : d.css("borderRightWidth"))
                    };
                    f = {
                        vert: a.vert + parseInt(f ? f.marginTop : d.css("marginTop")) + parseInt(f ? f.marginBottom : d.css("marginBottom")) + 2,
                        horiz: a.horiz + parseInt(f ? f.marginLeft : d.css("marginLeft")) + parseInt(f ? f.marginRight : d.css("marginRight")) + 2
                    };
                    document.body.removeChild(e);
                    this.sizeInfo = {
                        liHeight: c,
                        headerHeight: l,
                        searchHeight: h,
                        actionsHeight: s,
                        doneButtonHeight: n,
                        dividerHeight: b,
                        menuPadding: a,
                        menuExtras: f
                    }
                }
            },
            setSize: function() {
                this.findLis();
                this.liHeight();
                this.options.header && this.$menu.css("padding-top", 0);
                if (!1 !== this.options.size) {
                    var e = this, a = this.$menu, c = this.$menuInner, b = m(window), d = this.$newElement[0].offsetHeight, f = this.$newElement[0].offsetWidth, g = this.sizeInfo.liHeight, l = this.sizeInfo.headerHeight, h = this.sizeInfo.searchHeight, s = this.sizeInfo.actionsHeight, n = this.sizeInfo.doneButtonHeight, x = this.sizeInfo.dividerHeight, C = this.sizeInfo.menuPadding, B = this.sizeInfo.menuExtras, D = this.options.hideDisabled ? ".disabled" : "", u, y, M, N, F, H, I, J, K = function() {
                        var a = e.$newElement.offset(), c = m(e.options.container), g;
                        e.options.container && !c.is("body") ? (g = c.offset(),
                        g.top += parseInt(c.css("borderTopWidth")),
                        g.left += parseInt(c.css("borderLeftWidth"))) : g = {
                            top: 0,
                            left: 0
                        };
                        F = a.top - g.top - b.scrollTop();
                        H = b.height() - F - d - g.top;
                        I = a.left - g.left - b.scrollLeft();
                        J = b.width() - I - f - g.left
                    };
                    K();
                    "auto" === this.options.size ? (x = function() {
                        var b;
                        b = function(a, e) {
                            return function(c) {
                                return e ? c.classList ? c.classList.contains(a) : m(c).hasClass(a) : !(c.classList ? c.classList.contains(a) : m(c).hasClass(a))
                            }
                        }
                        ;
                        var d = e.$menuInner[0].getElementsByTagName("li")
                          , d = Array.prototype.filter ? Array.prototype.filter.call(d, b("hidden", !1)) : e.$lis.not(".hidden");
                        b = Array.prototype.filter ? Array.prototype.filter.call(d, b("dropdown-header", !0)) : d.filter(".dropdown-header");
                        K();
                        u = H - B.vert;
                        y = J - B.horiz;
                        e.options.container ? (a.data("height") || a.data("height", a.height()),
                        M = a.data("height"),
                        a.data("width") || a.data("width", a.width()),
                        N = a.data("width")) : (M = a.height(),
                        N = a.width());
                        e.options.dropupAuto && e.$newElement.toggleClass("dropup", F > H && u - B.vert < M);
                        e.$newElement.hasClass("dropup") && (u = F - B.vert);
                        "auto" === e.options.dropdownAlignRight && a.toggleClass("dropdown-menu-right", I > J && y - B.horiz < N - f);
                        b = 3 < d.length + b.length ? 3 * g + B.vert - 2 : 0;
                        a.css({
                            "max-height": u + "px",
                            overflow: "hidden",
                            "min-height": b + l + h + s + n + "px"
                        });
                        c.css({
                            "max-height": u - l - h - s - n - C.vert + "px",
                            "overflow-y": "auto",
                            "min-height": Math.max(b - C.vert, 0) + "px"
                        })
                    }
                    ,
                    x(),
                    this.$searchbox.off("input.getSize propertychange.getSize").on("input.getSize propertychange.getSize", x),
                    b.off("resize.getSize scroll.getSize").on("resize.getSize scroll.getSize", x)) : this.options.size && "auto" != this.options.size && this.$lis.not(D).length > this.options.size && (D = this.$lis.not(".divider").not(D).children().slice(0, this.options.size).last().parent().index(),
                    D = this.$lis.slice(0, D + 1).filter(".divider").length,
                    u = g * this.options.size + D * x + C.vert,
                    e.options.container ? (a.data("height") || a.data("height", a.height()),
                    M = a.data("height")) : M = a.height(),
                    e.options.dropupAuto && this.$newElement.toggleClass("dropup", F > H && u - B.vert < M),
                    a.css({
                        "max-height": u + l + h + s + n + "px",
                        overflow: "hidden",
                        "min-height": ""
                    }),
                    c.css({
                        "max-height": u - C.vert + "px",
                        "overflow-y": "auto",
                        "min-height": ""
                    }))
                }
            },
            setWidth: function() {
                if ("auto" === this.options.width) {
                    this.$menu.css("min-width", "0");
                    var e = this.$menu.parent().clone().appendTo("body")
                      , a = this.options.container ? this.$newElement.clone().appendTo("body") : e
                      , c = e.children(".dropdown-menu").outerWidth() - 40
                      , b = a.css("width", "auto").children("button").outerWidth() - 40;
                    e.remove();
                    a.remove();
                    this.$newElement.css("width", Math.max(c, b) + "px")
                } else
                    "fit" === this.options.width ? (this.$menu.css("min-width", ""),
                    this.$newElement.css("width", "").addClass("fit-width")) : this.options.width ? (this.$menu.css("min-width", ""),
                    this.$newElement.css("width", this.options.width)) : (this.$menu.css("min-width", ""),
                    this.$newElement.css("width", ""));
                this.$newElement.hasClass("fit-width") && "fit" !== this.options.width && this.$newElement.removeClass("fit-width")
            },
            selectPosition: function() {
                this.$bsContainer = m('\x3cdiv class\x3d"bs-container" /\x3e');
                var e = this, a = m(this.options.container), c, b, d, f = function(f) {
                    e.$bsContainer.addClass(f.attr("class").replace(/form-control|fit-width/gi, "")).toggleClass("dropup", f.hasClass("dropup"));
                    c = f.offset();
                    a.is("body") ? b = {
                        top: 0,
                        left: 0
                    } : (b = a.offset(),
                    b.top += parseInt(a.css("borderTopWidth")) - a.scrollTop(),
                    b.left += parseInt(a.css("borderLeftWidth")) - a.scrollLeft());
                    d = f.hasClass("dropup") ? 0 : f[0].offsetHeight;
                    e.$bsContainer.css({
                        top: c.top - b.top + d,
                        left: c.left - b.left,
                        width: f[0].offsetWidth
                    })
                };
                this.$button.on("click", function() {
                    var a = m(this);
                    e.isDisabled() || (f(e.$newElement),
                    e.$bsContainer.appendTo(e.options.container).toggleClass("open", !a.hasClass("open")).append(e.$menu))
                });
                m(window).on("resize scroll", function() {
                    f(e.$newElement)
                });
                this.$element.on("hide.bs.select", function() {
                    e.$menu.data("height", e.$menu.height());
                    e.$bsContainer.detach()
                })
            },
            setSelected: function(e, a, c) {
                c || (this.togglePlaceholder(),
                c = this.findLis().eq(this.liObj[e]));
                c.toggleClass("selected", a).find("a").attr("aria-selected", a)
            },
            setDisabled: function(e, a, c) {
                c || (c = this.findLis().eq(this.liObj[e]));
                a ? c.addClass("disabled").children("a").attr("href", "#").attr("tabindex", -1).attr("aria-disabled", !0) : c.removeClass("disabled").children("a").removeAttr("href").attr("tabindex", 0).attr("aria-disabled", !1)
            },
            isDisabled: function() {
                return this.$element[0].disabled
            },
            checkDisabled: function() {
                var e = this;
                this.isDisabled() ? (this.$newElement.addClass("disabled"),
                this.$button.addClass("disabled").attr("tabindex", -1)) : (this.$button.hasClass("disabled") && (this.$newElement.removeClass("disabled"),
                this.$button.removeClass("disabled")),
                -1 != this.$button.attr("tabindex") || this.$element.data("tabindex") || this.$button.removeAttr("tabindex"));
                this.$button.click(function() {
                    return !e.isDisabled()
                })
            },
            togglePlaceholder: function() {
                var e = this.$element.val();
                this.$button.toggleClass("bs-placeholder", null === e || "" === e)
            },
            tabIndex: function() {
                this.$element.data("tabindex") !== this.$element.attr("tabindex") && -98 !== this.$element.attr("tabindex") && "-98" !== this.$element.attr("tabindex") && (this.$element.data("tabindex", this.$element.attr("tabindex")),
                this.$button.attr("tabindex", this.$element.data("tabindex")));
                this.$element.attr("tabindex", -98)
            },
            clickListener: function() {
                var e = this
                  , a = m(document);
                this.$newElement.on("touchstart.dropdown", ".dropdown-menu", function(a) {
                    a.stopPropagation()
                });
                a.data("spaceSelect", !1);
                this.$button.on("keyup", function(e) {
                    /(32)/.test(e.keyCode.toString(10)) && a.data("spaceSelect") && (e.preventDefault(),
                    a.data("spaceSelect", !1))
                });
                this.$button.on("click", function() {
                    e.setSize()
                });
                this.$element.on("shown.bs.select", function() {
                    if (!e.options.liveSearch && !e.multiple)
                        e.$menuInner.find(".selected a").focus();
                    else if (!e.multiple) {
                        var a = e.liObj[e.$element[0].selectedIndex];
                        "number" === typeof a && !1 !== e.options.size && (a = e.$lis.eq(a)[0].offsetTop - e.$menuInner[0].offsetTop,
                        a = a - e.$menuInner[0].offsetHeight / 2 + e.sizeInfo.liHeight / 2,
                        e.$menuInner[0].scrollTop = a)
                    }
                });
                this.$menuInner.on("click", "li a", function(a) {
                    var c = m(this)
                      , d = c.parent().data("originalIndex")
                      , f = e.$element.val()
                      , g = e.$element.prop("selectedIndex")
                      , l = !0;
                    e.multiple && 1 !== e.options.maxOptions && a.stopPropagation();
                    a.preventDefault();
                    if (!e.isDisabled() && !c.parent().hasClass("disabled")) {
                        var h = e.$element.find("option");
                        a = h.eq(d);
                        var s = a.prop("selected")
                          , n = a.parent("optgroup")
                          , x = e.options.maxOptions
                          , C = n.data("maxOptions") || !1;
                        if (e.multiple) {
                            if (a.prop("selected", !s),
                            e.setSelected(d, !s),
                            c.blur(),
                            !1 !== x || !1 !== C) {
                                var B = x < h.filter(":selected").length
                                  , D = C < n.find("option:selected").length;
                                if (x && B || C && D)
                                    if (x && 1 == x)
                                        h.prop("selected", !1),
                                        a.prop("selected", !0),
                                        e.$menuInner.find(".selected").removeClass("selected"),
                                        e.setSelected(d, !0);
                                    else if (C && 1 == C)
                                        n.find("option:selected").prop("selected", !1),
                                        a.prop("selected", !0),
                                        x = c.parent().data("optgroup"),
                                        e.$menuInner.find('[data-optgroup\x3d"' + x + '"]').removeClass("selected"),
                                        e.setSelected(d, !0);
                                    else {
                                        var c = "string" === typeof e.options.maxOptionsText ? [e.options.maxOptionsText, e.options.maxOptionsText] : e.options.maxOptionsText
                                          , c = "function" === typeof c ? c(x, C) : c
                                          , h = c[0].replace("{n}", x)
                                          , n = c[1].replace("{n}", C)
                                          , u = m('\x3cdiv class\x3d"notify"\x3e\x3c/div\x3e');
                                        c[2] && (h = h.replace("{var}", c[2][1 < x ? 0 : 1]),
                                        n = n.replace("{var}", c[2][1 < C ? 0 : 1]));
                                        a.prop("selected", !1);
                                        e.$menu.append(u);
                                        x && B && (u.append(m("\x3cdiv\x3e" + h + "\x3c/div\x3e")),
                                        l = !1,
                                        e.$element.trigger("maxReached.bs.select"));
                                        C && D && (u.append(m("\x3cdiv\x3e" + n + "\x3c/div\x3e")),
                                        l = !1,
                                        e.$element.trigger("maxReachedGrp.bs.select"));
                                        setTimeout(function() {
                                            e.setSelected(d, !1)
                                        }, 10);
                                        u.delay(750).fadeOut(300, function() {
                                            m(this).remove()
                                        })
                                    }
                            }
                        } else
                            h.prop("selected", !1),
                            a.prop("selected", !0),
                            e.$menuInner.find(".selected").removeClass("selected").find("a").attr("aria-selected", !1),
                            e.setSelected(d, !0);
                        !e.multiple || e.multiple && 1 === e.options.maxOptions ? e.$button.focus() : e.options.liveSearch && e.$searchbox.focus();
                        l && (f != e.$element.val() && e.multiple || g != e.$element.prop("selectedIndex") && !e.multiple) && (b = [d, a.prop("selected"), s],
                        e.$element.triggerNative("change"))
                    }
                });
                this.$menu.on("click", "li.disabled a, .popover-title, .popover-title :not(.close)", function(a) {
                    a.currentTarget == this && (a.preventDefault(),
                    a.stopPropagation(),
                    e.options.liveSearch && !m(a.target).hasClass("close") ? e.$searchbox.focus() : e.$button.focus())
                });
                this.$menuInner.on("click", ".divider, .dropdown-header", function(a) {
                    a.preventDefault();
                    a.stopPropagation();
                    e.options.liveSearch ? e.$searchbox.focus() : e.$button.focus()
                });
                this.$menu.on("click", ".popover-title .close", function() {
                    e.$button.click()
                });
                this.$searchbox.on("click", function(a) {
                    a.stopPropagation()
                });
                this.$menu.on("click", ".actions-btn", function(a) {
                    e.options.liveSearch ? e.$searchbox.focus() : e.$button.focus();
                    a.preventDefault();
                    a.stopPropagation();
                    m(this).hasClass("bs-select-all") ? e.selectAll() : e.deselectAll()
                });
                this.$element.change(function() {
                    e.render(!1);
                    e.$element.trigger("changed.bs.select", b);
                    b = null
                })
            },
            liveSearchListener: function() {
                var e = this
                  , a = m('\x3cli class\x3d"no-results"\x3e\x3c/li\x3e');
                this.$button.on("click.dropdown.data-api touchstart.dropdown.data-api", function() {
                    e.$menuInner.find(".active").removeClass("active");
                    e.$searchbox.val() && (e.$searchbox.val(""),
                    e.$lis.not(".is-hidden").removeClass("hidden"),
                    a.parent().length && a.remove());
                    e.multiple || e.$menuInner.find(".selected").addClass("active");
                    setTimeout(function() {
                        e.$searchbox.focus()
                    }, 10)
                });
                this.$searchbox.on("click.dropdown.data-api focus.dropdown.data-api touchend.dropdown.data-api", function(a) {
                    a.stopPropagation()
                });
                this.$searchbox.on("input propertychange", function() {
                    var c = e.$searchbox
                      , b = e.$menuInner
                      , d = e.$lis;
                    0 < m("body").find("#form-abposselect").length && "select" == m("body").find("#form-abposselect").attr("entity") && (e.$searchbox = m("body").find("#form-abposselect").find(".widget-content").find(".bs-searchbox").find("input"),
                    e.$menuInner = m("body").find("#form-abposselect").find(".widget-content").find("ul"),
                    e.$lis = m("body").find("#form-abposselect").find(".widget-content").find("ul").find("li"));
                    if (e.$searchbox.val()) {
                        var f = e.$lis.not(".is-hidden").removeClass("hidden").children("a");
                        0 < m("body").find("#form-abposselect").length && "select" == m("body").find("#form-abposselect").attr("entity") && (f = m("body").find("#form-abposselect").find(".widget-content").find("ul").find("li").not(".is-hidden").removeClass("hidden").children("a"));
                        f = e.options.liveSearchNormalize ? f.not(":a" + e._searchStyle() + '("' + h(e.$searchbox.val()) + '")') : f.not(":" + e._searchStyle() + '("' + e.$searchbox.val() + '")');
                        f.parent().addClass("hidden");
                        e.$lis.filter(".dropdown-header").each(function() {
                            var a = m(this)
                              , c = a.data("optgroup");
                            0 === e.$lis.filter("[data-optgroup\x3d" + c + "]").not(a).not(".hidden").length && (a.addClass("hidden"),
                            e.$lis.filter("[data-optgroup\x3d" + c + "div]").addClass("hidden"))
                        });
                        var l = e.$lis.not(".hidden");
                        l.each(function(a) {
                            var e = m(this);
                            e.hasClass("divider") && (e.index() === l.first().index() || e.index() === l.last().index() || l.eq(a + 1).hasClass("divider")) && e.addClass("hidden")
                        });
                        e.$lis.not(".hidden, .no-results").length ? a.parent().length && a.remove() : (a.parent().length && a.remove(),
                        a.html(e.options.noneResultsText.replace("{0}", '"' + g(e.$searchbox.val()) + '"')).show(),
                        e.$menuInner.append(a))
                    } else
                        e.$lis.not(".is-hidden").removeClass("hidden"),
                        a.parent().length && a.remove();
                    e.$lis.filter(".active").removeClass("active");
                    e.$searchbox.val() && e.$lis.not(".hidden, .divider, .dropdown-header").eq(0).addClass("active").children("a").focus();
                    m(this).focus();
                    e.$searchbox = c;
                    e.$menuInner = b;
                    e.$lis = d
                })
            },
            _searchStyle: function() {
                return {
                    begins: "ibegins",
                    startsWith: "ibegins"
                }[this.options.liveSearchStyle] || "icontains"
            },
            val: function(e) {
                return "undefined" !== typeof e ? (this.$element.val(e),
                this.render(),
                this.$element) : this.$element.val()
            },
            changeAll: function(e) {
                if (this.multiple) {
                    "undefined" === typeof e && (e = !0);
                    this.findLis();
                    var a = this.$element.find("option")
                      , c = this.$lis.not(".divider, .dropdown-header, .disabled, .hidden")
                      , b = c.length
                      , d = [];
                    if (e) {
                        if (c.filter(".selected").length === c.length)
                            return
                    } else if (0 === c.filter(".selected").length)
                        return;
                    c.toggleClass("selected", e);
                    for (var f = 0; f < b; f++) {
                        var g = c[f].getAttribute("data-original-index");
                        d[d.length] = a.eq(g)[0]
                    }
                    m(d).prop("selected", e);
                    this.render(!1);
                    this.togglePlaceholder();
                    this.$element.triggerNative("change")
                }
            },
            selectAll: function() {
                return this.changeAll(!0)
            },
            deselectAll: function() {
                return this.changeAll(!1)
            },
            toggle: function(e) {
                (e = e || window.event) && e.stopPropagation();
                this.$button.trigger("click")
            },
            keydown: function(e) {
                var a = m(this), c = a.is("input") ? a.parent().parent() : a.parent(), b, d = c.data("this"), f, g, l, v, s, n, x, C = {
                    32: " ",
                    48: "0",
                    49: "1",
                    50: "2",
                    51: "3",
                    52: "4",
                    53: "5",
                    54: "6",
                    55: "7",
                    56: "8",
                    57: "9",
                    59: ";",
                    65: "a",
                    66: "b",
                    67: "c",
                    68: "d",
                    69: "e",
                    70: "f",
                    71: "g",
                    72: "h",
                    73: "i",
                    74: "j",
                    75: "k",
                    76: "l",
                    77: "m",
                    78: "n",
                    79: "o",
                    80: "p",
                    81: "q",
                    82: "r",
                    83: "s",
                    84: "t",
                    85: "u",
                    86: "v",
                    87: "w",
                    88: "x",
                    89: "y",
                    90: "z",
                    96: "0",
                    97: "1",
                    98: "2",
                    99: "3",
                    100: "4",
                    101: "5",
                    102: "6",
                    103: "7",
                    104: "8",
                    105: "9"
                };
                d.options.liveSearch && (c = a.parent().parent());
                d.options.container && (c = d.$menu);
                b = m('[role\x3d"listbox"] li', c);
                x = d.$newElement.hasClass("open");
                if (!x && (48 <= e.keyCode && 57 >= e.keyCode || 96 <= e.keyCode && 105 >= e.keyCode || 65 <= e.keyCode && 90 >= e.keyCode))
                    d.options.container ? d.$button.trigger("click") : (d.setSize(),
                    d.$menu.parent().addClass("open"),
                    x = !0),
                    d.$searchbox.focus();
                else if (d.options.liveSearch && (/(^9$|27)/.test(e.keyCode.toString(10)) && x && 0 === d.$menu.find(".active").length && (e.preventDefault(),
                d.$button.click().focus()),
                b = m('[role\x3d"listbox"] li:not(.disabled, .hidden, .dropdown-header, .divider)', c),
                a.val() || /(38|40)/.test(e.keyCode.toString(10)) || 0 !== b.filter(".active").length || (b = d.$menuInner.find("li"),
                b = d.options.liveSearchNormalize ? b.filter(":a" + d._searchStyle() + "(" + h(C[e.keyCode]) + ")") : b.filter(":" + d._searchStyle() + "(" + C[e.keyCode] + ")"))),
                b.length) {
                    if (/(38|40)/.test(e.keyCode.toString(10)))
                        c = b.index(b.find("a").filter(":focus").parent()),
                        g = b.filter(":not(.disabled, .hidden, .dropdown-header, .divider)").first().index(),
                        l = b.filter(":not(.disabled, .hidden, .dropdown-header, .divider)").last().index(),
                        f = b.eq(c).nextAll(":not(.disabled, .hidden, .dropdown-header, .divider)").eq(0).index(),
                        v = b.eq(c).prevAll(":not(.disabled, .hidden, .dropdown-header, .divider)").eq(0).index(),
                        s = b.eq(f).prevAll(":not(.disabled, .hidden, .dropdown-header, .divider)").eq(0).index(),
                        d.options.liveSearch && (b.each(function(a) {
                            m(this).hasClass("disabled") || m(this).data("index", a)
                        }),
                        c = b.index(b.filter(".active")),
                        g = b.first().data("index"),
                        l = b.last().data("index"),
                        f = b.eq(c).nextAll().eq(0).data("index"),
                        v = b.eq(c).prevAll().eq(0).data("index"),
                        s = b.eq(f).prevAll().eq(0).data("index")),
                        n = a.data("prevIndex"),
                        38 == e.keyCode ? (d.options.liveSearch && c--,
                        c != s && c > v && (c = v),
                        c < g && (c = g),
                        c == n && (c = l)) : 40 == e.keyCode && (d.options.liveSearch && c++,
                        -1 == c && (c = 0),
                        c != s && c < f && (c = f),
                        c > l && (c = l),
                        c == n && (c = g)),
                        a.data("prevIndex", c),
                        d.options.liveSearch ? (e.preventDefault(),
                        a.hasClass("dropdown-toggle") || (b.removeClass("active").eq(c).addClass("active").children("a").focus(),
                        a.focus())) : b.eq(c).children("a").focus();
                    else if (!a.is("input")) {
                        var B = [];
                        b.each(function() {
                            m(this).hasClass("disabled") || m.trim(m(this).children("a").text().toLowerCase()).substring(0, 1) == C[e.keyCode] && B.push(m(this).index())
                        });
                        c = m(document).data("keycount");
                        c++;
                        m(document).data("keycount", c);
                        m.trim(m(":focus").text().toLowerCase()).substring(0, 1) != C[e.keyCode] ? (c = 1,
                        m(document).data("keycount", c)) : c >= B.length && (m(document).data("keycount", 0),
                        c > B.length && (c = 1));
                        b.eq(B[c - 1]).children("a").focus()
                    }
                    (/(13|32)/.test(e.keyCode.toString(10)) || /(^9$)/.test(e.keyCode.toString(10)) && d.options.selectOnTab) && x && (/(32)/.test(e.keyCode.toString(10)) || e.preventDefault(),
                    d.options.liveSearch ? /(32)/.test(e.keyCode.toString(10)) || (0 < m("body").find("#form-abposselect").length && "select" == m("body").find("#form-abposselect").attr("entity") ? m("body").find("#form-abposselect").find(".widget-content").find("ul").find(".active").not(".hidden").find("a").click() : d.$menuInner.find(".active a").click(),
                    a.focus()) : (a = m(":focus"),
                    a.click(),
                    a.focus(),
                    e.preventDefault(),
                    m(document).data("spaceSelect", !0)),
                    m(document).data("keycount", 0));
                    if (/(^9$|27)/.test(e.keyCode.toString(10)) && x && (d.multiple || d.options.liveSearch) || /(27)/.test(e.keyCode.toString(10)) && !x)
                        d.$menu.parent().removeClass("open"),
                        d.options.container && d.$newElement.removeClass("open"),
                        d.$button.focus()
                }
            },
            mobile: function() {
                this.$element.addClass("mobile-device")
            },
            refresh: function() {
                this.$lis = null;
                this.liObj = {};
                this.reloadLi();
                this.render();
                this.checkDisabled();
                this.liHeight(!0);
                this.setStyle();
                this.setWidth();
                this.$lis && this.$searchbox.trigger("propertychange");
                this.$element.trigger("refreshed.bs.select")
            },
            hide: function() {
                this.$newElement.hide()
            },
            show: function() {
                this.$newElement.show()
            },
            remove: function() {
                this.$newElement.remove();
                this.$element.remove()
            },
            destroy: function() {
                this.$newElement.before(this.$element).remove();
                this.$bsContainer ? this.$bsContainer.remove() : this.$menu.remove();
                this.$element.off(".bs.select").removeData("selectpicker").removeClass("bs-select-hidden selectpicker")
            }
        };
        var l = m.fn.selectpicker;
        m.fn.selectpicker = function(e, a) {
            var b = arguments
              , d = e
              , f = a;
            [].shift.apply(b);
            var g, l = this.each(function() {
                var a = m(this);
                if (a.is("select")) {
                    var e = a.data("selectpicker")
                      , l = "object" == typeof d && d;
                    if (!e)
                        e = m.extend({}, c.DEFAULTS, m.fn.selectpicker.defaults || {}, a.data(), l),
                        e.template = m.extend({}, c.DEFAULTS.template, m.fn.selectpicker.defaults ? m.fn.selectpicker.defaults.template : {}, a.data().template, l.template),
                        a.data("selectpicker", e = new c(this,e,f));
                    else if (l)
                        for (var h in l)
                            l.hasOwnProperty(h) && (e.options[h] = l[h]);
                    "string" == typeof d && (g = e[d]instanceof Function ? e[d].apply(e, b) : e.options[d])
                }
            });
            return "undefined" !== typeof g ? g : l
        }
        ;
        m.fn.selectpicker.Constructor = c;
        m.fn.selectpicker.noConflict = function() {
            m.fn.selectpicker = l;
            return this
        }
        ;
        m(document).data("keycount", 0).on("keydown.bs.select", '.bootstrap-select [data-toggle\x3ddropdown], .bootstrap-select [role\x3d"listbox"], .bs-searchbox input', c.prototype.keydown).on("focusin.modal", '.bootstrap-select [data-toggle\x3ddropdown], .bootstrap-select [role\x3d"listbox"], .bs-searchbox input', function(e) {
            e.stopPropagation()
        })
    }
    )(jQuery);
    jQuery.fn.selectpicker.defaults = {
        noneSelectedText: "",
        noneResultsText: "\u6ca1\u6709\u627e\u5230\u5339\u914d\u9879",
        countSelectedText: "\u9009\u4e2d{1}\u4e2d\u7684{0}\u9879",
        maxOptionsText: ["\u8d85\u51fa\u9650\u5236 (\u6700\u591a\u9009\u62e9{n}\u9879)", "\u7ec4\u9009\u62e9\u8d85\u51fa\u9650\u5236(\u6700\u591a\u9009\u62e9{n}\u7ec4)"],
        multipleSeparator: ", "
    }
});
define("form/component/documentselecter", ["form/tplutil", "form/componentmodel"], function(n, y, u) {
    var m = n("form/tplutil")
      , h = n("form/componentmodel");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/formsearchview", ["form/tplutil"], function(n, y, u) {
    var m = n("form/tplutil");
    y = Backbone.View.extend({
    });
    u.exports = y
});
define("form/component/option", ["form/component", "form/tplutil"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil");
    window.Option = y.extend({
        initialize: function(h) {
            this.componentSetup = {
                componentKey: "Option",
                name: "",
                order: 0,
                index: 0,
                selectionId: "",
                fieldId: "",
                defOption: !1,
                other: !1,
                objId: "",
                parent: "",
                children: [],
                isReadonly: !1,
                uid: ""
            };
            null != h && (this.componentSetup.name = h.name,
            this.componentSetup.order = h.order,
            this.componentSetup.index = h.index,
            this.componentSetup.selectionId = h.selectionId,
            this.componentSetup.defOption = h.defOption,
            this.componentSetup.other = h.other,
            this.componentSetup.objId = h.objId,
            this.componentSetup.parent = h.parent,
            this.componentSetup.children = h.children,
            this.componentSetup.fieldId = h.fieldId,
            this.componentSetup.uid = h.uid,
            this.componentSetup.isReadonly = h.isReadonly);
            this.componentSetup.uid || (this.componentSetup.uid = formPlugin.uid());
            this.tpl = m.get("option")

        },
        setUid: function(h) {
            this.componentSetup.uid = h
        },
        setIsReadonly: function(h) {
            this.componentSetup.isReadonly = h
        },
        setName: function(h) {
            this.componentSetup.name = h
        },
        setOrder: function(h) {
            this.componentSetup.order = h
        },
        setOther: function(h) {
            this.componentSetup.other = h
        },
        setDefOption: function(h) {
            this.componentSetup.defOption = h
        },
        setObjId: function(h) {
            this.componentSetup.objId = h
        },
        setParent: function(h) {
            this.componentSetup.parent = h
        },
        setChildren: function(h) {
            this.componentSetup.children = h
        },
        setFieldId: function(h) {
            this.componentSetup.fieldId = h
        },
        setSelectionId: function(h) {
            this.componentSetup.selectionId = h
        },
        render: function(h, g) {
            var f = $(this.tpl).siblings("#form-option")
              , f = "ImageRadioBox" != g.componentSetup.componentKey && "ImageCheckBox" != g.componentSetup.componentKey || "mobile" != window.systemInfo_form ? f.find("." + g.componentSetup.componentKey + "_js").clone() : f.find("." + g.componentSetup.componentKey + "_mobile_js").clone();            
            if ("Select" == g.componentSetup.componentKey)
                f.text(this.componentSetup.name),
                f.attr("value", this.componentSetup.selectionId),
                "true" != this.componentSetup.defOption && 1 != this.componentSetup.defOption || f.attr("selected", "true");
            else if ("ImageRadioBox" == g.componentSetup.componentKey || "ImageCheckBox" == g.componentSetup.componentKey) {               
                f.find("input").attr("value", this.componentSetup.selectionId);
                f.find("img").attr("src", TEAMS.api.downImgUrl+"/" + this.componentSetup.objId);
                f.find(".j_image_container").attr("imghref", TEAMS.api.downImgUrl+"/" + this.componentSetup.objId);
                f.find("img").attr("imageid", this.componentSetup.objId);
                f.find("span").text(this.componentSetup.name);
                if ("true" == this.componentSetup.defOption || 1 == this.componentSetup.defOption)
                    f.find("input").attr("checked", "true"),
                    f.find(".j_ico").addClass("checked");
                var d = g.componentSetup.fieldId
                  , d = "" == d || null == d ? g.cid : d;
                f.find("input").attr("name", d)
            } else {
                if ("ComboSelect" == g.componentSetup.componentKey) {
                    var b = function(c, d) {
                        var e = h.find(".combo_select_js[index\x3d'" + c + "']")
                          , a = f.clone();
                        a.text(d.name);
                        a.attr("value", d.selectionId);
                        a.attr("selected", "true");
                        e.append(a);
                        if (d && d.children)
                            for (e = 0; e < d.children.length; e++)
                                a = d.children[e],
                                "true" != a.defOption && 1 != a.defOption || b(c + 1, a)
                    };
                    b(1, this.componentSetup);
                    return
                }
                f.find("input").attr("value", this.componentSetup.selectionId);
                if ("true" == this.componentSetup.defOption || 1 == this.componentSetup.defOption)
                    f.find("input").attr("checked", "true"),
                    f.find(".j_ico").addClass("checked");
                d = g.componentSetup.fieldId;
                d = "" == d || null == d ? g.cid : d;
                f.find("input").attr("name", d);
                f.find("span").text(this.componentSetup.name);
                "true" != this.componentSetup.other && 1 != this.componentSetup.other || f.append('\x3cinput type\x3d"text" class\x3d"form-control form-w120 input-otherchoice" disabled\x3d"disabled"\x3e')
            }
            h.find(".j_no_option").remove();
            h.append(f)
        },
        renderEditor: function(h, g, f) {
            var d = $(this.tpl).siblings("#editor-option")
              , b = g.componentSetup.componentKey
              , d = "true" == this.componentSetup.other || 1 == this.componentSetup.other ? d.find(".otherOption_js") : d.find("." + b + "_js").clone();
            1 != this.componentSetup.other && "true" != this.componentSetup.other || d.children(".other_option_js").attr("value", this.componentSetup.selectionId);
            if ("ComboSelect" == b) {
                if (d.children(".combo_option_js").attr("value", this.componentSetup.selectionId),
                d.find(".combo_optionName_js").attr("value", this.componentSetup.name),
                "true" != this.componentSetup.defOption && 1 != this.componentSetup.defOption || d.children(".combo_option_js").attr("checked", "true"),
                d.data("option", this.componentSetup),
                1 == this.componentSetup.isReadonly || "true" == this.componentSetup.isReadonly)
                    d.find(".combo_optionName_js").attr("disabled", "disabled").css("border-radius", "3px"),
                    d.find("span.input-group-btn").remove()
            } else if (d.children(".option_js").attr("value", this.componentSetup.selectionId),
            d.children(".option_js").attr("uid", this.componentSetup.uid),
            "true" != this.componentSetup.defOption && 1 != this.componentSetup.defOption || d.children(".option_js").attr("checked", "true"),
            d.children(".optionName_js").attr("value", this.componentSetup.name),
            "ImageRadioBox" == b || "ImageCheckBox" == b) {
                var c = this.componentSetup.objId;
                g = g.componentSetup.formId;
                g = $('\x3cdiv id\x3d"' + c + '" imageid\x3d"' + c + '" class\x3d"img-item j_imageItem"\x3e\x3cdiv class\x3d"img-box"\x3e\x3ca  class\x3d"gallery-pic" onclick\x3d"$.openPhotoGallery(this)" rel\x3d"0" type\x3d"image" imghref\x3d"'+TEAMS.api.downImgUrl+'/' + c + '?module\x3dform"\x3e\x3cimg imageid\x3d"' + c + '" src\x3d"'+TEAMS.api.downImgUrl+'/' + c + '"\x3e\x3c/div\x3e\x3c/div\x3e');
                d.find(".j_cut_image").attr("imageId", c);
                d.find(".j_image_container").append(g)
            }
            "Select" == b && 1 == this.componentSetup.isReadonly && (d.find(".optionName_js").attr("disabled", "disabled"),
            d.find("span.cs-p").remove());
            f ? (d.insertAfter(f),
            d.find("input.optionName_js").focus(),
            d.find("input.combo_optionName_js").eq(0).focus()) : h.append(d)
        },
        change: function(h) {},
        renderPreview: function(h, g) {

            var f = $(this.tpl).siblings("#preview-option")
              , f = "ImageRadioBox" != g.componentSetup.componentKey && "ImageCheckBox" != g.componentSetup.componentKey || "mobile" != window.systemInfo_form ? f.find("." + g.componentSetup.componentKey + "_js").clone() : f.find("." + g.componentSetup.componentKey + "_mobile_js").clone();
           
            this.componentSetup.selectionId = this.componentSetup.selectionId ? this.componentSetup.selectionId : this.cid;
            if ("Select" == g.componentSetup.componentKey) {
                f.text(this.componentSetup.name),
                f.attr("value", this.componentSetup.selectionId),
                "true" != this.componentSetup.defOption && 1 != this.componentSetup.defOption || f.attr("selected", "true"),
                f.attr("uid", this.componentSetup.uid),
                f.data("componentData", this);
            }   
            else if ("ImageRadioBox" == g.componentSetup.componentKey || "ImageCheckBox" == g.componentSetup.componentKey) {
                f.find("input").attr("value", this.componentSetup.selectionId);
                if ("true" == this.componentSetup.defOption || 1 == this.componentSetup.defOption)
                    f.find("input").attr("checked", "true"),
                    "mobile" == window.systemInfo_form && f.find(".j_ico").addClass("checked");
                var d = g.componentSetup.fieldId
                  , d = "" == d || null == d ? g.cid : d + g.cid;
                f.find("input").attr("name", d);
                f.find("input").attr("id", this.componentSetup.selectionId);
                f.find("input").data("componentData", this);
                f.find("span").text(this.componentSetup.name).attr("title", this.componentSetup.name);
               
                var _objId = this.componentSetup.objId;
                var _order = this.componentSetup.order;       

                $("#widget-control .field-active").find(".ImageRadioBox_js").each(function() {
                     var _i = $(this).index();
                    var _imageid = $(this).find('img').attr('imageid');
                    if(_order == _i) {
                        _objId = _imageid

                    }
                })
                f.find("img").attr("src", TEAMS.api.downImgUrl+"/" + _objId);
                f.find("img").attr("imageid",_objId);
                f.find("a").attr("imghref", TEAMS.api.downImgUrl+"/" + _objId ).attr("title", this.componentSetup.name);
                f.find(".j_image_container").attr("imghref", TEAMS.api.downImgUrl+"/" + _objId ).attr("title", this.componentSetup.name)
            } else {
                if ("ComboSelect" == g.componentSetup.componentKey) {
                    var b = function(c, d) {
                        var e = h.find(".combo_select_js[index\x3d'" + c + "']")
                          , a = f.clone();
                        a.text(d.name);

                        a.attr("value", d.generatorId);
                        a.attr("uid", d.uid);
                        a.data("option", d);
                        if ("true" == d.defOption || 1 == d.defOption) {
                            a.attr("selected", "true");
                            for (var g = 0; g < d.children.length; g++) 
                                b(c + 1, d.children[g])
                            
                        }
                        e.append(a)
                    };
                    b(1, this.componentSetup);
                    return
                }
                f.find("input").attr("value", this.componentSetup.selectionId);
                if ("true" == this.componentSetup.defOption || 1 == this.componentSetup.defOption)
                    f.find("input").attr("checked", "true"),
                    "CheckBox" != g.componentSetup.componentKey && "RadioBox" != g.componentSetup.componentKey || f.find(".j_ico").addClass("checked");
                d = g.componentSetup.fieldId;
                d = "" == d || null == d ? g.cid : d + g.cid;
                f.find("input").attr("name", d);
                f.find("input").attr("id", this.componentSetup.selectionId);
                f.find("span").text(this.componentSetup.name);
                f.find("input").attr("uid", this.componentSetup.uid);
                f.find("input").data("componentData", this);
                "true" != this.componentSetup.other && 1 != this.componentSetup.other || f.append('\x3cinput type\x3d"text" placeholder\x3d"\u8bf7\u586b\u5199\u5176\u4ed6\u5185\u5bb9" style\x3d"display: none;" class\x3d"form-control form-w120 input-otherchoice"\x3e')
            }
            h.append(f)
        },
        submitCheck: function(h, g) {},
        checkEvents: function(h) {}
    });
    u.exports = window.Option
});
define("form/component/productionlist", ["form/tplutil", "form/component/formfilter"], function(n, y, u) {
    var m = n("form/tplutil")
      , h = n("form/component/formfilter");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/positioncomponent", ["form/editablecomponent", "form/tplutil", "form/component/positionselecter"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/positionselecter");
    window.PositionComponent = m.extend({
        initialize: function(f) {
            m.prototype.initialize.call(this, f);
            var d = {
                componentKey: "PositionComponent",
                title: "\u5730\u7406\u4f4d\u7f6e",
                isAutoPosition: !1,
                defaultAddress: "",
                defaultLng: "",
                defaultLat: ""
            };
            null != f && (d.title = f.title,
            d.isAutoPosition = f.isAutoPosition,
            d.defaultAddress = f.defaultAddress,
            d.defaultLng = f.defaultLng,
            d.defaultLat = f.defaultLat,
            d.isDefault = f.isDefault);
            this.componentSetup = $.extend(this.componentSetup, d);
            this.tpl = h.get("position", {
                isMobileForm: this.isMobileForm
            })
        },
        setTitle: function(f) {
            this.componentSetup.setTitle = f
        },
        setIsAutoPosition: function(f) {
            this.componentSetup.isAutoPosition = f;
            if (1 == f || "true" == f)
                this.componentSetup.isDefault = !1,
                f = $("#editor-component"),
                f.find("#isDefault").prop("checked", !1),
                f.find("#j_default_value").addClass("hide"),
                $("#widget-control .field-active").find(".field-value_js").text("\u83b7\u53d6\u5730\u7406\u4f4d\u7f6e"),
                $("#widget-control .field-active").find(".field-value_js").parent().removeClass("field-position-nobd")
        },
        setIsDefault: function(f) {
            this.componentSetup.isDefault = f;
            if (1 == f || "true" == f)
                this.componentSetup.isAutoPosition = !1,
                $("#editor-component").find("#isAutoPosition").prop("checked", !1)
        },
        setDefaultAddress: function(f) {
            this.componentSetup.defaultAddress = f
        },
        setDefaultLng: function(f) {
            this.componentSetup.defaultLng = f
        },
        setDefaultLat: function(f) {
            this.componentSetup.defaultLat = f
        },
        render: function(f) {
            var d = $(this.tpl).siblings("#form-position");
            m.prototype.render.call(this, f, d);
            f.html(d.html())
        },
        renderEditPreview: function(f) {
            var d = $(this.tpl).siblings("#form-position");
            m.prototype.renderEditPreview.call(this, f, d);
            var b = this.componentSetup.isDefault;
            if (1 == b || "true" == b)
                d.find(".field-value_js").text(this.componentSetup.defaultAddress),
                d.find(".field-value_js").parent().addClass("field-position-nobd");
            f.append(d)
        },
        renderEditor: function() {
            var f = $(this.tpl).siblings("#editor-position");
            m.prototype.renderEditor.call(this, f);
            var d = this.componentSetup.isAutoPosition;
            1 != d && "true" != d || f.find("#isAutoPosition").attr("checked", "true");
            d = this.componentSetup.isDefault;
            if (1 == d || "true" == d)
                this.componentSetup.defaultAddress && f.find(".j_defaultPosition").text(this.componentSetup.defaultAddress).attr("address", this.componentSetup.defaultAddress),
                this.componentSetup.defaultLng && f.find(".j_defaultPosition").attr("lng", this.componentSetup.defaultLng),
                this.componentSetup.defaultLat && f.find(".j_defaultPosition").attr("lat", this.componentSetup.defaultLat);
            $("#editor-component").html(f.html())
        },
        errorBack: function(f) {
            formPlugin.notify("\u5b9a\u4f4d\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01")
        },
        showPosition: function(f) {
            var d = window.qdgps;
            window.HOST_TYPE = "2";
            window.BMap_loadScriptTime = (new Date).getTime();
            n.async(["https://api.map.baidu.com/getscript?v\x3d2.0\x26ak\x3dXKXXQG69VnCYhXvtrfjVuWjh\x26services\x3d\x26t\x3d" + TEAMS.version], function() {
                d.renderPoint(f.coords.longitude, f.coords.latitude)
            })
        },
        renderPoint: function(f, d) {
            var b = window.qdgps
              , c = [new BMap.Point(f,d)];
            (new BMap.Convertor).translate(c, 1, 5, function(c) {
                if (0 === c.status) {
                    c = c.points[0];
                    var e = c.lng
                      , a = c.lat;
                    (new BMap.Geocoder).getLocation(c, function(c) {
                        c = c.addressComponents;
                        c = c.city + c.district + c.street + c.streetNumber;
                        var d = b.formTpl;
                        d.find(".check_js").text(c).attr("title", c).attr("address", c).attr("lng", e).attr("lat", a);
                        d.find(".check_js").parent().addClass("field-position-nobd")
                    })
                }
            })
        },
        translate: function(f, d, b) {
            var c = "cbk_" + Math.round(1E4 * Math.random());
            this.load_script("https://api.map.baidu.com/ag/coord/convert?from\x3d" + d + "\x26to\x3d4\x26x\x3d" + f.lng + "\x26y\x3d" + f.lat + "\x26callback\x3dBMap.Convertor." + c);
            BMap.Convertor[c] = function(d) {
                delete BMap.Convertor[c];
                d = new BMap.Point(d.x,d.y);
                b && b(d)
            }
        },
        load_script: function(f, d) {
            var b = document.getElementsByTagName("head")[0]
              , c = document.createElement("script");
            c.type = "text/javascript";
            c.src = f;
            c.onload = c.onreadystatechange = function() {
                this.readyState && "loaded" !== this.readyState && "complete" !== this.readyState || (d && d(),
                c.onload = c.onreadystatechange = null,
                b && c.parentNode && b.removeChild(c))
            }
            ;
            b.insertBefore(c, b.firstChild)
        },
        renderPreview: function(f, d, b, c, g) {
            var e = $(this.tpl).siblings("#preview-position");
            b && e.find(".check_js").attr("canSelect", !1);
            m.prototype.renderPreview.call(this, f, d, b, e);
            d = this.componentSetup.isDefault;
            1 == d || "true" == d ? (this.componentSetup.defaultAddress && e.find(".check_js").text(this.componentSetup.defaultAddress).attr("title", this.componentSetup.defaultAddress).attr("address", this.componentSetup.defaultAddress),
            this.componentSetup.defaultLng && e.find(".check_js").attr("lng", this.componentSetup.defaultLng),
            this.componentSetup.defaultLat && e.find(".check_js").attr("lat", this.componentSetup.defaultLat),
            e.find(".check_js").parent().addClass("field-position-nobd")) : e.find(".check_js").parent().removeClass("field-position-nobd");
            this.formTpl = e;
            if ("true" == this.componentSetup.isAutoPosition || 1 == this.componentSetup.isAutoPosition)
                c && c.fieldReads ? (c = c.fieldReads[this.componentSetup.fieldId],
                ("undefined" == typeof c || c) && this.renderAutoPosition(e, g)) : this.renderAutoPosition(e, g);
            f.append(e)
        },
        renderAutoPosition: function(f, d) {
            if ("formdatareport" != d) {
                var b = this.componentSetup.fieldId || this.componentSetup.tempId;
                "mobile" == window.systemInfo_form ? (window.qdgps = this,
                navigator.geolocation ? navigator.geolocation.getCurrentPosition(this.showPosition, this.errorBack, {
                    enableHighAccuracy: !0
                }) : formPlugin.notify("\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5730\u7406\u5b9a\u4f4d")) : $.ajax({
                    url: "https://api.map.baidu.com/location/ip?ak\x3dXKXXQG69VnCYhXvtrfjVuWjh\x26coor\x3dbd09ll",
                    type: TEAMS.ajaxMethod,
                    dataType: "jsonp",
                    success: function(c) {
                        var d = f.find(".check_js[componentKey\x3d'PositionComponent'][id\x3d'" + b + "']")
                          , e = d.attr("lng")
                          , d = d.attr("lat");
                        if ((!e || !d) && c.content && c.content.point) {
                            e = c.content.point.x;
                            d = c.content.point.y;
                            c = c.content.address_detail;
                            var a = "";
                            c.province && (a += c.province);
                            c.city && c.province && c.city != c.province && (a += c.city);
                            c.district && (a += c.district);
                            c.street && (a += c.street);
                            c.streetNumber && (a += c.streetNumber);
                            f.find(".check_js").text(a).attr("title", a).attr("address", a).attr("lng", e).attr("lat", d).attr("level", 11);
                            f.find(".check_js").parent().addClass("field-position-nobd")
                        }
                    }
                })
            }
        },
        renderStatSearch: function(f) {
            var d = $(this.tpl)
              , b = d.siblings("#statsearch-position")
              , c = f.value
              , g = f.term
              , e = f.parentEl;
            if ("mobile" != window.systemInfo_form)
                c && b.find("input").val(c),
                g && b.find("select:first option[value\x3d" + g + "]").attr("selected", "true"),
                e.attr("class", "sch-group j_formFieldSearchGroup"),
                e.find(".j_formField-condition").html(b);
            else {
                var c = f.fieldId
                  , g = f.fieldTitle
                  , a = f.subFormId
                  , b = d.siblings("#statsearch-mobile-position")
                  , d = f.filterEl;
                f = f.condition;
                d && (d = d.find(".j_filterList .selectd #comp-val span").text(),
                b.find(".j_compVal").val(d));
                f && (b.find(".j_condition").find('option[value\x3d"' + f + '"]').attr("selected", !0),
                "null" != f && "notnull" != f || b.find(".j_control").hide());
                b.find(".j_inputName").text(g + ":");
                e.find("#component-div").html(b);
                e.find(".j_comp-ok").attr("comKey", "PositionComponent").attr("fieldId", c).attr("title", g).attr("subFormId", a);
                e.off("change", "#statsearch-mobile-position .j_condition").on("change", "#statsearch-mobile-position .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? e.find("#statsearch-mobile-position .j_control").hide() : e.find("#statsearch-mobile-position .j_control").show()
                })
            }
        },
        checkEvents: function(f) {
            f = this.el || $(document);
            var d = this.componentSetup.fieldId || this.componentSetup.tempId
              , b = this.componentSetup.isReadOnly;
            1 != b && "true" != b || f.find(".check_js[componentKey\x3d'PositionComponent'][id\x3d'" + d + "']").attr("canSelect", !1);
            "mobile" == window.systemInfo_form ? (f.on("click", ".check_js[componentKey\x3d'PositionComponent'][id\x3d'" + d + "']", function() {
                var c = $(this)
                  , b = c.parents(".j_page-view")
                  , e = c.attr("level") || 18
                  , a = c.attr("lng")
                  , d = c.attr("lat")
                  , f = c.attr("address")
                  , h = new g
                  , m = c.attr("canSelect")
                  , p = !1;
                if (0 == m || "false" == m)
                    p = !0;
                h.render("mb", {
                    level: e,
                    lng: a,
                    lat: d,
                    address: f,
                    parentEl: c,
                    parentView: b,
                    readOnly: p
                });
                b.addClass("hide")
            }),
            f.on("addressConfirm", ".check_js[componentKey\x3d'PositionComponent'][id\x3d'" + d + "']", function(c, b) {
                var e = $(this)
                  , a = b.address
                  , d = b.lng
                  , f = b.lat;
                e.text(a).attr("lng", d).attr("lat", f).attr("address", a)
            })) : (f.on("click", ".j_positionSelectDiv", function() {
                var c = $(this).find(".check_js[componentKey\x3d'PositionComponent']")
                  , b = c.attr("level") || 18
                  , e = c.attr("lng")
                  , a = c.attr("lat")
                  , d = c.attr("address")
                  , f = new g
                  , h = c.attr("canSelect")
                  , m = !1;
                if (0 == h || "false" == h)
                    m = !0;
                f.render("pc", {
                    level: b,
                    lng: e,
                    lat: a,
                    address: d,
                    parentEl: c,
                    readOnly: m
                })
            }),
            f.on("selectAddr", ".check_js[componentKey\x3d'PositionComponent'][id\x3d'" + d + "']", function(c, b) {
                var e = $(this);
                e.attr("lng", b.lng);
                e.attr("lat", b.lat);
                e.attr("address", b.address);
                e.text(b.address);
                e.attr("title", b.address);
                e.parent().addClass("field-position-nobd")
            }))
        },
        autoSaveEvents: function(f) {
            var d = this;
            (d.el || $(document)).on("selectAddr", ".check_js[componentKey\x3d'PositionComponent'][id\x3d'" + (d.componentSetup.fieldId || d.componentSetup.tempId) + "']", function() {
                d.saveComponentValue($(this), f)
            })
        },
        check: function(f) {
            var d = f.attr("lng")
              , b = f.attr("lat")
              , c = {};
            c.element = f;
            d || b || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (c.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            return c
        },
        getValue: function(f, d) {
            var b = $.trim(f.text())
              , c = f.attr("lng")
              , g = f.attr("lat")
              , b = {
                formField: {
                    id: this.componentSetup.fieldId
                },
                content: b,
                longitude: c,
                latitude: g
            };
            return c && g || d ? b : null
        },
        setValue: function(f, d) {
            if (null != d) {
                var b = d.content
                  , c = d.longitude
                  , g = d.latitude
                  , e = f.find(".check_js[componentKey\x3d'PositionComponent'][id\x3d'" + (this.componentSetup.fieldId || this.componentSetup.tempId) + "']");
                e.text(b).attr("title", b).attr("lng", c).attr("lat", g).attr("address", b);
                e.text(b).parent().addClass("field-position-nobd");
                f.find(".j_readOnly").html(b).attr("title", b).attr("lng", c).attr("lat", g).attr("address", b)
            }
        },
        empty: function(f) {
            f.find(".check_js[componentKey\x3d'PositionComponent'][id\x3d'" + (this.componentSetup.fieldId || this.componentSetup.tempId) + "']").text("").attr("title", "").attr("lng", "").attr("lat", "").attr("address", "")
        },
        readOnly: function(f, d) {
            var b = f.find(".check_js[componentKey\x3d'PositionComponent'][id\x3d'" + (this.componentSetup.fieldId || this.componentSetup.tempId) + "']")
              , b = this.isMobileForm ? b.parent() : b;
           // d ? b.attr("canSelect", !1) : b.attr("canSelect", !0)
            d ? (b.attr("canSelect", !1),
            b.addClass("hide"),
            b.siblings(".j_readOnly").removeClass("hide")) : (b.attr("canSelect", !0),
            b.removeClass("hide"),
            b.siblings(".j_readOnly").addClass("hide"))
        }
    });
    u.exports = window.PositionComponent
});
define("form/component/monitor", ["form/component", "form/tplutil", "form/componentmodel", "form/component/monitoreditor", "form/editablecomponent"], function(n, y, u) {
    function m(b, c, d, e) {
        this.value = b;
        this.type = c;
        this.monitorFields = d;
        this.monitorType = e
    }
    n("form/component");
    var h = n("form/tplutil")
      , g = n("form/componentmodel")
      , f = n("form/component/monitoreditor")
      , d = n("form/editablecomponent");
    window.Monitor = d.extend({
    });
    u.exports = window.Monitor
});
define("form/component/select", ["form/editablecomponent", "form/tplutil", "form/componentmodel", "form/component/option"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel")
      , f = n("form/component/option");
    window.Select = m.extend({
        initialize: function(d) {
            m.prototype.initialize.call(this, d);
            var b = {
                componentKey: "Select",
                title: "\u4e0b\u62c9\u83dc\u5355",
                options: [],
                parent: "",
                placeholder: "\u8bf7\u9009\u62e9",
                templateId: "",
                detailDefaultId: ""
            };
            null != d && (b.title = d.title,
            b.options = d.options,
            b.parent = d.parent,
            b.placeholder = d.placeholder ? d.placeholder : "\u8bf7\u9009\u62e9",
            b.templateId = d.templateId,
            b.detailDefaultId = d.detailDefaultId);
            this.componentSetup = $.extend(this.componentSetup, b);
            if (null == this.componentSetup.templateId || "" == this.componentSetup.templateId) {
                if (!this.componentSetup.options || 0 == this.componentSetup.options.length) {
                    d = new f;
                    d.setName("\u9009\u98791");
                    d.setOrder(0);
                    b = new f;
                    b.setName("\u9009\u98792");
                    b.setOrder(1);
                    var c = new f;
                    c.setName("\u9009\u98793");
                    c.setOrder(2);
                    this.componentSetup.options = [];
                    this.componentSetup.options[0] = d.componentSetup;
                    this.componentSetup.options[1] = b.componentSetup;
                    this.componentSetup.options[2] = c.componentSetup
                }
            } else
                this.componentSetup.options = [];
            this.tpl = h.get("select", {
                isMobileForm: this.isMobileForm
            });
            this.componentModel = new g
        },
        setDetailDefaultId: function(d) {
            this.componentSetup.detailDefaultId = d
        },
        setTemplateId: function(d) {
            this.componentSetup.templateId = d
        },
        setOptions: function(d) {
            this.componentSetup.options = d
        },
        setPlaceholder: function(d, b) {
            this.componentSetup.placeholder = d
        },
        setParent: function(d) {
            this.componentSetup.parent = d
        },
        setTempId: function(d) {
            this.componentSetup.tempId = d
        },
        layoutCheck: function() {
            for (var d = !1, b = this.componentSetup.options, c = [], f = 0; f < b.length; f++) {
                var e = b[f];
                0 != e.other && "false" != e.other || "" == e.name || c.push(e.name)
            }
            b = c.sort();
            for (f = 0; f < b.length; f++)
                if (b[f] == b[f + 1]) {
                    d = !0;
                    break
                }
            if (d)
                throw formPlugin.notify("\u9009\u9879\u540d\u79f0\u5b58\u5728\u91cd\u590d"),
                $("#widget-control").find(".field_js").removeClass("field-active"),
                $("#widget-control").find('.field_js[componentKey\x3d"' + this.componentSetup.componentKey + '"][tempId\x3d"' + this.componentSetup.tempId + '"]').addClass("field-active"),
                $("#formEdit_js").find("#edit-form").addClass("hide"),
                $("#formEdit_js").find("#edit-widget").removeClass("hide"),
                this.renderEditor(),
                Error();
        },
        render: function(d) {
            var b = this
              , c = $(this.tpl).siblings("#form-select");
            m.prototype.render.call(this, d, c);
            var l = c.find(".choicelist_js");
            l.append("\x3coption value\x3d''\x3e" + b.componentSetup.placeholder + "\x3c/option\x3e");
            for (var e = 0; e < this.componentSetup.options.length; e++)
                (new f(this.componentSetup.options[e])).render(l, this);
            b.componentSetup.tempId ? d.attr("tempId", b.componentSetup.tempId) : this.componentModel.generatorId(function(a) {
                a = a.generatorId;
                b.componentSetup.tempId = a;
                d.attr("tempId", a)
            });
            c.find(".choicelist_js").addClass(this.componentSetup.size);
            d.html(c.html())
        },
        renderEditPreview: function(d, b) {
            var c = $(this.tpl).siblings("#form-select").clone();
            m.prototype.renderEditPreview.call(this, d, c);
            var l = c.find(".choicelist_js");
            l.append("\x3coption value\x3d''\x3e" + this.componentSetup.placeholder + "\x3c/option\x3e");
            for (var e = 0; e < this.componentSetup.options.length; e++)
                (new f(this.componentSetup.options[e])).renderPreview(l, this);
            c.find(".choicelist_js").addClass(this.componentSetup.size);
            b ? d.replaceWith(c) : d.append(c)
        },
        renderEditor: function() {
            var f = $(this.tpl).siblings("#editor-select");
            f.find("input:radio[name\x3d'componentType'][value\x3d'" + this.componentSetup.componentKey + "']").attr("checked", "true");
            f.find("input:radio[name\x3d'layout'][value\x3d'choicelist-" + this.componentSetup.layout + "']").attr("checked", "true");
            f.find(".placeholder_js").attr("value", this.componentSetup.placeholder);
            var d = $("#module").val();
            "biaoge" != d && "workflow" != d && (f.find(".j_cancel_template_data").remove(),
            f.find(".j_optDataSource_hide").remove());
            d = f.find("ul.choicelistEdit_js");
            if (this.componentSetup.templateId) {
                this.templateSource || (this.templateSource = []);
                this.templateSource && this.templateSource.template ? d = this.templateSource.template : (d = this.renderTemplateAll(this.componentSetup.templateId),
                this.templateSource.template = d);
                if (d) {
                    var b = d.name
                    , l = [];
                    f.find(".btn-default_js").parent().addClass("hide");
                    f.find(".j_optBatcEdit").parent().addClass("hide");
                    f.find(".j_componentType_change").addClass("hide");
                    f.find(".j_data_template_name").removeClass("hide").find(".j_template_name_span").html(c).attr("title", c);
                    f.find(".j_cancel_template").removeClass("hide");
                }
            }
            m.prototype.renderEditor.call(this, f);
            $("#editor-component").html(f.html());
            f = $("#editor-component").find(".choicelistEdit_js");
            if (this.componentSetup.templateId) {
                if (d && (b = d.name,
                b = d.detailsList,
                null != b)) {
                    for (var c = [], g = function(a, e) {
                        var c = [];
                        if (a && 0 < a.length)
                            for (var b = 0; b < a.length; b++) {
                                var d = a[b]
                                  , f = new Option;
                                f.setName(d.name);
                                f.setOrder(d.order);
                                f.setSelectionId(d.id);
                                f.setIsReadonly(!0);
                                if (e && 0 < e.length)
                                    for (var k = 0; k < e.length; k++)
                                        d.id == e[k] && f.setDefOption(!0);
                                d.children && 0 < d.children.length && f.setChildren(g(d.children));
                                c.push(f.componentSetup)
                            }
                        return c
                    }, e = this.componentSetup.detailDefaultId, d = 0; d < b.length; d++) {
                        var a = b[d]
                          , k = new Option;
                        k.setName(a.name);
                        k.setOrder(a.order);
                        k.setSelectionId(a.id);
                        k.setIsReadonly(!0);
                        if (e && 0 < e.length)
                            for (var h = 0; h < e.length; h++)
                                a.id == e[h] && k.setDefOption(!0);
                        k.setChildren(g(a.children, e));
                        c.push(k.componentSetup);
                        a = new Option(k.componentSetup);
                        a.renderEditor(f, this)
                    }
                    this.componentSetup.dataDetails = c
                }
            } else
                for (d = 0; d < this.componentSetup.options.length; d++)
                    k = this.componentSetup.options[d],
                    a = new Option(k),
                    a.renderEditor(f, this),
                    "true" != k.other && 1 != k.other || $("#editor-component").find(".btn-default_js").parent().hide();
            this.optionDrag()
            if(f.children('li').length>20) {
                f.children('li:gt(19)').hide();
                $('.j_moreDataSource').show();
            } else {
                $('.j_moreDataSource').hide();
            }
        },
        renderOption: function(d, b) {
            var c = d.find("ul.choicelistEdit_js").html("");
            if (b)
                for (var l = 0; l < b.length; l++)
                    (new f(b[l])).renderEditor(c, this)
        },
        renderTemplate: function(d) {
            var b = null
              , c = {};
            c.templateId = d;
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                async: !1,
                url: TEAMS.api.queryDataTemplateById,
                dataType: "json",
                data: JSON.stringify(c),
                success: function(c) {
                    b = c.formDataTemplate
                }
            });
            return b
        },
        renderTemplateAll: function(f) {
            var d = null
              , b = {};
            var levelNum = 1;
            b.templateId = f;
            b.detailsLevel = String(levelNum);
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                async: !1,
                url: TEAMS.api.queryDataSourcesByTemplate,
                dataType: "json",
                data: JSON.stringify(b),
                success: function(c) {
                    c.message ? formPlugin.notify(c.message) : d = c.formDataTemplate
                }
            });
            return d
        },
        renderTemplateDetails: function(d) {
            var b = null
              , c = {};
            c.templateId = d;
            c.detailsLevel = "1";
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                async: !1,
                url: TEAMS.api.queryDateDetailsByDetails,
                dataType: "json",
                data: JSON.stringify(c),
                success: function(c) {
                    b = c.templateDetailsList
                }
            });
            return b
        },
        optionDrag: function() {
            var d = this
              , b = $("#editor-component");
            b.find(".choicelistEdit_js").mousedown(function() {
                document.activeElement.blur()
            });
            b.find(".choicelistEdit_js").sortable({
                cursor: "move",
                scroll: !1,
                containment: "#editor-component",
                placeholder: "combo-select-placeholder",
                items: ".Select_js",
                connectWith: ".choicelistEdit_js",
                update: function(c, f) {
                    f.item.data("update", !0);
                    for (var e = [], a = b.find("ul.choicelistEdit_js li"), k = 0; k < a.length; k++)
                        for (var g = $(a[k]), g = g.find(".option_js").attr("uid"), h = 0; h < d.componentSetup.options.length; h++) {
                            var q = d.componentSetup.options[h]
                              , p = q.uid;
                            if (g) {
                                if (g == p) {
                                    q.order = k;
                                    e.push(q);
                                    break
                                }
                            } else if (1 == q.other || "true" == q.other) {
                                e.push(q);
                                break
                            }
                        }
                    d.componentSetup.options = e;
                    e = $("#widget-control .field-active").find(".choicelist_js li");
                    for (a = 0; a < e.length; a++)
                        g = $(e[a]),
                        g.find("span").text(d.componentSetup.options[a].name)
                },
                receive: function(c, b) {
                    b.item.data("receive", !0)
                },
                stop: function(c, b) {
                    b.item.data("update") && (b.item.data("update", !1),
                    b.item.data("receive") && b.item.data("receive", !1))
                }
            })
        },
        renderPreview: function(d, b, c) {
            var l = $(this.tpl).siblings("#preview-select")
              , e = l.find(".choicelist_js");
            e.append("\x3coption value\x3d''\x3e" + this.componentSetup.placeholder + "\x3c/option\x3e");
            if (this.componentSetup.templateId) {
                var a = [];
                window.selectOption || (window.selectOption = []);
                var k = "field_" + (this.componentSetup.fieldId || this.componentSetup.tempId);
                window.selectOption[k] ? a = window.selectOption[k] : (a = this.renderTemplateDetails(this.componentSetup.templateId),
                window.selectOption[k] = a);
                if (a && 0 < a.length)
                    for (k = 0; k < a.length; k++) {
                        var g = a[k]
                          , h = new f;
                        h.setName(g.name);
                        h.setOrder(g.order);
                        h.setSelectionId(g.id);
                        h.setUid(g.id);
                        this.componentSetup.detailDefaultId && this.componentSetup.detailDefaultId == g.id && h.setDefOption(!0);
                        g = new f(h.componentSetup);
                        g.renderPreview(e, this)
                    }
            } else
                for (new f,
                k = 0; k < this.componentSetup.options.length; k++)
                    h = this.componentSetup.options[k],
                    g = new f(h),
                    g.renderPreview(e, this);
            b && l.find(".check_js").val("");
            "true" != this.componentSetup.isReadOnly && 1 != this.componentSetup.isReadOnly || l.find(".check_js").attr("disabled", !0);
            l.find(".choicelist_js").addClass(this.componentSetup.size);
            m.prototype.renderPreview.call(this, d, b, c, l);
            c || l.find(".check_js").selectpicker({
                mobile: "mobile" != window.systemInfo_form ? !1 : !0,
                liveSearch: 10 < this.componentSetup.options.length ? !0 : !1,
                size: 10
            });
            d.append(l)
        },
        change: function(d) {
            var b = d.oldObj;
            d = d.changeEl;
            this.componentSetup.title = b.componentSetup.title;
            this.componentSetup.describe = b.componentSetup.describe;
            this.componentSetup.order = b.componentSetup.order;
            this.componentSetup.index = b.componentSetup.index;
            this.componentSetup.required = b.componentSetup.required;
            this.componentSetup.fieldId = b.componentSetup.fieldId;
            this.componentSetup.tempId = b.componentSetup.tempId;
            this.componentSetup.options = b.componentSetup.options;
            this.render(d)
        },
        renderStatSearch: function(d) {
            var b = this
              , c = d.fieldId
              , f = d.fieldTitle
              , e = d.subFormId
              , a = d.parentEl
              , k = d.filterEl
              , g = d.condition
              , h = b.unique(d.ids)
              , q = d.term
              , p = {
                fieldId: c,
                componentModule: d.componentModule
            };
            d = window.getdatastaturl({
                module: d.module
            }, "/findFiledOptions.json");
            $.ajax({
                type: TEAMS.ajaxMethod,
                url: d,
                dataType: "json",
                async: !1,
                data: p,
                success: function(d) {
                    "mobile" != window.systemInfo_form ? b.pcStatSearch(a, h, q, d.fieldOptions) : b.mobileStatSearch(c, f, a, h, q, d.fieldOptions, e, k, g)
                }
            })
        },
        pcStatSearch: function(d, b, c, f) {
            for (var e = $(this.tpl).siblings("#statsearch-select"), a = e.find(".j_resultList"), k = 0; k < f.length; k++) {
                var g = f[k]
                  , h = g.name
                  , q = g.id
                  , g = g["delete"]
                  , p = $(a.find("option")[0]).clone();
                p.attr("id", q).text(h);
                1 != g && "true" != g || p.addClass("finished-line").attr("id", q).text(h);
                a.append(p)
            }
            d.attr("class", "sch-group j_formFieldSearchGroup");
            d.find(".j_formField-condition").html("").append(e);
            if (b)
                for (k = 0; k < b.length; k++)
                    e = '\x3cspan class\x3d"entity-item"\x3e\x3ca id\x3d"' + b[k].id + '" title\x3d"' + b[k].text + '"\x3e' + b[k].text + "\x3c/a\x3e\x3c/span\x3e",
                    d.find(".j_formField-condition .entity-container").append(e);
            c && d.find(".j_formField-condition select:first option[value\x3d" + c + "]").attr("selected", "true")
        },
        mobileStatSearch: function(d, b, c, f, e, a, k, g, h) {
            var q = $(this.tpl).siblings("#statsearch-select-mobile");
            h && (q.find(".j_condition").find('option[value\x3d"' + h + '"]').attr("selected", !0),
            "null" != h && "notnull" != h || q.find(".j_control").hide());
            g && (q.find("#seleted-list").empty(),
            g.find(".j_filterList .selectd #comp-val span").each(function() {
                var a = $(this).attr("optionId")
                  , e = $(this).text()
                  , c = $("\x3cspan\x3e\x3c/span\x3e");
                c.attr("id", a).text(e);
                q.find("#seleted-list").append(c)
            }));
            q.find(".j_optionUl").empty();
            q.find("#seleted-list").attr("fieldId", d);
            for (f = 0; f < a.length; f++) {
                e = a[f];
                g = e.name;
                h = e.id;
                var p = q.find("#li-clone li").clone();
                0 < q.find("#seleted-list").find("#" + h).length && p.addClass("selected");
                p.find(".j_optionname").text(g);
                p.attr("id", h);
                p.data("fieldOption", e);
                q.find(".j_optionUl").append(p)
            }
            c.find("#component-div").html(q);
            c.find(".j_comp-ok").attr("comKey", "Select").attr("fieldId", d).attr("title", b).attr("subFormId", k);
            c.off("change", "#statsearch-select-mobile .j_condition").on("change", "#statsearch-select-mobile .j_condition", function() {
                var a = $(this).val();
                "null" == a || "notnull" == a ? c.find("#statsearch-select-mobile .j_control").hide() : c.find("#statsearch-select-mobile .j_control").show()
            });
            c.off("tap", "#statsearch-select-mobile .j_optionli").on("tap", "#statsearch-select-mobile .j_optionli", function() {
                var a = $(this);
                a.hasClass("selected") ? a.removeClass("selected") : a.addClass("selected");
                var e = a.data("fieldOption")
                  , a = e.id
                  , e = '\x3cspan id\x3d"' + a + '"\x3e' + e.name + "\x3c/span\x3e";
                0 < c.find("#statsearch-select-mobile #seleted-list #" + a).length ? c.find("#statsearch-select-mobile #seleted-list #" + a).remove() : c.find("#statsearch-select-mobile #seleted-list").append(e)
            })
        },
        checkEvents: function(d) {
            var b = this
              , c = b.el || $(document)
              , f = ""
              , f = b.componentSetup.fieldId ? "select[id\x3d'" + b.componentSetup.fieldId + "'][cid\x3d'" + b.cid + "']" : "select[cid\x3d'" + b.cid + "']";
            c.on("change", f, function(e, a) {
                var c = $(this).find("option:selected");
                $(this).attr("id", b.componentSetup.fieldId);
                var c = c.data("componentData")
                  , f = b.isMobileForm ? ".j_otherchoiceWrap" : ".j_otherchoiceInput";
                c ? "true" == c.componentSetup.other || 1 == c.componentSetup.other ? ($(this).parents(".select-continer_js").find(".j_otherchoiceInput").attr("disabled", !1),
                $(this).parents(".select-continer_js").find(f).show()) : ($(this).parents(".select-continer_js").find(".j_otherchoiceInput").attr("disabled", !0),
                $(this).parents(".select-continer_js").find(f).hide()) : ($(this).parents(".select-continer_js").find(".j_otherchoiceInput").attr("disabled", !0),
                $(this).parents(".select-continer_js").find(f).hide());
                a && 0 == a.isCheck ? d({
                    element: $(this)
                }) : (c = b.check($(this)),
                d(c))
            })
        },
        autoSaveEvents: function(d) {
            var b = this
              , c = b.el || $(document);
            c.on("change", "select[id\x3d'" + b.componentSetup.fieldId + "'][cid\x3d'" + b.cid + "']", function(c) {
                if (c.isTrigger)
                    return !0;
                b.saveComponentValue($(this), d)
            });
            c.on("change", "#field_" + b.componentSetup.fieldId + " input:text", function(c) {
                b.saveComponentValue($(this), d)
            })
        },
        check: function(d) {
            var b = d.val()
              , c = {};
            c.element = d;
            "" != b && null != b || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (c.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            return c
        },
        getValue: function(d, b) {
            var c = {
                formField: {
                    id: this.componentSetup.fieldId
                }
            }
              , f = d.val()
              , e = d.find("option:selected").data("componentData")
              , a = "";
            e && ("true" == e.componentSetup.other || 1 == e.componentSetup.other ? (a = d.parents(".select-continer_js").find(".j_otherchoiceInput").val(),
            0 == a.length && (a = "\u5176\u4ed6")) : a = e.componentSetup.name);
            c.dataOptions = [{
                optionId: f,
                content: a
            }];
            return null != f && "" != $.trim(f) || b ? c : null
        },
        setValue: function(d, b) {
            if (this.componentSetup.fieldId) {
                var c = "mobile" == window.systemInfo_form ? ".j_otherchoiceWrap" : ".j_otherchoiceInput";
                if (null != b && null != b.dataOptions)
                    for (var f = 0; f < b.dataOptions.length; f++) {
                        var e = b.dataOptions[f]
                          , a = e.optionId
                          , k = d.find("select#" + this.componentSetup.fieldId)
                          , g = null;
                        b.isMacthByName ? (g = k.find("option").filter(function() {
                            return $(this).text() == e.content
                        }),
                        g.prop("selected", !0)) : (g = d.find("[value\x3d" + a + "]"),
                        k.val(a));
                        k.selectpicker("render");
                        if (0 == g.length)
                            break;
                        if (a = g.data("componentData"))
                            a = a.componentSetup.other,
                            "true" == a || 1 == a ? (d.find(".j_otherchoiceInput").val(e.content),
                            d.find(c).show(),
                            d.find(".j_readOnly").html(e.content)) : d.find(".j_readOnly").html(g.text())
                    }
            }
        },
        empty: function(d) {
            d.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val("");
            d.find(".j_readOnly").html("")
        },
        readOnly: function(d, b) {
            b ? (d.find(".check_js").prop("disabled", !0),
            d.find("input:text").prop("disabled", !0),
            d.find(".select-continer_js").addClass("hide"),
            d.find(".j_readOnly").removeClass("hide")) : (d.find(".check_js").removeClass("hide"),
            d.find(".j_readOnly").addClass("hide"))
        }
    });
    u.exports = window.Select
});
define("form/component/comboselect", ["form/editablecomponent", "form/tplutil", "form/componentmodel"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel");
    window.ComboSelect = m.extend({
        initialize: function(f) {
            m.prototype.initialize.call(this, f);
            var d = {
                componentKey: "ComboSelect",
                title: "\u591a\u7ea7\u4e0b\u62c9\u6846",
                selects: [],
                options: [],
                selectIds: [],
                fieldReads: [],
                fieldWrites: [],
                componentLevel: "1",
                templateId: "",
                detailDefaultId: []
            };
            null != f && (d.title = f.title,
            d.options = f.options,
            d.selects = f.selects,
            d.selectIds = f.selectIds,
            d.fieldReads = f.fieldReads,
            d.fieldWrites = f.fieldWrites,
            f.componentLevel && (d.componentLevel = f.componentLevel),
            d.templateId = f.templateId,
            d.detailDefaultId = f.detailDefaultId);
            this.componentSetup = $.extend(this.componentSetup, d);
            this.componentModel = new g;
            this.tpl = h.get("comboselect", {
                isMobileForm: this.isMobileForm
            })
        },
        setDetailDefaultId: function(f) {
            this.componentSetup.detailDefaultId = f
        },
        setTemplateId: function(f) {
            this.componentSetup.templateId = f
        },
        getOptions: function() {
            return this.componentSetup.options
        },
        setSelects: function(f) {
            this.componentSetup.selects = f
        },
        setSelectIds: function(f) {
            this.componentSetup.selectIds = f
        },
        setOptions: function(f) {
            this.componentSetup.options = f
        },
        setPlaceholder: function(f, d) {
            this.componentSetup.selects[d].placeholder = f
        },
        setComponentLevel: function(f) {
            this.componentSetup.componentLevel = f
        },
        getComponentLevel: function() {
            return this.componentSetup.componentLevel
        },
        setDataDetails: function(f) {
            this.componentSetup.dataDetails = f
        },
        render: function(f) {
            var d = this
              , b = $(d.tpl).siblings("#combo-select");
            this.componentModel.generatorIds({
                size: 3
            }, function(a) {
                d.componentSetup.selectIds = a.generatorIds
            });
            this.initOpt(2);
            var c = b.find(".selectlist_js").html("")
              , g = this.componentSetup.selects.length;
            2 == g && c.addClass("two-columns").removeClass("three-columns");
            3 == g && c.addClass("three-columns").removeClass("two-columns");
            for (var e = 0; e < g; e++)
                c.append("\x3cselect class\x3d'choicelist form-control combo_select_js' index\x3d'" + (e + 1) + "'\x3e\x3coption value\x3d''\x3e" + (d.componentSetup.selects[e].placeholder ? d.componentSetup.selects[e].placeholder : "\u8bf7\u9009\u62e9") + "\x3c/option\x3e\x3c/select\x3e");
            for (e = 0; e < this.componentSetup.options.length; e++)
                if (c = this.componentSetup.options[e],
                "true" == c.defOption || 1 == c.defOption)
                    g = b.find("selectlist_js"),
                    (new Option(c)).render(g, this);
            m.prototype.render.call(this, f, b);
            d.componentSetup.tempId ? f.attr("tempId", d.componentSetup.tempId) : this.componentModel.generatorId(function(a) {
                a = a.generatorId;
                d.componentSetup.tempId = a;
                f.attr("tempId", a)
            });
            f.html(b.html())
        },
        renderEditPreview: function(f, d) {
            var b = this
              , c = $(this.tpl).siblings("#combo-select")
              , g = c.find(".selectlist_js").html("")
              , e = this.componentSetup.selects.length;
            if (null == b.componentSetup.selectIds || 0 == b.componentSetup.selectIds.length) {
                this.componentModel.generatorIds({
                    size: 3
                }, function(a) {
                    b.componentSetup.selectIds = a.generatorIds
                });
                for (var a = b.componentSetup.selectIds, k = 0; k < b.componentSetup.selects.length; k++)
                    b.componentSetup.selects[k].tempId = a[k];
                var h = function(e, c) {
                    e.uid = formPlugin.uid();
                    e.fieldId = a[c];
                    if (null != e.children && 0 < e.children.length)
                        for (var b = 0; b < e.children.length; b++)
                            h(e.children[b], c + 1)
                };
                if (b.componentSetup.options && 0 < b.componentSetup.options.length)
                    for (k = 0; k < b.componentSetup.options.length; k++)
                        h(b.componentSetup.options[k], 0)
            }
            2 == e && g.addClass("two-columns").removeClass("three-columns");
            3 == e && g.addClass("three-columns").removeClass("two-columns");
            for (k = 0; k < e; k++)
                g.append("\x3cselect class\x3d'choicelist form-control combo_select_js' index\x3d'" + (k + 1) + "'\x3e\x3coption value\x3d''\x3e" + (b.componentSetup.selects[k].placeholder ? b.componentSetup.selects[k].placeholder : "\u8bf7\u9009\u62e9") + "\x3c/option\x3e\x3c/select\x3e");
            for (k = 0; k < this.componentSetup.options.length; k++)
                e = this.componentSetup.options[k],
                !e || "true" != e.defOption && 1 != e.defOption || (new Option(e)).render(g, this);
            m.prototype.renderEditPreview.call(this, f, c);
            d ? f.replaceWith(c) : f.append(c)
        },
        renderEditor: function() {
            var f = $(this.tpl).siblings("#editor-combo");
            f.find("input:radio[name\x3d'layout'][value\x3d'choicelist-" + this.componentSetup.layout + "']").attr("checked", "true");
            f.find("input:radio[name\x3d'combotype'][value\x3d'" + this.componentSetup.selects.length + "']").attr("checked", "true");
            for (var d = 0; d < this.componentSetup.selects.length; d++)
                f.find(".placeholder_js[index\x3d'" + d + "']").attr("value", this.componentSetup.selects[d].placeholder ? this.componentSetup.selects[d].placeholder : "\u8bf7\u9009\u62e9");
            3 == this.componentSetup.selects.length ? f.find(".j_comboselect_three").removeClass("hide") : (f.find(".j_comboselect_three").addClass("hide"),
            $("#edit-widget .form-Edit-content .j_comboselect_level .j_level_three").addClass("hide"));
            d = $("#module").val();
            "biaoge" != d && "workflow" != d && (f.find(".j_cancel_template_data").remove(),
            f.find(".j_optDataSource").remove());
            d = "";
            if (this.componentSetup.templateId) {
                this.templateSource || (this.templateSource = []);
                this.templateSource && this.templateSource.template ? d = this.templateSource.template : (d = this.renderTemplateAll(this.componentSetup.templateId),
                this.templateSource.template = d);
                if (d) {
                    var b = d.name;
                    f.find(".j_data_template_name").find(".j_template_name_span").html(b).attr("title", b)
                }
                f.find(".j_combotype").addClass("hide");
                f.find(".j_data_template_name").removeClass("hide");
                f.find(".j_cancel_template").removeClass("hide");
                f.find(".j_comboselect_other").addClass("hide");
                f.find(".j_comboBatcEdit").addClass("hide");
                f.find(".js_other").addClass("hide").css("display", "none")
            }
            m.prototype.renderEditor.call(this, f);
            $("#editor-component").html(f.html());
            $("#editor-component .j_comboselect-tabs").find(".j_comboselect_three").hasClass("hide") ? ($("#editor-component .j_comboselect-tabs").hasClass("comboselect-tab-3") && $("#editor-component .j_comboselect-tabs").addClass("comboselect-tab-3"),
            $("#editor-component .j_comboselect-tabs").addClass("comboselect-tab-2"),
            $("#editor-component .j_comboselect-opt").hasClass("comboselect-opt-3") && $("#editor-component .j_comboselect-opt").addClass("comboselect-opt-3"),
            $("#editor-component .j_comboselect-opt").addClass("comboselect-opt-2")) : ($("#editor-component .j_comboselect-tabs").hasClass("comboselect-tab-2") && $("#editor-component .j_comboselect-tabs").addClass("comboselect-tab-2"),
            $("#editor-component .j_comboselect-tabs").addClass("comboselect-tab-3"),
            $("#editor-component .j_comboselect-opt").hasClass("comboselect-opt-2") && $("#editor-component .j_comboselect-opt").addClass("comboselect-opt-2"),
            $("#editor-component .j_comboselect-opt").addClass("comboselect-opt-3"));
            f = $("#editor-component").find(".combo_ul_js");
            if (this.componentSetup.templateId) {
                if (d && (b = d.name,
                b = d.detailsList,
                null != b)) {
                    for (var c = [], g = function(a, e) {
                        var c = [];
                        if (a && 0 < a.length)
                            for (var b = 0; b < a.length; b++) {
                                var d = a[b]
                                  , f = new Option;
                                f.setName(d.name);
                                f.setOrder(d.order);
                                f.setSelectionId(d.id);
                                f.setIsReadonly(!0);
                                if (e && 0 < e.length)
                                    for (var k = 0; k < e.length; k++)
                                        d.id == e[k] && f.setDefOption(!0);
                                d.children && 0 < d.children.length && f.setChildren(g(d.children));
                                c.push(f.componentSetup)
                            }
                        return c
                    }, e = this.componentSetup.detailDefaultId, d = 0; d < b.length; d++) {
                        var a = b[d]
                          , k = new Option;
                        k.setName(a.name);
                        k.setOrder(a.order);
                        k.setSelectionId(a.id);
                        k.setIsReadonly(!0);
                        if (e && 0 < e.length)
                            for (var h = 0; h < e.length; h++)
                                a.id == e[h] && k.setDefOption(!0);
                        k.setChildren(g(a.children, e));
                        c.push(k.componentSetup);
                        a = new Option(k.componentSetup);
                        a.renderEditor(f, this)
                    }
                    this.componentSetup.dataDetails = c
                }
            } else
                for (d = 0; d < this.componentSetup.options.length; d++)
                    k = this.componentSetup.options[d],
                    a = new Option(k),
                    a.renderEditor(f, this),
                    "true" != k.other && 1 != k.other || $("#editor-component").find(".btn-default_js").parent().hide();
            if (1 == this.componentSetup.required || "true" == this.componentSetup.required)
                $("#edit-widget .form-Edit-content .j_comboselect_level").removeClass("hide"),
                3 == this.componentSetup.selects.length && $("#edit-widget .form-Edit-content .j_comboselect_level .j_level_three").removeClass("hide"),
                $("#edit-widget .form-Edit-content .j_comboselect_level input:radio[value\x3d'" + this.componentSetup.componentLevel + "']").prop("checked", !0);
            this.optionDrag()
            if(f.children('li').length>20) {
                f.children('li:gt(19)').hide();
                $('.j_moreDataSource').show();
            } else {
                $('.j_moreDataSource').hide();
            }

        },
        renderOption: function(f) {
            var d = $("#editor-component").find(".combo_ul_js").html("");
            if (f)
                for (var b = 0; b < f.length; b++)
                    (new Option(f[b])).renderEditor(d, this);
            this.componentSetup.dataDetails = f
        },
        renderTemplateAll: function(f) {
            var d = null
              , b = {};
            var levelNum = this.componentSetup.selects.length || 1;
            b.templateId = f;
            b.detailsLevel = String(levelNum);
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                async: !1,
                url: TEAMS.api.queryDataSourcesByTemplate,
                dataType: "json",
                data: JSON.stringify(b),
                success: function(c) {
                    c.message ? formPlugin.notify(c.message) : d = c.formDataTemplate
                }
            });
            return d
        },
        renderTemplate: function(f) {
            var d = null
              , b = {};
            b.templateId = f;
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                async: !1,
                url: TEAMS.api.queryDataTemplateById,
                dataType: "json",
                data: JSON.stringify(b),
                success: function(c) {
                    d = c.formDataTemplate
                }
            });
            return d
        },
        renderTemplateDetails: function(f) {
            var d = null;
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                async: !1,
                url: TEAMS.api.queryDateDetailsByDetails,
                dataType: "json",
                data: JSON.stringify(f),
                success: function(b) {
                    d = b.templateDetailsList;
                }
            });
            return d
        },
        optionDrag: function() {
            var f = this
              , d = $("#editor-component");
            d.find(".combo_ul_js").mousedown(function() {
                document.activeElement.blur()
            });
            d.find(".combo_ul_js").sortable({
                cursor: "move",
                scroll: !1,
                containment: "#editor-component",
                tolerance: "pointer",
                placeholder: "combo-select-placeholder",
                items: "\x3e.ComboSelect_js",
                update: function(b, c) {
                    c.item.data("update", !0);
                    f.changeOpt(d.find(".choicelistEdit_js"))
                },
                receive: function(b, c) {
                    c.item.data("receive", !0)
                },
                stop: function(b, c) {
                    c.item.data("update") && (c.item.data("update", !1),
                    c.item.data("receive") && c.item.data("receive", !1))
                }
            })
        },
        getAllComboSelectOptions: function(f) {
            var d = []
              , b = this.componentSetup.detailDefaultId;
            if (f && 0 < f.length)
                for (var c = 0; c < f.length; c++) {
                    var g = f[c]
                      , e = new Option;
                    e.setName(g.name);
                    e.setOrder(g.order);
                    e.setSelectionId(g.id);
                    e.setUid(g.id);
                    if (b && 0 < b.length)
                        for (var a = 0; a < b.length; a++)
                            g.id == b[a] && e.setDefOption(!0);
                    g.children && 0 < g.children.length && e.setChildren(this.getAllComboSelectOptions(g.children));
                    d.push(e.componentSetup)
                }
            return d
        },
        renderPreview: function(f, d, b, c) {
            var g = this
              , e = $(g.tpl).siblings("#preview-combo")
              , a = e.find(".selectlist_js").html("")
              , k = this.componentSetup.selects.length;
            2 == k && a.addClass("two-columns").removeClass("three-columns");
            3 == k && a.addClass("three-columns").removeClass("two-columns");
            for (var h = 0; h < k; h++) {
                var r = this.componentSetup.selectIds[h];
                "mobile" == window.systemInfo_form ? a.append("\x3cdiv class\x3d'combo-select-div'\x3e\x3cdiv class\x3d'eui-form-outline'\x3e\x3cselect class\x3d'form-control combo_select_js selectpicker' index\x3d'" + (h + 1) + "' id\x3d'field_" + r + "'\x3e\x3coption value\x3d''\x3e" + (g.componentSetup.selects[h].placeholder ? g.componentSetup.selects[h].placeholder : "\u8bf7\u9009\u62e9") + "\x3c/option\x3e\x3c/select\x3e\x3c/div\x3e\x3cdiv class\x3d'eui-form-outline j_otherchoiceWrap mt-10 hide'\x3e\x3cinput type\x3d'text' placeholder\x3d'\u8bf7\u586b\u5199\u5176\u4ed6\u5185\u5bb9' class\x3d'form-control j_otherchoiceInput'\x3e\x3c/div\x3e\x3c/div\x3e") : a.append("\x3cdiv class\x3d'combo-select-div'\x3e\x3cselect class\x3d'form-control combo_select_js selectpicker' index\x3d'" + (h + 1) + "' id\x3d'field_" + r + "'\x3e\x3coption value\x3d''\x3e" + (g.componentSetup.selects[h].placeholder ? g.componentSetup.selects[h].placeholder : "\u8bf7\u9009\u62e9") + "\x3c/option\x3e\x3c/select\x3e\x3cinput type\x3d'text' style\x3d'display: none;' placeholder\x3d'\u8bf7\u586b\u5199\u5176\u4ed6\u5185\u5bb9' class\x3d'form-control input-otherchoice j_otherchoiceInput'\x3e\x3c/div\x3e")
            }
            k = g.componentSetup.options;
            if (!d && g.componentSetup.templateId) {
                h = {};
                k = g.componentSetup.templateId;
                g.componentSetup.detailDefaultId && 0 < g.componentSetup.detailDefaultId.length && (h.detailDefaultId = g.componentSetup.detailDefaultId);
                h.templateId = g.componentSetup.templateId;
                h.detailsLevel = "1";
                r = [];
                f.hasClass("subtd_js") && (g.isinDataTable = !0);
                if (1 == g.isinDataTable || "true" == g.isinDataTable) {
                    if (c) {
                        var q = $("div[cid\x3d'" + c.dataCid + "']").find("th:eq(" + c.index + ")").data("componentData");
                        q && q.comboselectOption ? r = q.comboselectOption[k] : (q.comboselectOption = [],
                        r = g.renderTemplateDetails(h),
                        q.comboselectOption[k] = r,
                        $("div[cid\x3d'" + c.dataCid + "']").find("th:eq(" + c.index + ")").data("componentData", q))
                    }
                } else
                    g.comboselectOption ? r = g.comboselectOption[k] : (g.comboselectOption = [],
                    r = g.renderTemplateDetails(h),
                    g.comboselectOption[k] = r);
                k = g.getAllComboSelectOptions(r)
            }
            if (k && 0 < k.length)
                for (h = 0; h < k.length; h++)
                    (new Option(k[h])).renderPreview(a, this);
            d && e.find(".check_js .combo_select_js").val("");
            "true" != this.componentSetup.isReadOnly && 1 != this.componentSetup.isReadOnly || e.find(".check_js .combo_select_js").attr("disabled", !0);
            m.prototype.renderPreview.call(this, f, d, b, e);
            b || setTimeout(function() {
                a.find("select").selectpicker({
                    iveSearch: 10 < g.componentSetup.options.length ? !0 : !1,
                    size: 10
                })
            });
            f.append(e);
            this.componentSetup.selects[0].fieldId && this.componentSetup.fieldReads && (d = this.componentSetup.fieldReads[this.componentSetup.selects[0].fieldId],
            "undefined" == typeof d || d || f.children().last().addClass("hide"));
            d = b;
            !b && this.componentSetup.selects[0].fieldId && this.componentSetup.fieldWrites && (b = this.componentSetup.fieldWrites[this.componentSetup.selects[0].fieldId],
            "undefined" == typeof b || b || (d = !0));
            this.readOnly(e, d);
            d && f.children().last().addClass("fieldReadOnly")
        },
        numToCn: function(f) {
            return 0 <= f && 10 > f ? "\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d".charAt(f) : ""
        },
        initOpt: function(f) {
            var d = this.componentSetup.selectIds
              , b = function(e, a, c, f) {
                var g = new Option;
                g.setName(e);
                g.setOrder(a);
                g.setFieldId(d[f]);
                1 < c && (e = [b(e + 1, 0, c - 1, f + 1), b(e + 2, 1, c - 1, f + 1)],
                g.setChildren(e));
                return g.componentSetup
            };
            if (null == this.componentSetup.selects || 0 == this.componentSetup.selects.length) {
                this.componentSetup.selects = [];
                for (var c = 0; c < f; c++) {
                    var g = new Select;
                    g.setTempId(d[c]);
                    g.setOptions([]);
                    this.componentSetup.selects[c] = g.componentSetup
                }
            }
            this.componentSetup.options = [];
            this.componentSetup.options[0] = b("\u9009\u98791", c, f, 0);
            this.componentSetup.options[1] = b("\u9009\u98792", c, f, 0)
        },
        renderOpt: function(f) {
            var d = this.componentSetup.dataDetails
              , b = $("#editor-component")
              , c = b.find(".combo_ul_js").html("");
            f = parseInt(f + "");
            b.find(".choicelistEdit_js select").removeClass("j_comboselect_active");
            !this.componentSetup.templateId && this.componentSetup.options && 0 < this.componentSetup.options.length && (d = this.componentSetup.options,
            b.find(".btn-default_js").parent().show());
            if (0 == f) {
                b.find(".j_comboselect_one").addClass("hide");
                b.find(".j_comboselect_two").addClass("hide");
                for (var g = 0; g < d.length; g++) {
                    var e = new Option(d[g]);
                    e.renderEditor(c, this);
                    "true" != d[g].other && 1 != d[g].other || b.find(".btn-default_js").parent().hide()
                }
            }
            if (1 == f) {
                b.find(".j_comboselect_one").removeClass("hide");
                b.find(".j_comboselect_two").addClass("hide");
                e = b.find(".j_comboselect_one").find("select").html("").addClass("j_comboselect_active");
                for (g = 0; g < d.length; g++)
                    "false" != d[g].other && 0 != d[g].other || e.append($("\x3coption\x3e" + d[g].name + "\x3c/option\x3e").data("option", d[g]));
                for (g = 0; g < d[0].children.length; g++)
                    e = new Option(d[0].children[g]),
                    e.renderEditor(c, this),
                    "true" != e.componentSetup.other && 1 != e.componentSetup.other || b.find(".btn-default_js").parent().hide()
            }
            if (2 == f) {
                b.find(".j_comboselect_one").removeClass("hide");
                b.find(".j_comboselect_two").removeClass("hide");
                f = b.find(".j_comboselect_one").find("select").html("");
                for (g = 0; g < d.length; g++)
                    "false" != d[g].other && 0 != d[g].other || f.append($("\x3coption\x3e" + d[g].name + "\x3c/option\x3e").data("option", d[g]));
                f = b.find(".j_comboselect_two").find("select").html("").addClass("j_comboselect_active");
                for (g = 0; g < d[0].children.length; g++)
                    e = d[0].children[g],
                    "false" != e.other && 0 != e.other || f.append($("\x3coption\x3e" + e.name + "\x3c/option\x3e").data("option", e));
                for (g = 0; g < d[0].children[0].children.length; g++)
                    e = new Option(d[0].children[0].children[g]),
                    e.renderEditor(c, this),
                    "true" != e.componentSetup.other && 1 != e.componentSetup.other || b.find(".btn-default_js").parent().hide()
            }
        },
        changeDefault: function(f) {
            var d = f.prop("checked")
              , b = f.closest("li").data("option")
              , c = this.componentSetup.dataDetails;
            !this.componentSetup.templateId && this.componentSetup.options && 0 < this.componentSetup.options.length && (c = this.componentSetup.options);
            var g = function(a) {
                for (var e = 0; e < a.length; e++) {
                    var c = a[e];
                    c.defOption = !1;
                    null != c.children && 0 < c.children.length && g(c.children)
                }
            };
            d ? (f.closest(".ComboSelect_js").siblings().find(".combo_option_js").prop("checked", !1),
            g(c),
            $("#editor-component").find(".choicelistEdit_js select:visible").find("option:selected").each(function() {
                $(this).data("option").defOption = !0
            })) : (b.defOption = !1,
            b.children && 0 < b.children.length && g(b.children));
            this.changeOpt($("#editor-component").find(".choicelistEdit_js"));
            var e = $("#widget-control .field-active").find(".selectlist_js");
            e.find("select").find("option:gt(0)").remove();
            for (var a = [], k = function(e) {
                for (var c = 0; c < e.length; c++) {
                    var b = e[c];
                    !b || "true" != b.defOption && 1 != b.defOption || a.push(b.selectionId);
                    null != b.children && 0 < b.children.length && k(b.children)
                }
            }, h = 0; h < c.length; h++) {
                var m = c[h];
                "0" == $("#editor-component").find(".j_comboselect-tabs").find(".active").attr("index") && this.componentSetup.templateId && m.selectionId == f.val() && (m.defOption = d);
                !m || "true" != m.defOption && 1 != m.defOption || (b = new Option(m),
                this.componentSetup.templateId && (a.push(m.selectionId),
                k(m.children)),
                b.render(e, this))
            }
            this.componentSetup.templateId && this.setDetailDefaultId(a)
        },
        changeOpt: function(f) {
            var d = this.componentSetup.selectIds[parseInt($(".j_comboselect-tabs .active").attr("index"))]
              , b = [];
            f.find(".combo_ul_js li").each(function(c) {
                var e = $(this)
                  , a = e.data("option")
                  , a = new Option(a);
                if (e.hasClass("otherOption_js"))
                    a.setFieldId(d),
                    a.setName("\u5176\u4ed6"),
                    a.setOrder(c),
                    a.setSelectionId(""),
                    a.setOther(!0);
                else {
                    var f = e.find(".combo_optionName_js").val().trim();
                    if (!f)
                        return !0;
                    a.setName(f);
                    a.setOrder(c);
                    a.setFieldId(d);
                    a.setSelectionId(e.children(".combo_option_js").val());
                    a.setDefOption(e.children(".combo_option_js").is(":checked"))
                }
                b.push(a.componentSetup)
            });
            if (0 < f.find(".j_comboselect_active").length) {
                var c = $(".j_comboselect-tabs").find(".j_comboselect_tab.active").attr("index");
                c && "2" == c ? f.find(".j_comboselect_active:last").find("option:selected").data("option").children = b : f.find(".j_comboselect_active").find("option:selected").data("option").children = b
            } else
                this.componentSetup.options = b
        },
        renderType: function(f, d) {
            var b = $("#editor-component");
            b.find(".j_comboBatcOther input").prop("checked", !1);
            3 == f ? (b.find(".j_comboselect_three").removeClass("hide"),
            $(".j_comboselect-tabs").hasClass("comboselect-tab-2") && $(".j_comboselect-tabs").removeClass("comboselect-tab-2"),
            $(".j_comboselect-tabs").addClass("comboselect-tab-3"),
            $(".j_comboselect-opt").hasClass("comboselect-opt-2") && $(".j_comboselect-opt").removeClass("comboselect-opt-2"),
            $(".j_comboselect-opt").addClass("comboselect-opt-3"),
            b.find(".j_level_three").removeClass("hide")) : (b.find(".j_comboselect_three").addClass("hide"),
            $(".j_comboselect-tabs").hasClass("comboselect-tab-3") && $(".j_comboselect-tabs").removeClass("comboselect-tab-3"),
            $(".j_comboselect-tabs").addClass("comboselect-tab-2"),
            $(".j_comboselect-opt").hasClass("comboselect-opt-3") && $(".j_comboselect-opt").removeClass("comboselect-opt-3"),
            $(".j_comboselect-opt").addClass("comboselect-opt-2"),
            b.find(".j_level_three").addClass("hide"),
            b.find(".j_comboselect_level input:radio[value\x3d'1']").prop("checked", !0),
            this.setComponentLevel("1"));
            2 == f && 3 == this.componentSetup.selects.length && (this.componentSetup.selects = this.componentSetup.selects.slice(0, 2));
            if (3 == f && 2 == this.componentSetup.selects.length) {
                var c = new Select;
                c.setOptions([]);
                c.componentSetup.tempId = this.componentSetup.selectIds[2];
                this.componentSetup.selects.push(c.componentSetup)
            }
            var c = $("#widget-control").find(".field-active").find(".selectlist_js").html("")
              , g = this.componentSetup.selects.length;
            2 == g && c.addClass("two-columns").removeClass("three-columns");
            3 == g && c.addClass("three-columns").removeClass("two-columns");
            for (var e = 0; e < g; e++)
                c.append("\x3cselect class\x3d'choicelist form-control combo_select_js' index\x3d'" + (e + 1) + "'\x3e\x3coption value\x3d''\x3e" + (this.componentSetup.selects[e].placeholder ? this.componentSetup.selects[e].placeholder : "\u8bf7\u9009\u62e9") + "\x3c/option\x3e\x3c/select\x3e");
            0 != d && "false" != d && this.initOpt(f);
            b.find(".j_comboselect_tab:first").click()
        },
        renderStatSearch: function(f) {
            var d = this
              , b = $(this.tpl)
              , c = f.parentEl
              , g = f.fieldId
              , e = f.subFormId
              , a = f.fieldTitle
              , k = f.layoutDetail
              , h = f.filterEl
              , m = f.ids
              , q = f.term
              , p = f.condition
              , w = f.module
              , n = null;
            if ("mobile" != window.systemInfo_form) {
                var s = ""
                  , p = [];
                if (k && 0 < k.length && (s = JSON.parse(k),
                s = s.templateId)) {
                    var A = {};
                    A.templateId = s;
                    A.detailsLevel = "1";
                    d.comboselectOption ? (p = d.comboselectOption[s],
                    p || (p = x.renderTemplateDetails(A),
                    d.comboselectOption[s] = p)) : (d.comboselectOption = [],
                    p = d.renderTemplateDetails(A),
                    d.comboselectOption[s] = p)
                }
                n = b.siblings("#statsearch-entity");
                (new Date).getTime();
                null != k && 0 != k.length || this.componentModel.findFieldLayoutDetail({
                    fieldId: g,
                    fieldType: "Complex",
                    module: w
                }, function(a) {
                    k = a.layoutDetail
                });
                if (k) {
                    for (var x = JSON.parse(k), A = x.selects, g = n.find(".selectlist_js"), w = 0; w < A.length; w++)
                        e = b.siblings(".j_filter-box").clone(),
                        f = A[w],
                        e.attr("index", w),
                        e.attr("id", f.fieldId),
                        g.append(e);
                    s && (x.options = p);
                    for (w = 0; w < x.options.length; w++)
                        b = x.options[w],
                        e = g.find(".combo_select_js[index\x3d'0']").children("ul"),
                        p = $("\x3cli\x3e\x3ca\x3e\x3c/a\x3e\x3c/li\x3e"),
                        p.children("a").text(b.name),
                        p.attr("selectionId", b.selectionId || b.id),
                        p.attr("title", b.name),
                        p.data("option", b),
                        x.templateId && p.attr("templateId", x.templateId),
                        e.append(p);
                    c.find(".j_formField-condition").html(n);
                    c.attr("class", "sch-group j_formFieldSearchGroup");
                    c.find(".combo_select_js").mCustomScrollbar({
                        axis: "y",
                        theme: "darkblue",
                        scrollButtons: {
                            enable: !0
                        },
                        advanced: {
                            autoExpandHorizontalScroll: !0
                        }
                    });
                    q && c.find(".j_formField-condition select:first option[value\x3d" + q + "]").attr("selected", "true");
                    if (m && 0 < m.length)
                        for (w = 0; w < m.length; w++)
                            for (x = m[w],
                            g = 0; g < x.ids.length; g++)
                                e = x.ids[g],
                                e = '\x3cspan name\x3d"js_entity_item" class\x3d"js_entity_item employee-item j_component entity-item"\x3e\x3ca class\x3d"entitybox-toggle" data-id\x3d' + e.id + ' id\x3d"' + e.id + '" selectId\x3d"' + x.fieldId + '" title\x3d"' + e.text + '"\x3e' + e.text + "\x3c/a\x3e\x3c/span\x3e",
                                c.find(".j_formField-condition .entity-container").append(e);
                    c.off("click", ".combo_select_js li").on("click", ".combo_select_js li", function() {
                        var a = $(this)
                          , e = a.data("option")
                          , b = a.closest(".combo_select_js").index();
                        a.addClass("active").siblings().removeClass("active");
                        c.find(".combo_select_js:gt(" + b + ")").find("ul").html("");
                        var f = [];
                        a.attr("templateid") && (d.comboselectOption || (d.comboselectOption = []),
                        a = e.id,
                        d.comboselectOption[a] ? selectOptions = d.comboselectOption[a] : (f = {},
                        f.parentId = a,
                        f.templateId = e.templateId,
                        f = d.renderTemplateDetails(f),
                        d.comboselectOption[a] = f,
                        e.children = f));
                        if (e)
                            for (b = c.find(".combo_select_js:eq(" + (b + 1) + ")").find("ul"),
                            f = 0; f < e.children.length; f++) {
                                var a = e.children[f]
                                  , g = $("\x3cli\x3e\x3ca\x3e\x3c/a\x3e\x3c/li\x3e");
                                g.children("a").text(a.name);
                                g.attr("selectionId", a.selectionId || a.id);
                                g.attr("title", a.name);
                                g.data("option", a);
                                e.templateId && g.attr("templateId", e.templateId);
                                b.append(g)
                            }
                    });
                    c.off("click", ".j_add-btn").on("click", ".j_add-btn", function(a) {
                        $(this).parent().toggleClass("open")
                    })
                }
            } else {
                n = b.siblings("#statsearch-comboselect-mobile");
                p && (n.find(".j_condition").find('option[value\x3d"' + p + '"]').attr("selected", !0),
                "null" != p && "notnull" != p || n.find(".j_control").hide());
                h && (n.find("#seleted-list").empty(),
                h.find(".j_filterList .selectd #comp-val span").each(function() {
                    var a = $(this).attr("optionId")
                      , e = $(this).text()
                      , c = $(this).attr("selectId")
                      , b = $("\x3cspan\x3e\x3c/span\x3e");
                    b.attr("optionId", a).text(e).attr("selFieldId", c).addClass("lastSel");
                    n.find("#seleted-list").append(b)
                }));
                null != k && 0 != k.length || this.componentModel.findFieldLayoutDetail({
                    fieldId: g,
                    fieldType: "Complex",
                    module: w
                }, function(a) {
                    k = a.layoutDetail
                });
                if (k) {
                    x = JSON.parse(k);
                    A = x.selects;
                    for (w = 0; w < A.length; w++)
                        f = A[w],
                        n.find(".j_level" + w).find(".j_Ul" + w).attr("index", w).attr("id", f.fieldId);
                    s = "";
                    p = [];
                    k && 0 < k.length && (s = JSON.parse(k),
                    s = s.templateId) && (A = {},
                    A.templateId = s,
                    A.detailsLevel = "1",
                    d.comboselectOption ? (p = d.comboselectOption[s],
                    p || (p = x.renderTemplateDetails(A),
                    d.comboselectOption[s] = p)) : (d.comboselectOption = [],
                    p = d.renderTemplateDetails(A),
                    d.comboselectOption[s] = p));
                    s && (x.options = p);
                    f = x.options;
                    m = n.find(".j_nav-box");
                    A = n.find(".j_level0 .j_Ul0");
                    s && (x.options = p);
                    for (w = 0; w < f.length; w++)
                        b = f[w],
                        p = $("\x3cli\x3e\x3c/li\x3e"),
                        p.text(b.name),
                        p.attr("value", b.selectionId || b.id),
                        p.attr("title", b.name),
                        p.data("option", b),
                        x.templateId && p.attr("templateId", x.templateId),
                        A.append(p);
                    x = n.find(".j_selected").height();
                    x = $(window).height() - x - 81;
                    m.css("height", x)
                }
                c.find("#component-div").html(n);
                c.find(".j_comp-ok").attr("comKey", "ComboSelect").attr("fieldId", g).attr("title", a).attr("subFormId", e);
                c.off("change", "#statsearch-comboselect-mobile .j_condition").on("change", "#statsearch-comboselect-mobile .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? c.find("#statsearch-comboselect-mobile .j_control").hide() : c.find("#statsearch-comboselect-mobile .j_control").show()
                });
                c.off("tap", "#statsearch-comboselect-mobile .j_selectlist li").on("tap", "#statsearch-comboselect-mobile .j_selectlist li", function(a, e) {
                    var c = $(this)
                      , b = n.find(".j_selectlist")
                      , f = c.data("option")
                      , g = $("\x3cspan\x3e\x3c/span\x3e");
                    g.attr("optionId", f.selectionId || f.id);
                    g.attr("selFieldId", f.fieldId || c.parent().attr("id"));
                    g.text(f.name);
                    if (null == e || "" == e)
                        if (h) {
                            var k = f.selectionId;
                            k || (k = f.id);
                            0 < b.find(".j_selected").find('span[optionId\x3d"' + k + '"]').length ? b.find(".j_selected").find('span[optionId\x3d"' + k + '"]').remove() : (b.find('.j_selected span:not([class\x3d"lastSel"])').remove(),
                            b.find(".j_selected").append(g))
                        } else
                            b.find(".j_selected").empty().append(g);
                    g = c.closest("ul").attr("index");
                    g = parseInt(g);
                    c.addClass("active").siblings().removeClass("active");
                    b.find(".j_selectUl:gt(" + g + ")").html("");
                    k = [];
                    c.attr("templateid") && (d.comboselectOption || (d.comboselectOption = []),
                    c = f.id,
                    d.comboselectOption[c] ? selectOptions = d.comboselectOption[c] : (k = {},
                    k.parentId = c,
                    k.templateId = f.templateId,
                    k = d.renderTemplateDetails(k),
                    d.comboselectOption[c] = k,
                    f.children = k));
                    if (f)
                        for (c = parseInt(g + 1),
                        b = b.find('.j_selectUl[index\x3d"' + c + '"]'),
                        c = 0; c < f.children.length; c++)
                            g = f.children[c],
                            k = $("\x3cli\x3e\x3c/li\x3e"),
                            k.text(g.name),
                            k.attr("value", g.selectionId || f.id),
                            k.attr("title", g.name),
                            k.data("option", g),
                            f.templateId && k.attr("templateId", f.templateId),
                            b.append(k)
                });
                0 < A.find("li").length && (c.find("#statsearch-comboselect-mobile .j_Ul0 li:eq(0)").trigger("tap", "init"),
                0 < n.find(".j_Ul1 li").length && c.find("#statsearch-comboselect-mobile .j_Ul1 li:eq(0)").trigger("tap", "init"));
                0 < c.find("#statsearch-comboselect-mobile .j_level2 .j_Ul2 li").length ? c.find("#statsearch-comboselect-mobile .j_selectlist").addClass("filtrate-dropdown-more") : c.find("#statsearch-comboselect-mobile .j_selectlist").removeClass("filtrate-dropdown-more")
            }
        },
        layoutCheck: function() {
            var f = this.checkOptionName(this.componentSetup.options);
            if (1 == f || "true" == f)
                throw formPlugin.notify("\u9009\u9879\u540d\u79f0\u5b58\u5728\u91cd\u590d"),
                $("#widget-control").find(".field_js").removeClass("field-active"),
                $("#widget-control").find('.field_js[componentKey\x3d"' + this.componentSetup.componentKey + '"][tempId\x3d"' + this.componentSetup.tempId + '"]').addClass("field-active"),
                $("#formEdit_js").find("#edit-form").addClass("hide"),
                $("#formEdit_js").find("#edit-widget").removeClass("hide"),
                this.renderEditor(),
                Error();
        },
        checkOptionName: function(f) {
            for (var d = !1, b = [], c = f.length - 1; 0 <= c; c--) {
                var g = f[c];
                "" == g.name.trim() || null == g.name ? f.remove(g) : b.push(g.name.trim())
            }
            for (c = 0; c < f.length; c++)
                g = f[c],
                g.order = c;
            g = b.sort();
            for (c = 0; c < g.length; c++)
                if (g[c] == g[c + 1])
                    return d = !0;
            for (c = 0; c < f.length; c++)
                if (g = f[c],
                g.children && 0 < g.children.length) {
                    for (var e = [], a = 0; a < g.children.length; a++) {
                        var k = g.children[a];
                        "" != k.name.trim() && "\u5176\u4ed6" != k.name.trim() && e.push(k.name.trim())
                    }
                    a = e.sort();
                    for (b = 0; b < a.length; b++)
                        if (a[b] == a[b + 1])
                            return d = !0;
                    if (0 < e.length)
                        for (a = g.children.length - 1; 0 <= a; a--)
                            k = g.children[a],
                            "" == k.name.trim() && g.children.remove(k);
                    else
                        for (e = !1,
                        a = g.children.length - 1; 0 <= a; a--)
                            k = g.children[a],
                            "" == k.name.trim() && (e ? g.children.remove(k) : e = !0)
                }
            for (c = 0; c < f.length; c++)
                if (g = f[c],
                g.children && 0 < g.children.length)
                    for (a = 0; a < g.children.length; a++)
                        if (k = g.children[a],
                        k.children && 0 < k.children.length) {
                            e = [];
                            for (b = 0; b < k.children.length; b++)
                                "" != k.children[b].name.trim() && "\u5176\u4ed6" != k.children[b].name.trim() && e.push(k.children[b].name.trim());
                            for (var h = e.sort(), b = 0; b < h.length; b++)
                                if (h[b] == h[b + 1])
                                    return d = !0;
                            if (0 < e.length)
                                for (b = k.children.length - 1; 0 <= b; b--)
                                    "" == k.children[b].name.trim() && k.children.remove(k.children[b]);
                            else
                                for (e = !1,
                                b = k.children.length - 1; 0 <= b; b--)
                                    "" == k.children[b].name.trim() && (e ? k.children.remove(k.children[b]) : e = !0)
                        }
            return d
        },
        batchEditorOther: function(f) {
            var d = f.is(":checked");
            f = f.val();
            var b = this.componentSetup.options
              , c = this.componentSetup.selectIds;
            if (d) {
                1 == f && "true" != b[b.length - 1].other && 1 != b[b.length - 1].other && (d = new Option,
                d.setName("\u5176\u4ed6"),
                d.setOther(!0),
                d.setFieldId(c[0]),
                b.push(d.componentSetup));
                if (2 == f)
                    for (var g = 0; g < b.length; g++)
                        if (d = b[g],
                        "false" == d.other || 0 == d.other) {
                            var e = d.children;
                            "true" != e[e.length - 1].other && 1 != e[e.length - 1].other && (d = new Option,
                            d.setName("\u5176\u4ed6"),
                            d.setOther(!0),
                            d.setFieldId(c[1]),
                            e.push(d.componentSetup))
                        }
                if (3 == f)
                    for (g = 0; g < b.length; g++)
                        if (d = b[g],
                        "false" == d.other || 0 == d.other)
                            for (var e = d.children, a = 0; a < e.length; a++)
                                if ("false" == e[a].other || 0 == e[a].other) {
                                    var k = e[a].children;
                                    "true" != k[k.length - 1].other && 1 != k[k.length - 1].other && (d = new Option,
                                    d.setName("\u5176\u4ed6"),
                                    d.setOther(!0),
                                    d.setFieldId(c[2]),
                                    k.push(d.componentSetup))
                                }
            } else {
                1 == f && ("true" != b[b.length - 1].other && 1 != b[b.length - 1].other || b.pop());
                if (2 == f)
                    for (g = 0; g < b.length; g++)
                        if (d = b[g],
                        "false" == d.other || 0 == d.other)
                            e = d.children,
                            "true" != e[e.length - 1].other && 1 != e[e.length - 1].other || e.pop();
                if (3 == f)
                    for (g = 0; g < b.length; g++)
                        if (d = b[g],
                        "false" == d.other || 0 == d.other)
                            for (e = d.children,
                            a = 0; a < e.length; a++)
                                if ("false" == e[a].other || 0 == e[a].other)
                                    k = e[a].children,
                                    "true" != k[k.length - 1].other && 1 != k[k.length - 1].other || k.pop()
            }
            1 == f && "0" == $("#editor-component .j_comboselect-tabs .active").attr("index") ? $("#editor-component .j_comboselect-tabs .active").click() : $("#editor-component .j_comboselect_active").change()
        },
        checkEvents: function(f, d) {
            var b = this
              , c = b.el || $(document)
              , c = b.componentSetup.fieldId ? c.find("div[id\x3d'" + b.componentSetup.fieldId + "'][cid\x3d'" + b.cid + "']") : c.find("div[cid\x3d'" + b.cid + "']");
            if (b.componentSetup.templateId)
                c.on("show.bs.dropdown", ".bootstrap-select", function() {
                    var c = {}
                      , e = []
                      , a = b.componentSetup.templateId
                      , e = $(this).parent().index();
                    if (!$(this).attr("isFirst")) {
                        $(this).attr("isFirst", "isFirst");
                        if (0 == e)
                            if (c.templateId = a,
                            c.detailsLevel = "1",
                            1 == b.isinDataTable || "true" == b.isinDataTable) {
                                var e = $(this).parents(".subtd_js").index()
                                  , d = $(this).parents(".subtr_js").siblings().first().find("th:eq(" + e + ")").data("componentData");
                                d && d.comboselectOption ? (e = d.comboselectOption[a],
                                e || (e = b.renderTemplateDetails(c),
                                d.comboselectOption[a] = e,
                                $(this).parents(".subtr_js").siblings().first().find("th:eq(0)").data("componentData", d))) : (d.comboselectOption = [],
                                e = b.renderTemplateDetails(c),
                                d.comboselectOption[a] = e,
                                $(this).parents(".subtr_js").siblings().first().find("th:eq(0)").data("componentData", d))
                            } else
                                b.comboselectOption ? (e = b.comboselectOption[f],
                                e || (e = b.renderTemplateDetails(c),
                                b.comboselectOption[a] = e)) : (b.comboselectOption = [],
                                e = b.renderTemplateDetails(c),
                                b.comboselectOption[a] = e);
                        else {
                            var f = $(this).parent().prev().find(".combo_select_js").find("option:selected").val();
                            c.parentId = f,
                            c.templateId = a;
                            if (!f)
                                return;
                            1 == b.isinDataTable || "true" == b.isinDataTable ? (e = $(this).parents(".subtd_js").index(),
                            (d = $(this).parents(".subtr_js").siblings().first().find("th:eq(" + e + ")").data("componentData")) && d.comboselectOption ? (e = d.comboselectOption[f],
                            e || (e = b.renderTemplateDetails(c),
                            d.comboselectOption[f] = e,
                            $(this).parents(".subtr_js").siblings().first().find("th:eq(0)").data("componentData", d))) : (d.comboselectOption = [],
                            e = b.renderTemplateDetails(c),
                            d.comboselectOption[f] = e,
                            $(this).parents(".subtr_js").siblings().first().find("th:eq(0)").data("componentData", d))) : b.comboselectOption ? (e = b.comboselectOption[f],
                            e || (e = b.renderTemplateDetails(c),
                            b.comboselectOption[f] = e)) : (b.comboselectOption = [],
                            e = b.renderTemplateDetails(c),
                            b.comboselectOption[f] = e)
                        }
                        if (e && 0 < e.length) {
                            c = b.getAllComboSelectOptions(e);
                            for (a = 0; a < c.length; a++)
                                f = c[a],
                                1 > $(this).find(".combo_select_js").find("option[value\x3d'" + f.selectionId + "']").length && (e = $("\x3coption class\x3d'ComboSelect_js' value\x3d''\x3e\x3c/option\x3e"),
                                e.text(f.name),
                                e.attr("value", f.selectionId),
                                e.attr("uid", f.uid),
                                e.data("option", f),
                                $(this).find(".combo_select_js").append(e));
                            $(this).find(".combo_select_js").selectpicker("refresh")
                        }
                    }
                });
            c.on("change", ".combo_select_js", function(g, e) {
                var a = $(this)
                  , h = $(this).find("option:selected").data("option")
                  , m = $(this).attr("index");
                c.find(".combo_select_js").each(function() {
                    var a = $(this);
                    a.attr("index") > m && (a.html("\x3coption value\x3d''\x3e" + (b.componentSetup.selects[parseInt(a.attr("index")) - 1].placeholder ? b.componentSetup.selects[parseInt(a.attr("index")) - 1].placeholder : "\u8bf7\u9009\u62e9") + "\x3c/option\x3e").selectpicker("refresh"),
                    a.closest(".bootstrap-select").next().hide())
                });
                if (b.componentSetup.templateId && h && 1 > h.children.length) {
                    var r = h.selectionId;
                    e = {};
                    e.parentId = r;
                    e.templateId = b.componentSetup.templateId;
                    var q = []
                      , p = [];
                    if (1 == b.isinDataTable || "true" == b.isinDataTable) {
                        var q = $(this).parents(".subtd_js").index()
                          , w = $(this).parents(".subtr_js").siblings().first().find("th:eq(" + q + ")").data("componentData");
                        w && w.comboselectOption ? (p = w.comboselectOption[r],
                        p || (p = b.renderTemplateDetails(e),
                        w.comboselectOption[r] = p,
                        $(this).parents(".subtr_js").siblings().first().find("th:eq(0)").data("componentData", w)),
                        q = b.getAllComboSelectOptions(p),
                        h.children = q) : (w.comboselectOption = [],
                        p = b.renderTemplateDetails(e),
                        q = b.getAllComboSelectOptions(p),
                        w.comboselectOption[r] = p,
                        h.children = q,
                        $(this).parents(".subtr_js").siblings().first().find("th:eq(0)").data("componentData", w))
                    } else
                        b.comboselectOption ? (p = b.comboselectOption[r],
                        p || (p = b.renderTemplateDetails(e),
                        b.comboselectOption[r] = p),
                        q = b.getAllComboSelectOptions(p)) : (b.comboselectOption = [],
                        p = b.renderTemplateDetails(e),
                        q = b.getAllComboSelectOptions(p),
                        b.comboselectOption[r] = p),
                        h.children = q
                }
                r = b.isMobileForm ? ".j_otherchoiceWrap" : ".j_otherchoiceInput";
                if (h) {
                    if ("true" == h.other || 1 == h.other)
                        $(this).parents(".combo-select-div").find(".j_otherchoiceInput").attr("disabled", !1),
                        $(this).parents(".combo-select-div").find(r).show();
                    else {
                        $(this).parents(".combo-select-div").find(".j_otherchoiceInput").attr("disabled", !0);
                        $(this).parents(".combo-select-div").find(r).hide();
                        for (var n = c.find(".combo_select_js[index\x3d'" + (Number(m) + 1) + "']"), r = 0; r < h.children.length; r++)
                            q = h.children[r],
                            p = $("\x3coption class\x3d'ComboSelect_js' value\x3d''\x3e\x3c/option\x3e"),
                            p.text(q.name),
                            p.attr("value", q.selectionId),
                            p.attr("uid", q.uid),
                            p.data("option", q),
                            n.append(p),
                            n.selectpicker("refresh")
                    }
                    formPlugin.sensitiveWordsPage(n)
                } else
                    $(this).parents(".combo-select-div").find(".j_otherchoiceInput").attr("disabled", !0),
                    $(this).parents(".combo-select-div").find(r).hide();
                e && 0 == e.isCheck || d || (a = b.check(a.closest(".check_js")),
                f(a))
            })
        },
        autoSaveEvents: function(f) {
            var d = this
              , b = d.el || $(document);
            b.on("change", "#" + d.componentSetup.fieldId + "[cid\x3d'" + d.cid + "'] select", function(c) {
                if (c.isTrigger)
                    return !0;
                d.saveComponentValue($(this), f)
            });
            b.on("change", "#" + d.componentSetup.fieldId + "[cid\x3d'" + d.cid + "'] input:text", function(c) {
                d.saveComponentValue($(this), f)
            })
        },
        check: function(f) {
            var d = !1;
            f.find(".combo_select_js");
            var b = 0;
            f.find(".combo_select_js").each(function() {
                $(this).val() && b++
            });
            var d = b >= (this.componentSetup.componentLevel ? this.componentSetup.componentLevel : 1) ? !0 : !1
              , c = {};
            c.element = f;
            d || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (c.message = 0 == b ? this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a" : 1 == b ? this.componentSetup.title + "\u7b2c\u4e8c\u7ea7\u4e0d\u80fd\u4e3a\u7a7a" : this.componentSetup.title + "\u7b2c\u4e09\u7ea7\u4e0d\u80fd\u4e3a\u7a7a");
            return c
        },
        getValue: function(f, d) {
            for (var b = [], c = "", g = 0; g < this.componentSetup.selects.length; g++) {
                var e = this.componentSetup.selects[g]
                  , a = f.find(".combo_select_js:eq(" + g + ")")
                  , h = a.val()
                  , m = f.find(".combo_select_js:eq(" + g + ")").find("option:selected").data("option")
                  , r = "";
                m && (r = m.name,
                "true" == m.other || 1 == m.other) && ((r = a.parents(".combo-select-div").find(".j_otherchoiceInput").val()) && 0 != r.length || (r = "\u5176\u4ed6"));
                e = {
                    formField: {
                        id: e.fieldId
                    }
                };
                h && (e.dataOptions = [{
                    optionId: h,
                    content: r
                }]);
                c += h;
                b.push(e)
            }
            return null != c && "" != $.trim(c) || d ? b : null
        },
        setValue: function(f, d) {
            if (this.componentSetup.fieldId) {
                var b = this;
                f = f.closest(".field_js");
                if (null != d && null != d.dataOptions)
                    for (var c = 0; c < d.dataOptions.length; c++) {
                        var g = d.dataOptions[c]
                          , e = g.optionId
                          , a = f.find("#field_" + d.formField.id);
                        if (b.componentSetup.templateId) {
                            var h = {}
                              , m = []
                              , r = b.componentSetup.templateId;
                            if (1 == a.attr("index"))
                                if (h.templateId = r,
                                h.detailsLevel = "1",
                                1 == this.isinDataTable || "true" == this.isinDataTable) {
                                    var m = a.parents(".subtd_js").index()
                                      , q = a.parents(".subtr_js").siblings().first().find("th:eq(" + m + ")").data("componentData");
                                    q && q.comboselectOption ? (m = q.comboselectOption[r],
                                    m || (m = this.renderTemplateDetails(h),
                                    q.comboselectOption[r] = m,
                                    a.parents(".subtr_js").siblings().first().find("th:eq(0)").data("componentData", q))) : (q.comboselectOption = [],
                                    m = this.renderTemplateDetails(h),
                                    q.comboselectOption[r] = m,
                                    a.parents(".subtr_js").siblings().first().find("th:eq(0)").data("componentData", q))
                                } else
                                    this.comboselectOption ? (m = this.comboselectOption[r],
                                    m || (m = this.renderTemplateDetails(h),
                                    this.comboselectOption[r] = m)) : (this.comboselectOption = [],
                                    m = this.renderTemplateDetails(h),
                                    this.comboselectOption[r] = m);
                            else {
                                r = a.parents(".combo-select-div").prev().find(".combo_select_js").find("option:selected").val();
                                h.parentId = r;
                                h.templateId = b.componentSetup.templateId;
                                if (!r)
                                    break;
                                1 == this.isinDataTable || "true" == this.isinDataTable ? (m = a.parents(".subtd_js").index(),
                                (q = a.parents(".subtr_js").siblings().first().find("th:eq(" + m + ")").data("componentData")) && q.comboselectOption ? (m = q.comboselectOption[r],
                                m || (m = this.renderTemplateDetails(h),
                                q.comboselectOption[r] = m,
                                a.parents(".subtr_js").siblings().first().find("th:eq(0)").data("componentData", q))) : (q.comboselectOption = [],
                                m = this.renderTemplateDetails(h),
                                q.comboselectOption[r] = m,
                                a.parents(".subtr_js").siblings().first().find("th:eq(0)").data("componentData", q))) : this.comboselectOption ? (m = this.comboselectOption[r],
                                m || (m = this.renderTemplateDetails(h),
                                this.comboselectOption[r] = m)) : (this.comboselectOption = [],
                                m = this.renderTemplateDetails(h),
                                this.comboselectOption[r] = m)
                            }
                            if (m && 0 < m.length) {
                                r = this.getAllComboSelectOptions(m);
                                for (c = 0; c < r.length; c++)
                                    h = r[c],
                                    m = $("\x3coption class\x3d'ComboSelect_js' value\x3d''\x3e\x3c/option\x3e"),
                                    m.text(h.name),
                                    m.attr("value", h.selectionId),
                                    m.attr("uid", h.uid),
                                    m.data("option", h),
                                    a.append(m);
                                a.selectpicker("refresh")
                            }
                        }
                        d.isMacthByName ? a.find("option").filter(function() {
                            return $(this).text() == g.content
                        }).prop("selected", !0) : a.val(e);
                        var e = (r = a.find("option:selected").data("option")) ? r.name : ""
                          , p = a.attr("index");
                        f.find(".combo_select_js").each(function() {
                            var a = $(this);
                            a.attr("index") > p && a.html("\x3coption value\x3d''\x3e" + (b.componentSetup.selects[parseInt(a.attr("index")) - 1].placeholder ? b.componentSetup.selects[parseInt(a.attr("index")) - 1].placeholder : "\u8bf7\u9009\u62e9") + "\x3c/option\x3e")
                        });
                        if (r) {
                            q = f.find(".combo_select_js[index\x3d'" + (Number(p) + 1) + "']");
                            for (c = 0; c < r.children.length; c++)
                                h = r.children[c],
                                m = $("\x3coption value\x3d''\x3e\x3c/option\x3e"),
                                m.text(h.name),
                                m.attr("value", h.selectionId),
                                m.data("option", h),
                                m.attr("uid", h.uid),
                                q.append(m);
                            h = r.other;
                            m = this.isMobileForm ? ".j_otherchoiceWrap" : ".j_otherchoiceInput";
                            if ("true" == h || 1 == h)
                                a.parents(".combo-select-div").find(".j_otherchoiceInput").val(g.content),
                                a.parents(".combo-select-div").find(m).show(),
                                e = g.content
                        }
                        f.find(".combo_select_js").first().data("selectpicker") && setTimeout(function() {
                            f.find(".combo_select_js").selectpicker("refresh")
                        });
                        "" == f.find(".j_readOnly").html() ? f.find(".j_readOnly").html(e) : f.find(".j_readOnly").html(f.find(".j_readOnly").html() + "&nbsp;&nbsp;" + e)
                    }
            }
        },
        empty: function(f) {
            f = f.closest(".field_js");
            f.find("select").val("");
            f.find(".combo_select_js").selectpicker("refresh");
            f.find("input:text").val("").hide();
            f.find(".j_readOnly").html("")
        },
        readOnly: function(f, d) {
            d ? (f.find(".check_js").addClass("hide"),
            f.find(".j_readOnly").removeClass("hide")) : (f.find(".check_js").removeClass("hide"),
            f.find(".j_readOnly").addClass("hide"))
        }
    });
    u.exports = window.ComboSelect
});
define("form/component/chancelist", ["form/tplutil", "form/component/formfilter"], function(n, y, u) {
    var m = n("form/tplutil")
      , h = n("form/component/formfilter");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/imageradiobox", ["form/editablecomponent", "form/tplutil", "form/component/option", "form/component/imagecut", "form/component/imageviewer"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/option")
      , f = n("form/component/imagecut")
      , d = n("form/component/imageviewer");
    window.ImageRadioBox = RadioBox.extend({
        initialize: function(b) {
            m.prototype.initialize.call(this, b);
            var c = {
                componentKey: "ImageRadioBox",
                title: "\u56fe\u7247\u5355\u9009\u6846",
                formId: "",
                layout: "choicelist-inline",
                options: []
            };
            null != b && (c.title = b.title,
            c.layout = b.layout,
            c.formId = b.formId,
            c.options = b.options);
            this.componentSetup = $.extend(this.componentSetup, c);
            this.tpl = h.get("imageradiobox", {
                isMobileForm: this.isMobileForm
            })
        },
        setLayout: function(b) {
            this.componentSetup.layout = b
        },
        setOptions: function(b) {
            this.componentSetup.options = b
        },
        renderEditor: function() {
            var b = $(this.tpl).siblings("#editor-radiobox");            
            m.prototype.renderEditor.call(this, b);
            b.find("input:radio[name\x3d'componentType'][value\x3d'" + this.componentSetup.componentKey + "']").attr("checked", "true");
            b.find("input:radio[name\x3d'layout'][value\x3d'" + this.componentSetup.layout + "']").attr("checked", "true");
            for (var c = b.find("ul.choicelistEdit_js"), d = 0; d < this.componentSetup.options.length; d++) {
                var e = this.componentSetup.options[d];
                (new g(e)).renderEditor(c, this);
                "true" != e.other && 1 != e.other || b.find(".btn-default_js").parent().hide()
            }
            $("#editor-component").html(b.html());
            b = $("#j_item_container .form-img-uploaddata");
            this.initUploader("#j_item_container .j_img_add", "#j_item_container .choicelistEdit_js", b)
        },
        getValue: function(b, c) {
            var d = {
                formField: {
                    id: this.componentSetup.fieldId
                }
            };
            "true" != this.componentSetup.isReadOnly && 1 != this.componentSetup.isReadOnly || b.find("li .j_ico").hide();
            var e = b.find("input:radio[name\x3d'" + this.componentSetup.fieldId + this.cid + "']:checked")
              , a = e.val();
            if (null == e.get(0))
                return null;
            e = e.data("componentData");
            d.dataOptions = [{
                optionId: a,
                content: e.componentSetup.name,
                targetId: e.componentSetup.objId
            }];
            return null != a && "" != $.trim(a) || c ? d : null
        },
        setValue: function(b, c) {
            var d = $(this.tpl).siblings("#readonly-radiobox").find("li")
              , e = "";
            b.find(".j_ico").removeClass("checked");
            b.find(".j_readOnly ul").html("");
            if (null != c && null != c.dataOptions)
                for (var a = 0; a < c.dataOptions.length; a++) {
                    var f = c.dataOptions[a]
                      , g = f.optionId
                      , h = f.targetId
                      , e = null
                      , e = c.isMacthByName ? b.find("span").filter(function() {
                        return $(this).text() == f.content
                    }).closest("li").find("input") : b.find("input:radio[name\x3d'" + this.componentSetup.fieldId + this.cid + "'][value\x3d'" + g + "']")
                      , g = e.get(0);
                    if (!g)
                        break;
                    g.checked = !0;
                    e.parents("li").find(".j_ico").addClass("checked");
                    g = e.data("componentData").componentSetup.other;
                    "true" == g || 1 == g ? (b.find("input:text").val(f.content).show(),
                    e = f.content) : e = e.next().text();
                    g = d.clone();
                    g.find("span").text(e).attr("title", e);
                    window.systemInfo_print ? (b.find(".j_readOnly ul").addClass("j_imageoption_list"),
                    g.addClass("j_imgSizeChange"),
                    g.find("img").attr({
                        src: TEAMS.api.downImgUrl+"/" + h,
                        id: h,
                        count: "1"
                    }),
                    g.find(".j_image_container").append(g.find("img")),
                    g.find("a.gallery-pic").remove()) : (g.find("img").attr("src", TEAMS.api.downImgUrl+"/" + h),
                    g.find("a").attr("imghref", TEAMS.api.downImgUrl+"/" + h).attr("title", e));
                    b.find(".j_readOnly ul").append(g)
                }
        },
        empty: function(b) {
            b.find(".j_ico").removeClass("checked");
            b.find(".j_readOnly ul").html("");
            b.find("input:radio").each(function() {
                this.checked = !1
            })
        },
        initUploader: function(b, c, d) {
            var e = this;
            b = b || "#imageAdd" + this.componentSetup.fieldId + this.cid + " .j_imageAdd";
            c = c || "#" + this.componentSetup.fieldId + this.cid;
            d = d || $(c).parents("#field_" + this.componentSetup.fieldId);
            b = this.uploader = new plupload.Uploader({
                runtimes: "html5,flash",
                file_data_name: "data",
                browse_button: b,
                drop_element: b,
                container: d,
                max_file_size: "50M",
                url: TEAMS.api.uploadImage+"?module\x3dform\x26refId\x3d" + e.componentSetup.formId,
                flash_swf_url: "/static/swf/plupload.swf"
            });
            b.init();
            b.bind("FilesAdded", function(a, e) {
                $.each(e, function(a, e) {
                    plupload.formatSize(e.size)
                });
                a.refresh();
                a.start()
            });
            b.bind("UploadProgress", function(a, e) {
                $("#" + e.id + " i").html(e.percent + "%")
            });
            b.bind("Error", function(a, e) {
                -600 == e.code && formPlugin.notify("\u53ea\u80fd\u4e0a\u4f20\u6700\u5927\u4e0d\u8d85\u8fc750M\u7684\u6587\u4ef6", "\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7\u9650\u5236", "error");
                a.refresh()
            });
            b.bind("FileUploaded", function(a, b, d) {
                a = jQuery.parseJSON(d.response);
                d = a.fileObj;
                b = d.name.slice(0, d.name.lastIndexOf("."));
                d = d.image;
                "true" == d || 1 == d ? (d = new g,
                d.setObjId(a.imageFile.id),
                d.setName(b),
                d.renderEditor($(c), e),
                e.componentSetup.options.push(d.componentSetup),
                a = $("#widget-control .field-active .choicelist_js"),
                d.render(a, e),
                formPlugin.notify("\u56fe\u7247\u4e0a\u4f20\u6210\u529f")) : formPlugin.notify("\u8bf7\u4e0a\u4f20\u56fe\u7247\u6587\u4ef6", "\u6587\u4ef6\u683c\u5f0f\u4e0d\u6b63\u786e", "error")
            })
        },
        cutImage: function(b,t) {
            (new f({
                formId: this.componentSetup.formId,
                imageId: b,
                callback: function(e) {
                    $("img[imageId\x3d'" + b + "']").each(function() {
                        t.attr("imageid", e.imageArea.id);
                        $(this).attr("imageid", e.imageArea.id);
                        var c = TEAMS.api.downImgUrl+"/"+e.imageArea.id 
                        $(this).attr("src", c);
                        $(this).parent('.gallery-pic').attr("imghref", c + "?module\x3dform");
                    })
                }
            })).render();
        },
        layoutCheck: function(a) {
            var d = this,
                l = a.find('.imageslist-inline'),
                o = this.componentSetup.options;
            l.each(function(index) {
                $(this).children('.ImageCheckBox_js').each(function(i, el) {
                    var imgId = $(this).find('img').attr('imageid');
                    for (var d = !1, b = o, c = [], f = 0; f < b.length; f++) {
                        if(f == i) {
                            var e = b[f];
                            e.objId = imgId
                        }
                        
                    }
                }); 
            });
        },
        checkEvents: function(b) {
            var c = this
              , f = c.el || $(document);
            RadioBox.prototype.checkEvents.call(this, b);
            "mobile" == window.systemInfo_form && (b = c.componentSetup.fieldId || c.componentSetup.tempId,
            f.on("click", "#field_" + b + " .ImageRadioBox_mobile_js .j_ico", function() {
                $(this).parents(".ImageRadioBox_mobile_js").find("input:radio").prop("checked", !0);
                $(this).addClass("checked");
                $(this).parents(".ImageRadioBox_mobile_js").siblings().find(".ico").removeClass("checked");
                $(this).parents(".ImageRadioBox_mobile_js").siblings().find("input:radio").prop("checked", !1)
            }),
            f.on("click", "#field_" + b + " .j_image_container", function() {
                var e = $(this).attr("imghref")
                  , a = $(this).find("img").attr("imageid");
                (new d({
                    preEl: $(this).parents(".j_page-view"),
                    imageId: a,
                    imageUrl: e
                })).render()
            }),
            $(window).on("resize.imagecheckbox", function() {
                c.calcImgHeight()
            }),
            $(window).trigger("resize.imagecheckbox"))
        },
        calcImgHeight: function() {
            var b = ($(window).width() - 20) / 4;
            this.el.find(".j_image_container").height(b - 10)
        }
    });
    u.exports = window.ImageRadioBox
});
define("form/component/serialnumber", ["form/editablecomponent", "form/tplutil", "form/componentmodel"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel");
    window.SerialNumber = m.extend({
    });
    u.exports = window.SerialNumber
});
define("form/component/tablelayout", ["form/component", "form/tplutil", "form/component/table"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil");
    n("form/component/table");
    window.TableLayout = y.extend({
        initialize: function(h) {
            this.componentSetup = {
                componentKey: "TableLayout",
                layoutDetail: [],
                order: 0,
                index: 0,
                rows: 4,
                cols: 3,
                thArray: [],
                tableId: "",
                fieldReads: [],
                fieldWrites: [],
                isBorder: !1
            };
            null != h && (this.componentSetup.title = h.title,
            this.componentSetup.layoutDetail = h.layoutDetail,
            this.componentSetup.order = h.order,
            this.componentSetup.index = h.index,
            this.componentSetup.rows = h.rows,
            this.componentSetup.cols = h.cols,
            this.componentSetup.thArray = h.thArray,
            this.componentSetup.tableId = h.tableId,
            this.componentSetup.fieldReads = h.fieldReads,
            this.componentSetup.fieldWrites = h.fieldWrites,
            this.componentSetup.isBorder = h.isBorder);
            this.tpl = m.get("tablelayout")
        },
        setIsBorder: function(h) {
            this.componentSetup.isBorder = h
        },
        render: function(h) {
            var g = $(this.tpl).siblings("#table-layout");
            h.attr("class", g.attr("class"));
            h.html(g.html());
            this.table = h.find(".j_table").table({
                rows: this.componentSetup.rows,
                cols: this.componentSetup.cols,
                afterCreateCell: function(f, d) {
                    $(document).trigger("afterCreateCell", {
                        cell: d
                    })
                },
                beforeChangeCell: function(f, d) {
                    return !0
                },
                afterChangeWidth: function(f, d) {
                    if (d && 0 < d.length) {
                        for (var b = 0, c = 0; c < d.length; c++)
                            b += ~~d[c];
                        b > $(".form-view").width() - 2 ? h.find(".form-layout-toolbar").css("margin-bottom", "17px") : h.find(".form-layout-toolbar").css("margin-bottom", "0px")
                    }
                },
                afterDeleteCol: function(f) {
                    0 == f.options.cols && f.$table.closest(".table_layout_js").remove()
                },
                afterDeleteRow: function(f) {
                    0 == f.options.rows && f.$table.closest(".table_layout_js").remove()
                }
            })
        },
        renderEditor: function() {
            var h = $(this.tpl).siblings("#editor-datatable");
            "true" != this.componentSetup.isBorder && 1 != this.componentSetup.isBorder || h.find("#delBorder").attr("checked", "true");
            
            $("#editor-component").html(h);
          //  $("#editor-component").append('<label>背景颜色</label><div class="color-box"></div>');
            
            // $("#editor-component").find(".color-box").colpick({
            //     flat: !0,
            //     layout: "hex",
            //     color: this.componentSetup.color,
            //     submit: 0,
            //     onChange: function(f, d, b, c) {
            //         $("#widget-control .field-active .widget-title").css("background-color", "#" + d);
            //         $("#widget-control .field-active").data("componentData").setColor("#" + d)
            //     }
            // })
        },
        renderPreview: function(h, g, f, d, b) {
            this.curModule = b;
            var c = $(this.tpl)
              , l = this.componentSetup.layoutDetail;
            
            this.isReadOnly = f;
            if ("mobile" != window.systemInfo_form) {
                var e = c.siblings("#preview-tablelayout");
                h.append(e);
                var a = this.componentSetup.rows
                  , c = $("\x3ctable class\x3d'table table-bordered'\x3e\x3c/table\x3e");
                e.find(".j_tablelayout").append(c);
                $("#formEdit_js").get(0) && e.find(".j_maximize ").remove();
                if ("true" == this.componentSetup.isBorder || 1 == this.componentSetup.isBorder) {
                    e.find('.j_tablelayout').addClass('noborder');
                } else {
                    e.find('.j_tablelayout').removeClass('noborder');
                }
                if (a && 0 < a)
                    for (var k = 0; k < a; k++)
                        c.append($("\x3ctr class\x3d''\x3e\x3c/tr\x3e"));
                if (l && 0 < l.length)
                    for (k = 0; k < l.length; k++) {
                        var a = l[k]
                          , m = Number(a.width);
                        if ( m > 16)
                            m = m-16;
                        if (a && 0 < a.rowSpan && 0 < a.colSpan) {
                            var m = $("\x3ctd rowspan\x3d'" + a.rowSpan + "' colspan\x3d'" + a.colSpan + "' style\x3d'width:" + m + "px'\x3e\x3c/td\x3e")
                              , r = a.coordinate.split("_")[0];
                            c.find("tr").eq(~~r).append(m);
                            if (a.layoutDetail && 0 < a.layoutDetail.length) {
                                r = a.layoutDetail[0].componentKey;
                                if ("DateInterval" == r || "ComboSelect" == r)
                                    a.layoutDetail[0].fieldWrites = this.componentSetup.fieldWrites,
                                    a.layoutDetail[0].fieldReads = this.componentSetup.fieldReads;
                                var r = new window[r](a.layoutDetail[0])
                                  , q = f;
                                if (!f && a.layoutDetail[0].fieldId && this.componentSetup.fieldWrites) {
                                    var p = this.componentSetup.fieldWrites[a.layoutDetail[0].fieldId];
                                    "undefined" == typeof p || p || (q = !0)
                                }
                                r.renderPreview(m, g, q, d, b);
                                a.layoutDetail[0].fieldId && this.componentSetup.fieldReads && (p = this.componentSetup.fieldReads[a.layoutDetail[0].fieldId],
                                "undefined" == typeof p || p || m.find(".field_js").addClass("hide"));
                                q && m.find(".field_js").addClass("fieldReadOnly");
                                r.checkEvents(function(a) {
                                    formPlugin.checkPrompt(a)
                                }, d);
                                r.conditionEvent(h, d);
                                d && !f && r.autoSaveEvents(d)
                            }
                            m = m.parent();
                            "TdLayout" == a.componentKey && (0 < m.find(".field_js").length && 0 == m.find(".field_js").not(".hide").size() || 0 == m.find(".field_js").length) ? m.hide() : m.show()
                        }
                    }
                e.attr("id", "");
                e.attr("cid", this.cid);
                setTimeout(function() {
                    e.find(".j_tablelayout table tr").not(":hidden").eq(e.find(".j_tablelayout table tr").not(":hidden").length - 1).find("td")
                }, 300)
            } else if (l && 0 < l.length)
                for (k = 0; k < l.length; k++)
                    if (a = l[k],
                    a.layoutDetail && 0 < a.layoutDetail.length) {
                        r = a.layoutDetail[0].componentKey;
                        if ("DateInterval" == r || "ComboSelect" == r)
                            a.layoutDetail[0].fieldWrites = this.componentSetup.fieldWrites,
                            a.layoutDetail[0].fieldReads = this.componentSetup.fieldReads;
                        r = new window[r](a.layoutDetail[0]);
                        q = f;
                        !f && a.layoutDetail[0].fieldId && this.componentSetup.fieldWrites && (p = this.componentSetup.fieldWrites[a.layoutDetail[0].fieldId],
                        "undefined" == typeof p || p || (q = !0));
                        r.renderPreview(h.closest(".form-view_js"), g, q, d, b);
                        a.layoutDetail[0].fieldId && this.componentSetup.fieldReads && (p = this.componentSetup.fieldReads[a.layoutDetail[0].fieldId],
                        "undefined" == typeof p || p || h.children().last().addClass("hide"));
                        q && h.children().last().addClass("fieldReadOnly");
                        r.checkEvents(function(a) {
                            formPlugin.checkPrompt(a)
                        }, d);
                        r.conditionEvent(h, d);
                        d && !f && r.autoSaveEvents(d)
                    }
            this.el = h
        },
        renderEditPreview: function(h) {
            var g = $(this.tpl).siblings("#table-layout");
            this.table = g.find(".j_table").table({
                rows: this.componentSetup.rows,
                cols: this.componentSetup.cols,
                tdArray: this.componentSetup.layoutDetail,
                thArray: this.componentSetup.thArray,
                afterCreateCell: function(f, d) {
                    $(document).trigger("afterCreateCell", {
                        cell: d
                    })
                },
                beforeChangeCell: function(f, d) {
                    return !0
                },
                afterCreateBodyTd: function(f, d, b) {
                    b.layoutDetail && 0 < b.layoutDetail.length && (new window[b.layoutDetail[0].componentKey](b.layoutDetail[0])).renderEditPreview(d)
                },
                afterChangeWidth: function(f, d) {
                    if (d && 0 < d.length) {
                        for (var b = 0, c = 0; c < d.length; c++)
                            b += ~~d[c];
                        b > $(".form-view").width() ? g.find(".form-layout-toolbar").css("margin-bottom", "17px") : g.find(".form-layout-toolbar").css("margin-bottom", "0px")
                    }
                },
                afterDeleteCol: function(f) {
                    0 == f.options.cols && f.$table.closest(".table_layout_js").remove()
                },
                afterDeleteRow: function(f) {
                    0 == f.options.rows && f.$table.closest(".table_layout_js").remove()
                }
            });
            g.attr("id", "");
            g.attr("cid", this.cid);
            g.data("componentData", this);
            h.append(g)
        },
        getTableSerialize: function(h, g, a) {
            var f = this.table
              , d = f.persist.storage
              , b = f.options
              , c = []
              , l = [];
            if (d && 0 < d.length)
                for (var e = 0; e < d.length; e++) {
                    var a = e
                      , k = d[e];
                    if (k && 0 < k.length)
                        for (var m = 0; m < k.length; m++) {
                            var r = k[m]
                              , q = {
                                coordinate: a + b.separator + m,
                                rowSpan: 0,
                                colSpan: 0,
                                width: null,
                                height: null
                            };
                            if (r) {
                                q.rowSpan = r.rowSpan;
                                q.colSpan = r.colSpan;
                                q.width = $(r).width() + 2;
                                m == k.length - 1 && (q.width = $(r).width() + 3);
                                q.height = $(r).height();
                                var r = h.assemComponent(g, $(r).find(".field_js"), a)
                                  , p = [];
                                null != r && p.push(r.componentSetup);
                                q.componentKey = "TdLayout";
                                q.layoutDetail = p
                            }
                            c.push(q)
                        }
                }
            var w = f.$table.find("thead th");
            w && 0 < w.length && w.each(function(a) {
                w.length - 1 ? l.push($(this).width() + 18) : l.push($(this).width() + 17)
            });
            this.componentSetup.layoutDetail = c;
            this.componentSetup.rows = b.rows;
            this.componentSetup.cols = b.cols;
            this.componentSetup.thArray = l
        },
        maximize: function(h) {
            var g = this
              , f = this.cid
              , d = $(this.tpl).siblings("#tableMaximize").clone();
            $("body").append("\x3cdiv id\x3d'" + f + "'\x3e\x3c/div\x3e");
            $("#" + f).append(d);
            var b = $("[cid\x3d" + this.cid + "]")
              , d = $("#" + f + " #tableMaximize #maximizePreview");
            d.data("form", {
                module: g.curModule
            });
            var c = {};
            this.componentSetup.fieldReads && (c.fieldReads = this.componentSetup.fieldReads);
            this.componentSetup.fieldWrites && (c.fieldWrites = this.componentSetup.fieldWrites);
            formPlugin.analyseComponent(this.componentSetup, d, null, this.isReadOnly, c);
            c = formPlugin.assembleFormFieldData(b);
            formPlugin.fillFieldContent(c, d);
            d.find("tr").each(function(c) {
                c = b.find("tr:eq(" + c + ")");
                var e = $(this);
                c.hasClass("form-condition-hide") ? e.addClass("form-condition-hide") : c.find("td").each(function(a) {
                    $(this).children().hasClass("form-condition-hide") && e.find("td:eq(" + a + ")").children().addClass("form-condition-hide")
                })
            });
            $("#tableMaximize").modal();
            $("#" + f).find(".j_maximize").remove();
            $("#" + f).on("hidden.bs.modal", function() {
                $(this).find("#tableMaximize").length && g.minimize(h);
                $(this).remove()
            })
        },
        minimize: function(h) {
            var g = $("[cid\x3d" + this.cid + "]")
              , f = $("#tableMaximize .modal-body");
            formPlugin.destroyEvents(f);
            f = formPlugin.assembleFormFieldData(f);
            formPlugin.setEmpty(g);
            formPlugin.fillFieldContent(f, g.parent());
            g.find(".field_js[componentkey\x3d'Select']").find("select").change();
            g.find(".field_js[componentkey\x3d'CheckBox'],.field_js[componentkey\x3d'RadioBox']").find("input:first").change();
            g.find(".relate_js").each(function() {
                var d = $(this)
                  , b = d.find(".check_js").data("componentData");
                b && b.triggerFillRelate(d, !1)
            });
            g.find(".field_js[componentkey\x3d'NumberComponent'],.field_js[componentkey\x3d'Money']").find("input:first").blur();
            g.find(".field_js[componentkey\x3d'DateInterval']").find("input:first").change();
            h && this.saveTableValue(h, formPlugin.assembleFormFieldData(g.closest(".form-view_js")))
        },
        checkEvents: function(h, g) {
            var f = this
              , d = f.el || $(document);
            this.checkCallback = h;
            d.on("click", "[cid\x3d" + f.cid + "] .j_maximize", function() {
                f.maximize(g)
            })
        },
        autoSaveEvents: function(h) {},
        saveTableValue: function(h, g) {
            var f = $("div[cid\x3d'" + this.cid + "']");
            if (0 < f.length) {
                var d = $.extend({}, h);
                d.parentEl = f;
                d.dataDetails = g;
                formPlugin.saveFieldData(d)
            }
        },
        readOnly: function(h, g) {
            console.error("you need to rewrite the method : readOnly")
        }
    });
    u.exports = TableLayout
});
define("form/component/contractcomponent", "form/relatecomponent form/tplutil form/componentmodel form/component/contractlist form/component/entityselecter form/component/typeahead form/component/relevancecontrol form/abposview".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel")
      , f = n("form/component/contractlist")
      , d = n("form/component/entityselecter")
      , b = n("form/component/typeahead")
      , c = n("form/component/relevancecontrol")
      , l = n("form/abposview");
    window.ContractComponent = m.extend({
    });
    u.exports = window.ContractComponent
});
define("form/component/datatable", ["form/component", "form/tplutil"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil");
    window.DataTable = y.extend({
        initialize: function(h) {
            this.componentSetup = {
                componentKey: "DataTable",
                subFormId: "",
                title: "",
                describe: "",
                layoutDetail: [],
                defaultRows: "3",
                showSreial: !1,
                formId: "",
                required: !1,
                order: 0,
                index: 0,
                thArray: [],
                isDran: !1,
                NOShow: {},
                fieldReads: [],
                fieldWrites: [],
                requiredRows: "1",
                totalLine: [],
                frozenColumn: "",
                color:"#f0f0f0"
            };
            if(h && h.subFormId=="") h.subFormId = parseInt(1000000000*Math.random());
            null != h && (this.componentSetup.subFormId = h.subFormId,
            this.componentSetup.title = h.title,
            this.componentSetup.describe = h.describe,
            this.componentSetup.layoutDetail = h.layoutDetail,
            this.componentSetup.defaultRows = h.defaultRows,
            this.componentSetup.showSreial = h.showSreial,
            this.componentSetup.order = h.order,
            this.componentSetup.index = h.index,
            this.componentSetup.fieldReads = h.fieldReads,
            this.componentSetup.fieldWrites = h.fieldWrites,
            this.componentSetup.formId = h.formId,
            this.componentSetup.required = h.required,
            this.componentSetup.requiredRows = h.requiredRows,
            this.componentSetup.totalLine = h.totalLine,
            this.componentSetup.thArray = h.thArray,
            this.componentSetup.isDran = h.isDran,
            this.componentSetup.color = h.color,
            this.componentSetup.frozenColumn = h.frozenColumn);
            this.checkCallback = null;
            this.tpl = m.get("datatable");

        },
        setIsDran: function(h) {
            this.componentSetup.isDran = h
        },
        setFrozenColumn: function(h) {
            this.componentSetup.frozenColumn = h
        },
        setThArray: function(h) {
            this.componentSetup.thArray = h
        },
        setTitle: function(h) {
            this.componentSetup.title = h
        },
        setCrossPrint: function(h) {
            this.componentSetup.crossPrint = h
        },
        setDescribe: function(h) {
            this.componentSetup.describe = h
        },
        setRequired: function(h) {
            this.componentSetup.required = h
        },
        setDefaultRows: function(h) {
            this.componentSetup.defaultRows = h
        },
        setShowSreial: function(h) {
            this.componentSetup.showSreial = h
        },
        setRequiredRows: function(h) {
            this.componentSetup.requiredRows = h
        },
        setTotalLine: function(h) {
            this.componentSetup.totalLine = h
        },
        setColor: function(h) {
            this.componentSetup.color = h
        },
        filterItme: {
            DividingLine: !1,
            Paragraph: !1,
            ColumnPanel: !1
        },
        render: function(h) {
            this.componentSetup.formId = $("#formId").val();
            var g = this
              , f = $(this.tpl).siblings("#form-datatable");
            h.attr("cid", this.cid);
            h.attr("class", f.attr("class"));
            h.html(f.html());
            h.find("td").resizable({
                handles: "e",
                minWidth: 100,
                start: function(d, b) {
                    $("#widget-control div[cid\x3d'" + g.cid + "']").find(".j_notIstr").show()
                },
                stop: function(d, b) {
                    g.componentSetup.isDran = !0;
                    $("#widget-control div[cid\x3d'" + g.cid + "']").attr("isDran", "isDran")
                }
            });
            h.find(".ui-resizable-e").css("right", "0px");
            h.find("tr.subtr_js").append("\x3ctd class\x3d'j_notIstr' style\x3d'display:none;background: #e1e1e1'\x3e\x3c/td\x3e");
            h.find("tr.subtr_js td:not('.j_notIstr')").css("width", "362px")
        },
        renderEditor: function() {
            var h = $(this.tpl).siblings("#editor-datatable");
            h.find("#component-title-datatable").attr("value", this.componentSetup.title);
            h.find("#component-describe-datatable").text(this.componentSetup.describe);
            "true" != this.componentSetup.showSreial && 1 != this.componentSetup.showSreial || h.find("#datatable-showSreial").attr("checked", "true");
            "true" != this.componentSetup.required && 1 != this.componentSetup.required || h.find("#required").attr("checked", "true");
            h.find("#datatable-defaultRows").attr("value", this.componentSetup.defaultRows);
            "true" == this.componentSetup.required || 1 == this.componentSetup.required ? (h.find(".j_isRequired_Div").removeClass("hide"),
            h.find("#datatable-requiredRows").attr("value", this.componentSetup.requiredRows)) : h.find(".j_isRequired_Div").addClass("hide");
            this.componentSetup.frozenColumn && h.find(".j_data_frozen input:radio[name\x3d'data-frozen'][value\x3d'" + this.componentSetup.frozenColumn + "']").attr("checked", "true");
            $("#editor-component").html(h);
            $("#editor-component").append('<label>表头颜色</label><div class="color-box"></div>');
            
            $("#editor-component").find(".color-box").colpick({
                flat: !0,
                layout: "hex",
                color: this.componentSetup.color,
                submit: 0,
                onChange: function(f, d, b, c) {
                    $("#widget-control .field-active .widget-title").css("background-color", "#" + d);
                    $("#widget-control .field-active").data("componentData").setColor("#" + d)
                }
            })
        },
        renderPreview: function(h, g, f, d, b) {            
            this.curModule = b;
            this.formObj = h.data("form");
            var c = $(this.tpl)
              , l = c.siblings("#preview-datatable");
            "mobile" == window.systemInfo_form && (l = c.siblings("#mobile-preview"));            
            this.componentSetup.describe && "" != this.componentSetup.describe && (l.find(".j_datatableDescription").text(this.componentSetup.describe),
            l.find(".j_datatableDescription").removeClass("hide"));
            this.componentSetup.title && "" != this.componentSetup.title && (l.find(".j_datatableTitle").text(this.componentSetup.title),
            l.find(".j_datatableTitle").removeClass("hide"));
            window.systemInfo_print && (l.find(".j_setFiled").removeClass("hide"),
            l.find(".js_printvertical").removeClass("hide"));
            $("#formEdit_js").get(0) ? l.find(".j_maximize ").remove() : l.find(".j_datatableTitle").removeClass("hide");
            var e = null == this.componentSetup.subFormId || "" == this.componentSetup.subFormId ? this.cid : this.componentSetup.subFormId;
            l.attr("id", e);
            l.attr("cid", this.cid);
            var a = this.componentSetup.layoutDetail;
            0 == a.length && l.hide();
            this.notDefault = g;
            this.isReadOnly = f;
            g = c.siblings("#operating-datatable");
            c = $("\x3ctr class\x3d'subtr_js'\x3e");
            if ("true" == this.componentSetup.showSreial || 1 == this.componentSetup.showSreial) {
                var k = $("\x3cth class\x3d'sn'\x3e");
                k.append($("\x3clabel class\x3d'widget-title'\x3e").append("\x26nbsp;"));
                c.append(k)
            }
            for (var m = 0, r = 0; r < a.length; r++) {
                var k = $("\x3cth class\x3d'subtd_js'\x3e")
                  , q = a[r];
                this.renderDisableModule(q.componentKey) && k.addClass("hide");
                if (this.componentSetup.fieldReads) {
                    var p = this.componentSetup.fieldReads[q.fieldId];
                    "DateInterval" == q.componentKey ? p = this.componentSetup.fieldReads[q.start.fieldId] : "ComboSelect" == q.componentKey && (p = this.componentSetup.fieldReads[q.selects[0].fieldId]);
                    "undefined" == typeof p || p || (k.addClass("hide"),
                    m += 1)
                }
                p = new window[q.componentKey](q);
                k.data("componentData", p);
                "NumberComponent" != q.componentKey && "Money" != q.componentKey && "Monitor" != q.componentKey || k.append($("\x3cinput type\x3d'text' class\x3d'hide number_component_js' value\x3d'0' name\x3d'" + q.fieldId + "' id\x3d'" + q.fieldId + "'\x3e").data("componentData", p));
                k.append($("\x3clabel class\x3d'widget-title'\x3e").append("\x3cspan class\x3d'widget-title_js'\x3e" + q.title + "\x3c/span\x3e"));
                "true" != q.required && 1 != q.required || k.find("label").append($("\x3cspan class\x3d'c-danger required_js'\x3e").append("*"));
                "EinvoiceComponent" != q.componentKey || "false" != q.isReadOnly && 0 != q.isReadOnly || "undefined" != typeof this.isReadOnly && "false" != this.isReadOnly && 0 != this.isReadOnly || this.componentSetup.fieldWrites && "undefined" != typeof this.componentSetup.fieldWrites[q.fieldId] && !this.componentSetup.fieldWrites[q.fieldId] || "wechat" != window.webapp && "serviceNumber" != TEAMS.currentUser.loginChannel || (l.find(".add-invoice-js").removeClass("hide"),
                n.async("teamsjs/component/wechatEvent" + seajsClip));
                c.append(k);
                "mobile" != window.systemInfo_form && r == a.length - 1 && this.isEditRow(a) && (k = g.find(".subthoper_js").clone(),
                c.append(k))
            }
            parseInt(m) == a.length && l.hide();
            3 <= a.length && l.find(".subtable_js").addClass("one-three");
            l.find(".subtable_js").append(c);
            "mobile" == window.systemInfo_form && (g = a.length,
            c = l.find(".subtable_js .subtd_js"),
            m = parseInt($(window).width() / 2),
            1 < g && 2 >= g ? (c.css("min-width", m + "px"),
            c.find("label").css("max-width", m - 2 + "px")) : 2 < g && (m = parseInt(($(window).width() - 30) / 3),
            c.css("min-width", m + "px"),
            c.find("label").css("max-width", m - 2 + "px")),
            3 < g && l.find(".j_arrow-right").removeClass("hide"),
            this.isEditRow(a) || (l.find(".j_mobileSubadd").remove(),
            l.find(".add-invoice-js").remove()),
            !f && l.find(".j_subFormDesc").hasClass("hide") && l.find(".j_subFormTitle").hasClass("hide") && l.find(".form-databox-hd").addClass("hide"));
            l.find(".subtable_js").data("componentData", this);            
            this.el = h;
            this.autoSave = d;
            h.append(l);
            this.addTotalRow(h);
            if ("mobile" != window.systemInfo_form && !window.systemInfo_print && this.componentSetup.isDran && this.componentSetup.thArray && this.componentSetup.thArray.length == a.length) {
                if ((f = $("#" + e + "[cid\x3d" + this.cid + "] tbody").find("th.subtd_js")) && 0 < $(f).length)
                    for (a = d = 0,
                    g = $("#formContent").width() || 768,
                    c = 0; c < $(f).length; c++)
                        m = $(f)[c],
                        d += Number(this.componentSetup.thArray[c]),
                        g > d && c == $(f).length - 1 ? "true" == this.componentSetup.showSreial || 1 == this.componentSetup.showSreial ? Number(g - a - 104 - 45) > this.componentSetup.thArray[c] ? $(m).width(g - a - 104 - 45) : $(m).width(this.componentSetup.thArray[c]) : Number(g - a - 104) > this.componentSetup.thArray[c] ? $(m).width(g - a - 104) : $(m).width(this.componentSetup.thArray[c]) : (a += Number(this.componentSetup.thArray[c]),
                        $(m).width(this.componentSetup.thArray[c]));
                l.find(".subtable_js").addClass("one-three")
            }
            $("#" + e + "[cid\x3d" + this.cid + "] tbody").attr("cmodule", b).data("form", h.data("form"))
            
            l.find(".widget-title").css("background-color", this.componentSetup.color);

            l.find(".form-databox table th").css("background-color", this.componentSetup.color);
        },
        frozenColumn: function(h) {
            if ("mobile" != window.systemInfo_form && (1 == this.isReadOnly || "true" == this.isReadOnly) && !window.systemInfo_print && this.componentSetup.frozenColumn) {
                var g = h.find(".subtable_js").clone();
                g.removeClass("subtable_js").addClass("subtable_js_clone");
                g.find(".check_js").removeClass("check_js");
                g.find("input:radio").removeAttr("name");
                g.find(".form-condition-hide").remove();
                h.find(".subtable_js").parents(".form-data").after(g);
                var f = this.componentSetup.frozenColumn
                  , d = g.find("tr").length;
                g.find("tr").each(function() {
                    $(this).find("th:gt(" + Number(f - 1) + ")").remove();
                    $(this).find("td:gt(" + Number(f - 1) + ")").remove()
                });
                for (var b = 0; b <= d - 1; b++)
                    for (var c = 0; c <= f - 1; c++)
                        g.find("tr:eq(" + b + ")\x3etd").not(".form-condition-hide").eq(c).css({
                            width: h.find(".subtable_js tr:eq(" + b + ")\x3etd").not(".form-condition-hide").eq(c).innerHeight(),
                            height: h.find(".subtable_js tr:eq(" + b + ")").innerHeight()
                        });
                for (c = d = 0; c <= f - 1; c++)
                    d += parseFloat(h.find(".subtable_js tr\x3eth").not(".form-condition-hide").eq(c).width() + 1);
                g.css({
                    width: d,
                    position: "absolute",
                    left: "0",
                    top: "0",
                    "z-index": "2",
                    background: "#fff"
                });
                h = h.find(".j_formLine");
                h.parents().hasClass("form-databox-full") ? h.css({
                    width: "1px",
                    position: "absolute",
                    left: d,
                    top: "0",
                    bottom: "0",
                    height: "",
                    "z-index": "2",
                    background: "#ddd"
                }) : (g = g.innerHeight(),
                h.css({
                    width: "1px",
                    position: "absolute",
                    left: d,
                    top: "0",
                    height: g,
                    "z-index": "2",
                    background: "#ddd"
                }))
            }
        },
        renderDisableModule: function(h) {
            var g = !1;
            h = this.transKey(h);
            var f = TEAMS.disableModules;
            if (f && 0 < f.length)
                for (var d = 0; d < f.length; d++) {
                    var b = f[d];
                    if (b.module && b.module == h)
                        if ("form" == h) {
                            if (b.moduleId && 3 >= b.moduleId.length) {
                                g = !0;
                                break
                            }
                        } else {
                            g = !0;
                            break
                        }
                }
            return g
        },
        transKey: function(h) {
            var g = "";
            "Task" == h ? g = "task" : "Document" == h ? g = "document" : "Mainline" == h ? g = "mainline" : "Workflow" == h ? g = "workflow" : "CustomerComponent" == h ? g = "customer" : "ContractComponent" == h ? g = "contract" : "ContactComponent" == h ? g = "contact" : "ChanceComponent" == h ? g = "saleChance" : "ProductionComponent" == h ? g = "production" : "FormComponent" == h && (g = "form");
            return g
        },
        renderEditPreview: function(h) {
            var g = this
              , f = $(this.tpl).siblings("#form-datatable");
            f.find(".j_datatableTitle").text(this.componentSetup.title);
            this.componentSetup.describe && "" != this.componentSetup.describe && (f.find(".j_datatableDescription").text(this.componentSetup.describe),
            f.find(".j_datatableDescription").removeClass("hide"));
            this.componentSetup.title && "" != this.componentSetup.title && (f.find(".j_datatableTitle").text(this.componentSetup.title),
            f.find(".j_datatableTitle").removeClass("hide"));
            f.attr("id", null == this.componentSetup.subFormId || "" == this.componentSetup.subFormId ? this.cid : this.componentSetup.subFormId);
            f.attr("cid", this.cid);
            var d = f.find("tr.subtr_js")
              , b = this.componentSetup.layoutDetail;
            d.html("");
            if (b && 0 < b.length) {
                for (var c = 0, l = 0; l < b.length; l++) {
                    var e = b[l]
                      , a = $("\x3ctd class\x3d'subtd_js' style\x3d'height: 71px;'\x3e");
                    g.componentSetup.isDran && g.componentSetup.thArray && g.componentSetup.thArray.length == b.length ? $(a).width(g.componentSetup.thArray[l]) : 1 == b.length ? $(a).width("100%") : 2 == b.length ? $(a).width("362px") : $(a).width("241px");
                    f.find(".subtable_js").addClass("one-three");
                    (new window[e.componentKey](e)).renderEditPreview(a);
                    c += Number($(a).width());
                    d.append(a)
                }
                726 < c && f.find(".datatable-toolbar_js").css({
                    "margin-bottom": "17px"
                });
                d.append("\x3ctd class\x3d'j_notIstr' style\x3d'background: #e1e1e1'\x3e\x3c/td\x3e")
            } else
                d.append("\x3ctd class\x3d'subtd_js' style\x3d'height: 71px; width:727px'\x3e"),
                d.append("\x3ctd class\x3d'j_notIstr' style\x3d'display:none;background: #e1e1e1'\x3e\x3c/td\x3e");
            f.find(".subtable_js").addClass("one-three");
            f.data("componentData", this);
            f.find(".widget-title").css("background-color", this.componentSetup.color);
            f.find(".form-databox table th").css("background-color", this.componentSetup.color);
            h.append(f);
            g.componentSetup.isDran && 0 != g.componentSetup.isDran && "false" != g.componentSetup.isDran && $("#widget-control div[cid\x3d'" + g.cid + "']").attr("isDran", "isDran");
            $("#widget-control div[cid\x3d'" + g.cid + "']").find("td.subtd_js").resizable({
                handles: "e",
                minWidth: 100,
                stop: function(a, e) {
                    g.componentSetup.isDran = !0;
                    $("#widget-control div[cid\x3d'" + g.cid + "']").attr("isDran", "isDran")
                }
            });
            h.find(".ui-resizable-e").css("right", "0px");
            /msie 9\.0/i.test(window.navigator.userAgent.toLowerCase()) && f.find(".subtable_js .subtd_js").hover(function() {
                var a = $(this).parents(".form-databox")
                  , e = $(this).parents(".subtable_js");
                a.height(e.height() + 17)
            })

        },
        formatMoney: function(h, g) {
            g = 2 < g && 20 >= g ? g : 2;
            h = parseFloat((h + "").replace(/[^\d\.-]/g, "")).toFixed(g) + "";
            var f = h.split(".")[0].split("").reverse()
              , d = h.split(".")[1];
            t = "";
            for (i = 0; i < f.length; i++)
                t += f[i] + (0 == (i + 1) % 3 && i + 1 != f.length ? "," : "");
            return t.split("").reverse().join("") + "." + d
        },
        submitCheck: function(h, g) {},
        countTotal: function(h) {
            var g = h.data("componentData")
              , f = h.attr("name")
              , d = h.attr("componentKey");
            h = h.parents(".subform_js");
            var b = h.find('input[name\x3d"' + f + '"]'), c, b = new String(formPlugin.calculateTotal(b));
            "Money" === d && (0 < b.length && (c = this.formatMoney(b, 0 < b.indexOf(".") ? b.length - (b.indexOf(".") + 1) : -1)),
            "\u4eba\u6c11\u5e01" == h.find('span[name\x3d"' + f + '"]').attr("tp") && (h.find('span[name\x3d"' + f + '"]').attr("type", "Money"),
            b = c + " " + ("" == this.numberToChinese(b) ? this.numberToChinese(b) : "(" + this.numberToChinese(b) + ")")));
            "NumberComponent" === d && "mobile" != window.systemInfo_form && "number" == g.componentSetup.numberType && (1 == g.componentSetup.isCapital || "true" == g.componentSetup.isCapital) && 0 < b.length && (b = b + " " + ("" == this.numberToChinese(b) ? this.numberToChinese(b) : "(" + this.numberToChinese(b) + ")"));
            "Monitor" === d && "mobile" != window.systemInfo_form && "number" == g.componentSetup.monitorType && (1 == g.componentSetup.isCapital || "true" == g.componentSetup.isCapital) && 0 < b.length && (b = b + " " + ("" == this.numberToChinese(b) ? this.numberToChinese(b) : "(" + this.numberToChinese(b) + ")"));
            h.find('span[name\x3d"' + f + '"]').html(b)
        },
        numberToChinese: function(h) {
            var g = parseFloat(h)
              , f = parseFloat("10000000000000000");
            if (g >= f)
                return "\u8d85\u51fa\u6700\u5927\u5904\u7406\u6570\u5b57";
            g = "";
            0 == h.indexOf("-") && (g += "\u8d1f",
            h = h.substring(1));
            strUnit = "\u4edf\u4f70\u62fe\u4e07\u4edf\u4f70\u62fe\u4ebf\u4edf\u4f70\u62fe\u4e07\u4edf\u4f70\u62fe\u5143\u89d2\u5206";
            h += "00";
            f = h.indexOf(".");
            0 <= f && (h = h.substring(0, f) + h.substr(f + 1, 2));
            strUnit = strUnit.substr(strUnit.length - h.length);
            for (f = 0; f < h.length; f++)
                g += "\u96f6\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c\u7396".substr(h.substr(f, 1), 1) + strUnit.substr(f, 1);
            return g.replace(/\u96f6\u5206$/, "").replace(/\u96f6\u89d2\u96f6\u5206$/, "").replace(/\u96f6[\u4edf\u4f70\u62fe]/g, "\u96f6").replace(/\u96f6{2,}/g, "\u96f6").replace(/\u96f6([\u4ebf|\u4e07])/g, "$1").replace(/\u96f6+\u5143/, "\u5143").replace(/\u4ebf\u96f6{0,3}\u4e07/, "\u4ebf").replace(/^\u5143/, "\u96f6\u5143").replace(/\u96f6\u89d2$/, "").replace(/\u96f6\u5143$/, "")
        },
        checkEvents: function(h, g) {
            var f = this
              , d = f.el || $(document);
            this.checkCallback = h;
            var b = null == this.componentSetup.subFormId || "" == this.componentSetup.subFormId ? this.cid : this.componentSetup.subFormId;
            if ("mobile" != window.systemInfo_form && !this.notDefault) {
                var c = this.componentSetup.defaultRows;
                isNaN(c) && (c = 3);
                for (var l = 0; l < c; l++)
                    this.addRow()
            }
            d.find("#" + b).on("blur", "input[componentKey\x3d'Money'],input[componentKey\x3d'Monitor'],input[componentKey\x3d'NumberComponent']", function() {
                f.countTotal($(this))
            });
            $(window).on("resize", function() {
                $("#datatableMaximize .j_formMaximizeX").css("height", $("#datatableMaximize .form-data").height())
            });
            d.on("click", "#" + b + "[cid\x3d" + f.cid + "] .subtradd_js", function() {
                f.addRowNumber || (f.addRowNumber = 0);
                f.addRowNumber++;
                f.addRow(!1);
                $("#" + b + "[cid\x3d" + f.cid + "]").find("tr:first").find(".number_component_js").each(function() {
                    $(this).blur()
                });
                if (g) {
                    var e = $("#" + b + "[cid\x3d" + f.cid + "] tbody tr:last");
                    g.parentEl = e;
                    formPlugin.saveFieldData(g)
                }
            });
            d.on("click", "#" + b + "[cid\x3d" + f.cid + "] .subtrins_js", function() {
                var e = $(this).closest("tr");
                f.addRow(!1, e);
                e.parent().find("tr:first").find(".number_component_js").each(function() {
                    $(this).blur()
                });
                g && f.saveDataTableValue(g)
            });
            d.on("click", "#" + b + "[cid\x3d" + f.cid + "] .subtrdel_js", function() {
                var e = $(this);
                g ? formPlugin.confirm("\u786e\u8ba4\u5220\u9664\u8be5\u884c\u4e48?", function(a) {
                    a && 1 != f.removeRow(e) && (d.find("#" + b).find("tr:first").find(".number_component_js").each(function() {
                        $(this).blur()
                    }),
                    f.saveDataTableValue(g))
                }) : (f.removeRow($(this)),
                d.find("#" + b).find("tr:first").find(".number_component_js").each(function() {
                    $(this).blur()
                }))
            });
            d.off("click", "#" + b + "[cid\x3d" + f.cid + "] .j_maximize").on("click", "#" + b + "[cid\x3d" + f.cid + "] .j_maximize", function() {
                f.maximize(g)
            });
            d.on("click", "#" + b + "[cid\x3d" + f.cid + "] .j_setFiled", function() {
                f.setupFields()
            });
            d.on("click", "#" + b + "[cid\x3d" + f.cid + "] .js_printvertical", function() {
                var e = $(this).closest(".subform_js")
                  , a = e.find(".js_vertical_table")
                  , c = e.find(".form-databox");
                0 == a.length && (f.printVerticaltable(e),
                $("body").find(".js_printDvider").prop("checked") && e.find(".js_vertical_table").find(".line:gt(0)").before('\x3cdiv class\x3d"print-devider j_deviderItem"\x3e\x3cdiv class\x3d"devider-sn j_deviderSn"\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-line"\x3e\x3ci class\x3d"icon-scissors"\x3e\x3c/i\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-mark j_devidermark"\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-dele j_deviderdele icon-remove-sign"\x3e\x3c/div\x3e\x3c/div\x3e'));
                "true" == f.componentSetup.crossPrint || 1 == f.componentSetup.crossPrint ? (f.setCrossPrint(!1),
                $(this).attr("crossPrint", !1),
                c.find(".print-devider-enable").removeClass("is_hide"),
                a.find(".print-devider-enable").addClass("is_hide")) : (f.setCrossPrint(!0),
                $(this).attr("crossPrint", !0),
                c.find(".print-devider-enable").addClass("is_hide"),
                a.find(".print-devider-enable").removeClass("is_hide"));
                e.find(".js_vertical_table").toggle();
                c.toggle();
                window.setTimeout(function() {
                    var a = $(".js_vertical_table").find(".j_imgSizeChange");
                    0 < a.length && (a.css("width", "20%"),
                    a.find("img").attr("count", "1").removeClass("clicked"));
                    window.systemInfo_print && $("#print").trigger("updatePageNo")
                }, 100)
            });
            /msie 9\.0/i.test(window.navigator.userAgent.toLowerCase()) && $("#" + b + "[cid\x3d" + f.cid + "] .subtable_js .subtd_js").hover(function() {
                var e = $(this).parents(".form-databox")
                  , a = $(this).parents(".subtable_js");
                e.height(a.height() + 17)
            });
            if ("mobile" == window.systemInfo_form && (d.on("tap", "#" + b + "[cid\x3d" + f.cid + "] .add-invoice-js", function() {
                f.addRow();
                var e = d.find("#" + f.componentSetup.subFormId + "[cid\x3d" + f.cid + "] .subtable_js .subtr_js:last")
                  , a = null;
                e.find(".field_js[componentKey\x3d'EinvoiceComponent'] .check_js").each(function() {
                    var e = $(this).data("componentData");
                    if (1 != e.isReadOnly)
                        return a = e,
                        !1
                });
                a ? a.addInvoice(g, function() {
                    f.mobileShow(e, formPlugin.assembleFormFieldData(e));
                    f.createSerial()
                }) : e.remove()
            }),
            d.on("tap", "#" + b + "[cid\x3d" + f.cid + "] .j_mobileSubadd", function() {
                var e = $(this),
                    _id = f.cid;
                e.removeClass("j_mobileSubadd");
                setTimeout(function() {
                    f.mobilefillDetail();
                    e.addClass("j_mobileSubadd")
                }, 500)
            }),
            $("body").on("tap", "#j_confirmAdd" + b + "[cid\x3d" + f.cid + "]", function(e, a) {
                e.preventDefault();
                var c = $(this).attr("index") || 0
                  , b = $("#mobile-subFillDetail #subForm-fill-detail")
                  , d = $(this).attr("cid")
                  , d = $('.j_formpreview div[cid\x3d"' + d + '"]');
                formPlugin.submitCheck(b) ? (c ? f.mobileAddRow(c) : (f.addRow(),
                f.mobileAddRow(),
                d.find("tfoot").remove(),
                f.addTotalRow()),
                formPlugin.renderTotal(d),
                f.createSerial(),
                f.initPage(),
                a && f.mobilefillDetail(),
                d.find("tr:first").find(".number_component_js").each(function() {
                    $(this).blur()
                }),
                d.unbind("tap", "#" + b + "[cid\x3d" + f.cid + "] .subtable_js .subtr_js:not(:eq(0))"),
                g && f.saveDataTableValue(g),
                window.form_error = !1) : window.form_error = !0
            }),
            $("body").on("tap", "#j_continueSave" + b + "[cid\x3d" + f.cid + "]", function() {
                $(this).parents("#mobile-subFillDetail").find("#j_confirmAdd" + b + "[cid\x3d" + f.cid + "]").trigger("tap", [!0])
            }),
            $("body").on("tap", ".j_cancelAdd", function() {
                setTimeout(function() {
                    f.initPage()
                }, 500)
            }),
            $("body").on("tap", "#j_deleteSubForm" + b + "[cid\x3d" + f.cid + "]", function() {
                var e = $(this)
                  , a = function() {
                    var a = e.data("removerEl");
                    if(a.siblings().length>1) a.siblings().hide();
                    else a.siblings().show();
                    if (f.removeRow(a.find(".subtd_js").eq(0)))
                        return !0;
                    f.createSerial();
                    setTimeout(function() {
                        f.initPage()
                    }, 500)
                };
                g ? formPlugin.confirm("\u786e\u8ba4\u5220\u9664\u8be5\u884c\u4e48?", function(e) {
                    e && 1 != a() && (f.saveDataTableValue(g),
                    $("#" + b + "[cid\x3d" + f.cid + "]").find("tr:first").find(".number_component_js").each(function() {
                        $(this).blur()
                    }))
                }) : (a(),
                $("#" + b + "[cid\x3d" + f.cid + "]").find("tr:first").find(".number_component_js").each(function() {
                    $(this).blur()
                }))
            }),
            $("#" + b + "[cid\x3d" + f.cid + "] .j_scrollSubform").scroll(function() {
                var e = $(this).scrollLeft()
                  , a = this.offsetWidth
                  , c = this.scrollWidth;
                0 == e ? $(this).find(".j_arrow-left").addClass("hide") : $(this).find(".j_arrow-left").removeClass("hide");
                c == e + a ? $(this).find(".j_arrow-right").addClass("hide") : $(this).find(".j_arrow-right").removeClass("hide")
            }),
            d.on("tap", "#" + b + "[cid\x3d" + f.cid + "] .j_arrow-right", function() {
                var e = $(this).parents(".j_scrollSubform").get(0)
                  , a = e.offsetWidth
                  , e = e.scrollWidth;
                $(this).parents(".j_scrollSubform").scrollLeft(e - a)
            }),
            d.on("tap", "#" + b + "[cid\x3d" + f.cid + "] .j_arrow-left", function() {
                var e = $(this).parents(".j_scrollSubform").get(0)
                  , a = e.offsetWidth
                  , e = e.scrollWidth;
                $(this).parents(".j_scrollSubform").scrollLeft(a - e)
            }),
            f.isEditRow(f.componentSetup.layoutDetail)))
                d.on("tap", "#" + b + "[cid\x3d" + f.cid + "] .subtable_js .subtr_js:not(:eq(0))", function() {
                    var e = $(this);
                    setTimeout(function() {
                        $("#mobile-subFillDetail").remove();
                        var a = f.componentSetup.subFormId
                          , c = e.attr("index");
                        f.mobilefillDetail(c);
                        c = formPlugin.assembleFormFieldData(e);
                        if (null != c)
                            for (var b = 0; b < c.length; b++)
                                c[b].subForm = null;
                        b = $("#mobile-subFillDetail");
                        b.find(".j_continueSave").attr("id", "j_deleteSubForm" + a).attr("cid", f.cid).data("removerEl", e).text("\u5220\u9664");
                        formPlugin.fillFieldContent(c, b)
                    }, 500)
                })
        },
        conditionEvent: function(h) {
            (this.el || $(document)).find("#" + (null == this.componentSetup.subFormId || "" == this.componentSetup.subFormId ? this.cid : this.componentSetup.subFormId) + "[cid\x3d" + this.cid + "] th").each(function(g) {
                var f = $(this)
                  , d = f.data("componentData");
                d && d.componentSetup.condition && d.componentSetup.condition.fields && $.each(d.componentSetup.condition.fields, function(b, c) {
                    h.on("change", "#field_" + c.fieldId + " select,#field_" + c.fieldId + " input[componentkey\x3d'Option'] ", function() {
                        d.checkShow(f)
                    });
                    h.on("datacheck", "#field_" + c.fieldId + "[componentkey\x3d'DataSource']", function() {
                        d.checkShow(f)
                    })
                })
            })
        },
        autoSaveEvents: function(h) {},
        saveDataTableValue: function(h, g) {
            var f = this.componentSetup.subFormId
              , d = $("#" + f + "[cid\x3d'" + this.cid + "']");
            if (0 < d.length) {
                var b = $.extend({}, h);
                b.parentEl = d;
                b.dataDetails = g;
                formPlugin.saveFieldData(b, f)
            }
        },
        addRow: function(h, g, f) {
            var d = null == this.componentSetup.subFormId || "" == this.componentSetup.subFormId ? this.cid : this.componentSetup.subFormId
              , b = $("#" + d + "[cid\x3d" + this.cid + "] tbody").attr("cmodule")
              , c = $("#" + d + "[cid\x3d" + this.cid + "] tbody").data("form")
              , l = this.checkCallback
              , e = this.componentSetup.layoutDetail
              , a = $(this.tpl).siblings("#operating-datatable")
              , k = $("\x3ctr class\x3d'subtr_js'\x3e");
            if ("true" == this.componentSetup.showSreial || 1 == this.componentSetup.showSreial) {
                var m = $("\x3ctd class\x3d'sn subtdSreial_js'\x3e");
                k.append(m)
            }
            for (var r = [], q = 0; q < e.length; q++) {
                var p = e[q]
                  , m = $("\x3ctd class\x3d'subtd_js'\x3e")
                  , n = p.componentKey;
                this.renderDisableModule(n) && m.addClass("hide");
                if (this.componentSetup.fieldReads) {
                    var v = this.componentSetup.fieldReads[p.fieldId];
                    "DateInterval" == p.componentKey ? v = this.componentSetup.fieldReads[p.start.fieldId] : "ComboSelect" == p.componentKey && (v = this.componentSetup.fieldReads[p.selects[0].fieldId]);
                    "undefined" == typeof v || v || m.addClass("hide")
                }
                v = new window[p.componentKey](p);
                if ("DateInterval" == p.componentKey || "ComboSelect" == p.componentKey)
                    this.componentSetup.fieldWrites && (p.fieldWrites = this.componentSetup.fieldWrites),
                    this.componentSetup.fieldReads && (p.fieldReads = this.componentSetup.fieldReads);
                var s = this.isReadOnly;
                if (!s && p.fieldId && this.componentSetup.fieldWrites) {
                    var A = this.componentSetup.fieldWrites[p.fieldId];
                    "DateInterval" == p.componentKey ? A = this.componentSetup.fieldWrites[p.start.fieldId] : "ComboSelect" == p.componentKey && (A = this.componentSetup.fieldWrites[p.selects[0].fieldId]);
                    "undefined" == typeof A || A || (s = !0)
                }
                p = this.notDefault;
                null != h && (p = h);
                m.data("form", c);
                "ComboSelect" == n ? (n = [],
                n.index = q,
                n.dataId = this.componentSetup.subFormId,
                n.dataCid = this.cid,
                v.renderPreview(m, p, s, n)) : v.renderPreview(m, p, s, "", b);
                s && m.find(".field_js").addClass("fieldReadOnly");
                r[q] = v;
                k.append(m);
                q == e.length - 1 && this.isEditRow(e) && (m = a.find(".subtroper_js").clone(),
                k.append(m))
            }
            k.find(".widget-title_js").parent().hide();
            k.find(".field-description").remove();
            g ? (g.after(k),
            g.parents(".j_formMaximizeX") && $("#datatableMaximize .j_formMaximizeX").css("height", $("#datatableMaximize .form-data").height())) : f ? f.find("#" + d + "[cid\x3d" + this.cid + "] .subtable_js tbody").append(k) : ($("#" + d + "[cid\x3d" + this.cid + "] .subtable_js tbody").append(k),
            $("#" + d + "[cid\x3d" + this.cid + "] .subtable_js tbody").parents(".j_formMaximizeX") && $("#datatableMaximize .j_formMaximizeX").css("height", $("#datatableMaximize .form-data").height()));
            f ? f.find("#" + d + "[cid\x3d" + this.cid + "] .subtable_js tbody").find("tr:first").children().each(function(a) {
                $(this).hasClass("form-condition-hide") && k.children(":eq(" + a + ")").addClass("form-condition-hide")
            }) : $("#" + d + "[cid\x3d" + this.cid + "] .subtable_js tbody").find("tr:first").children().each(function(a) {
                $(this).hasClass("form-condition-hide") && k.children(":eq(" + a + ")").addClass("form-condition-hide")
            });
            this.resizeSreial();

            for (q = 0; q < r.length; q++)
                v = r[q],
                v.checkEvents(l, this.autoSave),
                v.conditionEvent(this.el, this.autoSave),
                this.autoSave && !this.isReadOnly && v.autoSaveEvents(this.autoSave);                
            h || (k.find(".check_js").each(function() {
                var a = $(this).data("componentData");
                a && a.componentSetup.relateField && a.fillRelateValue(a.componentSetup.relateField.fieldId, k, null, !1)
            }),
            k.find("input[componentkey\x3d'Monitor']").each(function() {
                $(this);
                var a = $(this).data("componentData");
                a && a.getMonitorValue()
            }));
            f || formPlugin.renderTotal($("[id\x3d'" + d + "'][cid\x3d'" + this.cid + "']"))
        },
        printVerticaltable: function(h) {
            var g = this
              , f = h.find(".subtr_js:gt(0)")
              , d = $("\x3cdiv class\x3d'js_vertical_table vertical-table hide'\x3e\x3c/div\x3e");
            f.each(function(b) {
                $this = $(this);
                d.append("\x3cspan class\x3d'line'\x3e\x3cspan class\x3d'text'\x3e" + g.componentSetup.title + "\uff08\u7b2c" + formPlugin.priToAry(b + 1) + "\u884c)\x3c/span\x3e\x3c/span\x3e");
                var c = $("\x3cdiv class\x3d'js_vertical_row content'\x3e\x3c/div\x3e");
                $this.find("td").each(function(b) {
                    $this = $(this);
                    $this.hasClass("subtdSreial_js") ? c.append("\x3cdiv class\x3d'field_js' style\x3d'display:none'\x3e\x3c/div\x3e") : (c.append($(this).html()),
                    $this.is(":visible") || c.children(":last").addClass("hide"))
                });
                d.append(c)
            });
            d.find(".widget-title_js").parent().show();
            h.append(d)
        },
        resizeSreial: function() {
            $("#" + (null == this.componentSetup.subFormId || "" == this.componentSetup.subFormId ? this.cid : this.componentSetup.subFormId) + "[cid\x3d" + this.cid + "] tbody tr.subtr_js").each(function(h) {
                $(this).find(".subtdSreial_js").html(h)
            })
        },
        removeRow: function(h, g) {
            var f = h.parents(".subtr_js")
              , d = f.index();
            g || (g = this.el.closest(".form-view_js"));
            var b = g.data("subFormdata")
              , c = !1;
            b && f.find(".subtd_js.form-condition-hide,.subtd_js.hide").each(function() {
                var e = $(this).find(".check_js")
                  , a = e.data("componentData");
                if (b[e.attr("id") + d] && a && a.getValue(e))
                    return c = !0,
                    !1
            });
            if(f.find(".subtr_js").length>1) f.find(".subtr_js").eq(0).hide();
            else f.find(".subtr_js").eq(0).show();

            if (c)
                return formPlugin.notify("\u8be5\u884c\u6709\u5176\u4ed6\u6570\u636e,\u8bf7\u6e05\u7a7a\u518d\u5220\u9664\uff01"),
                c;
            formPlugin.destroyEvents(f);
            var l = h.parents(".subform_js");
            f.remove();
            f.parents(".j_formMaximizeX") && $("#datatableMaximize .j_formMaximizeX").css("height", $("#datatableMaximize .form-data").height());
            formPlugin.renderTotal(l);
            this.resizeSreial();
            return c
        },
        readOnly: function(h, g) {
            var f = h.find("#" + (null == this.componentSetup.subFormId || "" == this.componentSetup.subFormId ? this.cid : this.componentSetup.subFormId) + "[cid\x3d" + this.cid + "] .subtable_js");
            if (this.isReadOnly = g)
                f.find(".subtr_js .subthoper_js").remove(),
                f.find(".subtr_js .subtroper_js").remove();
            else if (null == f.find(".subtr_js .subthoper_js").get(0)) {
                var d = $(this.tpl).siblings("#operating-datatable")
                  , b = d.find(".subthoper_js").clone()
                  , d = d.find(".subtroper_js").clone();
                f.find(".subtr_js").eq(0).append(b);
                f.find(".subtr_js").not(":eq(0)").append(d);
                if(f.find(".subtr_js").length>1) f.find(".subtr_js").eq(0).hide();
                else f.find(".subtr_js").eq(0).show();
                f.find("tfoot tr").append('\x3ctd class\x3d"subtroper_js"\x3e\x3c/td\x3e')
            }
        },
        maximize: function(h) {
            var g = this
              , f = null == this.componentSetup.subFormId || "" == this.componentSetup.subFormId ? this.cid : this.componentSetup.subFormId
              , d = f + this.cid
              , b = $(this.tpl).siblings("#datatableMaximize").clone();
            $("body").append("\x3cdiv id\x3d'" + d + "'\x3e\x3c/div\x3e");
            $("#" + d).append(b);
            var c = $("div[id\x3d'" + f + "'][cid\x3d'" + this.cid + "']")
              , b = c.find(".subtable_js tbody tr").length - 1
              , l = $("#datatableMaximize #maximizePreview");
            l.data("form", {
                module: g.curModule,
                formId: g.options.formId      //g.formObj.formId
            });
            var e = {};
            this.componentSetup.fieldReads && (e.fieldReads = this.componentSetup.fieldReads);
            this.componentSetup.fieldWrites && (e.fieldWrites = this.componentSetup.fieldWrites);
            formPlugin.analyseComponent(this.componentSetup, l, null, this.isReadOnly, e);
            formPlugin.subFormFillRows([{
                maxIndex: b,
                subFormId: f
            }], l);
            b = formPlugin.assembleFormFieldData(c);
            g.dataDetailsStr = JSON.stringify(b);
            formPlugin.fillFieldContent(b, l);
            $("#" + d).find(".form-view_js").data("subFormdata", g.el.closest(".form-view_js").data("subFormdata"));
            l.find(".subtable_js tr").each(function(a) {
                var e = $(this);
                a = c.find(".subtable_js tr:eq(" + a + ")");
                a.hasClass("form-condition-hide") ? e.addClass("form-condition-hide") : a.children().each(function(a) {
                    $(this).hasClass("form-condition-hide") && e.children(":eq(" + a + ")").addClass("form-condition-hide")
                })
            });
            $("#datatableMaximize").modal();
            $("#" + f + g.cid).on("hidden.bs.modal", function() {
                $(this).find("#datatableMaximize").length && g.minimize(h);
                $(this).remove()
            });
            $("#" + f + g.cid).on("shown.bs.modal", function() {
                $(this).find("#datatableMaximize").length && setTimeout(function() {
                    g.frozenColumn(l)
                }, 100)
            });
            $("#maximizePreview .form-databox").addClass("j_formMaximizeX").css({
                "max-height": "auto",
                "border-style": "solid",
                "border-color": "#ddd",
                "border-width": "0 1px"
            });
            $("#maximizePreview .form-data").addClass("form-data-noscroll");
            $("#maximizePreview .j_formLine").css({
                height: $("#maximizePreview .j_formMaximizeScr").height() - 20,
                bottom: ""
            });
            setTimeout(function() {
                var a;
                $("#datatableMaximize .j_formMaximizeX").mCustomScrollbar({
                    axis: "x",
                    theme: "darkblue",
                    scrollInertia: 100,
                    scrollButtons: {
                        enable: !0
                    },
                    mouseWheel: {
                        enable: !1
                    },
                    callbacks: {
                        whileScrolling: function() {
                            $("#datatableMaximize .subtable_js_clone").css("left", Math.abs(this.mcs.left) + "px");
                            $("#datatableMaximize .j_formLine").css("left", Math.abs(this.mcs.left) + $("#datatableMaximize .subtable_js_clone").innerWidth() + "px");
                            a = Math.abs($("#datatableMaximize .j_formMaximizeX .mCSB_dragger").css("left"))
                        }
                    }
                });
                $("#datatableMaximize .j_formMaximizeScr").mCustomScrollbar({
                    axis: "y",
                    theme: "darkblue",
                    scrollButtons: {
                        enable: !0
                    },
                    mouseWheel: {
                        enable: !0
                    },
                    scrollInertia: 100,
                    callbacks: {
                        whileScrolling: function() {
                            var e = $("#datatableMaximize .j_formMaximizeScr").innerHeight() + Math.abs($("#datatableMaximize .j_formMaximizeScr\x3e.mCustomScrollBox\x3e.mCSB_container").css("top").slice(0, -2))
                              , c = $("#datatableMaximize .j_formMaximizeScr\x3e.mCustomScrollBox\x3e.mCSB_container");
                            Math.abs(c.css("top").slice(0, -2));
                            $("#datatableMaximize .j_formMaximizeX .mCSB_dragger").css("left", a);
                            g.updateScroller(e)
                        }
                    }
                });
                $("#datatableMaximize .j_formLine").css("height", $("#datatableMaximize .j_formMaximizeScr").innerHeight() - 20);
                $("#datatableMaximize .j_formMaximizeX").css("height", $("#datatableMaximize .form-data").height());
                $("#datatableMaximize .j_formMaximizeX .mCSB_container").css("margin-bottom", "0px");
                var e = $("#datatableMaximize .j_formMaximizeScr").innerHeight();
                g.updateScroller(e)
            }, 200)
        },
        updateScroller: function(h) {
            var g = $("#datatableMaximize .j_formMaximizeX").find(".mCSB_scrollTools")
              , f = $(".j_datatableTitle").hasClass("hide") ? 0 : $("#datatableMaximize .form-databox-head").height() + 2;
            g.css({
                top: h - 33 - f + "px",
                "z-index": "3"
            })
        },
        minimize: function(h) {
            var g = null == this.componentSetup.subFormId || "" == this.componentSetup.subFormId ? this.cid : this.componentSetup.subFormId
              , f = $("div[id\x3d'" + g + "'][cid\x3d'" + this.cid + "']")
              , d = $("#datatableMaximize .modal-body");
            formPlugin.destroyEvents(d);
            var b = formPlugin.assembleFormFieldData(d);
            formPlugin.setEmpty(f);
            d = d.find(".subtable_js tbody tr").length - 1;
            formPlugin.subFormFillRows([{
                maxIndex: d,
                subFormId: g
            }], f.parent());
            formPlugin.fillFieldContent(b, f.parent());
            this.dataDetailsStr != JSON.stringify(b) && (f.find("tr:first").find(".number_component_js").each(function() {
                $(this).blur()
            }),
            h && this.saveDataTableValue(h, b));
            this.dataDetailsStr = null
        },
        setupFields: function() {
            var h = this.componentSetup.layoutDetail
              , g = this.componentSetup.NOShow
              , f = $(this.tpl).siblings("#preview-filed");
            $("#setupFields").remove();
            $("body").append("\x3cdiv id\x3d'setupFields'\x3e\x3c/div\x3e");
            this.changeFields();
            $("#setupFields").append(f);
            if ("true" == this.componentSetup.showSreial || 1 == this.componentSetup.showSreial) {
                var d = f.find("#columnFiledsClone li").clone()
                  , b = d.find(".j_column")
                  , c = d.find(".j_filedName");
                g.isHide && (b.attr("checked", !0),
                b.get(0).checked = !0);
                b.data("field", g);
                c.html("\u5e8f\u53f7");
                f.find("#columnFileds").append(d)
            }
            for (var l = 0; l < h.length; l++)
                g = h[l],
                d = f.find("#columnFiledsClone li").clone(),
                this.componentSetup.fieldReads && (b = this.componentSetup.fieldReads[g.fieldId],
                "DateInterval" == g.componentKey ? b = this.componentSetup.fieldReads[g.start.fieldId] : "ComboSelect" == g.componentKey && (b = this.componentSetup.fieldReads[g.selects[0].fieldId]),
                "undefined" == typeof b || b || d.addClass("hide")),
                b = d.find(".j_column"),
                c = d.find(".j_filedName"),
                g.isHide && (b.attr("checked", !0),
                b.get(0).checked = !0),
                b.data("field", g),
                c.html(g.title),
                f.find("#columnFileds").append(d);
            $("#" + this.componentSetup.subFormId + "[cid\x3d" + this.cid + "]").find("tr:first").find("td").each(function(e) {
                $(this).hasClass("form-condition-hide") && f.find("#columnFileds").find("li:eq(" + e + ")").addClass("form-condition-hide")
            });
            $("#preview-filed").modal()
        },
        changeFields: function() {
            var h = this
              , g = null == this.componentSetup.subFormId || "" == this.componentSetup.subFormId ? this.cid : this.componentSetup.subFormId;
            $("body").off("change", "#setupFields .j_column").on("change", "#setupFields .j_column", function() {
                var f = $(this).data("field")
                  , d = $(this).parents(".checkbox").index();
                $(this).is(":checked") ? ($("#" + g + "[cid\x3d" + h.cid + "] table tr").each(function() {
                    var e = $(this).find("th,td").eq(d);
                    e.addClass("hide").addClass("j_print_temp_table_hide");
                    e.next().css("border-left", "none")
                }),
                $("#" + g + "[cid\x3d" + h.cid + "] .js_vertical_table .js_vertical_row").each(function() {
                    $(this).find(".field_js").eq(d).addClass("hide").addClass("j_print_temp_table_hide")
                }),
                f.isHide = !0) : (f.isHide = !1,
                $("#" + g + "[cid\x3d" + h.cid + "] table tr").each(function() {
                    $(this).find("th,td").eq(d).removeClass("hide").removeClass("j_print_temp_table_hide")
                }),
                $("#" + g + "[cid\x3d" + h.cid + "] .js_vertical_table .js_vertical_row").each(function() {
                    $(this).find(".field_js").eq(d).removeClass("hide").removeClass("j_print_temp_table_hide")
                }));
                if (h.componentSetup.crossPrint && "false" != h.componentSetup.crossPrint && 0 != h.componentSetup.crossPrint)
                    $("#" + g + "[cid\x3d" + h.cid + "] .js_vertical_table table tr").find("td,th").attr("style", ""),
                    $("#" + g + "[cid\x3d" + h.cid + "] .js_vertical_table table tr").each(function() {
                        $(this).find("th:not('.hide'):last,td:not('.hide'):last").css("border-right", "none")
                    });
                else {
                    $("#" + g + "[cid\x3d" + h.cid + "] .form-databox table tr").each(function() {
                        $(this).find("th:not('.hide'):last,td:not('.hide'):last").css("border-right", "none")
                    });
                    for (var f = $("#" + g + "[cid\x3d" + h.cid + "] .form-databox table tr:first th:not('.hide')"), b = 0; b < f.length - 1; b++) {
                        var c = f[b];
                        $(c).width($(c).width())
                    }
                }
                $("#" + g + "[cid\x3d" + h.cid + "] table tfoot").removeClass("hide");
                var l = !0;
                $("#" + g + "[cid\x3d" + h.cid + "] table tfoot").find("td:visible").each(function() {
                    if ($(this).text().trim())
                        return l = !1
                });
                l ? $("#" + g + "[cid\x3d" + h.cid + "] table tfoot").addClass("hide") : $("#" + g + "[cid\x3d" + h.cid + "] table tfoot").removeClass("hide")
            })
        },
        addTotalRow: function(h) {
            var g = this.componentSetup.layoutDetail
              , f = this.componentSetup.totalLine
              , d = !1
              , b = $("\x3ctfoot\x3e\x3ctr\x3e\x3c/tr\x3e\x3c/tfoot\x3e");
            if ("true" == this.componentSetup.showSreial || 1 == this.componentSetup.showSreial) {
                var c = $("\x3ctd\x3e\x3c/td\x3e");
                b.find("tr").append(c)
            }
            for (var l = 0; l < g.length; l++) {
                var e = g[l]
                  , a = e.componentKey
                  , k = e.fieldId || e.tempId
                  , m = e.type
                  , c = $("\x3ctd\x3e\x3c/td\x3e");
                if (this.componentSetup.fieldReads) {
                    var r = this.componentSetup.fieldReads[e.fieldId];
                    "DateInterval" == e.componentKey ? r = this.componentSetup.fieldReads[e.start.fieldId] : "ComboSelect" == e.componentKey && (r = this.componentSetup.fieldReads[e.selects[0].fieldId]);
                    "undefined" == typeof r || r || c.addClass("hide")
                }
                if ("Money" == a || "NumberComponent" == a || "Monitor" == a)
                    -1 == $.inArray(e.tempId, f) && c.html('\u5408\u8ba1\uff1a\x3cspan name\x3d"' + k + '" type\x3d"' + a + '" tp\x3d"' + m + '"\x3e0\x3c/span\x3e'),
                    d = !0;
                b.find("tr").append(c)
            }
            d && ("mobile" != window.systemInfo_form ? (this.isEditRow(g) && b.find("tr").append('\x3ctd class\x3d"subtroper_js"\x3e\x3c/td\x3e'),
            h.find('div[cid\x3d"' + this.cid + '"]').find(".subtable_js").append(b),
            h.find('div[cid\x3d"' + this.cid + '"]').find(".subtable_js").find("tr:first").children().each(function(a) {
                $(this).hasClass("form-condition-hide") && b.find("tr").children(":eq(" + a + ")").addClass("form-condition-hide")
            })) : ($('.j_formpreview div[cid\x3d"' + this.cid + '"]').find(".subtable_js").append(b),
            $('.j_formpreview div[cid\x3d"' + this.cid + '"]').find(".subtable_js").find("tr:first").children().each(function(a) {
                $(this).hasClass("form-condition-hide") && b.find("tr").children(":eq(" + a + ")").addClass("form-condition-hide")
            })),
            0 == b.find("td:not(.form-condition-hide)").children().length && b.addClass("form-condition-hide"))
        },
        mobilefillDetail: function(h) {
            var g = this.componentSetup.subFormId
              , f = this.cid;
            $("#ebgformdetailView,#flow-info,#preview_m,#datareport-info,#biaogeform-container,#write-report,#datareportdetail-info,#edit-blog,.js-freeform-el").addClass("hide");
            $(".j_freepage").addClass("hide");
            var d = $(this.tpl);
            $("body").find("#mobile-subFillDetail").remove();
            for (var d = d.siblings("#mobile-subFillDetail"), b = this.checkCallback, c = this.componentSetup.layoutDetail, l = $('\x3cdiv id\x3d"subForm-fill-detail" class\x3d"form-preview form-view_js"\x3e\x3c/div\x3e'), e = [], a = 0; a < c.length; a++) {
                var k = c[a]
                  , m = new window[k.componentKey](k);
                if ("DateInterval" == k.componentKey || "ComboSelect" == k.componentKey)
                    this.componentSetup.fieldWrites && (k.fieldWrites = this.componentSetup.fieldWrites),
                    this.componentSetup.fieldReads && (k.fieldReads = this.componentSetup.fieldReads);
                var r = this.isReadOnly;
                if (!r && k.fieldId && this.componentSetup.fieldWrites) {
                    var q = this.componentSetup.fieldWrites[k.fieldId];
                    "DateInterval" == k.componentKey ? q = this.componentSetup.fieldWrites[k.start.fieldId] : "ComboSelect" == k.componentKey && (q = this.componentSetup.fieldWrites[k.selects[0].fieldId]);
                    "undefined" == typeof q || q || (r = !0)
                }
                l.data("form", this.formObj);
                q = this.notDefault;
                h || (q = !1);
                m.renderPreview(l, q, r, "", this.curModule);
                this.componentSetup.fieldReads && (q = this.componentSetup.fieldReads[k.fieldId],
                "DateInterval" == k.componentKey ? q = this.componentSetup.fieldReads[k.start.fieldId] : "ComboSelect" == k.componentKey && (q = this.componentSetup.fieldReads[k.selects[0].fieldId]),
                "undefined" == typeof q || q || l.children().last().addClass("hide"));
                r && l.find(".field_js").addClass("fieldReadOnly");
                $("#" + g + "[cid\x3d" + this.cid + "]").find("tr:first").children(".subtd_js").each(function(a) {
                    $(this).hasClass("form-condition-hide") && l.children(":eq(" + a + ")").addClass("form-condition-hide")
                });
                e[a] = m
            }
            d.find(".j_moblieSubForm").prepend(l);
            $("body").append(d);
            for (a = 0; a < e.length; a++)
                m = e[a],
                m.checkEvents(b),
                m.conditionEvent();
            h ? $("#mobile-subFillDetail .j_confirmAdd").attr("index", h) : ($("#mobile-subFillDetail .j_confirmAdd").removeAttr("index"),
            l.find(".check_js").each(function() {
                var a = $(this).data("componentData");
                a && a.componentSetup.relateField && a.fillRelateValue(a.componentSetup.relateField.fieldId, l)
            }),
            l.find("input[componentkey\x3d'Monitor']").each(function() {
                $(this);
                var a = $(this).data("componentData");
                a && a.getMonitorValue()
            }));
            $("#mobile-subFillDetail .j_continueSave").attr("id", "j_continueSave" + g).attr("cid", f);
            $("#mobile-subFillDetail .j_confirmAdd").attr("id", "j_confirmAdd" + g).attr("cid", f)
        },
        mobileAddRow: function(h) {
            var g = this
              , f = formPlugin.assembleFormFieldData($("#mobile-subFillDetail #subForm-fill-detail"))
              , d = $( "div[cid\x3d" + g.cid + "] .subtable_js .subtr_js")
              , b = null
              , b = h ? d.eq(h) : d.eq(d.length - 1);

            if(d.length>1) d.eq(0).hide();
            else d.eq(0).show();
            b.find(".subtroper_js").remove();
            b.find(".check_js").each(function(c) {
                c = $(this).data("componentData");
                var b = $(this).parents(".subtd_js");
                b.empty();
                var e = g.isReadOnly;
                if (!e && c.componentSetup.fieldId && g.componentSetup.fieldWrites) {
                    var a = g.componentSetup.fieldWrites[c.componentSetup.fieldId];
                    "DateInterval" == c.componentSetup.componentKey ? a = g.componentSetup.fieldWrites[c.componentSetup.start.fieldId] : "ComboSelect" == c.componentSetup.componentKey && (a = g.componentSetup.fieldWrites[c.componentSetup.selects[0].fieldId]);
                    "undefined" == typeof a || a || (e = !0)
                }
                b.data("form", g.formObj);
                c.renderPreview(b, g.notDefault, g.fieldWrite, "", g.curModule);
                e && b.find(".field_js").addClass("fieldReadOnly");
             //   b.find(".widget-title").remove()
            });
            formPlugin.fillFieldContent(f, b);
            g.mobileShow(b, f)
        },
        mobileShow: function(h, g) {
            var f = this;
            var cc = $( "div[cid\x3d" + f.cid + "]")

            h.find(".widget-content").siblings(".j_subField").remove();
            h.find(".widget-content").addClass("hide");
            for (var d = 0; d < g.length; d++) {
                var b = g[d]
                  , c = b.content
                  , l = b.dataText
                  , e = b.dataOptions
                  , a = b.formField.id || parseInt(cc.attr('id'))
                  , k = h.find("#" + a);
                0 == k.length && (k = h.find("#field_" + a));
                k = k.parents(".widget-content");
                a = k.find("#" + a).attr("componentKey");
                "NumberComponent" == a && "percentage" == b.type ? k.parent().addClass("field-percentage").append('\x3cdiv class\x3d"j_subField sub-field"\x3e\x3c/div\x3e\x3cspan id\x3d"type-item" class\x3d"input-group-addon"\x3e%\x3c/span\x3e') : k.parent().append('\x3cdiv class\x3d"j_subField"\x3e\x3c/div\x3e');
                k.addClass("hide");
                var k = k.next()
                  , m = f.componentSetup.formId;

                if (e)
                    for (var r = 0; r < e.length; r++) {
                        var q = e[r].content
                          , p = e[r].type
                          , n = e[r].optionId;
                        if (p && "einvoice" == p) {
                            k.append("\x3cspan class\x3d'einvoice-preview-js'\x3e" + e.length + "\u5f20\u7535\u5b50\u53d1\u7968\x3c/span\x3e");
                            break
                        } else {

                            p && "imageFile" == p ? k.append('\x3cimg src\x3d"'+TEAMS.api.downImgUrl+'/' + n + '?module\x3dform"\x3e') : e[r].targetId && 0 < e[r].targetId.length ? k.append('\x3cimg src\x3d"'+TEAMS.api.downImgUrl+'/' + e[r].targetId  + '?module\x3dform" title\x3d"' + q + '"\x3e') : k.append("\x3cspan class\x3d'sub-title'\x3e" + q + "\x3c/span\x3e")
                         }
                    }

                if (c)
                    if ("Money" == a)
                        if (p = b.type)
                            b = f.getTypeName(p),
                            k.append("\x3cspan class\x3d'mr-10'\x3e" + c + "\x3c/span\x3e\x3cspan class\x3d''\x3e(" + b + ")\x3c/span\x3e");
                        else {
                            if (f = k.parent().find(".check_js").data("componentData"))
                                p = f.componentSetup.type,
                                k.append("\x3cspan class\x3d'mr-10'\x3e" + c + "\x3c/span\x3e\x3cspan class\x3d''\x3e(" + p + ")\x3c/span\x3e")
                        }
                    else
                        k.append("\x3cspan class\x3d'mr-10'\x3e" + c + "\x3c/span\x3e");
                l && l.content && k.append("\x3cspan\x3e" + l.content + "\x3c/span\x3e")
            }
            null == h.find(".j_subField").get(0) && h.remove()
        },
        getTypeName: function(h) {
            var g = "\u4eba\u6c11\u5e01";
            switch (h) {
            case "RMB":
                g = "\u4eba\u6c11\u5e01";
                break;
            case "DOLLAR":
                g = "\u7f8e\u5143";
                break;
            case "YEN":
                g = "\u65e5\u5143";
                break;
            case "EURO":
                g = "\u6b27\u5143";
                break;
            case "HK":
                g = "\u6e2f\u5e01";
                break;
            case "TAIWAN":
                g = "\u53f0\u5e01";
                break;
            case "SINGAPORE":
                g = "\u65b0\u52a0\u5761\u5e01";
                break;
            case "POUND":
                g = "\u82f1\u9551"
            }
            return g
        },
        createSerial: function() {
            $("#" + this.cid + "[cid\x3d" + this.cid + "] .subtable_js .subtr_js").not(":eq(0)").each(function(h) {
                $(this).attr("index", h + 1);
                $(this).find(".subtd_js .check_js").removeClass("date-selected");
                $(this).find(".subtd_js .check_js input").removeClass("date-selected");
                $(this).find(".subtd_js .check_js .js_useritem_container").removeClass("entity-seleted")
            })
        },
        initPage: function(h) {
            $("#ebgformdetailView,#flow-info,#preview_m,#datareport-info,#biaogeform-container,#write-report,#datareportdetail-info,#edit-blog,.js-freeform-el").removeClass("hide");
            $(".j_freepage").removeClass("hide");
            $("body #mobile-subFillDetail").remove()
        },
        getValue: function(h, g) {
            var f = {
                title: this.componentSetup.title,
                subFormId: this.componentSetup.subFormId,
                removeRowNumber: this.removeRowNumber,
                addRowNumber: this.addRowNumber
            };
            this.removeRowNumber = this.removeRowNumber = 0;
            return f
        },
        isEditRow: function(h) {
            var g;
            if (this.isReadOnly)
                return !1;
            g = !0;
            if (this.componentSetup.fieldWrites && h) {
                g = !1;
                for (var f = 0; f < h.length; f++) {
                    var d = h[f]
                      , b = this.componentSetup.fieldWrites[d.fieldId]
                      , c = this.componentSetup.fieldReads[d.fieldId];
                    "DateInterval" == d.componentKey ? (b = this.componentSetup.fieldWrites[d.start.fieldId],
                    c = this.componentSetup.fieldReads[d.start.fieldId]) : "ComboSelect" == d.componentKey && (b = this.componentSetup.fieldWrites[d.selects[0].fieldId],
                    c = this.componentSetup.fieldReads[d.selects[0].fieldId]);
                    if ("undefined" == typeof b || (c || "undefined" == typeof c) && b) {
                        g = !0;
                        break
                    }
                }
            }
            return g
        }
    });
    u.exports = window.DataTable
});
define("form/component/tabcontrol", ["form/component", "form/tplutil"], function(m, y, w) {
    y = m("form/component");
    var k = m("form/tplutil");
    window.TabControl = y.extend({
        initialize: function(e) {
            this.componentSetup = {
                title: "",
                describe: "",
                componentKey: "TabControl",
                heightType: "auto",
                fixedHeight: "",
                formId: "",
                order: 0,
                index: 0,
                tabFormId: "",
                layoutDetail: [],
                tabOptionTitle: []
            };
            null != e && (this.componentSetup.heightType = e.heightType,
            this.componentSetup.fixedHeight = e.fixedHeight,
            this.componentSetup.title = e.title,
            this.componentSetup.describe = e.describe,
            this.componentSetup.order = e.order,
            this.componentSetup.index = e.index,
            this.componentSetup.tabFormId = e.tabFormId,
            this.componentSetup.formId = e.formId,
            this.componentSetup.layoutDetail = e.layoutDetail,
            this.componentSetup.tabOptionTitle = e.tabOptionTitle);
            if (!this.componentSetup.layoutDetail || 0 == this.componentSetup.layoutDetail.length) {
                e = {};
                e.uid = formPlugin.uid();
                e.name = "tab\u98751";
                e.index = 0;
                this.componentSetup.tabOptionTitle[0] = e;
                var d = {
                    index: 0
                };
                d.uid = e.uid;
                d.name = "tab\u98751";
                d.layoutDetail = [];
                this.componentSetup.layoutDetail[0] = d
            }
            this.tpl = k.get("tabcontrol")
        },
        setTitle: function(e) {
            this.componentSetup.title = e
        },
        setDescribe: function(e) {
            this.componentSetup.describe = e
        },
        setHeightType: function(e) {
            this.componentSetup.heightType = e
        },
        setFixedHeight: function(e) {
            this.componentSetup.fixedHeight = e
        },
        render: function(e) {
            var d = $(this.tpl).siblings("#form-tabcontrol");
            e.attr("cid", this.cid);
            e.attr("class", d.attr("class"));
            e.attr("style", "position:relative");
            this.renderTabEditInfo(d, !0);
            e.html(d.html())
        },
        renderEditor: function() {
            var e = $(this.tpl)
              , d = e.siblings("#editor-tabcontrol");
            d.find("input:radio[name\x3d'tab-heightType'][value\x3d'" + this.componentSetup.heightType + "']").attr("checked", "true");
            "fixed" == this.componentSetup.heightType && d.find(".j-tab-fixed-height").removeClass("hide").find("input").val(this.componentSetup.fixedHeight);
            for (var a = 0; a < this.componentSetup.tabOptionTitle.length; a++) {
                var b = e.siblings(".j_tabOptionTitle_clone").clone();
                b.removeClass("j_tabOptionTitle_clone").addClass("j_tab_title");
                b.attr("index", a).attr("uid", this.componentSetup.tabOptionTitle[a].uid).find("input").val(this.componentSetup.tabOptionTitle[a].name);
                d.find(".choicelistEdit_js").append(b)
            }
            $("#editor-component").html(d);
            this.optionDrag()
        },
        renderPreview: function(e, d, a, b, c) {
            var f = this;
            f.curModule = c;
            f.notDefault = d;
            f.autoSave = b;
            f.isReadOnly = a;
            var l = $(f.tpl).siblings("#preview-tabcontrol");
            l.attr("id", "");
            l.attr("cid", this.cid);
            this.el = e;
            "mobile" == window.systemInfo_form ? f.renderPreviewFormMobile(e) : (e.append(l),
            f.renderTabEditInfo(l),
            l.find(".j-tab-li").removeClass("j-tab-li"),
            1 == window.systemInfo_print || "true" == window.systemInfo_print ? (l.find(".j_head-opt").removeClass("hide"),
            setTimeout(function() {
                f.afterBorderDiv(l.find(".j-tab-contents\x3ediv").eq(0));
                l.find(".j-tab-contents\x3ediv").eq(0).children().is(":visible") && l.find(".j-tab-contents").css("border-bottom-width", "0")
            }, 100)) : "fixed" == f.componentSetup.heightType && (l.find(".j-tab-contents").height(25 * Number(f.componentSetup.fixedHeight)),
            l.addClass("form-tabsfixed-wrapper")),
            setTimeout(function() {
                f.beforeBorderDiv(l.find(".j-tab-contents\x3ediv").eq(0))
            }, 1),
            f.checkEvents())
        },
        afterBorderDiv: function(e) {
            var d = 0
              , a = $('\x3cdiv class\x3d"border-div j_border-div"\x3e\x3c/div\x3e')
              , b = e.children().length;
            if (!(0 < e.find(".j_border-div").length || e.parents("body").hasClass("print-template-page") || e.parents("body").hasClass("print-page"))) {
                for (var c = 0; c < b; c++)
                    d += e.children().eq(c).outerHeight();
                d < e.closest(".j-tab-contents").outerHeight() && (e.append(a),
                a.css("height", e.outerHeight() - d))
            }
        },
        beforeBorderDiv: function(e) {
            var d = e.find("div:visible").eq(0)
              , a = $('\x3cdiv class\x3d"before-border-div"\x3e\x3c/div\x3e');
           // 0 < e.find(".before-border-div").length || (d.hasClass("form-tablelayout-wrap") || d.hasClass("form-databox-wrap") || d.hasClass("form-layout")) && a.insertBefore(d)
            0 < e.find(".before-border-div").length || (d.hasClass("form-tablelayout-wrap") || d.hasClass("form-databox-wrap") || d.hasClass("form-layout")) && a.children('.before-border-div').append(d)

        },
        renderEditPreview: function(e) {
            var d = $(this.tpl).siblings("#form-tabcontrol");
            d.data("componentData", this);
            d.attr("cid", this.cid);
            d.attr("style", "position:relative");
            e.append(d);
            this.renderTabEditInfo(d, !0);
            "fixed" == this.componentSetup.heightType && (d.find(".j-tab-contents").height(25 * Number(this.componentSetup.fixedHeight)),
            d.addClass("form-tabsfixed-wrapper"))
        },
        renderTabEditInfo: function(e, d) {
            var a = this
              , b = $(a.tpl);
            e.find(".j-tab-ul").empty();
            e.find(".j-tab-contents").empty();
            if (d) {
                for (var c = 0; c < this.componentSetup.layoutDetail.length; c++) {
                    var f = this.componentSetup.layoutDetail[c];
                    a.addOneTabEidtInfo(b, e, c, f);
                    var l = e.find(".j-tab-contents").find(".j-tab-content[uid\x3d'" + f.uid + "']");
                    if (f && f.layoutDetail)
                        for (var f = f.layoutDetail, g = 0; g < f.length; g++) {
                            var h = f[g];
                            a.analyseComponent(h, l)
                        }
                }
                a.renderEditTabPageClick(e.find(".j-tab-li:first"), e)
            } else {
                for (c = 0; c < this.componentSetup.layoutDetail.length; c++)
                    if (f = this.componentSetup.layoutDetail[c],
                    a.addOneTabEidtInfo(b, e, c, f),
                    l = e.find(".j-tab-contents").find(".j-tab-content[uid\x3d'" + f.uid + "']"),
                    f && f.layoutDetail)
                        for (f = f.layoutDetail,
                        g = 0; g < f.length; g++)
                            h = f[g],
                            formPlugin.analyseComponent(h, l, a.notDefault, a.isReadOnly, a, a.autoSave);
                a.renderPreviewTabPageClick(e.find(".j-tab-head-page:first"), e)
            }
            setTimeout(function() {
                a.setTabheadWidth(e)
            }, 100)
        },
        setTabheadWidth: function(e) {
            var d = 0;
            e.find(".j-tab-ul").parents("body").hasClass("print-page") ? d = e.find(".j-tab-ul").outerWidth() - 132 : (d = e.find(".j-tab-ul").outerWidth(),
            0 == d && (d = e.parents(".module-detail-slide").width() - 69));
            var a = e.find(".j-tab-ul\x3eli").length
              , d = 8 >= a ? d / 8 : d / a;
            e.find(".j-tab-ul\x3eli").css("width", d)
        },
        renderEditTabPageClick: function(e, d) {
            var a = d.find(".j-tab-contents").find(".j-tab-content[uid\x3d'" + e.attr("uid") + "']");
            e.addClass("active").siblings().removeClass("active");
            a.removeClass("hide").siblings().addClass("hide");
            a.addClass("j_tab_content_new").siblings().removeClass("j_tab_content_new");
            $(document).trigger("afterCreateTabPage")
        },
        renderPreviewTabPageClick: function(e, d) {
            var a = d.find(".j-tab-contents").find(".j-tab-content[uid\x3d'" + e.attr("uid") + "']");
            e.addClass("active").siblings().removeClass("active");
            a.removeClass("hide").siblings().addClass("hide");
            "fixed" != this.componentSetup.heightType && (0 == a.find("div").length ? d.find(".j-tab-contents").css("height", 30) : d.find(".j-tab-contents").css("height", ""))
        },
        addOneTabEidtInfo: function(e, d, a, b) {
            var c = e.siblings(".j-tab-head-clone").clone();
            c.removeClass("j-tab-head-clone").addClass("j-tab-li");
            c.attr("index", a).attr("uid", b.uid).html(b.name);
            d.find(".j-tab-ul").append(c);
            e = e.siblings(".j-tab-content-clone").clone();
            e.removeClass("j-tab-content-clone").addClass("j-tab-content");
            e.attr("index", a).attr("uid", b.uid).attr("tabName", b.name);
            d.find(".j-tab-contents").append(e);
            this.setTabheadWidth(d)
        },
        addTabOption: function() {
            var e = $(this.tpl)
              , d = $("#editor-component .choicelistEdit_js");
            if (10 <= d.find(".j_tab_title").length)
                formPlugin.notify("\u6700\u591a\u6dfb\u52a010\u4e2atab\u9875!");
            else {
                var a = formPlugin.uid()
                  , b = "tab\u9875" + (d.find("li").length + 1)
                  , c = d.find("li").length
                  , f = e.siblings(".j_tabOptionTitle_clone").clone();
                f.removeClass("j_tabOptionTitle_clone").addClass("j_tab_title");
                f.attr("index", c).attr("uid", a).find("input").val(b);
                d.append(f);
                d = {};
                d.uid = a;
                d.name = b;
                d.index = c;
                d.layoutDetail = [];
                this.addOneTabEidtInfo(e, $("div[cid\x3d'" + this.cid + "']"), c, d);
                this.findTabLayoutDetail()
            }
        },
        removeTabOption: function(e) {
            var d = $("#editor-component .choicelistEdit_js");
            if (1 == d.find(".j_tab_title").length)
                formPlugin.notify("\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2atab\u9875!");
            else {
                e = e.parents(".j_tab_title");
                var a = e.attr("uid")
                  , b = e.attr("index");
                e.remove();
                d.find(".j_tab_title").each(function(c) {
                    $(this).attr("index", c)
                });
                this.componentSetup.layoutDetail.splice(b, 1);
                $("div[cid\x3d'" + this.cid + "']").find(".j-tab-ul").find(".j-tab-li[uid\x3d'" + a + "']").remove();
                $("div[cid\x3d'" + this.cid + "']").find(".j-tab-contents").find(".j-tab-content[uid\x3d'" + a + "']").remove();
                this.findTabLayoutDetail()
            }
        },
        checkTabOptionName: function(e) {
            if ($.trim(e.val()) != e.attr("oldName")) {
                var d = !1;
                e.parent().siblings("li").each(function(a) {
                    $(this).find(".j_tab_name").val() == e.val() && (e.val(e.attr("oldName")),
                    e.focus(),
                    d = !0)
                });
                d ? formPlugin.notify("tab\u9875\u540d\u79f0\u4e0d\u80fd\u91cd\u590d!") : e.val() ? this.findTabLayoutDetail() : (formPlugin.notify("tab\u9875\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a!"),
                e.val(e.attr("oldName")),
                e.focus())
            }
        },
        findTabLayoutDetail: function() {
            var e = [];
            $("#editor-component .choicelistEdit_js").find(".j_tab_title").each(function(a) {
                var c = {};
                c.uid = $(this).attr("uid");
                c.name = $.trim($(this).find(".j_tab_name").val());
                c.index = a;
                e.push(c)
            });
            this.componentSetup.tabOptionTitle = e;
            for (var d = 0; d < this.componentSetup.tabOptionTitle.length; d++) {
                var a = this.componentSetup.tabOptionTitle[d];
                $("#widget-control div[cid\x3d'" + this.cid + "']").find(".j-tab-ul").find(".j-tab-li[uid\x3d'" + a.uid + "']").attr("index", a.index).html(a.name).attr("title", a.name);
                $("#widget-control div[cid\x3d'" + this.cid + "']").find(".j-tab-contents").find(".j-tab-content[uid\x3d'" + a.uid + "']").attr("tabName", a.name).attr("index", a.index)
            }
        },
        checkEvents: function(e, d) {
            var a = this
              , b = a.el || $(document);
            b.on("click", "div[cid\x3d" + a.cid + "] .j-tab-head-page", function() {
                a.renderPreviewTabPageClick($(this), $(this).parents(".j-preview-tabcontrol"));
                var c = $(this).attr("uid")
                  , f = $(".j-tab-content-page[uid\x3d" + c + "]");
                if (1 == window.systemInfo_print || "true" == window.systemInfo_print) {
                    if ($("#print").hasClass("page-divider-line") && !$(this).hasClass("printPage")) {
                        $(this).addClass("printPage");
                        c = $(this).closest(".j_tabs").find(".j-tab-contents").find(".j-tab-content[uid\x3d'" + $(this).attr("uid") + "']");
                        $(c).find(".field:visible").each(function() {
                            ($(this).parent().hasClass("form-view") || $(this).parent().hasClass("j-tab-content-page")) && $(this).after('\x3cdiv class\x3d"print-devider j_deviderItem"\x3e\x3cdiv class\x3d"devider-sn j_deviderSn"\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-line"\x3e\x3ci class\x3d"icon-scissors"\x3e\x3c/i\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-mark j_devidermark"\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-dele j_deviderdele icon-remove-sign"\x3e\x3c/div\x3e\x3c/div\x3e')
                        });
                        var b = $(c).find(".form-layout_js:visible");
                        0 < b.length && b.each(function() {
                            $(this).after('\x3cdiv class\x3d"print-devider j_deviderItem"\x3e\x3cdiv class\x3d"devider-sn j_deviderSn"\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-line"\x3e\x3ci class\x3d"icon-scissors"\x3e\x3c/i\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-mark j_devidermark"\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-dele j_deviderdele icon-remove-sign"\x3e\x3c/div\x3e\x3c/div\x3e')
                        });
                        c = $(c).find(".table:visible");
                        0 < c.length && c.each(function() {
                            var g = $(this)
                              , h = g.find("tbody tr")
                              , f = "";
                            if (!(1 >= h.length || 0 < g.find("th").length && 2 >= h.length)) {
                                for (var c = 0; c < h.length - 1; c++)
                                    f += '\x3cdiv class\x3d"devider-mark j_table_devider j_devidermark"\x3e\x3c/div\x3e';
                                var a = $('\x3cdiv class\x3d"j_printTriggers print-devider-table-triggers"\x3e' + f + "\x3c/div\x3e");
                                a.css({
                                    top: g.position().top
                                });
                                g.parent().parent().append(a);
                                g.attr("data-dividers-sn", g.index());
                                h.each(function() {
                                    var h = $(this);
                                    a.find(".j_devidermark").eq(h.index()).css({
                                        top: h.position().top + h.innerHeight() - 4
                                    }).attr({
                                        "data-tr": h.index(),
                                        "data-table": g.index()
                                    })
                                });
                                0 < g.find("th").length && a.children().eq(0).css("visibility", "hidden")
                            }
                        })
                    } else
                        $("#print").hasClass("page-divider-line") || $(this).removeClass("printPage");
                    a.afterBorderDiv(f);
                    (1 == window.systemInfo_print || "true" == window.systemInfo_print) && f.eq(0).children().is(":visible") && f.parent().css("border-bottom-width", "0")
                }
                setTimeout(function() {
                    a.beforeBorderDiv(f)
                }, 100)
            });
            b.off("click", "div[cid\x3d" + a.cid + "] .j-print-paved").on("click", "div[cid\x3d" + a.cid + "] .j-print-paved", function() {
                var c = $(this).closest(".j_head-opt").find(".j_tab_headopt").is(":checked")
                  , f = $(this).hasClass("ispaved")
                  , b = $(this).closest(".j_tabs")
                  , g = b.siblings(".j_tab_paved_two")
                  , h = $(this).closest(".j-preview-tabcontrol");
                $(this).closest(".j_head-opt");
                if (c && 1 == c) {
                    if (f && 1 == f)
                        $(this).removeClass("ispaved"),
                        g.addClass("hide"),
                        b.find(".j-tab-contents").removeClass("hide"),
                        h.removeClass("form-tabspaved-wrapper");
                    else {
                        $(this).addClass("ispaved");
                        b.find(".j-tab-contents").addClass("hide");
                        if (!g.hasClass("j_has_init"))
                            for (g.addClass("j_has_init"),
                            c = 0; c < a.componentSetup.layoutDetail.length; c++)
                                if ((f = a.componentSetup.layoutDetail[c]) && f.layoutDetail) {
                                    var n = $("\x3cdiv \x3e\x3c/div\x3e");
                                    n.addClass("j-tab-li paved-head");
                                    n.attr("index", c).attr("uid", f.uid).html(f.name);
                                    g.append(n);
                                    f = b.find(".j-tab-contents").find(".j-tab-content[uid\x3d'" + f.uid + "']").clone(!0);
                                    $(f).removeClass("hide").addClass("paved-content");
                                    g.append(f)
                                }
                        g.removeClass("hide");
                        h.addClass("form-tabspaved-wrapper");
                        b.find(".tabs-head").addClass("tabs-head-block");
                        h = g.find(".j-tab-content-page");
                        h.each(function() {
                            var g = $(this);
                            0 < !g.children().length && g.css("border-top-width", "0")
                        });
                        if ($("#print").hasClass("page-divider-line") && !$(this).hasClass("printPage")) {
                            g.addClass("printPage");
                            var p = '\x3cdiv class\x3d"print-devider j_deviderItem"\x3e\x3cdiv class\x3d"devider-sn j_deviderSn"\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-line"\x3e\x3ci class\x3d"icon-scissors"\x3e\x3c/i\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-mark j_devidermark"\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-dele j_deviderdele icon-remove-sign"\x3e\x3c/div\x3e\x3c/div\x3e'
                              , h = g.find(".form-layout_js:visible");
                            0 < h.length && h.each(function() {
                                $(this).after(p)
                            });
                            var h = g.find(".table:visible")
                              , d = '\x3cdiv class\x3d"j_printTriggers print-devider-table-triggers"\x3e';
                            0 < h.length && h.each(function() {
                                var g = $(this)
                                  , h = g.find("tbody tr")
                                  , f = "";
                                if (!(1 >= h.length || 0 < g.find("th").length && 2 >= h.length)) {
                                    for (var c = 0; c < h.length - 1; c++)
                                        f += '\x3cdiv class\x3d"devider-mark j_table_devider j_devidermark"\x3e\x3c/div\x3e';
                                    var a = $(d + f + "\x3c/div\x3e");
                                    a.css({
                                        top: g.position().top
                                    });
                                    g.parent().parent().append(a);
                                    g.attr("data-dividers-sn", g.index());
                                    h.each(function() {
                                        var h = $(this);
                                        a.find(".j_devidermark").eq(h.index()).css({
                                            top: h.position().top + h.innerHeight() - 4
                                        }).attr({
                                            "data-tr": h.index(),
                                            "data-table": g.index()
                                        })
                                    });
                                    0 < g.find("th").length && a.children().eq(0).css("visibility", "hidden")
                                }
                            })
                        } else
                            $("#print").hasClass("page-divider-line") || g.removeClass("printPage")
                    }
                    b.find(".j-tab-ul").addClass("hide");
                    g.find(".j-tab-li").addClass("hide")
                } else if (f && 1 == f)
                    $(this).removeClass("ispaved"),
                    b.find(".j-tab-contents").removeClass("hide"),
                    b.find(".j-tab-ul").removeClass("hide"),
                    g.addClass("hide"),
                    h.removeClass("form-tabspaved-wrapper");
                else {
                    $(this).addClass("ispaved");
                    if (!g.hasClass("j_has_init"))
                        for (g.addClass("j_has_init"),
                        c = 0; c < a.componentSetup.layoutDetail.length; c++)
                            (f = a.componentSetup.layoutDetail[c]) && f.layoutDetail && (n = $("\x3cdiv \x3e\x3c/div\x3e"),
                            n.addClass("j-tab-li paved-head"),
                            n.attr("index", c).attr("uid", f.uid).html(f.name),
                            g.append(n),
                            f = b.find(".j-tab-contents").find(".j-tab-content[uid\x3d'" + f.uid + "']").clone(!0),
                            $(f).removeClass("hide").addClass("paved-content"),
                            g.append(f));
                    b.find(".j-tab-contents").addClass("hide");
                    b.find(".j-tab-ul").addClass("hide");
                    g.removeClass("hide");
                    h.addClass("form-tabspaved-wrapper");
                    g.find(".j-tab-li").removeClass("hide");
                    b.find(".tabs-head").addClass("tabs-head-block");
                    $("#print").hasClass("page-divider-line") && !$(this).hasClass("printPage") ? (g.addClass("printPage"),
                    p = '\x3cdiv class\x3d"print-devider j_deviderItem"\x3e\x3cdiv class\x3d"devider-sn j_deviderSn"\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-line"\x3e\x3ci class\x3d"icon-scissors"\x3e\x3c/i\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-mark j_devidermark"\x3e\x3c/div\x3e\x3cdiv class\x3d"devider-dele j_deviderdele icon-remove-sign"\x3e\x3c/div\x3e\x3c/div\x3e',
                    h = g.find(".form-layout_js:visible"),
                    0 < h.length && h.each(function() {
                        $(this).after(p)
                    }),
                    h = g.find(".table:visible"),
                    d = '\x3cdiv class\x3d"j_printTriggers print-devider-table-triggers"\x3e',
                    0 < h.length && h.each(function() {
                        var g = $(this)
                          , h = g.find("tbody tr")
                          , f = "";
                        if (!(1 >= h.length || 0 < g.find("th").length && 2 >= h.length)) {
                            for (var c = 0; c < h.length - 1; c++)
                                f += '\x3cdiv class\x3d"devider-mark j_table_devider j_devidermark"\x3e\x3c/div\x3e';
                            var a = $(d + f + "\x3c/div\x3e");
                            a.css({
                                top: g.position().top
                            });
                            g.parent().parent().append(a);
                            g.attr("data-dividers-sn", g.index());
                            h.each(function() {
                                var h = $(this);
                                a.find(".j_devidermark").eq(h.index()).css({
                                    top: h.position().top + h.innerHeight() - 4
                                }).attr({
                                    "data-tr": h.index(),
                                    "data-table": g.index()
                                })
                            });
                            0 < g.find("th").length && a.children().eq(0).css("visibility", "hidden")
                        }
                    })) : $("#print").hasClass("page-divider-line") || g.removeClass("printPage");
                    h = g.find(".j-tab-content-page");
                    h.each(function() {
                        var g = $(this);
                        0 < !g.children().length && g.css("border-top-width", "1px")
                    })
                }
            });
            b.off("change", "div[cid\x3d" + a.cid + "] .j_tab_headopt").on("change", "div[cid\x3d" + a.cid + "] .j_tab_headopt", function() {
                var c = $(this).is(":checked")
                  , f = $(this).closest(".j_head-opt").find(".j-print-paved").hasClass("ispaved")
                  , a = $(this).closest(".j_tabs")
                  , g = a.siblings(".j_tab_paved_two")
                  , h = $(this).closest(".j-preview-tabcontrol");
                c && 1 == c ? (f && 1 == f ? (g.find(".j-tab-li").addClass("hide"),
                a.find(".tabs-head").addClass("tabs-head-block"),
                c = g.find(".j-tab-content-page"),
                c.each(function() {
                    var g = $(this);
                    0 < !g.children().length && g.css("border-top-width", "0")
                })) : a.find(".j-tab-ul").addClass("hide"),
                h.addClass("form-tabsnohd-wrapper")) : (f && 1 == f ? (g.find(".j-tab-li").removeClass("hide"),
                a.find(".tabs-head").addClass("tabs-head-block"),
                c = g.find(".j-tab-content-page"),
                c.each(function() {
                    var g = $(this);
                    0 < !g.children().length && g.css("border-top-width", "1px")
                })) : a.find(".j-tab-ul").removeClass("hide"),
                h.removeClass("form-tabsnohd-wrapper"))
            })
        },
        autoSaveEvents: function(e) {},
        saveTableValue: function(e, d) {},
        readOnly: function(e, d) {
            console.error("you need to rewrite the method : readOnly")
        },
        analyseComponent: function(e, d) {
            var a = e.componentKey;
            if (a) {
                var b = (new window[a](e)).renderEditPreview(d);
                if ("ColumnPanel" == a && null != e.layoutDetail)
                    for (a = 0; a < e.layoutDetail.length; a++) {
                        var c = e.layoutDetail[a]
                          , f = ""
                          , f = 1 == e.size ? d : $(b[a]);
                        this.analyseComponent(c, f)
                    }
            }
        },
        getTabSerialize: function(e, d, a, b) {
            var c = [];
            a.find(".j-tab-li").each(function(f) {
                var l = a.find(".j-tab-content[uid\x3d'" + $(this).attr("uid") + "']")
                  , g = {}
                  , h = l.attr("uid")
                  , n = [];
                l.find("\x3ediv").each(function(g) {
                    g = e.assemComponent(g, $(this), b);
                    null != g && n.push(g.componentSetup)
                });
                g.index = f;
                g.uid = h;
                g.name = l.attr("tabName");
                g.layoutDetail = n;
                g.componentKey = "TbLayout";
                c[f] = g
            });
            this.componentSetup.layoutDetail = c
        },
        optionDrag: function() {
            var e = this
              , d = $("#editor-component")
              , a = $("#editor-component .choicelistEdit_js");
            d.find(".j_tab_option_list").mousedown(function() {
                document.activeElement.blur()
            });
            d.find(".j_tab_option_list").sortable({
                cursor: "move",
                scroll: !1,
                containment: "#editor-component",
                tolerance: "pointer",
                placeholder: "combo-select-placeholder",
                items: "\x3e.j_tab_title",
                update: function(b, c) {
                    c.item.data("update", !0);
                    a.find(".j_tab_title").each(function(g) {
                        $(this).attr("index", g)
                    });
                    e.findTabLayoutDetail();
                    for (var f = 0; f < e.componentSetup.tabOptionTitle.length; f++) {
                        var l = e.componentSetup.tabOptionTitle[f];
                        $("#widget-control div[cid\x3d'" + e.cid + "']").find(".j-tab-ul").find(".j-tab-li:eq(" + f + ")").attr("uid", l.uid).attr("index", l.index).html(l.name).attr("title", l.name)
                    }
                    $("#widget-control div[cid\x3d'" + e.cid + "']").find(".j-tab-li[index\x3d'0']").trigger("click");
                    $("#widget-control div[cid\x3d'" + e.cid + "']").find(".j-tab-content[index\x3d'0']").removeClass("hide").siblings().addClass("hide")
                },
                receive: function(a, c) {
                    c.item.data("receive", !0)
                },
                stop: function(a, c) {
                    c.item.data("update") && (c.item.data("update", !1),
                    c.item.data("receive") && c.item.data("receive", !1))
                }
            })
        },
        renderPreviewFormMobile: function(e) {
            var d = this.componentSetup.layoutDetail;
            if (d && 0 < d.length)
                for (var a = 0; a < d.length; a++) {
                    var b = d[a];
                    if (b && b.layoutDetail)
                        for (var c = 0; c < b.layoutDetail.length; c++)
                            formPlugin.analyseComponent(b.layoutDetail[c], e, this.notDefault, this.isReadOnly, this, this.autoSave)
                }
        }
    });
    w.exports = TabControl
});
define("form/component/einvoicecomponent", ["form/relatecomponent", "form/tplutil"], function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil");
    window.EinvoiceComponent = m.extend({
        initialize: function(g) {
            m.prototype.initialize.call(this, g);
            var f = {
                componentKey: "EinvoiceComponent",
                title: "\u7535\u5b50\u53d1\u7968"
            };
            null != g && (f.title = g.title);
            this.componentSetup = $.extend(this.componentSetup, f);
            this.tpl = h.get("einvoicecomponent", {
                isMobileForm: this.isMobileForm
            })
        },
        render: function(g) {
            var f = $(this.tpl).siblings("#form-einvoice");
            m.prototype.render.call(this, g, f);
            g.html(f.html())
        },
        renderEditPreview: function(g) {
            var f = $(this.tpl).siblings("#form-einvoice");
            m.prototype.renderEditPreview.call(this, g, f);
            g.append(f)
        },
        renderEditor: function() {
            var g = $(this.tpl).siblings("#editor-einvoice")
              , f = !1;
            if ("true" == this.componentSetup.isUnique || 1 == this.componentSetup.isUnique)
                f = !0;
            g.find("#isUnique").attr("checked", f);
            m.prototype.renderEditor.call(this, g);
            g.find(".j_relate_group").remove();
            $("#editor-component").html(g.html())
        },
        renderPreview: function(g, f, d) {
            var b = $(this.tpl);
            f = null;
            null == TEAMS.currentUser ? (f = b.siblings("#noeinvoice-preview"),
            f.find(".field_message_js").attr("cid", this.cid)) : f = "mobile" != window.systemInfo_form ? b.siblings("#preview-einvoice") : b.siblings("#mobile-preview");
            f.find(".widget-title .widget-title_js").text(this.componentSetup.title);
            "true" != this.componentSetup.isHideTitle && 1 != this.componentSetup.isHideTitle || f.addClass("field-notitle").find(".widget-title .widget-title_js").addClass("hide");
            "true" != this.componentSetup.required && 1 != this.componentSetup.required || f.find(".widget-title .widget-required_js").text(" *");
            "" != this.componentSetup.describe && (f.find(".field-description").text(this.componentSetup.describe),
            f.find(".field-description").show());
            f.find(".check_js").attr("id", this.componentSetup.fieldId + this.cid).attr("name", this.componentSetup.fieldId);
            f.find(".check_js").attr("cid", this.cid);
            f.find(".check_js").data("componentData", this);
            f.attr("id", "field_" + this.componentSetup.fieldId);
            f.attr("fieldId", this.componentSetup.fieldId);
            f.addClass(this.componentSetup.titleLayout);
            "mobile" == window.systemInfo_form && f.find(".einvoice-seleted").attr("id", this.componentSetup.fieldId);
            "wechat" == window.webapp || "serviceNumber" == TEAMS.currentUser.loginChannel ? f.find(".no-data_js").addClass("hide") : (f.find(".no-data_js").removeClass("hide"),
            f.find(".einvoice_seleted_js").addClass("hide"));
            b = this.componentSetup.isUnique;
            "true" != b && 1 != b || f.find(".js_einvoice").attr("data-multi", "false");
            if (1 == d || "true" == d || "true" == this.componentSetup.isReadOnly || 1 == this.componentSetup.isReadOnly)
                this.isReadOnly = !0,
                this.readOnly(f, !0);
            this.el = g;
            g.append(f)
        },
        submitCheck: function(g, f) {
            var d = this.check(g);
            f(d)
        },
        checkEvents: function(g, f) {
            var d = this
              , b = $(this.tpl)
              , c = (d.componentSetup.fieldId || d.componentSetup.tempId) + this.cid
              , h = d.el.find("#field_" + this.componentSetup.fieldId);
            h.on("click", ".delete_item_js", function() {
                $(this).closest(".invoice_detail_js").remove();
                0 == h.find(".invoice_detail_js").length && "wechat" != window.webapp && "serviceNumber" != TEAMS.currentUser.loginChannel && h.find(".no-data_js").removeClass("hide");
                f && d.saveComponentValue(h.find("#" + c), f);
                d.triggerFillRelate(h.find("#" + c));
                return !1
            });
            if ("mobile" == window.systemInfo_form) {
                if (h.on("tap", ".einvoice-preview-js", function(e) {
                    d.renderCard(h);
                    return !1
                }),
                h.on("tap", ".invoice_detail_js", function(e) {
                    d.renderCard(h)
                }),
                "wechat" == window.webapp || "serviceNumber" == TEAMS.currentUser.loginChannel)
                    n.async("teamsjs/component/wechatEvent" + seajsClip, function(e) {
                        d.wechatEvent = new e({
                            preEl: d.el,
                            module: "workflow",
                            targetId: TEAMS.currentUser.id,
                            jsApiList: ["chooseInvoice"]
                        });
                        d.wechatEvent.render()
                    }),
                    h.on("click", ".einvoice_seleted_js", function() {
                        d.addInvoice(f)
                    })
            } else
                h.on("click", ".show_invoice_js", function() {
                    $("body").append(b.siblings("#einvoice-card-modal").clone());
                    var e = $("#einvoice-card-modal").find(".einvoice_container_js").empty();
                    h.find(".invoice_detail_js").each(function() {
                        var a = $(this).data("wxInvoice");
                        if (a && a.einvoice) {
                            var c = a.einvoice
                              , d = b.siblings("#invoice-item-pc").children().clone().data("wxInvoice", a);
                            d.find(".type_js").text(c.type).attr("title", c.type);
                            d.find(".payee_js").text(c.payee).attr("title", c.payee);
                            d.find(".fee_js").text("\u00a5" + parseFloat(c.user_info.fee)).attr("title", "\u00a5" + parseFloat(c.user_info.fee));
                            d.find(".title_js").text(c.user_info.title).attr("title", c.user_info.title);
                            d.find(".billing_time_js").text(Date.create(parseFloat(c.user_info.billing_time)).format("{yyyy}-{MM}-{dd} {HH}:{mm}")).attr("title", Date.create(parseFloat(c.user_info.billing_time)).format("{yyyy}-{MM}-{dd} {HH}:{mm}"));
                            d.find(".billing_no_js").text(c.user_info.billing_no).attr("title", c.user_info.billing_no);
                            d.find(".billing_code_js").text(c.user_info.billing_code).attr("title", c.user_info.billing_code);
                            d.find(".infoStr_js").text(c.user_info.info_str).attr("title", c.user_info.info_str);
                            d.attr("carId_encryptCode", a.cardId + a.encryptCode);
                            a = TEAMS.api.remoteDownloadUrl + a.pdfId;
                            d.find(".pdf_js").attr("href", a);
                            e.append(d)
                        }
                    });
                    $("#einvoice-card-modal").modal();
                    $("#einvoice-card-modal").on("click", ".delete_item_js", function() {
                        $(this).closest(".invoice_detail_js").remove()
                    });
                    $("#einvoice-card-modal").on("shown.bs.modal", function() {
                        var a = $("body").find(".j_einvoiceScr");
                        a.hasClass("mCustomScrollbar") || (a.height(630),
                        a.mCustomScrollbar({
                            theme: "darkblue"
                        }))
                    });
                    $("#einvoice-card-modal").on("hidden.bs.modal", function() {
                        var a = {
                            dataOptions: []
                        };
                        $("#einvoice-card-modal").find(".invoice_detail_js").each(function() {
                            a.dataOptions.push({
                                optionObj: $(this).data("wxInvoice")
                            })
                        });
                        d.setValue(h, a);
                        f && d.saveComponentValue(h.find("#" + c), f);
                        d.triggerFillRelate(h.find("#" + c));
                        $("#einvoice-card-modal").remove()
                    })
                })
        },
        renderCard: function(g) {
            var f = $(this.tpl);
            $("body").children().addClass("eform-einvoice-hide");
            $("body").append("\x3cdiv id\x3d'einvoice-mobile-card'\x3e\x3cdiv id\x3d'einvoice-list'\x3e\x3cdiv id\x3d'einvoice-continer'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");
            var d = $("#einvoice-continer");
            g.find(".invoice_detail_js").each(function(b) {
                var c = $(this).data("wxInvoice");
                if (c) {
                    b = f.siblings(".einvoice_wrapper_js").clone();
                    var g = c.einvoice;
                    b.find(".type_js").text(g.type);
                    b.find(".payee_js").text(g.payee);
                    b.find(".fee_js").text("\u00a5" + parseFloat(g.user_info.fee));
                    b.find(".title_js").text(g.user_info.title);
                    b.find(".billing_time_js").text(Date.create(parseFloat(g.user_info.billing_time)).format("{yyyy}-{MM}-{dd} {HH}:{mm}"));
                    b.find(".billing_no_js").text(g.user_info.billing_no);
                    b.find(".billing_code_js").text(g.user_info.billing_code);
                    b.find(".infoStr_js").text(g.user_info.info_str).attr("title", g.user_info.info_str);
                    c = TEAMS.api.remoteDownloadUrl  + c.pdfId;
                    b.find(".pdf_js").attr("href", c);
                    d.append(b)
                }
            });
            1 < g.find(".invoice_detail_js").length && n.async("/static/js/plugins/unslider", function(b) {
                $("#einvoice-list").unslider({
                    noloop: !0,
                    selectors: {
                        container: "#einvoice-continer",
                        slides: ".einvoice_wrapper_js"
                    },
                    arrows: !1,
                    swipeThreshold: .1,
                    speed: 300
                })
            });
            setTimeout(function() {
                $("#einvoice-mobile-card").tap(function(b) {
                    if (0 < $(b.target).closest(".pdf_js").length)
                        return !0;
                    $(this).remove();
                    $("body").children().removeClass("eform-einvoice-hide")
                })
            }, 500)
        },
        addInvoice: function(g, f) {
            var d = this
              , b = d.el.find("#field_" + this.componentSetup.fieldId)
              , c = $(d.tpl)
              , h = (d.componentSetup.fieldId || d.componentSetup.tempId) + this.cid;
            wx.checkJsApi({
                jsApiList: ["chooseInvoice"],
                success: function(e) {}
            });
            wx.invoke("chooseInvoice", {
                timestamp: _wechatSign.timeStamp,
                nonceStr: _wechatSign.nonceStr,
                signType: "SHA1",
                cardSign: _wechatSign.cardSign
            }, function(e) {
                e = e.choose_invoice_info;
                "string" == typeof e && (e = JSON.parse(e));
                if (e && 0 != e.length) {
                    if ("true" == d.componentSetup.isUnique || 1 == d.componentSetup.isUnique)
                        e = e.splice(0, 1);
                    e && 0 < e.length && $.ajax({
                        type: TEAMS.ajaxMethod,
                        dataType: "json",
                        contentType: "application/json",
                        data: JSON.stringify({
                            invoiceLists: e,
                            module: "workflow"
                        }),
                        url: " freeform/queryEinvoiceInfo.json",
                        success: function(a) {
                            a = a.wxInvoices;
                            if (null != a) {
                                var e = b.find(".einvoice_container_js");
                                "true" != d.componentSetup.isUnique && 1 != d.componentSetup.isUnique || e.html("");
                                var m = !1;
                                b.closest(".field_js").parent().hasClass("subtd_js") && (m = !0);
                                for (var r = 0; r < a.length; r++) {
                                    var q = a[r].einvoice;
                                    if (0 == e.find(".invoice_detail_js[carId_encryptCode\x3d'" + a[r].cardId + a[r].encryptCode + "']").length) {
                                        var p = null;
                                        m ? p = $("\x3cli class\x3d'invoice_detail_js hide'\x3e\x3c/li\x3e") : (p = c.siblings("#invoice-item-mobile").children().clone(),
                                        p.find(".payee_js").text(q.payee).attr("title", q.payee),
                                        p.find(".fee_js").text("\u00a5" + parseFloat(q.user_info.fee)).attr("title", "\u00a5" + parseFloat(q.user_info.fee)),
                                        p.find(".billing_time_js").text(Date.create(parseFloat(q.user_info.billing_time)).format("{yyyy}-{MM}-{dd}")).attr("title", Date.create(parseFloat(q.user_info.billing_time)).format("{yyyy}-{MM}-{dd}")));
                                        p.data("wxInvoice", a[r]);
                                        p.attr("carId_encryptCode", a[r].cardId + a[r].encryptCode);
                                        e.append(p);
                                        null == d.relates && (d.relates = {});
                                        d.relates[a[r].id] = {
                                            relateEntity: q
                                        }
                                    }
                                }
                                m && "mobile" != window.systemInfo_form && e.append("\x3cli\x3e\x3ca class\x3d'show_invoice_js'\x3e" + a.length + "\u5f20\u7535\u5b50\u53d1\u7968\x3c/a\x3e\x3cli\x3e");
                                g && d.saveComponentValue(b.find("#" + h), g);
                                d.triggerFillRelate(b.find("#" + h));
                                "function" == typeof f && f()
                            } else
                                formPlugin.notify("\u83b7\u53d6\u53d1\u7968\u8be6\u60c5\u5931\u8d25")
                        }
                    })
                } else
                    "function" == typeof f && f()
            })
        },
        autoSaveEvents: function(g) {},
        check: function(g) {
            var f = $(g).find(".invoice_detail_js").length
              , d = {};
            d.element = g;
            0 != f || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (d.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            return d
        },
        getValue: function(g, f) {
            var d = {
                formField: {
                    id: this.componentSetup.fieldId
                }
            }
              , b = g.find(".einvoice_container_js .invoice_detail_js");
            if (0 < b.length) {
                var c = [];
                b.each(function(b) {
                    var e = $(this).data("wxInvoice");
                    c[b] = {
                        optionId: e.id,
                        content: e.payee,
                        type: "einvoice",
                        optionObj: e
                    }
                });
                d.dataOptions = c
            } else
                f || (d = null);
            return d
        },
        setValue: function(g, f) {
            var d = $(this.tpl)
              , b = g.find(".einvoice_container_js").empty();
            if (null != f && null != f.dataOptions && 0 < f.dataOptions.length) {
                var c = !1;
                g.closest(".field_js").parent().hasClass("subtd_js") && (c = !0);
                g.find(".no-data_js").addClass("hide");
                for (var h = 0; h < f.dataOptions.length; h++) {
                    var e = f.dataOptions[h].optionObj;
                    if (e) {
                        var a = e.einvoice
                          , k = null;
                        c ? k = $("\x3cli class\x3d'invoice_detail_js hide'\x3e\x3c/li\x3e") : "mobile" == window.systemInfo_form ? (k = d.siblings("#invoice-item-mobile").children().clone(),
                        k.find(".payee_js").text(a.payee).attr("title", a.payee),
                        k.find(".fee_js").text("\u00a5" + parseFloat(a.user_info.fee)).attr("title", "\u00a5" + parseFloat(a.user_info.fee)),
                        k.find(".billing_time_js").text(Date.create(parseFloat(a.user_info.billing_time)).format("{yyyy}-{MM}-{dd} {HH}:{mm}")).attr("title", Date.create(parseFloat(a.user_info.billing_time)).format("{yyyy}-{MM}-{dd} {HH}:{mm}"))) : (k = d.siblings("#invoice-item-pc").children().clone(),
                        k.find(".type_js").text(a.type).attr("title", a.type),
                        k.find(".payee_js").text(a.payee).attr("title", a.payee),
                        k.find(".fee_js").text("\u00a5" + parseFloat(a.user_info.fee)).attr("title", "\u00a5" + parseFloat(a.user_info.fee)),
                        k.find(".title_js").text(a.user_info.title).attr("title", a.user_info.title),
                        k.find(".billing_time_js").text(Date.create(parseFloat(a.user_info.billing_time)).format("{yyyy}-{MM}-{dd} {HH}:{mm}")).attr("title", Date.create(parseFloat(a.user_info.billing_time)).format("{yyyy}-{MM}-{dd} {HH}:{mm}")),
                        k.find(".billing_no_js").text(a.user_info.billing_no).attr("title", a.user_info.billing_no),
                        k.find(".billing_code_js").text(a.user_info.billing_code).attr("title", a.user_info.billing_code),
                        k.find(".infoStr_js").text(a.user_info.info_str).attr("title", a.user_info.info_str),
                        a = TEAMS.api.remoteDownloadUrl  + e.pdfId,
                        k.find(".pdf_js").attr("href", a));
                        this.isReadOnly && k.find(".delete_item_js").remove();
                        k.data("wxInvoice", e).attr("carId_encryptCode", e.cardId + e.encryptCode);
                        b.append(k)
                    }
                }
                c && b.append("\x3cli\x3e\x3ca class\x3d'show_invoice_js'\x3e" + f.dataOptions.length + "\u5f20\u7535\u5b50\u53d1\u7968\x3c/a\x3e\x3cli\x3e")
            } else
                g.find(".no-data_js").removeClass("hide")
        },
        empty: function(g) {
            g.find(".einvoice_container_js").empty()
        },
        readOnly: function(g, f) {
            var d = this.componentSetup.fieldId + this.cid;
            f && (g.find('div[id\x3d"' + d + '"] .delete_item_js').remove(),
            g.find('div[id\x3d"' + d + '"] .einvoice_seleted_js').remove(),
            g.find('div[id\x3d"' + d + '"] .no-data_js').addClass("hide"))
        }
    });
    u.exports = window.EinvoiceComponent
});
define("form/component/checkbox", ["form/editablecomponent", "form/tplutil", "form/component/option", "form/componentmodel"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/option")
      , f = n("form/componentmodel");
    window.CheckBox = m.extend({
        initialize: function(d) {
            m.prototype.initialize.call(this, d);
            var b = {
                componentKey: "CheckBox",
                title: "\u590d\u9009\u6846",
                layout: "choicelist-inline",
                options: [],
                selectedNum: ""
            };
            null != d && (b.title = d.title,
            b.layout = d.layout,
            b.options = d.options,
            b.selectedNum = d.selectedNum);
            this.componentSetup = $.extend(this.componentSetup, b);
            if (!this.componentSetup.options || 0 == this.componentSetup.options.length) {
                d = new g;
                d.setName("\u9009\u98791");
                d.setOrder(0);
                b = new g;
                b.setName("\u9009\u98792");
                b.setOrder(1);
                var c = new g;
                c.setName("\u9009\u98793");
                c.setOrder(2);
                this.componentSetup.options = [];
                this.componentSetup.options[0] = d.componentSetup;
                this.componentSetup.options[1] = b.componentSetup;
                this.componentSetup.options[2] = c.componentSetup
            }
            this.tpl = h.get("checkbox", {
                isMobileForm: this.isMobileForm
            });
            this.componentModel = new f
        },
        setSelectedNum: function(d) {
            this.componentSetup.selectedNum = d
        },
        setLayout: function(d) {
            this.componentSetup.layout = d
        },
        setOptions: function(d) {
            this.componentSetup.options = d
        },
        layoutCheck: function() {
            for (var d = !1, b = this.componentSetup.options, c = [], f = 0; f < b.length; f++) {
                var e = b[f];
                0 != e.other && "false" != e.other || "" == e.name.trim() || c.push(e.name.trim())
            }
            b = c.sort();
            for (f = 0; f < b.length; f++)
                if (b[f] == b[f + 1]) {
                    d = !0;
                    break
                }
            if (d)
                throw formPlugin.notify("\u9009\u9879\u540d\u79f0\u5b58\u5728\u91cd\u590d"),
                $("#widget-control").find(".field_js").removeClass("field-active"),
                $("#widget-control").find('.field_js[componentKey\x3d"' + this.componentSetup.componentKey + '"][tempId\x3d"' + this.componentSetup.tempId + '"]').addClass("field-active"),
                $("#formEdit_js").find("#edit-form").addClass("hide"),
                $("#formEdit_js").find("#edit-widget").removeClass("hide"),
                this.renderEditor(),
                Error();
        },
        render: function(d) {
            var b = this
              , c = $(this.tpl).siblings("#form-checkbox");
            this.componentSetup.formId = $("#formId").val();
            var f = c.find(".choicelist_js");
            f.addClass(this.componentSetup.layout);
            if (this.componentSetup.options && 0 < this.componentSetup.options.length) {
                f.html("");
                for (var e = 0; e < this.componentSetup.options.length; e++)
                    (new g(this.componentSetup.options[e])).render(f, this)
            } else
                f.html("\x3cli class\x3d'j_no_option'\x3e\u8bf7\u5728\u53f3\u4fa7\u6dfb\u52a0\u9009\u9879\x3c/li\x3e");
            "CheckBox" == this.componentSetup.componentKey && (b.componentSetup.tempId ? d.attr("tempId", b.componentSetup.tempId) : this.componentModel.generatorId(function(a) {
                a = a.generatorId;
                b.componentSetup.tempId = a;
                d.attr("tempId", a)
            }));
            m.prototype.render.call(this, d, c);
            d.html(c.html())
        },
        renderEditPreview: function(d, b) {
            var c = $(this.tpl).siblings("#form-checkbox")
              , f = c.find(".choicelist_js");
            f.addClass(this.componentSetup.layout);
            var e = this.componentSetup.options;
            if (null != e && 0 < e.length) {
                f.html("");
                for (var a = 0; a < e.length; a++)
                    (new g(e[a])).render(f, this)
            } else
                f.html("\x3cli class\x3d'j_no_option'\x3e\u8bf7\u5728\u53f3\u4fa7\u6dfb\u52a0\u9009\u9879\x3c/li\x3e");
            m.prototype.renderEditPreview.call(this, d, c);
            b ? d.replaceWith(c) : d.append(c)
        },
        renderEditor: function() {
            var d = $(this.tpl).siblings("#editor-checkbox");
            d.find("input:radio[name\x3d'componentType'][value\x3d'" + this.componentSetup.componentKey + "']").attr("checked", "true");
            d.find("input:radio[name\x3d'layout'][value\x3d'" + this.componentSetup.layout + "']").attr("checked", "true");
            for (var b = d.find("ul.choicelistEdit_js"), c = 0; c < this.componentSetup.options.length; c++) {
                var f = this.componentSetup.options[c];
                (new g(f)).renderEditor(b, this);
                "true" != f.other && 1 != f.other || d.find(".btn-default_js").parent().hide()
            }
            if ("true" == this.componentSetup.required || 1 == this.componentSetup.required)
                d.find(".j_selected_num").removeClass("hide"),
                this.componentSetup.selectedNum && (b = this.componentSetup.selectedNum.split("-"),
                d.find(".j_selected_num .j_selected_min").attr("value", b[0]),
                d.find(".j_selected_num .j_selected_max").attr("value", b[1]));
            m.prototype.renderEditor.call(this, d);
            $("#editor-component").html(d.html());
            this.optionDrag()
        },
        optionDrag: function() {
            var d = this
              , b = $("#editor-component");
            b.find(".choicelistEdit_js").mousedown(function() {
                document.activeElement.blur()
            });
            b.find(".choicelistEdit_js").sortable({
                cursor: "move",
                scroll: !1,
                containment: "#editor-component",
                items: ".CheckBox_js",
                connectWith: ".choicelistEdit_js",
                placeholder: "combo-select-placeholder",
                update: function(c, f) {
                    f.item.data("update", !0);
                    for (var e = [], a = b.find("ul.choicelistEdit_js li"), g = 0; g < a.length; g++)
                        for (var h = $(a[g]), h = h.find(".option_js").attr("uid"), m = 0; m < d.componentSetup.options.length; m++) {
                            var q = d.componentSetup.options[m]
                              , p = q.uid;
                            if (h) {
                                if (h == p) {
                                    q.order = g;
                                    e.push(q);
                                    break
                                }
                            } else if (1 == q.other || "true" == q.other) {
                                e.push(q);
                                break
                            }
                        }
                    d.componentSetup.options = e;
                    e = $("#widget-control .field-active").find(".choicelist_js li");
                    for (a = 0; a < e.length; a++)
                        h = $(e[a]),
                        h.find("span").text(d.componentSetup.options[a].name)
                },
                receive: function(c, b) {
                    b.item.data("receive", !0)
                },
                stop: function(c, b) {
                    b.item.data("update") && (b.item.data("update", !1),
                    b.item.data("receive") && b.item.data("receive", !1))
                }
            })
        },
        renderPreview: function(d, b, c) {
            var f = $(this.tpl).siblings("#preview-checkbox")
              , e = f.find(".choicelist_js");
            e.addClass(this.componentSetup.layout);
            for (var a = 0; a < this.componentSetup.options.length; a++)
                (new g(this.componentSetup.options[a])).renderPreview(e, this);
            b && (f.find(".check_js input:checkbox").attr("checked", !1),
            f.find(".check_js .j_ico").removeClass("checked"));
            "true" != this.componentSetup.isReadOnly && 1 != this.componentSetup.isReadOnly || f.find(".check_js input:checkbox").attr("disabled", !0);
            m.prototype.renderPreview.call(this, d, b, c, f);
            d.append(f)
        },
        change: function(d) {
            var b = d.oldObj;
            d = d.changeEl;
            this.componentSetup.title = b.componentSetup.title;
            this.componentSetup.describe = b.componentSetup.describe;
            this.componentSetup.order = b.componentSetup.order;
            this.componentSetup.index = b.componentSetup.index;
            this.componentSetup.required = b.componentSetup.required;
            this.componentSetup.fieldId = b.componentSetup.fieldId;
            this.componentSetup.tempId = b.componentSetup.tempId;
            this.componentSetup.layout = null == b.componentSetup.layout || "" == b.componentSetup.layout ? "choicelist-inline" : b.componentSetup.layout;
            this.componentSetup.options = b.componentSetup.options;
            this.render(d)
        },
        renderStatSearch: function(d) {
            var b = this
              , c = d.fieldId
              , f = d.fieldTitle
              , e = d.subFormId
              , a = d.parentEl
              , g = d.filterEl
              , h = d.condition
              , m = b.unique(d.ids)
              , q = d.term
              , p = {
                fieldId: c,
                componentModule: d.componentModule
            };
            d = window.getdatastaturl({
                module: d.module
            }, "/findFiledOptions.json");
            $.ajax({
                type: TEAMS.ajaxMethod,
                url: d,
                dataType: "json",
                async: !1,
                data: p,
                success: function(d) {
                    "mobile" != window.systemInfo_form ? b.pcStatSearch(a, m, q, d) : b.mobileStatSearch(c, f, a, m, q, d, e, g, h)
                }
            })
        },
        pcStatSearch: function(d, b, c, f) {
            for (var e = $(this.tpl).siblings("#statsearch-checkbox"), a = e.find(".j_resultList"), g = 0; g < f.fieldOptions.length; g++) {
                var h = f.fieldOptions[g]
                  , m = h.name
                  , q = h.id
                  , h = h["delete"]
                  , p = $(a.find("option")[0]).clone();
                p.attr("id", q).text(m);
                1 != h && "true" != h || p.addClass("finished-line").attr("id", q).text(m);
                a.append(p)
            }
            d.attr("class", "sch-group j_formFieldSearchGroup");
            d.find(".j_formField-condition").html("").append(e);
            if (b)
                for (g = 0; g < b.length; g++)
                    e = '\x3cspan class\x3d"entity-item"\x3e\x3ca id\x3d"' + b[g].id + '" title\x3d"' + b[g].text + '"\x3e' + b[g].text + "\x3c/a\x3e\x3c/span\x3e",
                    d.find(".j_formField-condition .entity-container").append(e);
            c && d.find(".j_formField-condition select:first option[value\x3d" + c + "]").attr("selected", "true")
        },
        mobileStatSearch: function(d, b, c, f, e, a, g, h, m) {
            var q = $(this.tpl).siblings("#statsearch-checkbox-mobile");
            m && (q.find(".j_condition").find('option[value\x3d"' + m + '"]').attr("selected", !0),
            "null" != m && "notnull" != m || q.find(".j_control").hide());
            h && (q.find("#seleted-list").empty(),
            h.find(".j_filterList .selectd #comp-val span").each(function() {
                var a = $(this).attr("optionId")
                  , e = $(this).text()
                  , c = $("\x3cspan\x3e\x3c/span\x3e");
                c.attr("id", a).text(e);
                q.find("#seleted-list").append(c)
            }));
            q.find(".j_optionUl").empty();
            q.find("#seleted-list").attr("fieldId", d);
            for (f = 0; f < a.fieldOptions.length; f++) {
                e = a.fieldOptions[f];
                h = e.name;
                m = e.id;
                var p = q.find("#li-clone li").clone();
                0 < q.find("#seleted-list").find("#" + m).length && p.addClass("selected");
                p.find(".j_optionname").text(h);
                p.attr("id", m);
                p.data("fieldOption", e);
                q.find(".j_optionUl").append(p)
            }
            c.find("#component-div").html(q);
            c.find(".j_comp-ok").attr("comKey", "CheckBox").attr("fieldId", d).attr("title", b).attr("subFormId", g);
            c.off("change", "#statsearch-checkbox-mobile .j_condition").on("change", "#statsearch-checkbox-mobile .j_condition", function() {
                var a = $(this).val();
                "null" == a || "notnull" == a ? c.find("#statsearch-checkbox-mobile .j_control").hide() : c.find("#statsearch-checkbox-mobile .j_control").show()
            });
            c.off("tap", "#statsearch-checkbox-mobile .j_optionli").on("tap", "#statsearch-checkbox-mobile .j_optionli", function() {
                var a = $(this);
                a.hasClass("selected") ? a.removeClass("selected") : a.addClass("selected");
                var e = a.data("fieldOption")
                  , a = e.id
                  , e = '\x3cspan id\x3d"' + a + '"\x3e' + e.name + "\x3c/span\x3e";
                0 < c.find("#statsearch-checkbox-mobile #seleted-list #" + a).length ? c.find("#statsearch-checkbox-mobile #seleted-list #" + a).remove() : c.find("#statsearch-checkbox-mobile #seleted-list").append(e)
            })
        },
        checkEvents: function(d) {
            var b = this
              , c = b.el || $(document);
            c.on("change", "input:checkbox[name\x3d'" + b.componentSetup.fieldId + this.cid + "']", function(c, e) {
                var a = $(this).parents(".check_js")
                  , f = $(this).data("componentData");
                if ("true" == f.componentSetup.other || 1 == f.componentSetup.other)
                    $(this).is(":checked") ? a.find("input:text").attr("disabled", !1).show() : a.find("input:text").attr("disabled", !0).hide();
                e && 0 == e.isCheck ? d({
                    element: a
                }) : (a = b.check(a),
                d(a))
            });
            if ("mobile" == window.systemInfo_form)
                c.on("click", "input:checkbox", function() {
                    $(this).is(":checked") ? $(this).parent().siblings(".j_ico").addClass("checked") : $(this).parent().siblings(".j_ico").removeClass("checked")
                })
        },
        autoSaveEvents: function(d) {
            var b = this
              , c = b.el || $(document);
            c.on("change", "#" + b.componentSetup.fieldId + "[cid\x3d'" + this.cid + "'] input:text", function() {
                b.saveComponentValue($(this), d)
            });
            c.on("change", "input:checkbox[name\x3d'" + b.componentSetup.fieldId + this.cid + "']", function(c) {
                if (c.isTrigger)
                    return !0;
                b.saveComponentValue($(this), d)
            })
        },
        check: function(d) {
            var b = d.find("input:checkbox[name\x3d'" + this.componentSetup.fieldId + this.cid + "']:checked").val()
              , c = {};
            c.element = d;
            if ("true" == this.componentSetup.required || 1 == this.componentSetup.required)
                if ("" == b || null == b)
                    c.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a";
                else if (this.componentSetup.selectedNum) {
                    var f = this.componentSetup.selectedNum.split("-")
                      , b = f[0]
                      , f = f[1];
                    d = d.find("input:checkbox:checked").length;
                    if (b || f)
                        if (b && f) {
                            if (Number(b) > d || Number(f) < d)
                                c.message = "\u9009\u4e2d\u4e2a\u6570\u5fc5\u987b\u5728" + b + "-" + f + "\u4e4b\u95f4!"
                        } else
                            b && !f && Number(b) > d ? c.message = "\u9009\u4e2d\u4e2a\u6570\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e" + b + "\u4e2a!" : !b && f && Number(f) < d && (c.message = "\u9009\u4e2d\u4e2a\u6570\u5fc5\u987b\u5c0f\u4e8e\u7b49\u4e8e" + f + "\u4e2a!")
                }
            return c
        },
        getValue: function(d, b) {
            var c = {
                formField: {
                    id: this.componentSetup.fieldId
                }
            }
              , f = 0
              , e = [];
            d.find("li").each(function(a) {
                var c = $(this).find("input:checkbox");
                a = c.val();
                if (c.is(":checked")) {
                    var b = ""
                      , c = c.data("componentData")
                      , b = "true" == c.componentSetup.other || 1 == c.componentSetup.other ? d.find("input:text").val() : c.componentSetup.name;
                    e[f] = {
                        optionId: a,
                        content: b
                    };
                    f++
                }
            });
            c.dataOptions = e;
            return 0 != f || b ? c : null
        },
        setValue: function(d, b) {
            d.find("input:checkbox").each(function() {
                this.checked = !1
            });
            if (null != b && null != b.dataOptions) {
                for (var c = "", f = 0; f < b.dataOptions.length; f++) {
                    var e = b.dataOptions[f]
                      , a = e.optionId
                      , m = d.find(".choicelist")
                      , n = f.content
                      , g = null
                      , g = b.isMacthByName ? d.find("span").filter(function() {
                        return $(this).text() == e.content
                    }).prev() : d.find("input:checkbox[name\x3d'" + this.componentSetup.fieldId + this.cid + "'][value\x3d'" + a + "']");
                    m.find(".CheckBox_js span").filter(function() {
                        if($(this).text() == f.content) {
                            $(this).siblings('input').get(0).checked = !0;
                        }
                    })
                    if (a = g.get(0))
                        a.checked = !0,
                        $(a).parent().siblings(".j_ico").addClass("checked"),
                        a = g.data("componentData").componentSetup.other,
                        "true" == a || 1 == a ? (d.find("input:text").val(e.content).show(),
                        c += e.content + ",") : c += g.next().text() + ","
                }
                0 != c.length && d.find(".j_readOnly").html(c.substring(0, c.length - 1))
            }
        },
        empty: function(d) {
            for (var b = d.find("input:checkbox[name\x3d'" + this.componentSetup.fieldId + this.cid + "']"), c = 0; c < b.length; c++) {
                var f = $(b[c]).get(0);
                null != f && (f.checked = !1)
            }
            d.find(".j_readOnly").html("");
            d.find("input:text").val("").hide()
        },
        readOnly: function(d, b) {
            d.find("input:checkbox[name\x3d'" + this.componentSetup.fieldId + this.cid + "']");
            b ? (d.find(".check_js").addClass("hide"),
            d.find(".j_readOnly").removeClass("hide")) : (d.find(".check_js").removeClass("hide"),
            d.find(".j_readOnly").addClass("hide"))
        }
    });
    u.exports = window.CheckBox
});
define("form/component/document", "form/relatecomponent form/tplutil form/component/entityselecter form/component/relevancecontrol form/componentmodel form/abposview".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/entityselecter")
      , f = n("form/component/relevancecontrol")
      , d = n("form/componentmodel")
      , b = n("form/abposview");
    window.Document = m.extend({
    });
    u.exports = window.Document
});
define("form/component/preview", function(n, y, u) {
    n = Backbone.View.extend({
        initialize: function(m) {
            this.afterJqObj = m.afterJqObj;
            this.container = m.container;
            this.previewType = m.previewType || "";
            this.rel = m.rel || "0";
            this.maxSize = TEAMS.currentTenant ? m.maxSize || ("normal" == TEAMS.currentTenant.status ? 10 : 5) : 5;
            m.fileObj ? (m = m.fileObj,
            this.isImage = m.image,
            this.docFileType = m.docType,
            this.docFileId = m.id,
            this.fileSize = m.size,
            this.title = m.name || "\u9884\u89c8") : m.document && (m = m.document,
            this.isImage = m.docFile.image,
            this.docFileType = m.docFile.docType,
            this.docFileId = m.docFile.id,
            this.fileSize = m.docFile.size)
        },
        initEvents: function() {},
        render: function() {
            var m = this.container
              , h = this.afterJqObj;
            1 == this.isImage || "true" == this.isImage ? (h.after("\x3ca id\x3d'document-preview-" + this.docFileId + "' onclick\x3d'$.openPhotoGallery(this)' rel\x3d'" + this.rel + "' title\x3d'" + this.title + "' class\x3d'document-preview-btn btn btn-xs btn-info'\x3e\u9884\u89c8\x3c/a\x3e"),
            "remote" == this.previewType ? m.find("#document-preview-" + this.docFileId).addClass("gallery-pic").attr("type", "image").attr("imghref", TEAMS.api.remoteDownloadUrl  + this.docFileId) : m.find("#document-preview-" + this.docFileId).addClass("gallery-pic").attr("type", "image").attr("imghref", "/base/download/" + this.docFileId + "?type\x3d" + this.previewType + "\x26timestamp\x3d" + Date.parse(new Date))) : "office" == this.docFileType || "pdf" == this.docFileType ? (h.after("\x3ca id\x3d'document-preview-" + this.docFileId + "'  data-value\x3d'" + this.docFileId + "'  title\x3d'\u9884\u89c8' class\x3d'document-preview-btn btn btn-xs btn-info' href\x3d''\x3e\u9884\u89c8\x3c/a\x3e"),
            "version" == this.previewType ? m.find("#document-preview-" + this.docFileId).attr({
                href: "/wopi/files/preview?id\x3d" + this.docFileId + "\x26type\x3d" + this.previewType,
                target: "_blank"
            }) : "remote" == this.previewType ? m.find("#document-preview-" + this.docFileId).attr({
                href: "/remote/previewremote/allView?id\x3d" + this.docFileId,
                target: "_blank"
            }) : m.find("#document-preview-" + this.docFileId).attr({
                href: "/wopi/files/preview?id\x3d" + this.docFileId,
                target: "_blank"
            }),
            this.fileSize > 1048576 * this.maxSize && m.find("#document-preview-" + this.docFileId).attr("disabled", "true").css({
                "background-color": "#ccc",
                "border-color": "#ccc",
                display: "none"
            }).after("\x3ca data-value\x3d'" + this.docFileId + "'  style\x3d'color:#ccc;size:10px;text-decoration : none;cursor:default;margin-left:5px;'\x3e\u8d85\u8fc7\u9884\u89c8\u6700\u5927\u9650\u5236" + this.maxSize + "M\x3c/a\x3e")) : "text" == this.docFileType && (h.after("\x3ca id\x3d'document-preview-" + this.docFileId + "'  data-value\x3d'" + this.docFileId + "'  title\x3d'\u9884\u89c8' class\x3d'document-preview-btn btn btn-xs btn-info' href\x3d''\x3e\u9884\u89c8\x3c/a\x3e"),
            "remote" == this.previewType ? m.find("#document-preview-" + this.docFileId).attr({
                href: "/remote/previewremote/allView?id\x3d" + this.docFileId,
                target: "_blank"
            }) : m.find("#document-preview-" + this.docFileId).attr({
                href: "/wopi/files/preview/txtView?id\x3d" + this.docFileId + "\x26type\x3d" + this.previewType,
                target: "_blank"
            }))
        },
        remove: function() {}
    });
    u.exports = n
});
define("form/component/userselecter", ["form/tplutil"], function(n, y, u) {
    var m = n("form/tplutil");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/chancecomponent", "form/relatecomponent form/tplutil form/componentmodel form/component/chancelist form/component/entityselecter form/component/typeahead form/component/relevancecontrol form/abposview".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel")
      , f = n("form/component/chancelist")
      , d = n("form/component/entityselecter")
      , b = n("form/component/typeahead")
      , c = n("form/component/relevancecontrol")
      , l = n("form/abposview");
    window.ChanceComponent = m.extend({
    });
    u.exports = window.ChanceComponent
});
define("form/component/piecomponent", ["form/component", "form/tplutil"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil");
    window.PieComponent = y.extend({
    });
    u.exports = window.PieComponent
});
define("form/component/email", ["form/editablecomponent", "form/tplutil"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil");
    window.Email = m.extend({
        initialize: function(g) {
            m.prototype.initialize.call(this, g);
            var f = {
                componentKey: "Email",
                title: "\u90ae\u7bb1"
            };
            null != g && (f.title = g.title);
            this.componentSetup = $.extend(this.componentSetup, f);
            this.tpl = h.get("email", {
                isMobileForm: this.isMobileForm
            })
        },
        render: function(g) {
            var f = $(this.tpl).siblings("#form-email");
            m.prototype.render.call(this, g, f);
            g.html(f.html())
        },
        renderEditPreview: function(g) {
            var f = $(this.tpl).siblings("#form-email");
            m.prototype.renderEditPreview.call(this, g, f);
            g.append(f)
        },
        renderEditor: function() {
            var g = $(this.tpl).siblings("#editor-email");
            m.prototype.renderEditor.call(this, g);
            $("#editor-component").html(g.html())
        },
        renderPreview: function(g, f, d) {
            var b = $(this.tpl).siblings("#preview-email");
            f && b.find(".check_js").val("");
            b.find(".form-control").attr("placeholder", null == this.componentSetup.placeholder || 1 > this.componentSetup.placeholder.length ? "\u8bf7\u586b\u5199" + this.componentSetup.title : this.componentSetup.placeholder);
            m.prototype.renderPreview.call(this, g, f, d, b);
            g.append(b)
        },
        renderStatSearch: function(g) {
            var f = $(this.tpl)
              , d = null
              , b = g.parentEl
              , c = g.term
              , h = g.value;
            if ("mobile" != window.systemInfo_form)
                d = f.siblings("#statsearch-email"),
                h && d.find("input").val(h),
                c && d.find("select:first option[value\x3d" + c + "]").attr("selected", "true"),
                b.attr("class", "sch-group j_formFieldSearchGroup"),
                b.find(".j_formField-condition").html(d);
            else {
                var c = g.fieldId
                  , h = g.fieldTitle
                  , e = g.subFormId
                  , d = f.siblings("#statsearch-email-mobile")
                  , f = g.filterEl;
                g = g.condition;
                f && (f = f.find(".j_filterList .selectd #comp-val span").text(),
                d.find(".j_compVal").val(f));
                g && (d.find(".j_condition").find('option[value\x3d"' + g + '"]').attr("selected", !0),
                "null" != g && "notnull" != g || d.find(".j_control").hide());
                d.find(".j_inputName").text(h + ":");
                b.find("#component-div").html(d);
                b.find(".j_comp-ok").attr("comKey", "Email").attr("fieldId", c).attr("title", h).attr("subFormId", e);
                b.off("change", "#statsearch-email-mobile .j_condition").on("change", "#statsearch-email-mobile .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? b.find("#statsearch-email-mobile .j_control").hide() : b.find("#statsearch-email-mobile .j_control").show()
                })
            }
        },
        checkEvents: function(g) {
            var f = this;
            (f.el || $(document)).on("blur", "input[id\x3d'" + (f.componentSetup.fieldId || f.componentSetup.tempId) + "'][cid\x3d'" + f.cid + "']", function() {
                var d = f.check($(this));
                g(d)
            })
        },
        autoSaveEvents: function(g) {
            var f = this;
            (f.el || $(document)).on("change", "input[id\x3d'" + f.componentSetup.fieldId + "'][cid\x3d'" + f.cid + "']", function() {
                f.saveComponentValue($(this), g)
            })
        },
        check: function(g) {
            var f = $.trim(g.val())
              , d = g.attr("placeholder")
              , b = {};
            b.element = g;
            f == d && (f = "");
            "" != f || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (b.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            "" == f || this.email(f) || (b.message = this.componentSetup.title + "\u683c\u5f0f\u6709\u8bef\uff0c\u8bf7\u8f93\u5165\u6709\u6548\u7684\u90ae\u7bb1");
            return b
        },
        email: function(g) {
            return /^([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/.test(g)
        },
        getValue: function(g, f) {
            var d = $.trim(g.val())
              , b = g.attr("placeholder")
              , c = {
                formField: {
                    id: this.componentSetup.fieldId
                },
                content: d
            };
            return "" != d && d != b && this.email(d) || f ? c : null
        },
        setValue: function(g, f) {
            if (null != f) {
                var d = f.content;
                g.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val(d);
                g.find(".j_readOnly").html(d)
            }
        },
        empty: function(g) {
            g.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val("");
            g.find(".j_readOnly").html("")
        },
        readOnly: function(g, f) {
            var d = g.find("input[id\x3d'" + this.componentSetup.fieldId + "'][cid\x3d'" + this.cid + "']")
              , d = this.isMobileForm ? d.parent() : d;
            f ? (d.addClass("hide"),
            d.siblings(".j_readOnly").removeClass("hide")) : (d.removeClass("hide"),
            d.siblings(".j_readOnly").addClass("hide"))
        }
    });
    u.exports = window.Email
});
define("form/component/contactlist", ["form/tplutil"], function(n, y, u) {
    var m = n("form/tplutil");
    n = Backbone.View.extend({
    });
    u.exports = n
});
define("form/component/table", function(n, y, u) {
    (function(m, h, g, f) {
        var d = function(b, c) {
            this.$element = b;
            this.defaults = {
                area: "area",
                current: "current",
                rows: 2,
                cols: 2,
                thead: !0,
                tfoot: !1,
                tableClass: "table table-bordered",
                headClass: "theader",
                bodyClass: "j_tablelayout",
                footClass: "foot",
                separator: "_",
                minColWidth: '',
                defaultWidth: 246,
                maxColWidth: 765,
                tdArray: [],
                thArray: [],
                beforeChangeCell: function(c, e) {
                    return !0
                },
                afterDeleteCol: function(c) {},
                afterDeleteRow: function(c) {},
                afterCreateCell: function(c, e) {},
                afterCreateBodyTd: function(c, e, a) {},
                afterChangeWidth: function(c, e) {}
            };
            this.options = m.extend({}, this.defaults, c);
            this.persist = {
                storage: [],
                place: [],
                selection: [],
                selected: [],
                range: {
                    start: null,
                    end: null
                },
                mouse: {
                    status: 0
                }
            }
        };
        d.prototype = {
            init: function() {
                this.renderTable();
                this.events();
                return this
            },
            events: function() {
                var b = this.$element
                  , c = this;
                b.on("mouseover", "td", function(b) {
                    c.onCellMouseOver(b)
                });
                b.on("mousedown", "td", function(b) {
                    if (1 == b.which)
                        c.onCellMouseLeftDown(b);
                    if (3 == b.which)
                        c.onCellMouseRightDown(b)
                });
                m(g).on("mouseup", function(b) {
                    c.onCellMouseUp(b)
                });
                m(g).on("mousedown", function(b) {
                    b = b.target;
                    "td" == b.tagName.toLowerCase() || m(b).hasClass("j_layout_menu") || c.clearSelection()
                });
                b.contextmenu({
                    target: "#context-menu",
                    onItem: function(b, e) {
                        m(e.target).parent().hasClass("disabled") || c.rightEvents(m(e.target).attr("type"))
                    },
                    before: function(b, e) {
                        c.initRightMenu()
                    }
                })
            },
            rightEvents: function(b) {
                switch (b) {
                case "merge":
                    this.merge();
                    break;
                case "clearMerge":
                    this.clearMerge();
                    break;
                case "deleteRow":
                    this.deleteRow();
                    break;
                case "deleteCol":
                    this.deleteCol();
                    break;
                case "addRow":
                    this.addRow();
                    break;
                case "addCol":
                    this.addCol();
                    break;
                case "clearSelect":
                    this.clearSelection()
                }
            },
            initRightMenu: function() {
                var b = this.persist.selection
                  , c = this.persist.selected
                  , d = this.persist.place
                  , e = m(".dropdown-menu");
                b && 0 != b.length ? e.find("li").removeClass("disabled") : (e.find("a[type\x3d'deleteCol']").parent().addClass("disabled"),
                e.find("a[type\x3d'deleteRow']").parent().addClass("disabled"),
                e.find("a[type\x3d'merge']").parent().addClass("disabled"),
                e.find("a[type\x3d'clearSelect']").parent().addClass("disabled"));
                d && 0 < d.length ? e.find("a[type\x3d'clearMerge']").parent().removeClass("disabled") : e.find("a[type\x3d'clearMerge']").parent().addClass("disabled");
                1 == c.length && e.find("a[type\x3d'merge']").parent().addClass("disabled")
            },
            _checkMerge: function() {
                return 1 < this.persist.selection.length ? !0 : !1
            },
            renderTable: function() {
                var b = this.$element
                  , c = this.options
                  , d = "\x3ctable class\x3d'" + c.tableClass + "' \x3e";
                if (c.tdArray && 0 < c.tdArray.length)
                    for (var d = d + ("\x3ctbody class \x3d'" + c.bodyClass + "'\x3e"), e = 0; e < c.rows; e++)
                        d += "\x3ctr\x3e\x3c/tr\x3e";
                else
                    for (d += "\x3ctbody class \x3d'" + c.bodyClass + "'\x3e",
                    e = 0; e < c.rows; e++) {
                        for (var d = d + "\x3ctr\x3e", a = 0; a < c.cols; a++)
                            d += "\x3ctd\x3e\x3c/td\x3e";
                        d += "\x3c/tr\x3e"
                    }
                d += "\x3c/tbody\x3e";
                if (c.tfoot) {
                    d += "\x3ctfoot class\x3d'" + c.footClass + "'\x3e\x3ctr\x3e";
                    for (e = 0; e < c.cols; e++)
                        d += "\x3ctd\x3e\x3c/td\x3e";
                    d += "\x3c/tr\x3e\x3c/tfoot\x3e"
                }
                b.html(d);
                this.$table = b.find("table");
                if (c.tdArray && 0 < c.tdArray.length)
                    this.initBody();
                else
                    for (b = this.$table.find("tbody tr"),
                    e = 0; e < b.length; e++)
                        c = m(b[e]).children(),
                        this.persist.storage[e] = c;
                this.options.afterCreateCell(this, this.$table.find("tbody td"));
                this.initHeader()
            },
            initBody: function() {
                var b = this.options.tdArray
                  , c = this.persist.storage;
                if (b && 0 < b.length)
                    for (var d = 0; d < b.length; d++) {
                        var e = b[d];
                        "string" == typeof e && (e = JSON.parse(e));
                        if (e) {
                            var a = e.coordinate.split(this.options.separator)
                              , f = ~~a[0]
                              , a = ~~a[1];
                            c[f] || (c[f] = []);
                            if (0 < e.rowSpan && 0 < e.colSpan) {
                                var g = m("\x3ctd rowspan\x3d'" + e.rowSpan + "' colspan\x3d'" + e.colSpan + "'\x3e\x3c/td\x3e");
                                this.$table.find("tbody tr").eq(f).append(g);
                                this.options.afterCreateBodyTd(this, g, e);
                                c[f][a] = g[0]
                            } else
                                c[f][a] = null
                        }
                    }
            },
            initHeader: function(b) {
                b = this.options;
                if (b.thead) {
                    this.$table.find("thead").remove();
                    var c = "";
                    b.headClass = 2 == b.cols ? b.headClass.concat(" two-columns") : b.headClass.replace("two-columns", "");
                    for (var c = c + ("\x3cthead class\x3d'" + b.headClass + "'\x3e\x3ctr\x3e"), d = 0; d < b.cols; d++) {
                        b.thArray[d] = b.thArray[d] ? b.thArray[d] : b.minColWidth;
                        var e = parseInt(d / 26)
                          , e = e ? e + "" : ""
                          , c = c + ("\x3cth style\x3d'width:" + b.thArray[d] + "px'\x3e" + String.fromCharCode(65 + d % 26) + e + "\x3c/th\x3e")
                    }
                    this.$table.prepend(c + "\x3c/tr\x3e\x3c/thead\x3e");
                    c = b.maxColWidth;
                    2 == b.cols && (this.$table.find("thead\x3etr\x3eth:last").attr("style", ""),
                    c = 510)
                }
                this.options.afterChangeWidth(this, b.thArray);
                this.resizable(c)
            },
            onCellMouseOver: function(b) {
                b = b.target;
                var c = this.persist;
                0 != c.mouse.status && (c.range.end = this.getCellIndex(b),
                this.clearSelection(),
                this.selectCell(),
                this.renderSelection())
            },
            onCellMouseLeftDown: function(b) {
                b = b.target;
                var c = this.persist;
                c.mouse.status = 1;
                c.range.start = this.getCellIndex(b);
                m(b).trigger("mouseover")
            },
            onCellMouseRightDown: function(b) {
                b = b.target;
                var c = this.persist;
                if (m(b).hasClass(this.options.area))
                    return !0;
                c.range.start = this.getCellIndex(b);
                c.range.end = this.getCellIndex(b);
                this.clearSelection();
                this.selectCell();
                this.renderSelection()
            },
            onCellMouseUp: function() {
                this.persist.mouse.status = 0
            },
            getRange: function() {
                var b = this.persist
                  , c = this.options;
                if (b.range.start && b.range.end) {
                    var d = b.range.start.split(c.separator), e = parseInt(d[0]), d = parseInt(d[1]), a = b.range.end.split(c.separator), c = parseInt(a[0]), f = parseInt(a[1]), g;
                    d > f ? (g = d + b.storage[e][d].colSpan - 1,
                    a = f) : d < f ? (g = f + b.storage[c][f].colSpan - 1,
                    a = d) : e > c ? (g = d + b.storage[e][d].colSpan - 1,
                    a = f) : e < c ? (g = f + b.storage[c][f].colSpan - 1,
                    a = d) : a = g = d;
                    e > c ? (b = e + b.storage[e][d].rowSpan - 1,
                    e = c) : e < c ? b = c + b.storage[c][f].rowSpan - 1 : d > f ? (b = e + b.storage[e][d].rowSpan - 1,
                    e = c) : d < f ? b = c + b.storage[c][f].rowSpan - 1 : e = b = e;
                    return this._getMaxRange({
                        minX: a,
                        maxX: g,
                        minY: e,
                        maxY: b
                    })
                }
                return {}
            },
            _getMaxRange: function(b) {
                for (var c = this.persist, d = b.minX, e = b.maxX, a = b.minY, f = b.maxY, g = d, h = e, q = a, n = f; a <= f; a++)
                    if (c.storage[a])
                        for (var w = d; w <= e; w++) {
                            var v = this.findCell(a, w)
                              , s = v.colSpan
                              , A = v.rowSpan;
                            (1 < s || 1 < A) && -1 == m.inArray(v, c.place) && (c.place.push(v),
                            v = this.getCellIndex(v).split(this.options.separator),
                            1 < s && (h = h > ~~v[1] + s - 1 ? h : ~~v[1] + s - 1,
                            g = g < ~~v[1] ? g : ~~v[1]),
                            1 < A && (n = n > ~~v[0] + A - 1 ? n : ~~v[0] + A - 1,
                            q = q < ~~v[0] ? q : ~~v[0]))
                        }
                c = {
                    minX: g,
                    maxX: h,
                    minY: q,
                    maxY: n
                };
                return this._checkRange(b, c) ? c : this._getMaxRange(c)
            },
            _checkRange: function(b, c) {
                return b.minX == c.minX && b.maxX == c.maxX && b.minY == c.minY && b.maxY == c.maxY
            },
            clearSelection: function() {
                var b = this.persist
                  , c = this.options;
                if (b.selection || 0 < b.selection.length)
                    for (var d = 0; d < b.selection.length; d++) {
                        var e = b.selection[d].split(c.separator)
                          , a = e[0]
                          , e = e[1];
                        b.storage[a] && b.storage[a][e] && b.storage[a][e].setAttribute("class", "")
                    }
                b.selection = [];
                b.selected = [];
                b.place = []
            },
            selectCell: function() {
                for (var b = this.persist, c = this.getRange(), d = c.minX, e = c.maxX, a = c.maxY, c = c.minY; c <= a; c++)
                    for (var f = d; f <= e; f++)
                        b.selection.push(c + this.options.separator + f),
                        b.storage[c][f] && b.selected.push(b.storage[c][f])
            },
            renderSelection: function() {
                for (var b = this.persist, c = this.options, d = 0; d < b.selection.length; d++) {
                    var e = b.selection[d].split(c.separator)
                      , a = e[0]
                      , e = e[1];
                    b.storage[a][e] && b.storage[a][e].setAttribute("class", c.area)
                }
            },
            merge: function() {
                var b = this.persist
                  , c = this.options;
                if (!this.options.beforeChangeCell(this, this.persist.selected))
                    return !1;
                if (this._checkMerge()) {
                    for (var d = this._selectionTrans2ArrayStack(), e = 0, a = 0, f = 0; f < d[0].length; f++) {
                        var g = d[0][f].split(c.separator)
                          , h = g[0]
                          , g = g[1];
                        b.storage[h][g] && (e += b.storage[h][g].colSpan)
                    }
                    for (f = 0; f < d.length; f++)
                        for (var m = 0; m < d[f].length; m++)
                            g = d[f][m].split(c.separator),
                            h = g[0],
                            g = g[1],
                            b.storage[h][g] && 0 === m && (a += b.storage[h][g].rowSpan,
                            1 < d[f][0].rowSpan && (f = f + b.storage[h][g].rowSpan - 1));
                    b.place = [];
                    b.selected = [];
                    for (f = 0; f < d.length; f++)
                        for (m = 0; m < d[f].length; m++)
                            g = d[f][m].split(c.separator),
                            h = g[0],
                            g = g[1],
                            b.storage[h][g] && (0 === f && 0 === m ? (b.place.push(b.storage[h][g]),
                            b.selected.push(b.storage[h][g]),
                            b.storage[h][g].rowSpan = a,
                            b.storage[h][g].colSpan = e,
                            b.range.start = d[f][m],
                            b.range.end = d[f][m]) : (b.storage[h][g].parentNode.removeChild(b.storage[h][g]),
                            b.storage[h][g] = null))
                }
            },
            clearMerge: function() {
                var b = this.persist
                  , c = b.place;
                if (!this.options.beforeChangeCell(this, this.persist.selected))
                    return !1;
                if (c && 0 != c.length) {
                    for (var d = 0; d < c.length; d++) {
                        for (var e = c[d], a = this.getCellIndex(e).split(this.options.separator), f, h = 0; h < e.rowSpan; h++) {
                            f = 0 === h ? e.parentNode : m(f).next()[0];
                            for (var n = 0; n < e.colSpan; n++)
                                if (0 !== n || 0 !== h) {
                                    var q = g.createElement(e.tagName.toLowerCase())
                                      , p = this.getPreviousSiblingStorageElementNotNull(~~a[0] + h, ~~a[1] + n);
                                    p ? this.nextSibling(p) ? f.insertBefore(q, this.nextSibling(p)) : f.appendChild(q) : this.firstChild(f) ? f.insertBefore(q, this.firstChild(f)) : f.appendChild(q);
                                    b.storage[~~a[0] + h][~~a[1] + n] = q;
                                    b.selected.push(q);
                                    this.options.afterCreateCell(this, m(q));
                                    q.setAttribute("class", this.options.area)
                                }
                        }
                        e.rowSpan = 1;
                        e.colSpan = 1
                    }
                    b.place = []
                }
            },
            deleteRow: function(b) {
                if (!this.options.beforeChangeCell(this, this.persist.selected))
                    return !1;
                b = this._selectionTrans2ArrayStack();
                for (var c, d = 0; d < b.length; d++) {
                    var e = b[d][0].split(this.options.separator);
                    0 === d && (c = new Number(e[0]));
                    this._deleteRowHandler(c, new Number(e[1]));
                    this.options.rows--
                }
                this.clearSelection();
                this.options.afterDeleteRow(this)
            },
            _deleteRowHandler: function(b, c, d) {
                var e = this.persist;
                c = e.storage[b][c];
                for (var a = 0; a < e.storage[b].length; a++) {
                    var f = e.storage[b][a];
                    if (f) {
                        if (1 < f.rowSpan) {
                            var h = this.nextRow(c.parentNode)
                              , n = g.createElement(f.tagName.toLowerCase());
                            n.rowSpan = f.rowSpan - 1;
                            n.colSpan = f.colSpan;
                            if (0 === a)
                                h.insertBefore(n, this.firstChild(h));
                            else {
                                for (var f = 0, q = e.storage[b + 1][a - 1]; !q; )
                                    f++,
                                    q = 0 > a - 1 - f ? this.firstChild(h) : e.storage[b][a - 1 - f];
                                h.insertBefore(n, this.nextSibling(q))
                            }
                            e.storage[b + 1][a] = n;
                            this.options.afterCreateCell(this, m(n))
                        }
                    } else {
                        h = b - 1;
                        if (-1 !== h)
                            for (; !e.storage[h][a] && (h--,
                            -1 !== h); )
                                ;
                        if (-1 !== h) {
                            if (e.storage[h][a])
                                if (1 < e.storage[h][a].rowSpan)
                                    e.storage[h][a].rowSpan--,
                                    1 < e.storage[h][a].colSpan && (a += e.storage[h][a].colSpan - 1);
                                else if (0 < a)
                                    if (e.storage[b][a - 1])
                                        a += e.storage[b][a - 1].colSpan - 1 - 1;
                                    else {
                                        h = b - 1;
                                        if (-1 !== h)
                                            for (; !e.storage[h][a - 1] && (h--,
                                            -1 !== h); )
                                                ;
                                        e.storage[h][a - 1] && (e.storage[h][a - 1].rowSpan--,
                                        a += e.storage[h][a - 1].colSpan - 2)
                                    }
                        } else
                            a += e.storage[b][a - 1].colSpan - 1 - 1
                    }
                }
                e.storage.splice(b, 1);
                !0 === d ? (h = this.getRow(b),
                h.parentNode.removeChild(h)) : c.parentNode.parentNode.removeChild(c.parentNode)
            },
            deleteCol: function() {
                if (!this.options.beforeChangeCell(this, this.persist.selected))
                    return !1;
                if (this.persist.selection && 0 < this.persist.selection.length)
                    for (var b, c, d = this._selectionTrans2ArrayStack(), e = 0; e < d[0].length; e++) {
                        var a = d[0][e].split(this.options.separator);
                        0 === e && (b = new Number(a[0]),
                        c = new Number(a[1]));
                        this._deleteColHandler(b, c);
                        this.options.thArray.splice(c, 1);
                        this.options.cols--
                    }
                this.clearSelection();
                this.initHeader();
                this.options.afterDeleteCol(this)
            },
            _deleteColHandler: function(b, c) {
                for (var d = this.persist, e = 0; e < d.storage.length; e++) {
                    var a = d.storage[e][c];
                    if (a)
                        1 < a.colSpan ? a.colSpan -= 1 : (d.storage[e].splice(c, 1),
                        a.parentNode.removeChild(a));
                    else {
                        var a = !1
                          , f = c;
                        if (0 <= f)
                            for (; !d.storage[e][f] && !(f--,
                            0 > f); )
                                ;
                        if (0 <= f) {
                            var g = d.storage[e][f].rowSpan;
                            if (d.storage[e][f].colSpan + f > c && 1 < d.storage[e][f].colSpan) {
                                d.storage[e][f].colSpan--;
                                if (1 < g) {
                                    for (f = 1; f < g; f++)
                                        d.storage[e + f].splice(c, 1);
                                    e += g - 1
                                } else
                                    a = !0;
                                d.storage[e - g + 1].splice(c, 1)
                            }
                        }
                        !1 === a && d.storage[e].splice(c, 1)
                    }
                }
            },
            addCol: function() {
                var b = this.persist;
                if (!this.options.beforeChangeCell(this, this.persist.selected))
                    return !1;
                b.selection && 0 < b.selection.length ? (b = this._selectionTrans2ArrayStack(),
                b = this.index2Obj(b[0][b[0].length - 1]),
                this._addColHandler(b.y, b.x)) : this._addLastColHandler();
                this.options.cols++;
                this.initHeader()
            },
            _addLastColHandler: function() {
                for (var b = this.persist.storage, c = [], d = 0; d < b.length; d++) {
                    var e = g.createElement("td");
                    b[d].push(e);
                    this.getRow(d).appendChild(e);
                    c.push(e)
                }
                this.options.thArray.push(this.options.minColWidth);
                this.options.afterCreateCell(this, c)
            },
            _addColHandler: function(b, c) {
                var d = this.persist
                  , e = this.findCell(b, c);
                this.options.thArray.splice(c + 1, 0, this.options.minColWidth);
                var a = this.getCellIndex(e).split(this.options.separator);
                b = ~~a[0];
                c = ~~a[1];
                for (var a = [b, c], f = null, h = 0; h < d.storage.length; h++) {
                    var n = !1
                      , q = d.storage[h][c];
                    null === f && (f = c + e.colSpan);
                    if (q) {
                        if (q.colSpan + c < f) {
                            for (n = 0; n < d.storage[h].length; n++)
                                if (d.storage[h][n] && d.storage[h][n].colSpan + n >= f) {
                                    q = d.storage[h][n];
                                    c = n;
                                    break
                                }
                            n = q.colSpan + c > f ? !0 : !1
                        } else
                            q.colSpan + c > f && (n = !0);
                        if (!1 === n) {
                            if (n = g.createElement(q.tagName.toLowerCase()),
                            this.nextSibling(q) ? q.parentNode.insertBefore(n, this.nextSibling(q)) : q.parentNode.appendChild(n),
                            this.options.afterCreateCell(this, m(n)),
                            d.storage[h].splice(f, 0, n),
                            1 < q.rowSpan) {
                                for (var p = null, w = 1; w < q.rowSpan; w++) {
                                    var n = g.createElement(q.tagName.toLowerCase())
                                      , p = p ? this.nextRow(p) : this.nextRow(q.parentNode)
                                      , v = f - 1;
                                    if (0 <= v)
                                        for (; !d.storage[h + w][v] && !(v--,
                                        0 > v); )
                                            ;
                                    d.storage[h + w][v] ? this.nextSibling(d.storage[h + w][v]) ? p.insertBefore(n, this.nextSibling(d.storage[h + w][v])) : p.appendChild(n) : this.firstChild(p) ? p.insertBefore(n, this.firstChild(p)) : p.appendChild(n);
                                    this.options.afterCreateCell(this, m(n));
                                    d.storage[h + w].splice(f, 0, n)
                                }
                                h += q.rowSpan - 1
                            }
                        } else {
                            d.storage[h].splice(f, 0, null);
                            if (1 < q.rowSpan) {
                                for (w = 1; w < q.rowSpan; w++)
                                    d.storage[h + w].splice(f, 0, null);
                                h += q.rowSpan - 1
                            }
                            q.colSpan++
                        }
                    } else {
                        q = c;
                        if (0 <= q)
                            for (; !d.storage[h][q] && !(q--,
                            0 > q); )
                                ;
                        if (d.storage[h][q]) {
                            if (q === parseInt(a[1]))
                                for (p = null,
                                w = 0; w < d.storage[h][q].rowSpan; w++) {
                                    0 === w ? p = d.storage[h][q].parentNode : p && (p = this.nextRow(p));
                                    n = g.createElement(d.storage[h][q].tagName.toLowerCase());
                                    if (0 === w)
                                        this.nextSibling(d.storage[h + w][q]) ? p.insertBefore(n, this.nextSibling(d.storage[h + w][q])) : p.appendChild(n);
                                    else {
                                        v = q;
                                        if (0 < v)
                                            for (; !d.storage[h + w][v] && !(v--,
                                            0 > v); )
                                                ;
                                        d.storage[h + w][v] ? TableUtils.nextSibling(d.storage[h + w][v]) ? p.insertBefore(n, this.nextSibling(d.storage[h + w][v])) : p.appendChild(n) : this.firstChild(p) ? p.insertBefore(n, this.firstChild(p)) : p.appendChild(n)
                                    }
                                    this.options.afterCreateCell(this, m(n));
                                    d.storage[h + w].splice(q + d.storage[h][q].colSpan, 0, n)
                                }
                            else {
                                d.storage[h].splice(f, 0, null);
                                if (1 < d.storage[h][q].rowSpan)
                                    for (w = 1; w < d.storage[h][q].rowSpan; w++)
                                        d.storage[h + w].splice(f, 0, null);
                                d.storage[h][q].colSpan++
                            }
                            h += d.storage[h][q].rowSpan - 1
                        }
                    }
                }
            },
            addRow: function() {
                var b = this.persist;
                if (!this.options.beforeChangeCell(this, this.persist.selected))
                    return !1;
                b.selection && 0 < b.selection.length ? (b = this._selectionTrans2ArrayStack(),
                b = this.index2Obj(b[b.length - 1][0]),
                this._addRowHandler(b.y, b.x)) : this._addLastRowHandler();
                this.options.rows++
            },
            _addLastRowHandler: function() {
                for (var b = g.createElement("tr"), c = [], d = this.options.cols, e = 0; e < d; e++) {
                    var a = g.createElement("td");
                    b.appendChild(a);
                    c.push(a)
                }
                this.persist.storage.push(c);
                this.$table.find("tbody")[0].appendChild(b);
                this.options.afterCreateCell(this, c)
            },
            _addRowHandler: function(b, c) {
                var d = this.persist
                  , e = this.findCell(b, c)
                  , a = d.storage.length
                  , f = d.storage[b].length
                  , h = [[]]
                  , n = g.createElement(e.parentNode.tagName.toLowerCase());
                this.nextRow(e.parentNode) ? b === a - 1 ? e.parentNode.parentNode.appendChild(n) : e.parentNode.parentNode.insertBefore(n, this.getRow(b + 1)) : e.parentNode.parentNode.appendChild(n);
                if (b === a - 1) {
                    for (a = 0; a < f; a++) {
                        var q = g.createElement(e.tagName.toLowerCase());
                        n.appendChild(q);
                        this.options.afterCreateCell(this, m(q));
                        h[0][a] = q
                    }
                    d.storage = d.storage.concat(h)
                } else {
                    for (a = 0; a < d.storage[b].length; a++)
                        if (d.storage[b][a])
                            if (1 < d.storage[b][a].rowSpan) {
                                if (h[0][a] = null,
                                d.storage[b][a].rowSpan++,
                                1 < d.storage[b][a].colSpan) {
                                    for (f = 1; f < d.storage[b][a].colSpan; f++)
                                        h[0][a + f] = null;
                                    a += d.storage[b][a].colSpan - 1
                                }
                            } else {
                                if (q = g.createElement(e.tagName.toLowerCase()),
                                n.appendChild(q),
                                this.options.afterCreateCell(this, m(q)),
                                h[0][a] = q,
                                1 < d.storage[b][a].colSpan) {
                                    for (f = 1; f < d.storage[b][a].colSpan; f++)
                                        q = g.createElement(e.tagName.toLowerCase()),
                                        n.appendChild(q),
                                        this.options.afterCreateCell(this, m(q)),
                                        h[0][a + f] = q;
                                    a += d.storage[b][a].colSpan - 1
                                }
                            }
                        else {
                            h[0][a] = null;
                            for (var p = b; !d.storage[p][a]; )
                                p--;
                            if (d.storage[p][a].rowSpan + p - 1 === b) {
                                if (q = g.createElement(e.tagName.toLowerCase()),
                                n.appendChild(q),
                                h[0][a] = q,
                                this.options.afterCreateCell(this, m(q)),
                                1 < d.storage[p][a].colSpan) {
                                    for (f = 1; f < d.storage[p][a].colSpan; f++)
                                        q = g.createElement(e.tagName.toLowerCase()),
                                        n.appendChild(q),
                                        this.options.afterCreateCell(this, m(q)),
                                        h[0][a + f] = q;
                                    a += d.storage[p][a].colSpan - 1
                                }
                            } else if (d.storage[p][a].rowSpan++,
                            1 < d.storage[p][a].colSpan) {
                                for (f = 1; f < d.storage[p][a].colSpan; f++)
                                    h[0][a + f] = null;
                                a += d.storage[p][a].colSpan - 1
                            }
                        }
                    d.storage.splice(b + 1, 0, h[0])
                }
            },
            resizable: function(b) {
                var c = this;
                c.$table.find("th").resizable({
                    handles: "e",
                    minWidth: '35',
                    maxWidth: b,
                    stop: function(b, e) {
                        c.options.thArray[e.element.index()] = e.size.width;
                        c.options.afterChangeWidth(c, c.options.thArray)
                    }
                })
            },
            _selectionTrans2ArrayStack: function(b) {
                b = b ? b : this.persist.selection;
                for (var c = [], d = 0; d < b.length; d++) {
                    var e = b[d].split(this.options.separator)[0];
                    c[e] || (c[e] = []);
                    c[e].push(b[d])
                }
                b = [];
                e = 0;
                for (d in c)
                    b[e] = c[d],
                    e++;
                return b
            },
            getRowIndex: function(b) {
                for (var c = b.parent().children(), d = 0; d < c.length; d++)
                    if (c[d] == b[0])
                        return d
            },
            getCellIndex: function(b) {
                var c = this.persist
                  , d = this.getRowIndex(m(b).parent());
                if (c.storage[d])
                    for (var e = 0; e < c.storage[d].length; e++)
                        if (b == c.storage[d][e])
                            return d + this.options.separator + e
            },
            nextRow: function(b) {
                for (var c = this.getTableRows(), d = 0, e = 0; e < c.length; e++)
                    if (c[e] === b) {
                        d = e;
                        break
                    }
                return c[d + 1] ? c[d + 1] : null
            },
            findCell: function(b, c) {
                var d = this.persist
                  , e = d.storage[b][c];
                if (!e) {
                    var a = b;
                    a: for (; 0 <= a; a--) {
                        var f = c;
                        b: for (; 0 <= f; f--)
                            if (d.storage[a][f]) {
                                var f = d.storage[a][f]
                                  , g = f.colSpan
                                  , h = f.rowSpan
                                  , m = this.getCellIndex(f).split(this.options.separator);
                                if (~~m[1] + g - 1 >= c && ~~m[0] + h - 1 >= b) {
                                    e = f;
                                    break a
                                } else
                                    break b
                            }
                    }
                }
                return e
            },
            getPreviousSiblingStorageElementNotNull: function(b, c) {
                var d = this.persist
                  , e = c - 1;
                if (0 <= e)
                    for (; !d.storage[b][e] && !(e--,
                    0 > e); )
                        ;
                return d.storage[b][e]
            },
            nextSibling: function(b) {
                return b.nextElementSibling || b.nextSibling
            },
            firstChild: function(b) {
                return b.firstElementChild || b.firstChild
            },
            getRow: function(b) {
                return this.getTableRows()[b]
            },
            getTableRows: function() {
                return this.$element.find("tbody tr")
            },
            index2Obj: function(b) {
                return b ? (b = b.split(this.options.separator),
                {
                    y: parseInt(b[0]),
                    x: parseInt(b[1])
                }) : null
            }
        };
        m.fn.table = function(b) {
            return (new d(this,b)).init()
        }
    }
    )(jQuery, window, document);
    (function(m) {
        var h = function(g, f) {
            this.$element = m(g);
            this.before = f.before || this.before;
            this.onItem = f.onItem || this.onItem;
            this.scopes = f.scopes || null;
            f.target && this.$element.data("target", f.target);
            this.listen()
        };
        h.prototype = {
            constructor: h,
            show: function(g) {
                var f, d, b = {
                    relatedTarget: this,
                    target: g.currentTarget
                };
                if (!this.isDisabled() && (this.closemenu(),
                !1 !== this.before.call(this, g, m(g.currentTarget))))
                    return f = this.getMenu(),
                    f.trigger(m.Event("show.bs.context", b)),
                    d = this.getPosition(g, f),
                    f.attr("style", "").css(d).addClass("open").on("click.context.data-api", "li:not(.divider)", m.proxy(this.onItem, this, m(g.currentTarget))).trigger("shown.bs.context", b),
                    f.find("ul").show(),
                    m("html").on("click.context.data-api", f.selector, m.proxy(this.closemenu, this)),
                    !1
            },
            closemenu: function(g) {
                var f;
                g = this.getMenu();
                g.hasClass("open") && (f = {
                    relatedTarget: this
                },
                g.trigger(m.Event("hide.bs.context", f)),
                g.removeClass("open").off("click.context.data-api", "li:not(.divider)").trigger("hidden.bs.context", f),
                g.find("ul").hide(),
                m("html").off("click.context.data-api", g.selector))
            },
            keydown: function(g) {
                27 == g.which && this.closemenu(g)
            },
            before: function(g) {
                return !0
            },
            onItem: function(g) {
                return !0
            },
            listen: function() {
                this.$element.on("contextmenu.context.data-api", this.scopes, m.proxy(this.show, this));
                m("html").on("click.context.data-api", m.proxy(this.closemenu, this));
                m("html").on("keydown.context.data-api", m.proxy(this.keydown, this));
                m("html").on("mousedown.context.data-api", m.proxy(this.mousedown, this))
            },
            mousedown: function(g) {
                0 == m(g.target).closest(".table_layout_js").length && this.closemenu(g)
            },
            destroy: function() {
                this.$element.off(".context.data-api").removeData("context");
                m("html").off(".context.data-api")
            },
            isDisabled: function() {
                return this.$element.hasClass("disabled") || this.$element.attr("disabled")
            },
            getMenu: function() {
                var g = this.$element.data("target"), f;
                g || (g = (g = this.$element.attr("href")) && g.replace(/.*(?=#[^\s]*$)/, ""));
                return (f = m(g)) && f.length ? f : this.$element.find(g)
            },
            getPosition: function(g, f) {
                var d = g.clientX
                  , b = g.clientY
                  , c = m(window).width()
                  , h = m(window).height()
                  , e = f.find(".dropdown-menu").outerWidth()
                  , a = f.find(".dropdown-menu").outerHeight()
                  , b = b + a > h ? {
                    top: b - a + m(window).scrollTop()
                } : {
                    top: b + m(window).scrollTop()
                }
                  , d = d + e > c && 0 < d - e ? {
                    left: d - e + m(window).scrollLeft()
                } : {
                    left: d + m(window).scrollLeft()
                }
                  , c = f.offsetParent().offset();
                d.left -= c.left;
                b.top -= c.top;
                return m.extend({
                    position: "absolute",
                    "z-index": 9999
                }, b, d)
            }
        };
        m.fn.contextmenu = function(g, f) {
            return this.each(function() {
                var d = m(this)
                  , b = d.data("context")
                  , c = "object" == typeof g && g;
                b || d.data("context", b = new h(d,c));
                "string" == typeof g && b[g].call(b, f)
            })
        }
        ;
        m.fn.contextmenu.Constructor = h;
        m(document).on("contextmenu.context.data-api", function() {
            m('[data-toggle\x3d"context"]').each(function() {
                var g = m(this).data("context");
                g && g.closemenu()
            })
        }).on("contextmenu.context.data-api", '[data-toggle\x3d"context"]', function(g) {
            m(this).contextmenu("show", g);
            g.preventDefault();
            g.stopPropagation()
        })
    }
    )(jQuery)
});
define("form/component/signaturecomponent", ["form/editablecomponent", "form/tplutil", "form/componentmodel", "form/component/imageviewer", "form/component/signcomview"], function(m, y, w) {
    var k = m("form/editablecomponent")
      , e = m("form/tplutil")
      , d = m("form/componentmodel")
      , a = m("form/component/imageviewer")
      , b = m("form/component/signcomview");
    window.SignatureComponent = k.extend({
    });
    w.exports = window.SignatureComponent
});
define("form/component/contactcomponent", "form/relatecomponent form/tplutil form/componentmodel form/component/contactlist form/component/entityselecter form/component/typeahead form/component/relevancecontrol form/abposview".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/componentmodel")
      , f = n("form/component/contactlist")
      , d = n("form/component/entityselecter")
      , b = n("form/component/typeahead")
      , c = n("form/component/relevancecontrol")
      , l = n("form/abposview");
    window.ContactComponent = m.extend({
    });
    u.exports = window.ContactComponent
});
define("form/component/formconditioneditorview", ["form/form-plugin", "form/tplutil"], function(n, y, u) {
    var m = n("form/form-plugin")
      , h = n("form/tplutil")
      , g = {
        fields: [],
        success: $.noop,
        condition: null
    };
    n = Backbone.View.extend({
        initialize: function(f) {
            this.el = "#formconditioneditor";
            this.options = $.extend({}, g, f);
            $("body").append(h.get("formcondition"))
        },
        delegateEvents: function() {
            var f = this
              , d = $(f.el);
            d.on("hidden.bs.modal", function() {
                f.remove()
            });
            d.on("click", "#cancel", function() {
                d.modal("hide")
            });
            d.on("click", "#success", function() {
                "function" == typeof f.options.success && f.options.success(f.bulidCondition());
                d.modal("hide")
            });
            d.on("change", ".j_field_select", function() {
                var b = $(this);
                f.changeField(b)
            });
            d.on("change", ".j_option_select", function() {
                var b = $(this)
                  , c = $(this).find("option:selected")
                  , d = c.attr("id")
                  , c = c.text()
                  , e = b.closest(".j_form_condition").find(".j_option_selected");
                if (c && d) {
                    var a = '\x3cspan class\x3d"entity-item"\x3e\x3ca id\x3d' + d + ' title\x3d"' + c + '" class\x3d"item-name"\x3e' + c + "\x3c/a\x3e\x3c/span\x3e";
                    e.find(".entity-item").each(function(c) {
                        d == $(this).find("a").attr("id") && (a = null)
                    });
                    e.append(a)
                }
                b.find("option").eq(0).prop("selected", !0)
            });
            d.on("click", ".j_addCondition", function() {
                f.renderField()
            });
            d.on("click", ".j_condition_delete", function() {
                $(this).closest(".j_form_condition").remove()
            });
            $("body").off("click.FormConditionEditor").on("click.FormConditionEditor", function(b) {
                0 == $(b.target).closest(".j_comboselect_ul").length && $(".j_comboselect_ul").removeClass("open")
            });
            d.on("click", ".j_add-btn", function(b) {
                $(this).parent().toggleClass("open")
            });
            d.on("click", ".combo_select_js li", function() {
                var b = $(this)
                  , c = b.data("option")
                  , d = b.closest(".combo_select_js").index()
                  , e = b.closest(".j_form_condition");
                if (b.attr("templateId")) {
                    var a = c.selectionId
                      , g = []
                      , g = [];
                    f.selectOption || (f.selectOption = []);
                    f.selectOption[a] || (g = {},
                    g.parentId = a,
                    g.templateId = b.attr("templateId"),
                    g = f.renderTemplateDetails(g),
                    g = f.getAllComboSelectOptions(g),
                    f.selectOption[a] = g,
                    c.children = g)
                }
                b.addClass("active").siblings().removeClass("active");
                e.find(".combo_select_js:gt(" + d + ")").find("ul").html("");
                if (c)
                    for (b = e.find(".combo_select_js:eq(" + (d + 1) + ")").find("ul"),
                    d = 0; d < c.children.length; d++)
                        e = c.children[d],
                        a = $("\x3cli\x3e\x3ca\x3e\x3c/a\x3e\x3c/li\x3e"),
                        a.children("a").text(e.name),
                        a.attr("id", e.uid),
                        a.attr("title", e.name),
                        a.data("option", e),
                        c.selectionId == c.uid && a.attr("templateId", c.selectionId),
                        b.append(a)
            });
            d.on("click", ".j_ok_btn", function() {
                var b = $(this).closest(".j_form_condition")
                  , c = b.find("li.active:last")
                  , d = c.attr("id")
                  , e = c.attr("title")
                  , c = c.closest(".combo_select_js").attr("id")
                  , a = b.find(".j_option_selected");
                if (e && d) {
                    var f = '\x3cspan class\x3d"entity-item"\x3e\x3ca id\x3d' + d + ' title\x3d"' + e + '" selectId\x3d"' + c + '"\x3e' + e + "\x3c/a\x3e\x3c/span\x3e";
                    a.find(".entity-item").each(function(a) {
                        d == $(this).find("a").attr("id") && (f = null)
                    });
                    a.append(f)
                }
                b.find(".j_comboselect_ul").removeClass("open")
            })
        },
        renderComboSelectOption: function(f, d) {
            for (var b = d.selects, c = f.find(".selectlist_js"), g = 0; g < b.length; g++) {
                var e = $('\x3cdiv class\x3d"filter-box j_filter-box combo_select_js" auto-scroll\x3d"yes" style\x3d"height:230px;"\x3e\x3cul\x3e\x3c/ul\x3e\x3c/div\x3e')
                  , a = b[g];
                e.attr("index", g);
                e.attr("id", a.fieldId);
                c.append(e)
            }
            for (g = 0; g < d.options.length; g++)
                b = d.options[g],
                e = c.find(".combo_select_js[index\x3d'0']").children("ul"),
                a = $("\x3cli\x3e\x3ca\x3e\x3c/a\x3e\x3c/li\x3e"),
                a.children("a").text(b.name),
                a.attr("id", b.uid),
                a.attr("title", b.name),
                a.data("option", b),
                d.templateId && a.attr("templateId", d.templateId),
                e.append(a);
            f.find(".combo_select_js").mCustomScrollbar({
                axis: "y",
                theme: "darkblue",
                scrollButtons: {
                    enable: !0
                },
                advanced: {
                    autoExpandHorizontalScroll: !0
                }
            })
        },
        render: function() {
            var f = $(this.el);
            f.modal({
                keyboard: !1,
                backdrop: "static"
            });
            var d = this.options.condition;
            if (d && d.fields)
                for (f.find(".j-condition-operate").val(d.operate),
                f = 0; f < d.fields.length; f++)
                    this.renderField(d.fields[f]);
            else
                this.renderField();
            m.initLayout($(".j_formconditionScr"))
        },
        renderField: function(f) {
            var d = $(this.el)
              , b = d.find("#form-condition .j_form_condition").clone()
              , c = this.options.fields
              , g = b.find(".j_field_select");
            if (null != c && 0 < c.length)
                for (var e = 0; e < c.length; e++) {
                    var a = $("\x3coption id\x3d'" + c[e].componentSetup.tempId + "' value\x3d'" + c[e].componentSetup.tempId + "'\x3e" + c[e].componentSetup.title + "\x3c/option\x3e");
                    a.data("field", c[e]);
                    g.append(a)
                }
            d.find(".j_form_conditions").append(b);
            if (f)
                if (b.find(".j_field_select").val(f.fieldId),
                b.find(".j_field_select").val())
                    if (b.find(".j_field_select").change(),
                    b.find(".j_option_operate").val(f.operate),
                    d = b.find(".j_field_select").find("option:selected").data("field"),
                    "ComboSelect" == d.componentSetup.componentKey)
                        for (var h in f.values) {
                            c = [];
                            if (d.componentSetup.templateId) {
                                if (g = {},
                                g.templateDetailsId = f.values[h],
                                g = this.renderTemplateDetails(g))
                                    c.uid = g[0].id,
                                    c.name = g[0].name
                            } else
                                c = this.getOptByUid(f.values[h], d.componentSetup.options);
                            c ? b.find(".j_option_selected").append('\x3cspan class\x3d"entity-item"\x3e\x3ca id\x3d' + c.uid + ' title\x3d"' + c.name + '" class\x3d"item-name"\x3e' + c.name + "\x3c/a\x3e\x3c/span\x3e") : b.find(".j_option_selected").append("\x3cspan class\x3d'entity-item'\x3e\x3ca class\x3d'item-name' title\x3d'\u672a\u77e5\u9009\u9879' id\x3d'" + f.values[h] + "' style\x3d'color:red'\x3e\u672a\u77e5\u9009\u9879\x3c/a\x3e\x3c/span\x3e")
                        }
                    else
                        for (h in f.values)
                            b.find(".j_option_select").val(f.values[h]).val() ? b.find(".j_option_select").change() : b.find(".j_option_selected").append("\x3cspan class\x3d'entity-item'\x3e\x3ca class\x3d'item-name' title\x3d'\u672a\u77e5\u9009\u9879' id\x3d'" + f.values[h] + "' style\x3d'color:red'\x3e\u672a\u77e5\u9009\u9879\x3c/a\x3e\x3c/span\x3e");
                else
                    b.remove()
        },
        getOptByUid: function(f, d) {
            for (var b = function(c, a) {
                if (a.uid == c)
                    return a;
                if (a.children)
                    for (var d = 0; d < a.children.length; d++) {
                        var f = b(c, a.children[d]);
                        if (f)
                            return f
                    }
            }, c = 0; c < d.length; c++) {
                var g = b(f, d[c]);
                if (g)
                    return g
            }
        },
        changeField: function(f) {
            var d = f.closest(".j_form_condition")
              , b = f.find("option:selected").data("field");
            f = d.find(".j_option_select").removeClass("hide").html("\x3coption value\x3d''\x3e\u8bf7\u9009\u62e9\x3c/option\x3e");
            d.find(".j_option_selected").html("");
            d.find(".j_comboselect_ul").addClass("hide");
            d.find(".selectlist_js").html("");
            if (b)
                if ("ComboSelect" == b.componentSetup.componentKey)
                    d.find(".j_comboselect_ul").removeClass("hide"),
                    d.find(".j_option_select").addClass("hide"),
                    this.renderComboSelectOption(d, b.componentSetup);
                else
                    for (d.find(".j_comboselect_ul").addClass("hide"),
                    d.find(".j_option_select").removeClass("hide"),
                    d = b.componentSetup.options,
                    "DataSource" == b.componentSetup.componentKey && (d = b.options),
                    b = 0; b < d.length; b++) {
                        d[b].uid || (d[b].uid = m.uid());
                        var c = $("\x3coption id\x3d'" + d[b].uid + "' value\x3d'" + d[b].uid + "'\x3e" + d[b].name + "\x3c/option\x3e");
                        f.append(c)
                    }
        },
        bulidCondition: function(f) {
            f = $(this.el);
            var d = {
                operate: f.find(".j-condition-operate").val(),
                fields: []
            };
            f.find(".j_form_conditions .j_form_condition").each(function() {
                var b = $(this)
                  , c = b.find(".j_field_select").find("option:selected").attr("id")
                  , f = [];
                b.find(".j_option_selected").find(".entity-item").each(function() {
                    f.push($(this).find("a").attr("id"))
                });
                c && 0 < f.length && d.fields.push({
                    operate: b.find(".j_option_operate").val(),
                    values: f,
                    fieldId: c
                })
            });
            return d
        },
        remove: function() {
            $(this.el).remove();
            $("body").off("click.FormConditionEditor")
        },
        renderTemplateDetails: function(f) {
            var d = null;
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                async: !1,
                url: TEAMS.api.queryDateDetailsByDetails,
                dataType: "json",
                data: JSON.stringify(f),
                success: function(b) {
                    d = b.templateDetailsList
                }
            });
            return d
        },
        getAllComboSelectOptions: function(f) {
            var d = [];
            if (f && 0 < f.length)
                for (var b = 0; b < f.length; b++) {
                    var c = f[b]
                      , g = new Option;
                    g.setName(c.name);
                    g.setOrder(c.order);
                    g.setSelectionId(c.id);
                    g.setUid(c.id);
                    c.children && 0 < c.children.length && g.setChildren(this.getAllComboSelectOptions(c.children));
                    d.push(g.componentSetup)
                }
            return d
        }
    });
    u.exports = n
});
(function(n) {
    "object" === typeof module && "object" === typeof module.exports ? n(require("jquery")) : "function" === typeof define && define.amd ? define([], n(window.jQuery)) : n(window.jQuery)
}
)(function(n) {
    if (!n)
        return console.warn("Unslider needs jQuery");
    n.Unslider = function(y, u) {
        var m = this;
        m._ = "unslider";
        m.defaults = {
            autoplay: !1,
            delay: 3E3,
            speed: 750,
            easing: "swing",
            keys: {
                prev: 37,
                next: 39
            },
            nav: !0,
            arrows: {
                prev: '\x3ca class\x3d"' + m._ + '-arrow prev"\x3ePrev\x3c/a\x3e',
                next: '\x3ca class\x3d"' + m._ + '-arrow next"\x3eNext\x3c/a\x3e'
            },
            animation: "horizontal",
            selectors: {
                container: "ul:first",
                slides: "li"
            },
            animateHeight: !1,
            activeClass: m._ + "-active",
            swipe: !0,
            swipeThreshold: .2
        };
        m.$context = y;
        m.options = {};
        m.$parent = null;
        m.$container = null;
        m.$slides = null;
        m.$nav = null;
        m.$arrows = [];
        m.total = 0;
        m.current = 0;
        m.prefix = m._ + "-";
        m.eventSuffix = "." + m.prefix + ~~(2E3 * Math.random());
        m.interval = [];
        m.init = function(h) {
            m.options = n.extend({}, m.defaults, h);
            m.$container = m.$context.find(m.options.selectors.container).addClass(m.prefix + "wrap");
            m.$slides = m.$container.children(m.options.selectors.slides);
            m.setup();
            n.each(["nav", "arrows", "keys", "infinite"], function(g, f) {
                m.options[f] && m["init" + n._ucfirst(f)]()
            });
            jQuery.event.special.swipe && m.options.swipe && m.initSwipe();
            m.options.autoplay && m.start();
            m.calculateSlides();
            m.$context.trigger(m._ + ".ready");
            return m.animate(m.options.index || m.current, "init")
        }
        ;
        m.setup = function() {
            m.$context.addClass(m.prefix + m.options.animation).wrap('\x3cdiv class\x3d"' + m._ + '" /\x3e');
            m.$parent = m.$context.parent("." + m._);
            "static" === m.$context.css("position") && m.$context.css("position", "relative");
            m.$context.css("overflow", "hidden")
        }
        ;
        m.calculateSlides = function() {
            m.$slides = m.$container.children(m.options.selectors.slides);
            m.total = m.$slides.length;
            if ("fade" !== m.options.animation) {
                var h = "width";
                "vertical" === m.options.animation && (h = "height");
                m.$container.css(h, 100 * m.total + "%").addClass(m.prefix + "carousel");
                m.$slides.css(h, 100 / m.total + "%")
            }
        }
        ;
        m.start = function() {
            m.interval.push(setTimeout(function() {
                m.next()
            }, m.options.delay));
            return m
        }
        ;
        m.stop = function() {
            for (var h; h = m.interval.pop(); )
                clearTimeout(h);
            return m
        }
        ;
        m.initNav = function() {
            var h = n('\x3cnav class\x3d"' + m.prefix + 'nav"\x3e\x3col /\x3e\x3c/nav\x3e');
            m.$slides.each(function(g) {
                var f = this.getAttribute("data-nav") || g + 1;
                n.isFunction(m.options.nav) && (f = m.options.nav.call(m.$slides.eq(g), g, f));
                h.children("ol").append('\x3cli data-slide\x3d"' + g + '"\x3e' + f + "\x3c/li\x3e")
            });
            m.$nav = h.insertAfter(m.$context);
            m.$nav.find("li").on("click" + m.eventSuffix, function() {
                var g = n(this).addClass(m.options.activeClass);
                g.siblings().removeClass(m.options.activeClass);
                m.animate(g.attr("data-slide"))
            })
        }
        ;
        m.initArrows = function() {
            !0 === m.options.arrows && (m.options.arrows = m.defaults.arrows);
            n.each(m.options.arrows, function(h, g) {
                m.$arrows.push(n(g).insertAfter(m.$context).on("click" + m.eventSuffix, m[h]))
            })
        }
        ;
        m.initKeys = function() {
            !0 === m.options.keys && (m.options.keys = m.defaults.keys);
            n(document).on("keyup" + m.eventSuffix, function(h) {
                n.each(m.options.keys, function(g, f) {
                    h.which === f && n.isFunction(m[g]) && m[g].call(m)
                })
            })
        }
        ;
        m.initSwipe = function() {
            var h = m.$slides.width();
            if ("fade" !== m.options.animation)
                m.$container.on({
                    movestart: function(g) {
                        if (g.distX > g.distY && g.distX < -g.distY || g.distX < g.distY && g.distX > -g.distY)
                            return !!g.preventDefault();
                        m.$container.css("position", "relative")
                    },
                    move: function(g) {
                        m.$container.css("left", -(100 * m.current) + 100 * g.distX / h + "%")
                    },
                    moveend: function(g) {
                        if (Math.abs(g.distX) / h > m.options.swipeThreshold)
                            m[0 > g.distX ? "next" : "prev"]();
                        else
                            m.$container.animate({
                                left: -(100 * m.current) + "%"
                            }, m.options.speed / 2)
                    }
                })
        }
        ;
        m.initInfinite = function() {
            var h = ["first", "last"];
            n.each(h, function(g, f) {
                m.$slides.push.apply(m.$slides, m.$slides.filter(':not(".' + m._ + '-clone")')[f]().clone().addClass(m._ + "-clone")["insert" + (0 === g ? "After" : "Before")](m.$slides[h[~~!g]]()))
            })
        }
        ;
        m.destroyArrows = function() {
            n.each(m.$arrows, function(h, g) {
                g.remove()
            })
        }
        ;
        m.destroySwipe = function() {
            m.$container.off("movestart move moveend")
        }
        ;
        m.destroyKeys = function() {
            n(document).off("keyup" + m.eventSuffix)
        }
        ;
        m.setIndex = function(h) {
            0 > h && (h = m.total - 1);
            m.current = Math.min(Math.max(0, h), m.total - 1);
            m.options.nav && m.$nav.find('[data-slide\x3d"' + m.current + '"]')._active(m.options.activeClass);
            m.$slides.eq(m.current)._active(m.options.activeClass);
            return m
        }
        ;
        m.animate = function(h, g) {
            "first" === h && (h = 0);
            "last" === h && (h = m.total);
            if (isNaN(h))
                return m;
            m.options.autoplay && m.stop().start();
            m.setIndex(h);
            m.$context.trigger(m._ + ".change", [h, m.$slides.eq(h)]);
            var f = "animate" + n._ucfirst(m.options.animation);
            if (n.isFunction(m[f]))
                m[f](m.current, g);
            return m
        }
        ;
        m.next = function() {
            var h = m.current + 1;
            h >= m.total && (h = m.options.noloop && !m.options.infinite ? m.total - 1 : 0);
            return m.animate(h, "next")
        }
        ;
        m.prev = function() {
            var h = m.current - 1;
            0 > h && (h = m.options.noloop && !m.options.infinite ? 0 : m.total - 1);
            return m.animate(h, "prev")
        }
        ;
        m.animateHorizontal = function(h) {
            var g = "left";
            "rtl" === m.$context.attr("dir") && (g = "right");
            m.options.infinite && m.$container.css("margin-" + g, "-100%");
            return m.slide(g, h)
        }
        ;
        m.animateVertical = function(h) {
            m.options.animateHeight = !0;
            m.options.infinite && m.$container.css("margin-top", -m.$slides.outerHeight());
            return m.slide("top", h)
        }
        ;
        m.slide = function(h, g) {
            m.animateHeight(g);
            if (m.options.infinite) {
                var f;
                g === m.total - 1 && (f = m.total - 3,
                g = -1);
                g === m.total - 2 && (f = 0,
                g = m.total - 2);
                "number" === typeof f && (m.setIndex(f),
                m.$context.on(m._ + ".moved", function() {
                    m.current === f && m.$container.css(h, -(100 * f) + "%").off(m._ + ".moved")
                }))
            }
            var d = {};
            d[h] = -(100 * g) + "%";
            return m._move(m.$container, d)
        }
        ;
        m.animateFade = function(h) {
            m.animateHeight(h);
            h = m.$slides.eq(h).addClass(m.options.activeClass);
            m._move(h.siblings().removeClass(m.options.activeClass), {
                opacity: 0
            });
            m._move(h, {
                opacity: 1
            }, !1)
        }
        ;
        m.animateHeight = function(h) {
            m.options.animateHeight && m._move(m.$context, {
                height: m.$slides.eq(h).outerHeight()
            }, !1)
        }
        ;
        m._move = function(h, g, f, d) {
            !1 !== f && (f = function() {
                m.$context.trigger(m._ + ".moved")
            }
            );
            return h._move(g, d || m.options.speed, m.options.easing, f)
        }
        ;
        return m.init(u)
    }
    ;
    n.fn._active = function(n) {
        return this.addClass(n).siblings().removeClass(n)
    }
    ;
    n._ucfirst = function(n) {
        return (n + "").toLowerCase().replace(/^./, function(n) {
            return n.toUpperCase()
        })
    }
    ;
    n.fn._move = function() {
        this.stop(!0, !0);
        return n.fn[n.fn.velocity ? "velocity" : "animate"].apply(this, arguments)
    }
    ;
    n.fn.unslider = function(y) {
        return this.each(function(u, m) {
            var h = n(m);
            if (!(n(m).data("unslider")instanceof n.Unslider)) {
                if ("string" === typeof y && h.data("unslider")) {
                    y = y.split(":");
                    var g = h.data("unslider")[y[0]];
                    if (n.isFunction(g))
                        return g.apply(h, y[1] ? y[1].split(",") : null)
                }
                return h.data("unslider", new n.Unslider(h,y))
            }
        })
    }
});
define("form/component/task", "form/relatecomponent form/tplutil form/component/entityselecter form/component/relevancecontrol form/componentmodel form/abposview".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/entityselecter")
      , f = n("form/component/relevancecontrol")
      , d = n("form/componentmodel")
      , b = n("form/abposview");
    window.Task = m.extend({
    });
    u.exports = window.Task
});
define("form/component/typeahead", "form/tplutil form/component/entityselecter form/component/contactlist form/component/formdatalist form/component/customerlist form/component/chancelist form/component/productionlist form/component/contractlist form/component/userselecter form/component/departselecter form/component/agendalist".split(" "), function(n, y, u) {
    y = n("form/tplutil");
    var m = n("form/component/entityselecter")
      , h = n("form/component/contactlist")
      , g = n("form/component/formdatalist")
      , f = n("form/component/customerlist")
      , d = n("form/component/chancelist")
      , b = n("form/component/productionlist")
      , c = n("form/component/contractlist")
      , l = n("form/component/userselecter")
      , e = n("form/component/departselecter")
      , a = n("form/component/agendalist")
      , k = {
        suggestion: "",
        remote: "",
        entity: "",
        tpl: y.get("typeahead"),
        el: ".j_default_container",
        isUnique: !1,
        changeValue: $.noop,
        formId: ""
    };
    n = Backbone.View.extend({
        initialize: function(a) {
            this.options = $.extend({}, k, a);
            this.el = this.options.el;
            this.sourceModule = a.sourceModule;
            this.dataTemplateId = a.dataTemplateId;
            $(this.el).html(this.options.tpl);
            this.source = this.options.source
        },
        delegateEvents: function() {
            var k = this
              , n = $(k.el)
              , q = k.options.isUnique;
            n.on("mouseenter.typeahead", ".typeahead-wrapper", function(a) {
                $(this).data("enter", !0)
            }).on("mouseleave.typeahead", ".typeahead-wrapper", function(a) {
                $(this).data("enter", !1)
            });
            n.on("click", ".control-btn", function(a) {
                a.stopPropagation();
                $(this).addClass("hide");
                $(this).prev(".typeahead-wrapper").removeClass("hide");
                $(this).prev(".typeahead-wrapper").find(".control-input").focus()
            });
            n.on("focusout", ".control-input", function(a, c) {
                var b = $(this).parents(".typeahead-wrapper");
                b.data("enter") && "tt" != c || (b.addClass("hide"),
                b.next(".control-btn").removeClass("hide"))
            });
            n.on("click", " #searchList\x3ep", function() {
                var a = $(this).data("obj")
                  , c = a.id
                  , b = a.name
                  , b = $('\x3cspan name\x3d"js_entity_item" class\x3d"js_entity_item employee-item j_component entity-item"\x3e\x3ca data-id\x3d"' + c + '" data-module\x3d"" id\x3d' + c + ' class\x3d"entitybox-toggle" title\x3d"' + b + '"\x3e' + b + "\x3c/a\x3e\x3c/span\x3e");
                b.data("obj", a);
                a = n.find(".js_entity_container");
                "true" == q || 1 == q ? (a.html(""),
                a.append(Item)) : (a.find(".js_entity_item").each(function(a) {
                    c == $(this).find(".entitybox-toggle").attr("id") && $(this).remove()
                }),
                a.append(b));
                k.options.changeValue()
            });
            n.on("click", ".js_deleteItem", function() {
                $(this).parent().remove();
                k.options.changeValue()
            });
            n.find("#entity-typeahead-div").off("mouseenter.tt", "p").on("mouseenter.tt", "p", function() {
                $(this).addClass("active");
                n.find("#entity-typeahead-div p.active").removeClass("active")
            });
            n.off("click.tt", "#entity-typeahead-div p").on("click.tt", "#entity-typeahead-div p", function(a) {
                p.trigger("focusout", "tt")
            });
            var p = n.find("#typeahead-entity");
            p.off("focus.tt").on("focus.tt", function(a) {
                k._search($(this))
            });
            p.off("click.tt").on("click.tt", function(a) {
                a.stopPropagation()
            });
            p.off("keyup.tt").on("keyup.tt", function(a) {
                a = a.which;
                13 == a ? n.find("#entity-typeahead-div p.active").trigger("click.tt") : 27 == a ? k.hide() : 38 == a ? (a = $("#entity-typeahead-div p.active"),
                1 > a.length ? n.find("#entity-typeahead-div p").last().addClass("active") : (a.removeClass("active"),
                (0 < a.prev().length ? a.prev() : n.find("#entity-typeahead-div p").last()).addClass("active"))) : 40 == a ? (a = n.find("#entity-typeahead-div p.active"),
                1 > a.length ? n.find("#entity-typeahead-div p").first().addClass("active") : (a.removeClass("active"),
                (0 < a.next().length ? a.next() : n.find("#entity-typeahead-div p").first()).addClass("active"))) : k._search($(this))
            });
            n.off("entitySelected", "#search-entity").on("entitySelected", "#search-entity", function(a) {
                n.find(".js_entity_container").empty();
                for (var c = k.options.entity, b = 1; b < arguments.length; b++) {
                    var e = arguments[b];
                    if (e) {
                        var d = e.id;
                        "contact" == c && (e.name = e.username);
                        var f = e.name
                          , g = $('\x3cspan name\x3d"js_entity_item" class\x3d"js_entity_item employee-item j_component entity-item"\x3e\x3ca data-id\x3d"' + d + '" data-module\x3d"" id\x3d' + d + ' class\x3d"entitybox-toggle" title\x3d"' + f + '"\x3e' + f + '\x3c/a\x3e\x3ca class\x3d"close js_deleteItem" title\x3d"\u5220\u9664"\x3e\x26times;\x3c/a\x3e\x3c/span\x3e');
                        k.source && (g = $('\x3cspan name\x3d"js_entity_item" class\x3d"js_entity_item employee-item j_component entity-item"\x3e\x3ca data-id\x3d"' + d + '" data-module\x3d"" id\x3d' + d + ' class\x3d"entitybox-toggle" title\x3d"' + f + '"\x3e' + f + "\x3c/a\x3e\x3c/span\x3e"));
                        g.data("obj", e);
                        n.find(".js_entity_container").append(g)
                    }
                }
                k.options.changeValue()
            });
            n.on("confirmHandler", "#search-entity", function(a, c) {
                if ("employee" == k.options.entity) {
                    if (0 < c.objs.length) {
                        n.find(".js_entity_container").empty();
                        var b = c.objs, e;
                        for (e in b) {
                            var d = b[e]
                              , f = $('\x3cspan name\x3d"js_entity_item" class\x3d"js_entity_item employee-item j_component entity-item"\x3e\x3ca data-id\x3d"' + d.id + '" data-module\x3d"" id\x3d' + d.id + ' class\x3d"entitybox-toggle" title\x3d"' + d.username + '"\x3e' + d.username + '\x3c/a\x3e\x3ca class\x3d"close js_deleteItem" title\x3d"\u5220\u9664"\x3e\x26times;\x3c/a\x3e\x3c/span\x3e');
                            k.source && (f = $('\x3cspan name\x3d"js_entity_item" class\x3d"js_entity_item employee-item j_component entity-item"\x3e\x3ca data-id\x3d"' + d.id + '" data-module\x3d"" id\x3d' + d.id + ' class\x3d"entitybox-toggle" title\x3d"' + d.username + '"\x3e' + d.username + "\x3c/a\x3e\x3c/span\x3e"));
                            f.data("obj", d);
                            n.find(".js_entity_container").append(f)
                        }
                    }
                } else
                    b = c.objs,
                    f = $('\x3cspan name\x3d"js_entity_item" class\x3d"js_entity_item employee-item j_component entity-item"\x3e\x3ca data-id\x3d"' + b.id + '" data-module\x3d"" id\x3d' + b.id + ' class\x3d"entitybox-toggle" title\x3d"' + b.name + '"\x3e' + b.name + '\x3c/a\x3e\x3ca class\x3d"close js_deleteItem" title\x3d"\u5220\u9664"\x3e\x26times;\x3c/a\x3e\x3c/span\x3e'),
                    k.source && (f = $('\x3cspan name\x3d"js_entity_item" class\x3d"js_entity_item employee-item j_component entity-item"\x3e\x3ca data-id\x3d"' + b.id + '" data-module\x3d"" id\x3d' + b.id + ' class\x3d"entitybox-toggle" title\x3d"' + b.name + '"\x3e' + b.name + "\x3c/a\x3e\x3c/span\x3e")),
                    0 < n.find(".js_entity_container").find("#" + b.id).length || (f.data("obj", b),
                    n.find(".js_entity_container").append(f))
            });
            n.on("click", "#search-entity", function(p) {
                window.abposview && window.abposview.remove();
                p.stopPropagation();
                n.find(".control-input").trigger("focusout", "tt");
                var v = [];
                p = n.find(".js_entity_container .js_entity_item");
                var s = k.options.entity;
                p && 0 < p.length && p.each(function(a) {
                    a = $(this).data("obj");
                    var c = a.id
                      , b = a.name
                      , e = ""
                      , e = "employee" == s ? {
                        username: b,
                        id: c
                    } : {
                        name: b,
                        id: c
                    };
                    "form" == s && (e.dataRow = a);
                    "customer" == s && (e.customer = a);
                    "contact" == s && (e.contact = a);
                    "chance" == s && (e.chance = a);
                    "production" == s && (e.production = a);
                    "contract" == s && (e.contract = a);
                    "employee" == s && (e.employee = a);
                    "department" == s && (e.department = a);
                    "datasource" == s && (e.datasource = a);
                    "agenda" == s && (e.agenda = a);
                    v.push(e)
                });
                p = $(this);
                switch (s) {
                case "form":
                    (new g).render("pc", {
                        targetEl: p,
                        keyword: "",
                        module: "form",
                        type: "",
                        isUnique: q,
                        seletedList: v,
                        formId: k.options.formId,
                        fieldIds: ["nofields"],
                        columnFields: [],
                        allData: !0
                    });
                    break;
                case "customer":
                    (new f).render("pc", {
                        targetEl: p,
                        keyword: "",
                        isUnique: q,
                        seletedList: v,
                        selectColumn: []
                    });
                    break;
                case "contact":
                    (new h).render("pc", {
                        targetEl: p,
                        isUnique: q,
                        seletedList: v,
                        linkedIds: [],
                        selectColumn: []
                    });
                    break;
                case "chance":
                    (new d).render("pc", {
                        targetEl: p,
                        keyword: "",
                        isUnique: q,
                        seletedList: v,
                        selectColumn: []
                    });
                    break;
                case "production":
                    (new b).render("pc", {
                        targetEl: p,
                        keyword: "",
                        isUnique: q,
                        seletedList: v,
                        selectColumn: []
                    });
                    break;
                case "contract":
                    (new c).render("pc", {
                        targetEl: p,
                        keyword: "",
                        isUnique: q,
                        seletedList: v,
                        selectColumn: []
                    });
                    break;
                case "agenda":
                    (new a).render("pc", {
                        targetEl: p,
                        keyword: "",
                        isUnique: q,
                        seletedList: v,
                        selectColumn: []
                    });
                    break;
                case "task":
                    var u = new m;
                    u.render("pc", {
                        targetEl: p,
                        keyword: "",
                        module: "task",
                        type: p.attr("data-type"),
                        isUnique: !1,
                        seletedList: v
                    });
                    break;
                case "mainline":
                    u = new m;
                    u.render("pc", {
                        targetEl: p,
                        keyword: "",
                        module: "mainline",
                        type: p.attr("data-type"),
                        isUnique: !1,
                        seletedList: v
                    });
                    break;
                case "workflow":
                    u = new m;
                    u.render("pc", {
                        targetEl: p,
                        keyword: "",
                        module: "workflow",
                        type: p.attr("data-type"),
                        isUnique: !1,
                        seletedList: v
                    });
                    break;
                case "document":
                    u = new m;
                    u.render("pc", {
                        targetEl: p,
                        keyword: "",
                        module: "document",
                        type: p.attr("data-type"),
                        isUnique: !1,
                        seletedList: v
                    });
                    break;
                case "datasource":
                    u = new m;
                    u.render("pc", {
                        targetEl: p,
                        keyword: "",
                        module: "datasource",
                        sourceModule: k.sourceModule,
                        dataTemplateId: k.dataTemplateId,
                        isUnique: !1,
                        seletedList: v
                    });
                    break;
                case "employee":
                    (new l).render("pc", {
                        isMulti: !0,
                        users: v,
                        target: p
                    });
                    break;
                case "department":
                    (new e).render("pc", {
                        target: p
                    })
                }
            })
        },
        render: function() {},
        _search: function(a) {
            var c = this
              , b = $(c.el)
              , e = $.trim(a.val())
              , d = this.options.entity;
            e == a.attr("placeholder") && (e = "");
            b.find("#entity-typeahead-div #searchList").html("");
            b.find("#entity-typeahead-div .loading_small").show();
            c.list && c.suggestion === e ? c._loadList(c.list) : (a = c.options.remote,
            e = c.getParam(1, e),
            $.ajax({
                contentType: "form" == d ? "application/json" : "application/x-www-form-urlencoded; charset\x3dUTF-8",
                type: TEAMS.ajaxMethod,
                url: a,
                dataType: "json",
                data: e,
                success: function(a) {
                    var b = [];
                    "form" == d && (b = a.formDatas);
                    "forms" == d && (b = a.formPage.result);
                    if ("customer" == d || "chance" == d)
                        b = a.relevances;
                    if ("contact" == d || "production" == d || "contract" == d)
                        b = a.data;
                    "employee" == d && (b = a.employees);
                    "department" == d && (b = a.departments);
                    "mainline" == d && (b = a.mainlines);
                    if ("task" == d || "workflow" == d || "document" == d)
                        b = a.relevances;
                    "datasource" == d && (b = a.optionPage.result);
                    "agenda" == d && (b = a.page.result);
                    c.list = b;
                    c._loadList(b)
                }
            }))
        },
        getParam: function(a, c) {
            var b = this.options.entity
              , e = {};
            e.pageNo = a;
            e.pageSize = 10;
            switch (b) {
            case "form":
                e.formId = this.options.formId;
                var b = []
                  , d = {};
                d.content = c;
                d.term = "like";
                b.push(d);
                e.names = b;
                e.fromComponent = !0;
                e = JSON.stringify(e);
                break;
            case "customer":
                e = {};
                e.keywords = c;
                e.searchType = "relevance";
                break;
            case "chance":
                e = {};
                e.keywords = c;
                e.searchType = "relevance";
                break;
            case "contact":
                e = {};
                b = {
                    pageNo: 1,
                    pageSize: 10,
                    orderWay: "desc",
                    conditions: [{
                        id: "CON.USERNAME",
                        type: "string",
                        operate: "like",
                        value: c
                    }]
                };
                e.queryStr = JSON.stringify(b);
                e.userId = TEAMS.currentUser.id;
                break;
            case "production":
                e = {};
                b = {
                    darw: 1,
                    pageNo: 1,
                    pageSize: 10,
                    orderWay: "desc",
                    orderBy: "updateTime",
                    conditions: [{
                        id: "name",
                        type: "string",
                        value: c
                    }],
                    filter: {
                        type: "all"
                    },
                    customConditions: []
                };
                e.queryStr = JSON.stringify(b);
                e.employeeId = TEAMS.currentUser.id;
                break;
            case "contract":
                e = {};
                b = {
                    darw: 1,
                    pageNo: 1,
                    pageSize: 10,
                    orderWay: "desc",
                    orderBy: "updateTime",
                    conditions: [{
                        id: "name",
                        type: "string",
                        value: c
                    }],
                    filter: {
                        type: "all"
                    },
                    customConditions: []
                };
                e.queryStr = JSON.stringify(b);
                e.employeeId = TEAMS.currentUser.id;
                break;
            case "employee":
                e = {};
                e.keywords = c;
                e.searchType = "employee";
                break;
            case "department":
                e = {};
                e.keywords = c;
                e.searchType = "department";
                break;
            case "mainline":
                e = {};
                e.keywords = c;
                e.searchType = "mainline";
                break;
            case "task":
                e = {};
                e.keywords = c;
                e.searchType = "task";
                break;
            case "workflow":
                e = {};
                e.keywords = c;
                e.searchType = "workflow";
                break;
            case "document":
                e = {};
                e.keywords = c;
                e.searchType = "document";
                break;
            case "datasource":
                e = {};
                e.keyword = c;
                e.sourceModule = this.sourceModule;
                e.templateId = this.dataTemplateId;
                break;
            case "agenda":
                e = {
                    pageSize: "10",
                    pageNo: "1"
                },
                e.keywords = c
            }
            return e
        },
        _loadList: function(a) {
            var c = $(this.el);
            c.find("#entity-typeahead-div .loading_small").hide();
            var b = this.options.entity;
            if (a && 0 < a.length)
                for (var e = 0, d = a.length; e < d; e++) {
                    var f = a[e];
                    if ("contact" == b || "employee" == b)
                        f.name = f.username;
                    f.name = f.name.replace(/</g, "\x26lt").replace(/>/g, "\x26gt").replace("/[\r\n]/g", " ");
                    var g = $("\x3cp\x3e\x3c/p\x3e");
                    g.text(f.name);
                    g.attr("title", f.name);
                    g.data("obj", f);
                    c.find("#entity-typeahead-div #searchList").append(g)
                }
            c.find("#entity-typeahead-div #searchList").show()
        },
        remove: function() {
            $(this.el).html("")
        }
    });
    u.exports = n
});
define("form/component/workflow", "form/relatecomponent form/tplutil form/component/entityselecter form/component/relevancecontrol form/componentmodel form/abposview".split(" "), function(n, y, u) {
    var m = n("form/relatecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/entityselecter")
      , f = n("form/component/relevancecontrol")
      , d = n("form/componentmodel")
      , b = n("form/abposview");
    window.Workflow = m.extend({
    });
    u.exports = window.Workflow
});
define("form/component/imagecheckbox", ["form/editablecomponent", "form/tplutil", "form/component/option", "form/component/imagecut", "form/component/imageviewer"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil")
      , g = n("form/component/option")
      , f = n("form/component/imagecut")
      , d = n("form/component/imageviewer");
    window.ImageCheckBox = CheckBox.extend({
        initialize: function(b) {
            m.prototype.initialize.call(this, b);
            var c = {
                componentKey: "ImageCheckBox",
                title: "\u56fe\u7247\u591a\u9009\u6846",
                formId: "",
                layout: "choicelist-inline",
                options: []
            };
            null != b && (c.title = b.title,
            c.layout = b.layout,
            c.formId = b.formId,
            c.options = b.options);
            this.componentSetup = $.extend(this.componentSetup, c);
            this.tpl = h.get("imagecheckbox", {
                isMobileForm: this.isMobileForm
            })
        },
        setLayout: function(b) {
            this.componentSetup.layout = b
        },
        setOptions: function(b) {
            this.componentSetup.options = b
        },
        renderEditor: function() {
            var b = $(this.tpl).siblings("#editor-checkbox");
            m.prototype.renderEditor.call(this, b);
            b.find("input:radio[name\x3d'componentType'][value\x3d'" + this.componentSetup.componentKey + "']").attr("checked", "true");
            b.find("input:radio[name\x3d'layout'][value\x3d'" + this.componentSetup.layout + "']").attr("checked", "true");
            for (var c = b.find("ul.choicelistEdit_js"), d = 0; d < this.componentSetup.options.length; d++) {
                var e = this.componentSetup.options[d];
                (new g(e)).renderEditor(c, this);
                "true" != e.other && 1 != e.other || b.find(".btn-default_js").parent().hide()
            }
            $("#editor-component").html(b.html());
            b = $("#j_item_container .form-img-uploaddata");
            this.initUploader("#j_item_container .j_img_add", "#j_item_container .choicelistEdit_js", b)
        },
        getValue: function(b, c) {
            var d = {
                formField: {
                    id: this.componentSetup.fieldId
                }
            }
              , e = 0
              , a = [];
            "true" != this.componentSetup.isReadOnly && 1 != this.componentSetup.isReadOnly || b.find("li .j_ico").hide();
            b.find("li").each(function(c) {
                var d = $(this).find("input:checkbox");
                c = d.val();
                if (d.is(":checked")) {
                    var f = ""
                      , d = d.data("componentData")
                      , f = "true" == d.componentSetup.other || 1 == d.componentSetup.other ? b.find("input:text").val() : d.componentSetup.name;
                    a[e] = {
                        optionId: c,
                        content: f,
                        targetId: d.componentSetup.objId
                    };
                    e++
                }
            });
            d.dataOptions = a;
            return 0 != e || c ? d : null
        },
        setValue: function(b, c) {
            var d = $(this.tpl).siblings("#readonly-checkbox").find("li");
            b.find("input:checkbox").each(function() {
                this.checked = !1
            });
            b.find(".j_ico").removeClass("checked");
            b.find(".j_readOnly ul").html("");
            if (null != c && null != c.dataOptions)
                for (var e = "", a = 0; a < c.dataOptions.length; a++) {
                    var f = c.dataOptions[a]
                      , g = f.optionId
                      , h = f.targetId
                      , m = null
                      , m = c.isMacthByName ? b.find("span").filter(function() {
                        return $(this).text() == f.content
                    }).closest("li").find("input") : b.find("input:checkbox[name\x3d'" + this.componentSetup.fieldId + this.cid + "'][value\x3d'" + g + "']");
                    if (g = m.get(0))
                        g.checked = !0,
                        m.parents("li").find(".j_ico").addClass("checked"),
                        g = "",
                        g = m.data("componentData").componentSetup.other,
                        "true" == g || 1 == g ? (g = f.content,
                        b.find("input:text").val(g).show(),
                        e += f.content + ",") : (g = m.next().text(),
                        e += m.next().text() + ","),
                        m = d.clone(),
                        m.find("span").text(g).attr("title", g),
                        window.systemInfo_print ? (b.find(".j_readOnly ul").addClass("j_imageoption_list"),
                        m.addClass("j_imgSizeChange"),
                        m.find("img").attr({
                            src: TEAMS.api.downImgUrl+"/" + h,
                            id: h,
                            count: "1"
                        })) : m.find("img").attr("src", TEAMS.api.downImgUrl+"/" + h),
                        m.find("a").attr("imghref", TEAMS.api.downImgUrl+"/" + h).attr("title", g),
                        b.find(".j_readOnly ul").addClass("j_imagecheckbox_list").append(m)
                }
        },
        empty: function(b) {
            b.find("input:checkbox").each(function() {
                this.checked = !1
            });
            b.find(".j_ico").removeClass("checked");
            b.find(".j_readOnly ul").html("")
        },
        initUploader: function(b, c, d) {
            var e = this;
            b = b || "#imageAdd" + this.componentSetup.fieldId + this.cid + " .j_imageAdd";
            c = c || "#" + this.componentSetup.fieldId + this.cid;
            d = d || $(c).parents("#field_" + this.componentSetup.fieldId);
            b = this.uploader = new plupload.Uploader({
                runtimes: "html5,flash",
                file_data_name: "data",
                browse_button: b,
                drop_element: b,
                container: d,
                max_file_size: "50M",
                url: TEAMS.api.uploadImage+"?module\x3dform\x26refId\x3d" + e.componentSetup.formId,
                flash_swf_url: "/static/swf/plupload.swf"
            });
            b.init();
            b.bind("FilesAdded", function(a, c) {
                console.log(a)

                $.each(c, function(a, c) {
                    plupload.formatSize(c.size)
                });
                a.refresh();
                a.start()
            });
            b.bind("UploadProgress", function(a, c) {
                $("#" + c.id + " i").html(c.percent + "%")
            });
            b.bind("Error", function(a, c) {
                console.log(a)

                -600 == c.code && formPlugin.notify("\u53ea\u80fd\u4e0a\u4f20\u6700\u5927\u4e0d\u8d85\u8fc750M\u7684\u6587\u4ef6", "\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7\u9650\u5236", "error");
                a.refresh()
            });
            b.bind("FileUploaded", function(a, b, d) {
                a = jQuery.parseJSON(d.response);
                d = a.fileObj;
                b = d.name.slice(0, d.name.lastIndexOf("."));
                d = d.image;
                "true" == d || 1 == d ? (d = new g,
                d.setObjId(a.imageFile.id),
                d.setName(b),
                d.renderEditor($(c), e),
                e.componentSetup.options.push(d.componentSetup),
                a = $("#widget-control .field-active .choicelist_js"),
                d.render(a, e),
                formPlugin.notify("\u56fe\u7247\u4e0a\u4f20\u6210\u529f")) : formPlugin.notify("\u8bf7\u4e0a\u4f20\u56fe\u7247\u6587\u4ef6", "\u6587\u4ef6\u683c\u5f0f\u4e0d\u6b63\u786e", "error")
            })
        },
        cutImage: function(b,t) {
            (new f({
                formId: this.componentSetup.formId,
                imageId: b,
                callback: function(e) {
                    $("img[imageId\x3d'" + b + "']").each(function() {
                        t.attr("imageid", e.imageArea.id);
                        $(this).attr("imageid", e.imageArea.id);
                        var c = TEAMS.api.downImgUrl+"/"+e.imageArea.id 
                        $(this).attr("src", c);
                        $(this).parent('.gallery-pic').attr("imghref", c + "?module\x3dform");
                    })
                }
            })).render()
        },
        layoutCheck: function(a) {
            var d = this,
                l = a.find('.imageslist-inline'),
                o = this.componentSetup.options;
            l.each(function(index) {
                $(this).children('.ImageCheckBox_js').each(function(i, el) {
                    var imgId = $(this).find('img').attr('imageid');
                    for (var d = !1, b = o, c = [], f = 0; f < b.length; f++) {
                        if(f == i) {
                            var e = b[f];
                            e.objId = imgId
                        }
                        
                    }
                }); 
            });
        },
        checkEvents: function(b) {
            var c = this
              , f = c.el || $(document);
            CheckBox.prototype.checkEvents.call(this, b);
            "mobile" == window.systemInfo_form && (b = c.componentSetup.fieldId || c.componentSetup.tempId,
            f.on("click", "#field_" + b + " .ImageCheckBox_mobile_js .j_ico", function() {
                var c = $(this).parents(".ImageCheckBox_mobile_js").find("input:checkbox");
                c.is(":checked") ? (c.prop("checked", !1),
                $(this).removeClass("checked")) : (c.prop("checked", !0),
                $(this).addClass("checked"))
            }),
            f.on("click", "#field_" + b + " .j_image_container", function() {
                var c = $(this).attr("imghref")
                  , a = $(this).find("img").attr("imageid");
                (new d({
                    preEl: $(this).parents(".j_page-view"),
                    imageId: a,
                    imageUrl: c
                })).render()
            }),
            $(window).on("resize.imagecheckbox", function() {
                c.calcImgHeight()
            }),
            $(window).trigger("resize.imagecheckbox"))
        },
        calcImgHeight: function() {
            var b = ($(window).width() - 20) / 4;
            this.el.find(".j_image_container").height(b - 10)
        }
    });
    u.exports = window.ImageCheckBox
});
define("form/component/phone", ["form/editablecomponent", "form/tplutil"], function(n, y, u) {
    var m = n("form/editablecomponent")
      , h = n("form/tplutil");
    window.Phone = m.extend({
        initialize: function(g) {
            m.prototype.initialize.call(this, g);
            var f = {
                componentKey: "Phone",
                title: "\u7535\u8bdd"
            };
            null != g && (f.title = g.title);
            this.componentSetup = $.extend(this.componentSetup, f);
            this.tpl = h.get("phone", {
                isMobileForm: this.isMobileForm
            })
        },
        render: function(g) {
            var f = $(this.tpl).siblings("#form-phone");
            m.prototype.render.call(this, g, f);
            g.html(f.html())
        },
        renderEditPreview: function(g) {
            var f = $(this.tpl).siblings("#form-phone");
            m.prototype.renderEditPreview.call(this, g, f);
            g.append(f)
        },
        renderEditor: function() {
            var g = $(this.tpl).siblings("#editor-phone");
            m.prototype.renderEditor.call(this, g);
            $("#editor-component").html(g.html())
        },
        renderPreview: function(g, f, d) {
            var b = $(this.tpl).siblings("#preview-phone");
            f && b.find(".check_js").val("");
            m.prototype.renderPreview.call(this, g, f, d, b);
            b.find(".form-control").attr("placeholder", null == this.componentSetup.placeholder || 1 > this.componentSetup.placeholder.length ? "\u8bf7\u586b\u5199" + this.componentSetup.title : this.componentSetup.placeholder);
            g.append(b)
        },
        renderStatSearch: function(g) {
            var f = $(this.tpl)
              , d = null
              , b = g.value
              , c = g.term
              , h = g.parentEl;
            if ("mobile" != window.systemInfo_form)
                d = f.siblings("#statsearch-phone"),
                b && d.find("input").val(b),
                c && d.find("select:first option[value\x3d" + c + "]").attr("selected", "true"),
                h.attr("class", "sch-group j_formFieldSearchGroup"),
                h.find(".j_formField-condition").html(d);
            else {
                var b = g.fieldId
                  , c = g.fieldTitle
                  , e = g.subFormId
                  , d = f.siblings("#statsearch-phone-mobile")
                  , f = g.filterEl;
                g = g.condition;
                f && (f = f.find(".j_filterList .selectd #comp-val span").text(),
                d.find(".j_compVal").val(f));
                g && (d.find(".j_condition").find('option[value\x3d"' + g + '"]').attr("selected", !0),
                "null" != g && "notnull" != g || d.find(".j_control").hide());
                d.find(".j_inputName").text(c + ":");
                h.find("#component-div").html(d);
                h.find(".j_comp-ok").attr("comKey", "Phone").attr("fieldId", b).attr("title", c).attr("subFormId", e);
                h.off("change", "#statsearch-phone-mobile .j_condition").on("change", "#statsearch-phone-mobile .j_condition", function() {
                    var a = $(this).val();
                    "null" == a || "notnull" == a ? h.find("#statsearch-phone-mobile .j_control").hide() : h.find("#statsearch-phone-mobile .j_control").show()
                })
            }
        },
        checkEvents: function(g) {
            var f = this;
            (f.el || $(document)).on("blur", "input[id\x3d'" + (f.componentSetup.fieldId || f.componentSetup.tempId) + "'][cid\x3d'" + f.cid + "']", function() {
                var d = f.check($(this));
                g(d)
            })
        },
        autoSaveEvents: function(g) {
            var f = this;
            (f.el || $(document)).on("change", "input[id\x3d'" + f.componentSetup.fieldId + "'][cid\x3d'" + f.cid + "']", function() {
                f.saveComponentValue($(this), g)
            })
        },
        check: function(g) {
            var f = $.trim(g.val())
              , d = g.attr("placeholder")
              , b = {};
            b.element = g;
            f == d && (f = "");
            "" != f || "true" != this.componentSetup.required && 1 != this.componentSetup.required || (b.message = this.componentSetup.title + "\u4e0d\u80fd\u4e3a\u7a7a");
            "" == f || this.tel(f) || (b.message = this.componentSetup.title + "\u683c\u5f0f\u6709\u8bef\uff0c\u8bf7\u8f93\u5165\u6709\u6548\u7684\u7535\u8bdd\u53f7\u7801");
            return b
        },
        tel: function(g) {
            return /(^(\d{7,8})$)|(^\((\d{3,4})\)(\d{7,8})$)|(^(\d{3,4})-(\d{7,8})$)|(^(\d{3,4})(\d{7,8})$)|(^(\d{3,4})(\d{7,8})-(\d{1,4})$)|(^(\d{3,4})-(\d{7,8})-(\d{1,4})$)|(^\((\d{3,4})\)(\d{7,8})-(\d{1,4})$)|(^(\d{7,8})-(\d{1,4})$)|(^0{0,1}1[3|4|5|6|7|8|9][0-9]{9}$)/.exec(g) ? !0 : !1
        },
        getValue: function(g, f) {
            var d = $.trim(g.val())
              , b = g.attr("placeholder")
              , c = {
                formField: {
                    id: this.componentSetup.fieldId
                },
                content: d
            };
            return "" != d && d != b && this.tel(d) || f ? c : null
        },
        setValue: function(g, f) {
            if (null != f) {
                var d = f.content;
                g.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val(d);
                g.find(".j_readOnly").html(d)
            }
        },
        empty: function(g) {
            g.find("#" + (this.componentSetup.fieldId || this.componentSetup.tempId)).val("");
            g.find(".j_readOnly").html("")
        },
        readOnly: function(g, f) {
            var d = g.find("input[id\x3d'" + this.componentSetup.fieldId + "'][cid\x3d'" + this.cid + "']")
              , d = this.isMobileForm ? d.parent() : d;
            f ? (d.addClass("hide"),
            d.siblings(".j_readOnly").removeClass("hide")) : (d.removeClass("hide"),
            d.siblings(".j_readOnly").addClass("hide"))
        }
    });
    u.exports = window.Phone
});
define("form/signscancodepage", ["form/signscancodeview"], function(n) {
    (new (n("form/signscancodeview"))({
        tenantKey: tenantKey,
        imUID: imUID,
        imCID: imCID,
        imURL: imURL,
        token: token,
        preview: preview
    })).render()
});
define("form/signscancodeview", function(n, y, u) {
    y = Backbone.View.extend({
    });
    u.exports = y
});
define("form/m.emojiarea", function(n, y, u) {
    return function(m) {
       
    }
});
define("form/editDataSourcesmodel", function(n, y, u) {
    n = Backbone.Model.extend({
    });
    u.exports = n
});
define("form/abposview", function(n, y, u) {
    n = Backbone.View.extend({
        initialize: function(m) {
            this.el = "#form-abposselect";
            this.$continer = m.continer;
            this.entity = m.entity
        },
        delegateEvents: function() {
            var m = this;
            $("#form-abposselect").on("click", function() {
                $("#form-abposselect").remove();
                0 < $("body").find(".form-preview").find(".field-item_js").length && $("body").find(".form-preview").find(".field-item_js").removeClass("field-item_js");
                m.remove()
            })
        },
        render: function() {
            0 < $("body").find("#form-abposselect").length && ($("#form-abposselect").remove(),
            0 < $("body").find(".form-preview").find(".field-item_js").length && $("body").find(".form-preview").find(".field-item_js").removeClass("field-item_js"));
            null != this.$continer && 0 < this.$continer.length && this.loading()
        },
        loading: function() {
            var m = this;
            $continer = m.$continer;
            var h;
            if (0 < $continer.parents("td").length) {
                $continer.find(".tt-suggestion #searchList").hide();
                h = $continer.parents("td").clone(!0, !0);
                var g = $continer.find(".typeahead-wrapper")[0].getBoundingClientRect();
                $continer.closest(".field_js").addClass("field-item_js");
                var f = g.top + g.height
                  , d = g.left
                  , g = g.width;
                h.find(".widget-title").hide();
                h.find(".tt-suggestion #searchList").show();
                h.find(".form-error").hide();
                $($(h).find(".widget-content").find("div")[1]).hide();
                "none" == $(h).find(".widget-content").find(".check_js").css("display") && ($(h).find(".widget-content").find(".check_js").css("display", "block"),
                $($(h).find(".widget-content").find(".check_js").children("div")[0]).hide());
                $(h).find(".widget-content").find("input").css({
                    width: "0px",
                    height: "20px"
                });
                $(h).find(".widget-content").find(".engine-search").hide();
                $(h).find(".widget-content").find(".tt-suggestion #searchList").show();
                $(h).find(".checkbox").each(function() {
                    $(this).remove();
                    0 < $(h).find("label").length && $(h).find("label").remove();
                    $(h).find(".js_" + m.entity + "item_container").hasClass("hide") || $(h).find(".js_" + m.entity + "item_container").addClass("hide")
                });
                $("body").append('\x3cdiv id\x3d"form-abposselect" class\x3d"form-dropselector-view" style\x3d"left:' + d + "px; top:" + f + "px; width:" + g + 'px; "\x3e\x3c/div\x3e');
                $(m.el).append(h)
            }
        },
        remove: function() {
            $("body").find("#form-abposselect").remove();
            0 < $("body").find(".form-preview").find(".field-item_js").length && $("body").find(".form-preview").find(".field-item_js").removeClass("field-item_js");
            window.abposview && (window.abposview = null)
        }
    });
    u.exports = n
});
define("form/component", function(n, y, u) {
    n = Backbone.View.extend({
        el: "#form",
        componentSetup: {},
        initialize: function(m) {
            this.name = m.name;
            this.componentmodel = null
        },
        render: function(m) {
            console.error("you need to rewrite the method : render")
        },
        renderEditor: function() {
            console.error("you need to rewrite the method : renderSetUp")
        },
        renderPreview: function(m, h, g) {
            console.error("you need to rewrite the method : renderPreview")
        },
        renderEditPreview: function(m) {
            console.error("you need to rewrite the method : renderEditPreview")
        },
        submitCheck: function(m, h) {
            console.error("you need to rewrite the method : submitCheck")
        },
        checkEvents: function(m) {
            console.error("you need to rewrite the method : checkEvents")
        },
        layoutCheck: function() {},
        autoSaveEvents: function() {},
        conditionEvent: function() {},
        readOnly: function(m, h) {
            console.error("you need to rewrite the method : readOnly")
        },
        stringify: function(m) {
            return JSON.stringify(m)
        },
        toStringify: function() {
            return null != this.componentSetup ? this.stringify(this.componentSetup) : null
        },
        toComponent: function(m) {
            if (null == JSON.parse(m).componentKey)
                return null
        },
        saveComponentValue: function(m, h) {
            var g = m.closest(".field_js");
            if (0 < $("body").find("#form-abposselect").length && 0 < $("body").find(".form-preview").find(".field-item_js").length) {
                var f = $("body").find(".form-preview").find(".field-item_js");
                f.attr("id") == g.attr("id") && f.attr("componentkey") == g.attr("componentkey") && (f.removeClass("field-item_js"),
                g = f)
            }
            0 < g.length && (h.parentEl = g,
            formPlugin.saveFieldData(h))
        },
        setComponentModel: function(m) {
            this.componentmodel = m
        }
    });
    u.exports = n
});


define("form/editablecomponent", ["form/component", "form/tplutil", "form/componentmodel"], function(n, y, u) {
    y = n("form/component");
    var m = n("form/tplutil")
      , h = n("form/componentmodel")
      , g = ["SerialNumber", "Monitor"]
      , f = "RadioBox CheckBox Select ComboSelect ImageCheckBox ImageRadioBox Mainline Task Document Workflow FormComponent CustomerComponent ContactComponent ChanceComponent ProductionComponent ContractComponent AgendaComponent".split(" ")
      , d = "Text TextArea NumberComponent Money Email Phone Mobile".split(" ")
      , b = "Mainline Task Document Workflow CustomerComponent ProductionComponent ContractComponent AgendaComponent".split(" ");
    n = y.extend({
        initialize: function(c) {
            this.componentSetup = {
                fieldId: "",
                titleLayout: "field-hoz",
                order: 0,
                index: 0,
                describe: "",
                required: !1,
                size: "medium",
                isReadOnly: !1,
                isDefault: !1,
                content: "",
                isHideTitle: !1,
                tempId: "",
                condition: null,
                relateField: null,
                placeholder: "",
                tableId: "",
                colId: "",
                isOrgtiqu: !1,
                isOrgtiqulist: !1,
                isAddForRelation: !0,
                isBorderLayout:1
            };
            this.isMobileForm = "mobile" == window.systemInfo_form;
            null != c && (this.componentSetup.titleLayout = c.titleLayout,
            this.componentSetup.describe = c.describe,
            this.componentSetup.order = c.order,
            this.componentSetup.index = c.index,
            this.componentSetup.required = c.required,
            this.componentSetup.size = c.size,
            this.componentSetup.fieldId = c.fieldId,
            this.componentSetup.isReadOnly = c.isReadOnly,
            this.componentSetup.isDefault = c.isDefault,
            this.componentSetup.content = c.content,
            this.componentSetup.isHideTitle = c.isHideTitle,
            this.componentSetup.condition = c.condition,
            this.componentSetup.relateField = c.relateField,
            this.componentSetup.tempId = c.tempId ? c.tempId : c.fieldId,
            this.componentSetup.placeholder = c.placeholder,
            this.componentSetup.tableId = c.tableId,
            this.componentSetup.colId = c.colId,
            this.componentSetup.isOrgtiqu = c.isOrgtiqu,
            this.componentSetup.isOrgtiqulist = c.isOrgtiqulist,
            this.componentSetup.isBorderLayout = c.isBorderLayout,
            this.componentSetup.isAddForRelation = c.isAddForRelation);
            this.editTpl = m.get("editablecomponent");
            this.componentModel = new h
        },
        setIsAddForRelation: function(c) {
            this.componentSetup.isAddForRelation = c
        },
        getIsAddForRelation: function() {
            return this.componentSetup.isAddForRelation
        },
        setCondition: function(c) {
            this.componentSetup.condition = c
        },
        setRelateField: function(c) {
            this.componentSetup.relateField = c
        },
        getRelateField: function() {
            return this.componentSetup.relateField
        },
        getCondition: function() {
            return this.componentSetup.condition
        },
        setTitle: function(c) {
            this.componentSetup.title = c
        },
        getTitle: function(c) {
            return this.componentSetup.title
        },
        setDfremind: function(c) {
            this.componentSetup.dfremind = c
        },
        getDfremind: function(c) {
            return this.componentSetup.dfremind
        },
        setTitleLayout: function(c) {
            this.componentSetup.titleLayout = c
        },
        setOrder: function(c) {
            this.componentSetup.order = c
        },
        setIndex: function(c) {
            this.componentSetup.index = c
        },
        setDescribe: function(c) {
            this.componentSetup.describe = c
        },
        setRequired: function(c) {
            this.componentSetup.required = c
        },
        setSize: function(c) {
            this.componentSetup.size = c
        },
        setFieldId: function(c) {
            this.componentSetup.fieldId = c
        },
        getFieldId: function() {
            return this.componentSetup.fieldId
        },
        setIsReadOnly: function(c) {
            this.componentSetup.isReadOnly = c
        },
        setIsDefault: function(c) {
            this.componentSetup.isDefault = c
        },
        setContent: function(c) {
            this.componentSetup.content = c
        },
        getContent: function() {
            return this.componentSetup.content
        },
        setIsHideTitle: function(c) {
            this.componentSetup.isHideTitle = c
        },
        getComponentKey: function() {
            return this.componentSetup.componentKey
        },
        setNumberType: function(c) {
            this.componentSetup.numberType = c
        },
        getNumberType: function() {
            return this.componentSetup.numberType
        },
        setPlaceholder: function(c) {
            this.componentSetup.placeholder = c
        },
        getPlaceHolder: function(c) {
            return this.componentSetup.placeholder
        },
        setRelatDataTableId: function(c) {    //  数据来源项
            this.componentSetup.tableId = c;
        },
        getRelatDataTableId: function(c) {
            return this.componentSetup.tableId
        },
        setRelatDataUnitId: function(c) {    //  数据来源表
            this.componentSetup.colId = c;
        },
        getRelatDataUnitId: function(c) {
            return this.componentSetup.colId
        },
        setIsOrgtiqu: function(c) {     //  提取数据
            this.componentSetup.isOrgtiqu = c;
        },
        getIsOrgtiqu: function(c) {
            return this.componentSetup.isOrgtiqu
        },
        setIsOrgtiqulist: function(c) {    //  列表显示
            this.componentSetup.isOrgtiqulist = c;
        },
        getIsOrgtiqulist: function(c) {
            return this.componentSetup.isOrgtiqulist
        },
        setIsBorderLayout: function(c) {    //  列表显示
            this.componentSetup.isBorderLayout = c;
        },
        getIsBorderLayout: function(c) {
            return this.componentSetup.isBorderLayout
        },
        render: function(c, b) {
            var d = this;
            b.find(".widget-title .widget-title_js").text(this.componentSetup.title);
            "RadioBox" != this.componentSetup.componentKey && "CheckBox" != this.componentSetup.componentKey && b.find(".form-control").removeClass('medium').addClass(this.componentSetup.size);
            c.attr("class", b.attr("class"));
            c.addClass(this.componentSetup.titleLayout);
            d.componentSetup.tempId ? c.attr("tempId", d.componentSetup.tempId) : this.componentModel.generatorId(function(a) {
                a = a.generatorId;
                d.componentSetup.tempId = a;
                c.attr("tempId", a)
            });
            -1 < $.inArray(d.componentSetup.componentKey, f) && b.append($(this.editTpl).siblings(".save-common-toolbar"))
        },
        renderEditPreview: function(c, b) {
            var d = this;
            b.find(".widget-title .widget-title_js").text(d.componentSetup.title);
            "true" != d.componentSetup.required && 1 != d.componentSetup.required || b.find(".widget-title .widget-required_js").text(" *");
            "true" != d.componentSetup.isHideTitle && 1 != d.componentSetup.isHideTitle || c.hasClass("subtd_js") || b.addClass("field-notitle").find(".widget-title .widget-title_js").addClass("hide");
            "true" != d.componentSetup.isDefault && 1 != d.componentSetup.isDefault || b.find(".field-value_js").val(d.componentSetup.content);
            "" != d.componentSetup.describe && (b.find(".field-description").text(d.componentSetup.describe),
            b.find(".field-description").show());
            b.find("input:radio[name\x3d'component-type'][value\x3d'" + d.componentSetup.numberType + "']").attr("checked", !0);
            "NumberComponent" == d.componentSetup.componentKey && d.componentSetup.size ? b.find(".form-control").parent().removeClass("medium-box").addClass(d.componentSetup.size + "-box") : "RadioBox" != d.componentSetup.componentKey && "CheckBox" != d.componentSetup.componentKey && b.find(".form-control").removeClass('medium').addClass(d.componentSetup.size);
            b.attr("id", d.componentSetup.tempId || d.componentSetup.fieldId);
            d.componentSetup.fieldId ? b.attr("tempId", d.componentSetup.tempId || d.componentSetup.fieldId) : d.componentModel.generatorId(function(a) {
                a = a.generatorId;
                d.componentSetup.tempId = a;
                b.attr("tempId", a)
            });
            b.data("componentData", d);
            b.addClass(d.componentSetup.titleLayout);
            -1 < $.inArray(d.componentSetup.componentKey, f) && b.append($(this.editTpl).siblings(".save-common-toolbar"))
        },
        renderEditor: function(c) {
            $(this.editTpl);
            c.find("#component-title").attr("value", this.componentSetup.title);
            c.find("#component-dfremind").attr("value", this.componentSetup.dfremind);
            c.find("input:radio[name\x3d'title-layout'][value\x3d'" + this.componentSetup.titleLayout + "']").attr("checked", !0);
            c.find("input:radio[name\x3d'component-type'][value\x3d'" + this.componentSetup.numberType + "']").attr("checked", !0);
            "percentage" == this.componentSetup.numberType && 0 < c.find("#j_default_value #type-item").length && (c.find("#j_default_value #type-item").removeClass("hide"),
            c.find("#j_default_value #type-item").parent().find(".input-instead").addClass("input-instead-border"));
            c.find("#component-describe").text(this.componentSetup.describe);
            0 > $.inArray(this.componentSetup.componentKey, g) && c.append($(this.editTpl).siblings(".j_relate_group"));
            c.find("#component-describe").closest(".form-group").after($(this.editTpl).siblings(".j_condition_group"));
            "true" != this.componentSetup.required && 1 != this.componentSetup.required || c.find("#required").attr("checked", "true");
            "true" != this.componentSetup.isHideTitle && 1 != this.componentSetup.isHideTitle || c.find("#isHideTitle").attr("checked", "true");
            "true" != this.componentSetup.isOrgtiqu && 1 != this.componentSetup.isOrgtiqu || c.find("#orgtiqu").attr("checked", "true");
            "true" != this.componentSetup.isOrgtiqulist && 1 != this.componentSetup.isOrgtiqulist || c.find("#orgtiqulist").attr("checked", "true");
            "true" != this.componentSetup.isBorderLayout && 1 != this.componentSetup.isBorderLayout || c.find("#isBorderLay").attr("checked", "true");
            "true" == this.componentSetup.isDefault || 1 == this.componentSetup.isDefault ? (c.find("#isDefault").attr("checked", "true"),
            c.find("#j_default_value").removeClass("hide")) : c.find("#j_default_value").addClass("hide");
            "true" != this.componentSetup.isReadOnly && 1 != this.componentSetup.isReadOnly || c.find("#isReadOnly").attr("checked", "true");
            0 <= $.inArray(this.componentSetup.componentKey, d) && (c.append($(this.editTpl).siblings(".j_input_placeholder")),
            c.find("#input_placeholder").text(this.componentSetup.placeholder));
            0 <= $.inArray(this.componentSetup.componentKey, b) && (c.find(".js_add_relation_position").append($(this.editTpl).siblings(".j_relation_add")),
            "false" != this.componentSetup.isAddForRelation && 0 != this.componentSetup.isAddForRelation && c.find("#isRelationAdd").attr("checked", "true"));
            c.find("#content").attr("value", this.componentSetup.content);
            c.find("input:radio[name\x3d'tSize'][value\x3d'" + this.componentSetup.size + "']").attr("checked", "true")
            c.find(".j_relate_datatable").attr('datatableid', this.componentSetup.tableId);
            c.find(".j_relate_dataunit").attr('datacolid', this.componentSetup.colId);
        },
        renderPreview: function(c, b, d, a) {
            a.find(".widget-title .widget-title_js").text(this.componentSetup.title);
            "true" != this.componentSetup.required && 1 != this.componentSetup.required || a.find(".widget-title .widget-required_js").text(" *");
            "true" != this.componentSetup.isHideTitle && 1 != this.componentSetup.isHideTitle || a.addClass("field-notitle").find(".widget-title .widget-title_js").addClass("hide");
            var f = a.find(".check_js");
            if ("true" == this.componentSetup.isDefault || 1 == this.componentSetup.isDefault)
                b || f.val(this.componentSetup.content);
            "true" != this.componentSetup.isReadOnly && 1 != this.componentSetup.isReadOnly || f.attr("disabled", !0);
            "" != this.componentSetup.describe && (a.find(".field-description").text(this.componentSetup.describe),
            a.find(".field-description").show());
            "NumberComponent" == this.componentSetup.componentKey && this.componentSetup.size ? a.find(".form-control").parent().removeClass("medium-box").addClass(this.componentSetup.size + "-box") : f.addClass(this.componentSetup.size);
            f.attr("cid", this.cid);
            f.attr("id", this.componentSetup.fieldId || this.componentSetup.tempId).attr("name", this.componentSetup.fieldId || this.componentSetup.tempId);
            f.data("componentData", this);
            a.attr("id", "field_" + (this.componentSetup.fieldId || this.componentSetup.tempId));
            a.addClass(this.componentSetup.titleLayout);
            this.el = c;
            this.readOnly(a, d)
        },
        submitCheck: function(c, b) {
            var d = this.check(c);
            b(d)
        },
        getCacheRelate: function(c) {
            var b = this.relates;
            return null != b ? b[c] : null
        },
        setCacheRelate: function(c, b) {
            null == this.relates && (this.relates = {});
            this.relates[b] = c
        },
        fillRelateValue: function(c, b, d, a) {
            var f = this
              , g = b.find("#field_" + c + " .check_js")
              , h = b.data(c + "_relateFields");
            if (null != h && 0 != h.length) {
                var m = g.data("componentData");
                if (m) {
                    "FormComponent" == m.componentSetup.componentKey && (f.componentSetup.relateField.isField = !0);
                    var n = b.find("#field_" + (f.componentSetup.fieldId || f.componentSetup.tempId));
                    f.empty(n);
                    if ((g = m.getValue(g)) && g.dataOptions && 0 < g.dataOptions.length) {
                        var u = g.dataOptions.pop();
                        (g = m.getCacheRelate(u.optionId)) ? (f.bulidDataDetail(g, h).forEach(function(a) {
                            f.setRelateValue(b.find("#field_" + (f.componentSetup.fieldId || f.componentSetup.tempId)), a)
                        }),
                        d && f.saveComponentValue(b.find("#field_" + (f.componentSetup.fieldId || f.componentSetup.tempId)), d)) : (h = {
                            dataId: u.optionId,
                            entityType: u.type,
                            relateFields: h
                        },
                        (g = b.closest(".form-view_js").data("form")) && g.dataId && (h.formDataId = g.dataId),
                        "Employee" == m.componentSetup.componentKey && (h.entityType = "employee"),
                        g = "freeform/queryRelateEntity.json",
                        !$("body").find("#formTenantKey").val() || null != TEAMS.currentUser && TEAMS.currentTenant.tenantKey.toUpperCase() == $("body").find("#formTenantKey").val().toUpperCase() || (g = TEAMS.service.baseUrl + "/datasources/queryRelateEntity.json"),
                        $.ajax({
                            contentType: "application/json",
                            type: TEAMS.ajaxMethod,
                            data: JSON.stringify(h),
                            dataType: "json",
                            async: !1,
                            url: g,
                            success: function(g) {
                                b.data(c + "_relateFields", g.relateFields);
                                m.setCacheRelate(g.relateObject, u.optionId);
                                f.bulidDataDetail(g.relateObject, g.relateFields).forEach(function(c) {
                                    f.setRelateValue(n, c, a)
                                });
                                d && f.saveComponentValue(n, d)
                            }
                        }))
                    } else {
                        if ("Money" == f.componentSetup.componentKey || "NumberComponent" == f.componentSetup.componentKey || "Monitor" == f.componentSetup.componentKey)
                            h = f.el.closest(".subform_js"),
                            0 < h.length && formPlugin.renderTotal(h),
                            n.find("input:first").trigger("blur", {
                                isAutoSave: a
                            });
                        "DateInterval" == f.componentSetup.componentKey && ("mobile" == window.systemInfo_form ? n.find("input:first").trigger("monitor_change") : n.find("input:first").trigger("change", {
                            isAutoSave: a
                        }));
                        d && f.saveComponentValue(n, d)
                    }
                }
            }
        },
        bulidDataDetail: function(c, b) {
            for (var d = [], a = null, f = c.relateEntity, g = c.dataDetails, h = null, m = 0; m < b.length; m++)
                if (b[m].id == this.componentSetup.tempId) {
                    h = b[m];
                    break
                }
            if (1 != h.isField && "true" != h.isField)
                if ("tasktype" == h.key && null != h.taskTypes) {
                    if (null != g && 0 < g.length) {
                        if (1 == h.isComplex || "true" == h.isComplex) {
                            for (m = 0; m < g.length; m++)
                                for (f = 0; f < h.subIds.length; f++)
                                    if (g[m].formField.id + "" == h.subIds[f]) {
                                        a = JSON.parse(JSON.stringify(g[m]));
                                        "ComboSelect" == this.componentSetup.componentKey && this.componentSetup.selectIds.length > f && (a.formField = {
                                            id: this.componentSetup.selectIds[f]
                                        },
                                        a.isMacthByName = !0,
                                        d.push(a));
                                        "DateInterval" == this.componentSetup.componentKey && (0 == f ? a.formField = {
                                            id: this.componentSetup.start.fieldId
                                        } : 1 == f && (a.formField = {
                                            id: this.componentSetup.end.fieldId
                                        }),
                                        d.push(a));
                                        break
                                    }
                            return d
                        }
                        for (m = 0; m < g.length; m++)
                            for (f = 0; f < h.taskTypes.length; f++)
                                if (g[m] && g[m].formField.id + "" == h.taskTypes[f].id + "") {
                                    a = g[m];
                                    break
                                }
                    }
                } else {
                    if (null != f) {
                        g = "";
                        h = h.key.split(".");
                        for (m = 0; m < h.length; m++)
                            if (m == h.length - 1)
                                g = f[h[m]];
                            else if (f = f[h[m]],
                            null == f)
                                break;
                        if (null != g)
                            if (a = {},
                            "TextArea" == this.componentSetup.componentKey)
                                a.dataText = {
                                    content: g
                                };
                            else if ("ImageComponent" != this.componentSetup.componentKey && "FileComponent" != this.componentSetup.componentKey || "string" != typeof g)
                                if ("object" == typeof g)
                                    if (g instanceof Array) {
                                        h = [];
                                        for (m = 0; m < g.length; m++)
                                            h.push({
                                                optionId: g[m].id,
                                                content: g[m].name
                                            });
                                        a.dataOptions = h
                                    } else
                                        a.dataOptions = [{
                                            optionId: g.id,
                                            content: g.name
                                        }];
                                else
                                    a.content = g;
                            else
                                a.dataOptions = [{
                                    optionId: g
                                }]
                    }
                }
            else {
                if (null != g && 0 < g.length) {
                    if (1 == h.isComplex || "true" == h.isComplex) {
                        for (m = 0; m < g.length; m++)
                            for (f = 0; f < h.subIds.length; f++)
                                if (g[m].formField.id + "" == h.subIds[f]) {
                                    a = JSON.parse(JSON.stringify(g[m]));
                                    "ComboSelect" == this.componentSetup.componentKey && this.componentSetup.selectIds.length > f && (a.formField = {
                                        id: this.componentSetup.selectIds[f]
                                    },
                                    a.isMacthByName = !0,
                                    d.push(a));
                                    "DateInterval" == this.componentSetup.componentKey && (0 == f ? a.formField = {
                                        id: this.componentSetup.start.fieldId
                                    } : 1 == f && (a.formField = {
                                        id: this.componentSetup.end.fieldId
                                    }),
                                    d.push(a));
                                    break
                                }
                        return d
                    }
                    for (m = 0; m < g.length; m++)
                        if (g[m] && g[m].formField.id + "" == h.key) {
                            a = g[m];
                            break
                        }
                }
                "TextArea" == this.componentSetup.componentKey && a && a.content && (a.dataText = {
                    content: a.content
                });
                "Text" == this.componentSetup.componentKey && a && a.dataText && a.dataText.content && (a.content = a.dataText.content)
            }
            null != a && (a.isMacthByName = !0);
            d.push(a);
            return d
        },
        setRelateValue: function(c, b, d) {
            if (null != b) {
                if ("Text" == this.componentSetup.componentKey) {
                    var a = parseInt(this.componentSetup.maxlen);
                    !isNaN(a) && null != b && null != b.content && b.content.length > a && (b.content = b.content.substring(0, a))
                }
                if ("DateComponent" == this.componentSetup.componentKey || "DateInterval" == this.componentSetup.componentKey) {
                    a = this.componentSetup.format;
                    "DateInterval" == this.componentSetup.componentKey && (a = this.componentSetup.start.format);
                    var f = b.content
                      , g = "";
                    f && 0 < (f + "").length && ("yyyy-MM-dd HH:mm" == a ? g = Date.create(f).format("{yyyy}-{MM}-{dd} {HH}:{mm}") : "yyyy-MM-dd" == a ? g = Date.create(f).format("{yyyy}-{MM}-{dd}") : "yyyy-MM" == a && (g = Date.create(f).format("{yyyy}-{MM}")));
                    b.content = g
                }
                "DateInterval" == this.componentSetup.componentKey ? this.setValue(c.find("#field_" + b.formField.id), b) : this.setValue(c, b)
            }
            if ("Money" == this.componentSetup.componentKey || "NumberComponent" == this.componentSetup.componentKey || "Monitor" == this.componentSetup.componentKey)
                b = this.el.closest(".subform_js"),
                0 < b.length && formPlugin.renderTotal(b),
                c.find("input:first").trigger("blur", {
                    isAutoSave: d
                });
            "DateInterval" == this.componentSetup.componentKey && ("mobile" == window.systemInfo_form ? c.find("input:first").trigger("monitor_change") : c.find("input:first").trigger("change", {
                isAutoSave: d
            }))
        },
        conditionEvent: function(c, b) {
            var d = this
              , a = d.el.closest(".subtr_js")
              , f = 1 == a.length ? a : d.el.closest(".form-view_js");
            if ((a = d.componentSetup.relateField) && "null" != a) {
                a.id = d.componentSetup.fieldId || d.componentSetup.tempId;
                var g = !0;
                if (d instanceof RelateComponent && "FormComponent" != d.componentSetup.componentKey) {
                    var h = $("body").find("#formTenantKey").val();
                    h ? h = h.toUpperCase() : null != TEAMS.currentTenant && (h = TEAMS.currentTenant.tenantKey.toUpperCase());
                    if (null == TEAMS.currentUser || TEAMS.currentTenant.tenantKey.toUpperCase() != h)
                        g = !1
                }
                if (1 == g) {
                    var m = a.fieldId
                      , g = f.data(m + "_relateFields");
                    null == g ? (g = [a],
                    f.data(m + "_relateFields", g)) : g.push(a);
                    f.on("fillRelate", "#field_" + m, function(a, c) {
                        !1 === c ? d.fillRelateValue(m, f) : d.fillRelateValue(m, f, b)
                    })
                }
            }
            if (d.el.hasClass("subtd_js") || !c)
                return !0;
            c = c.closest(".form-view_js");
            (a = d.componentSetup.condition) && a.fields && 0 < a.fields.length && $.each(a.fields, function(a, b) {
                c.on("change", "#field_" + b.fieldId + " select,#field_" + b.fieldId + " input[componentkey\x3d'Option'] ", function() {
                    d.checkShow(c)
                });
                c.on("datacheck", "#field_" + b.fieldId + "[componentkey\x3d'DataSource']", function() {
                    d.checkShow(c)
                })
            })
        },
        getRelateFields: function() {
            var c = this
              , b = []
              , d = $("div[tempId\x3d'" + (c.componentSetup.fieldId || c.componentSetup.tempId) + "']").closest(".subtr_js")
              , a = [];
            1 == d.length ? d.find(".relate_js").each(function() {
                var d = $(this)
                  , e = c.componentSetup.tempId;
                (d = d.data("componentData")) && d.componentSetup.tempId != e && !d.componentSetup.relateField && 0 > $.inArray(d.componentSetup.componentKey, a) && ("DataSource" == d.componentSetup.componentKey ? "vacation" == d.componentSetup.sourceModule && b.push(d) : b.push(d))
            }) : $("#formContainer_js").find(".relate_js:not(.subtd_js\x3e.relate_js)").each(function() {
                var d = $(this)
                  , e = c.componentSetup.tempId;
                (d = d.data("componentData")) && d.componentSetup.tempId != e && !d.componentSetup.relateField && 0 > $.inArray(d.componentSetup.componentKey, a) && ("DataSource" == d.componentSetup.componentKey ? "vacation" == d.componentSetup.sourceModule && b.push(d) : b.push(d))
            });
            return b
        },
        renderTemplateById: function(c) {
            var b = null
              , d = {};
            d.templateId = c;
            d.detailsLevel = "1";
            $.ajax({
                contentType: "application/json",
                type: TEAMS.ajaxMethod,
                async: !1,
                url: TEAMS.api.queryDateDetailsByDetails,
                dataType: "json",
                data: JSON.stringify(d),
                success: function(a) {
                    b = a.templateDetailsList
                }
            });
            return b
        },
        getAllComboSelectOptions: function(c, b) {
            var d = [];
            if (c && 0 < c.length)
                for (var a = 0; a < c.length; a++) {
                    var f = c[a]
                      , g = new Option;
                    g.setName(f.name);
                    g.setOrder(f.order);
                    g.setSelectionId(f.id);
                    g.setUid(f.id);
                    "ComboSelect" == b && f.children && f.children && 0 < f.children.length && g.setChildren(this.getAllComboSelectOptions(f.children, b));
                    d.push(g.componentSetup)
                }
            return d
        },
        getConditionFields: function() {
            var c = this
              , b = [];
            $("#formContainer_js").find(".field_js[componentkey\x3d'DataSource'],.field_js[componentkey\x3d'Select'],.field_js[componentkey\x3d'CheckBox'],.field_js[componentkey\x3d'RadioBox'],.field_js[componentkey\x3d'ComboSelect']").each(function() {
                var d = $(this);
                if (!d.parent().hasClass("subtd_js")) {
                    var a = d.data("componentData")
                      , d = c.componentSetup.tempId
                      , f = a.componentSetup.componentKey;
                    if ("Select" == f || "ComboSelect" == f) {
                        var g = a.componentSetup.templateId;
                        g && (g = c.renderTemplateById(g),
                        null != g && (a.componentSetup.options = c.getAllComboSelectOptions(g, f)))
                    }
                    "DataSource" == f && (g = {},
                    g.sourceModule = a.componentSetup.sourceModule,
                    g.templateId = a.componentSetup.dataTemplateId,
                    $.ajax({
                        type: TEAMS.ajaxMethod,
                        url: "freeform/queryDataSourceOption.json",
                        dataType: "json",
                        data: g,
                        async: !1,
                        success: function(b) {
                            var d = [];
                            b.optionPage && b.optionPage.result && (d = b.optionPage.result);
                            a.options = c.getAllComboSelectOptions(d, f)
                        }
                    }));
                    d ? a && a.componentSetup.tempId != d && (g = [],
                    a.getFormConditionFields(g),
                    0 > $.inArray(d, g) && b.push(a)) : b.push(a)
                }
            });
            return b
        },
        getFormConditionFields: function(b) {
            var d = this.componentSetup.condition;
            if (d && d.fields && 0 < d.fields.length)
                for (var e = 0; e < d.fields.length; e++) {
                    var a = d.fields[e];
                    "string" == typeof a && (a = JSON.parse(a));
                    b.push(a.fieldId);
                    a = $("#formContainer_js").find("[tempId\x3d'" + a.fieldId + "']");
                    0 < a.length && a.data("componentData").getFormConditionFields(b)
                }
        },
        getSelectUids: function(b, d) {
            var e = b.attr("componentkey")
              , a = "";
            "Select" == e ? a = b.find("option:selected").attr("uid") : "ComboSelect" == e ? b.find("select").each(function() {
                a += $(this).find("option:selected").attr("uid") + ","
            }) : "DataSource" == e ? b.find(".js_datasource .j_data_source").each(function() {
                a += $(this).attr("data-id") + ","
            }) : b.find("input:checked").each(function() {
                a += $(this).attr("uid") + ","
            });
            return a ? a.split(",") : []
        },
        checkFields: function(b, d) {
            var e = b.values.toString()
              , a = b.operate
              , f = !0
              , g = d.find("#field_" + b.fieldId);
            0 < g.length && (f = !1,
            g = this.getSelectUids(g, d),
            "in" == a && $.each(g, function(a, b) {
                if (0 < b.length && 0 <= e.indexOf(b))
                    return f = !0,
                    !1
            }),
            "notin" == a && (f = !0,
            $.each(g, function(a, b) {
                if (0 < b.length && 0 <= e.indexOf(b))
                    return f = !1
            })));
            return f
        },
        unique: function(b) {
            var d = []
              , e = {};
            if (b)
                for (var a = 0; a < b.length; a++)
                    e[b[a].id] || (d.push(b[a]),
                    e[b[a].id] = 1);
            return d
        },
        checkShow: function(b) {
            var d = null
              , d = b.is("th") ? b : b.find('[cid\x3d"' + this.cid + '"]').closest(".field_js,.no_field_js");
            b = b.closest(".form-view_js");
            var e = this.componentSetup.condition
              , a = !0;
            if (e && e.fields && 0 < e.fields.length) {
                var f = e.fields
                  , e = e.operate;
                if ("or" == e)
                    for (var a = !1, g = 0; g < f.length; g++)
                        if (this.checkFields(f[g], b)) {
                            a = !0;
                            break
                        }
                if ("and" == e)
                    for (g = 0; g < f.length; g++)
                        if (!this.checkFields(f[g], b)) {
                            a = !1;
                            break
                        }
            }
            a ? d.hasClass("subtd_js") ? (b = d.index(),
            d = d.closest(".subtable_js"),
            d.find("tbody").find("tr").find("td:eq(" + b + "),th:eq(" + b + ")").removeClass("form-condition-hide"),
            d.find("tfoot").find("tr").find("td:eq(" + b + ")").removeClass("form-condition-hide"),
            d.closest(".subform_js").removeClass("form-condition-hide"),
            d.find("tfoot").removeClass("form-condition-hide"),
            0 == d.find("tfoot").find("td:not(.form-condition-hide,.hide)").children().length && d.find("tfoot").addClass("form-condition-hide")) : d.parent().is("td") ? (d.removeClass("form-condition-hide"),
            d.closest("tr").removeClass("form-condition-hide"),
            d.closest('[componentkey\x3d"TableLayout"]').removeClass("form-condition-hide")) : d.parent().hasClass("cell_js") ? (d = d.parent(),
            d.removeClass("form-condition-hide"),
            d.closest('[componentkey\x3d"ColumnPanel"]').removeClass("form-condition-hide"),
            2 < d.closest('[componentkey\x3d"ColumnPanel"]').find(".cell_js:not(.form-condition-hide,.hide)").length && d.parent().addClass("three-columns")) : d.removeClass("form-condition-hide") : d.hasClass("subtd_js") ? (b = d.index(),
            d = d.closest(".subtable_js"),
            d.find("tbody").find("tr").find("td:eq(" + b + "),th:eq(" + b + ")").addClass("form-condition-hide"),
            d.find("tfoot").find("tr").find("td:eq(" + b + ")").addClass("form-condition-hide"),
            0 == d.find("tfoot").find("td:not(.form-condition-hide,.hide)").children().length && d.find("tfoot").addClass("form-condition-hide"),
            0 == d.find("tbody").find(".subtd_js:not(.form-condition-hide,.hide)").length && d.closest(".subform_js").addClass("form-condition-hide")) : d.parent().is("td") ? (d.addClass("form-condition-hide"),
            0 == d.closest("tr").find("td").children(":not(.form-condition-hide,.hide)").length && d.closest("tr").addClass("form-condition-hide"),
            0 == d.closest('[componentkey\x3d"TableLayout"]').find("tr:not(.form-condition-hide,.hide)").length && d.closest('[componentkey\x3d"TableLayout"]').addClass("form-condition-hide")) : d.parent().hasClass("cell_js") ? (d = d.parent(),
            d.addClass("form-condition-hide"),
            3 > d.closest('[componentkey\x3d"ColumnPanel"]').find(".cell_js:not(.form-condition-hide,.hide)").length && d.parent().removeClass("three-columns"),
            0 == d.closest('[componentkey\x3d"ColumnPanel"]').find(".cell_js:not(.form-condition-hide,.hide)").length && d.closest('[componentkey\x3d"ColumnPanel"]').addClass("form-condition-hide")) : d.addClass("form-condition-hide")
        }
    });
    u.exports = n
});
define("form/relatecomponent", ["form/editablecomponent", "form/tplutil"], function(n, y, u) {
    var m = n("form/editablecomponent");
    n("form/tplutil");
    window.RelateComponent = m.extend({
        initialize: function(h) {
            m.prototype.initialize.call(this, h);
            var g = {
                isUnique: !1,
                tempId: "",
                content: []
            };
            null != h && (g.isUnique = h.isUnique,
            g.tempId = h.tempId || h.fieldId,
            g.content = h.content || []);
            this.componentSetup = $.extend(this.componentSetup, g)
        },
        setIsUnique: function(h) {
            this.componentSetup.isUnique = h
        },
        triggerFillRelate: function(h, g) {
            h.closest(".field_js").trigger("fillRelate", g)
        },
        replaceItemUrl: function(h) {
            h.find(".employee-item").each(function() {
                $(this).attr("href", $(this).data("href"))
            })
        }
    });
    u.exports = window.RelateComponent
});

